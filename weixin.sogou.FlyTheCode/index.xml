<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>FlyTheCode</title>
<link>https://henix.github.io/feeds/weixin.sogou.FlyTheCode/</link>
<description>希望有一天,代码能如风一般飞奔在原野.</description>
<language>zh-cn</language>
<lastBuildDate>Sat, 12 May 2018 16:13:07 +0800</lastBuildDate>
<item>
<title>快捷的动态权限请求 - Permission Requester</title>
<link>https://henix.github.io/feeds/weixin.sogou.FlyTheCode/2018-01-13-1000000005.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?timestamp=1526112787&amp;amp;src=3&amp;amp;ver=1&amp;amp;signature=UoURoPG9cjs*CZOBjPO*j3n5hIePWel0b4IQzAvD2Dh0ll8uO-Wqz2X2MSiXIPL9utO2NoVvOBSMFFClviDOT6SygEFt5rCSKKJ-LNEOwI3b8DL3awA0d8OYlkVi6BoqX6lMgHYIP1psKmJEB*1m*Um-89-7zgf6WlAwKt5Ukng=&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div id=&quot;img-content&quot;&gt;
                
                &lt;h2 class=&quot;rich_media_title&quot; id=&quot;activity-name&quot;&gt;
                    快捷的动态权限请求 - Permission Requester                                    &lt;/h2&gt;
                &lt;div id=&quot;meta_content&quot; class=&quot;rich_media_meta_list&quot;&gt;
                                        &lt;span id=&quot;copyright_logo&quot; class=&quot;rich_media_meta meta_original_tag&quot;&gt;原创&lt;/span&gt;
                                                            &lt;em id=&quot;post-date&quot; class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;2018-01-13&lt;/em&gt;

                                        &lt;em class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;Tankery&lt;/em&gt;
                                        &lt;a class=&quot;rich_media_meta rich_media_meta_link rich_media_meta_nickname&quot; href=&quot;##&quot; id=&quot;post-user&quot;&gt;FlyTheCode&lt;/a&gt;
                    &lt;span class=&quot;rich_media_meta rich_media_meta_text rich_media_meta_nickname&quot;&gt;FlyTheCode&lt;/span&gt;

                    &lt;div id=&quot;js_profile_qrcode&quot; class=&quot;profile_container&quot; style=&quot;display:none;&quot;&gt;
                        &lt;div class=&quot;profile_inner&quot;&gt;
                            &lt;strong class=&quot;profile_nickname&quot;&gt;FlyTheCode&lt;/strong&gt;
                            &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;微信号&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;FlyTheCode&lt;/span&gt;
                            &lt;/p&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;功能介绍&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;希望有一天，代码能如风一般飞奔在原野。&lt;/span&gt;
                            &lt;/p&gt;
                            
                        &lt;/div&gt;
                        &lt;span class=&quot;profile_arrow_wrp&quot; id=&quot;js_profile_arrow_wrp&quot;&gt;
                            &lt;i class=&quot;profile_arrow arrow_out&quot;&gt;&lt;/i&gt;
                            &lt;i class=&quot;profile_arrow arrow_in&quot;&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                
                
                
                                                
                                                                
                
                &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;之前在问问的一个项目中，需要用到动态权限请求。趁着这个机会，我想把工程中所有项目的权限请求都统一到一起。通过和同事的讨论，发现将权限请求封装成一个 Activity 是最为合适的。通过 Activity，整套权限请求的流程都可以在此 Activity 中完成，各个 App 都只需要调起 Activity，然后获取最终的请求结果，大大简化各 App 请求权限的工作量，并统一了所有 App 的请求流程。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;如今稍有空挡，我将权限请求的逻辑从工程中抽出，去掉工程相关代码，整理成了一套 Android 系统上通用的权限请求库，Permission Reuquester，并且将它开源到了 GitHub 上 (https://github.com/tankery/permission-requester)。Permission Reuquester 可以让你用最少工作量，完成一整套权限请求逻辑。&lt;/p&gt;&lt;h2 style=&quot;box-sizing: border-box;margin: 0.2rem auto 0.5rem;&quot;&gt;&lt;strong&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;背景&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;在运行时请求权限 是 Android 6.0 (API level 23) 开始引入的功能，用户可以在运行应用，而不是安装时来请求必要的权限。目标版本是 23 及以上的应用，都必须在运行时请求“危险”权限。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;有很多事情需要我们考虑。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;首先你需要检查权限来判断应用是否已经获取到所需权限。如果没有权限，那么你得请求您需要的权限，而且通常你需要解释应用为什么需要权限。而请求权限以后，你可能会需要处理权限请求响应，这样你可以在根据权限请求结果来做不同的事情。更麻烦的是，如果用户点选了“不再提醒”，那么你的应用可能就失去获取权限的机会了，你只能选择引导用户到设置中去开启所需权限。&lt;/p&gt;&lt;h2 style=&quot;box-sizing: border-box;margin: 0.2rem auto 0.5rem;&quot;&gt;&lt;strong&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;代码库设计思路&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;我们来整理一下权限请求所需要做的事情：&lt;/p&gt;&lt;ol style=&quot;margin-left: auto;margin-right: auto;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;检查权限。判断是否已经有权限&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;从系统请求权限。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;获取系统权限请求结果。如果请求成功，那很好，你的用户同意了权限；如果失败了，那说明你的用户拒绝了权限请求。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;获取是否需要解释。如果系统告知是需要解释，那么你还有机会给用户一个解释，然后再请求权限。如果不需要解释。那要么是首次请求，要么就是已经请求过，被用户拒绝，且点选了“不再提醒”。如果是后者，那就很尴尬了，你在应用中已经没有机会再次请求权限了。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;跳转到设置。如果你在应用中已经没有机会再次请求权限，那么你只能提示用户去设置里重新开启权限。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;整个库的设计目标，就是尽可能的通过各类提示来向用户请求权限，并让用户始终有办法授权。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;需要注意的是，这个库是比较激进的，一上来会直接请求权限，用户拒绝后才会进行提示，而用户点选了“不再提醒”以后，会弹窗提示用户去设置开启。所以，一定要在某个功能确实需要权限时，才去调用这个库开启权限，这样才不至于打扰用户。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;比如，如果是一个音乐播放器，只有在用户点击“本地音乐”入口时，才去请求磁盘访问权限，这样，将权限请求和用户目标关联起来时，才更有可能争取到用户的同意。而这个库将权限请求这一过程变得如此简单。使得你能非常方便的在各种功能入口都加上对应权限的请求入口，不再会因为觉得麻烦，而在应用一开始，就去请求一大堆将来才会用到的权限。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;下图展示了 Permission Reuquester 是如何完成一次权限请求的：&lt;/p&gt;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;png&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zF3LiaNuTWoWg4WhOP5GpROU17nQ3bAcvjcOvrBzUmE9rMjOsTB5kjq5YDE4Y5ibHnibc20TFD3XViby06RUNTxv2Q/0?wx_fmt=png&quot; data-copyright=&quot;0&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.8461538461538461&quot; data-w=&quot;572&quot;&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;从图中我们看到。如果没有被授权，Permission Requester 会在一开始，就尝试通过系统接口去请求权限，如果你的请求是合理的，而且和用户目标关联，那绝大部分用户会很乐意直接同意这个请求。若用户拒绝，Requester 会弹出一个解释对话框（内容是你指定的），告诉用户我们为什么需要这个权限，并问他是不是要重新请求一下。如果“是”，则重新请求，如果”否“，Requester 会退出，并返回一个授权失败的结果。如果很不幸，用户在拒绝系统权限请求时，点选了”不再提醒“，那么 Requester 会弹出另一个解释对话框，并问他要不要去设置里开启权限。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;这一整套逻辑都被封装在 PermissionRequestActivity 中，对外来说，只需要 start，然后获取最终的请求结果。&lt;/p&gt;&lt;h2 style=&quot;box-sizing: border-box;margin: 0.2rem auto 0.5rem;&quot;&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;&lt;strong&gt;使用方式&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;首先，你需要在工程中引用 Permission Requester。我将这个库上传到了 jcenter，因为是 Gradle 的默认代码仓库，所以你需要做的只是在 module 的 &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;build.gradle&lt;/code&gt;中添加对这个库的依赖即可：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs nginx&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;dependencies&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-attribute&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;compile&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;&#39;me.tankery.lib:permission-requester:1.0.0&#39;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;Gradle 3.0 的话，可以用 implementation 方式依赖：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs nginx&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;dependencies&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-attribute&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;implementation&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;&#39;me.tankery.lib:permission-requester:1.0.0&#39;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;接下来，就可以在代码中使用了。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;要实现一个权限请求非常的容易。如果你不需要立刻获得权限请求结果，而仅仅是申请权限的话。用下面这一行代码就够了：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs css&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;PermissionRequestActivity&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-class&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-class&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;start&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;context&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;PERMISSIONS&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;rationalMsg&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;goSettingsMsg&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;你甚至可以在后台 Service 中开启权限请求。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;而如果你关心请求结果。那么你可以在你的 Activity 中调用另外一行代码：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs css&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;PermissionRequestActivity&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-class&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-class&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;start&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;activity&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;REQUEST_CODE&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;PERMISSIONS&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;rationalMsg&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;goSettingsMsg&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;然后，重载 Activity 的 &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;onActivityResult&lt;/code&gt; 来获取请求结果：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs java&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-meta&quot; style=&quot;box-sizing: border-box;color: rgb(31, 113, 153);&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;protected&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;onActivityResult&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;requestCode&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;resultCode&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;Intent&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;data&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;super&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;onActivityResult&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;requestCode&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;resultCode&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;requestCode&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;REQUEST_CODE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;resultCode&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;RESULT_OK&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;// 授权成功&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;// 授权失败&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;你甚至可以通过重载 &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;showRationaleDialog&lt;/code&gt; 来自定义解释说明对话框的展现形式：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs java&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;cm&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;/**
 * Override this method to show custom dialog.
 * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@param&lt;/span&gt; canRequestAgain if true, show request again dialog, else, show go settings dialog
 * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@param&lt;/span&gt; message dialog message
 * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@param&lt;/span&gt; dialogResult always have a result for user action
 *                     (ok - &amp;gt; positive/cancel -&amp;gt; negative/dismiss -&amp;gt; negative)
 */&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-meta&quot; style=&quot;box-sizing: border-box;color: rgb(31, 113, 153);&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;protected&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;showRationaleDialog&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;final&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;boolean&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;canRequestAgain&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;String&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;message&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;
                                   &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;final&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;DialogResult&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogResult&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;AlertDialog&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;alertDialog&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;AlertDialog&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;this&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setMessage&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setCancelable&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setPositiveButton&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;ok&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;OnClickListener&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-meta&quot; style=&quot;box-sizing: border-box;color: rgb(31, 113, 153);&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;
                &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;onClick&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;DialogInterface&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogInterface&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogInterface&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;dismiss&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogResult&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;onPositive&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setNegativeButton&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;android&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;cancel&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;OnClickListener&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-meta&quot; style=&quot;box-sizing: border-box;color: rgb(31, 113, 153);&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;
                &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;onClick&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;DialogInterface&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogInterface&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogInterface&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;cancel&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setOnCancelListener&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;OnCancelListener&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-meta&quot; style=&quot;box-sizing: border-box;color: rgb(31, 113, 153);&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;
                &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;onCancel&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;DialogInterface&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogInterface&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogInterface&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;dismiss&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;dialogResult&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;onNegative&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;alertDialog&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setCanceledOnTouchOutside&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;br&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 style=&quot;box-sizing: border-box;margin: 0.2rem auto 0.5rem;&quot;&gt;&lt;strong&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;它是如何实现的？&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;如果对实现方案感兴趣（其实也没什么特别的，只是对于从 Settings 返回、被锁屏、退回 Home 等麻烦的情况都做了比较好的处理。代码质量自我感觉也还不错），或者发现了什么问题想查找原因。欢迎下载源码进一步了解。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;如果你遇到什么 bug，或是有什么建议，欢迎提 issues。 已经找到问题并且有修复方案？或是有任何改进的代码，向我提 Pull Request 也是极好的。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;如果你喜欢这个库，加个 Star 就是很好的帮助。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;希望这个库能减轻你的一些繁杂工作的压力，留出时间去创造更美好的东西。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;script nonce=&quot;413112495&quot; type=&quot;text/javascript&quot;&gt;
                    var first_sceen__time = (+new Date());

                    if (&quot;&quot; == 1 &amp;&amp; document.getElementById(&#39;js_content&#39;)) {
                        document.getElementById(&#39;js_content&#39;).addEventListener(&quot;selectstart&quot;,function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf(&quot;WindowsWechat&quot;) != -1){
                            var link = document.createElement(&#39;link&#39;);
                            var head = document.getElementsByTagName(&#39;head&#39;)[0];
                            link.rel = &#39;stylesheet&#39;;
                            link.type = &#39;text/css&#39;;
                            link.href = &quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css&quot;;
                            head.appendChild(link);
                        }
                    })();
                &lt;/script&gt;
                
                
                                
                &lt;div class=&quot;ct_mpda_wrp&quot; id=&quot;js_sponsor_ad_area&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;

                
                                &lt;div class=&quot;reward_area tc&quot; id=&quot;js_preview_reward&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p id=&quot;js_preview_reward_wording&quot; class=&quot;tips_global reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;p&gt;
                        &lt;a class=&quot;reward_access&quot; id=&quot;js_preview_reward_link&quot; href=&quot;##&quot;&gt;&lt;span class=&quot;icon-reward&quot;&gt;&lt;/span&gt;赞赏&lt;/a&gt;

                    &lt;/p&gt;
                &lt;/div&gt;
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_preview_reward_qrcode&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;长按二维码向我转账&lt;/p&gt;
                    &lt;p id=&quot;js_preview_reward_ios_wording&quot; class=&quot;reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; src=&quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png&quot;&gt;&lt;/span&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。&lt;/p&gt;
                &lt;/div&gt;
                            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_toobar3&quot;&gt;
                                            &lt;a class=&quot;media_tool_meta meta_primary&quot; id=&quot;js_view_source&quot; href=&quot;##&quot;&gt;阅读原文&lt;/a&gt;
                                &lt;div id=&quot;js_read_area3&quot; class=&quot;media_tool_meta tips_global meta_primary&quot; style=&quot;display:none;&quot;&gt;阅读 &lt;span id=&quot;readNum3&quot;&gt;&lt;/span&gt;&lt;/div&gt;

                &lt;span style=&quot;display:none;&quot; class=&quot;media_tool_meta meta_primary tips_global meta_praise&quot; id=&quot;like3&quot;&gt;
                    &lt;i class=&quot;icon_praise_gray&quot;&gt;&lt;/i&gt;&lt;span class=&quot;praise_num&quot; id=&quot;likeNum3&quot;&gt;&lt;/span&gt;
                &lt;/span&gt;

                &lt;a id=&quot;js_report_article3&quot; style=&quot;display:none;&quot; class=&quot;media_tool_meta tips_global meta_extra&quot; href=&quot;##&quot;&gt;投诉&lt;/a&gt;

            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_sg_bar&quot;&gt;
                                &lt;a class=&quot;media_tool_meta meta_primary&quot; href=&quot;http://blog.tankery.me/development/dynamic-permission-request&quot; target=&quot;_blank&quot;&gt;阅读原文&lt;/a&gt;
                                
            &lt;/div&gt;</description>
<author>Tankery</author>
<guid isPermaLink="false">2018-01-13-1000000005</guid>
<pubDate>Sat, 13 Jan 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>刨根问底 - 如何将 PCM 音频编码成 MP4？</title>
<link>https://henix.github.io/feeds/weixin.sogou.FlyTheCode/2017-11-18-1000000004.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?timestamp=1526112787&amp;amp;src=3&amp;amp;ver=1&amp;amp;signature=UoURoPG9cjs*CZOBjPO*j3n5hIePWel0b4IQzAvD2Dh0ll8uO-Wqz2X2MSiXIPL9utO2NoVvOBSMFFClviDOT4QVH54yRWKDiZv3Yp5GsA36FQ-2VsnQGBIxUefZpdQB65QrT6toCK4LIXXyGT7NdwlpWcGb0EegRE2YCWupkNg=&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div id=&quot;img-content&quot;&gt;
                
                &lt;h2 class=&quot;rich_media_title&quot; id=&quot;activity-name&quot;&gt;
                    刨根问底 - 如何将 PCM 音频编码成 MP4？                                    &lt;/h2&gt;
                &lt;div id=&quot;meta_content&quot; class=&quot;rich_media_meta_list&quot;&gt;
                                                            &lt;em id=&quot;post-date&quot; class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;2017-11-18&lt;/em&gt;

                                        &lt;em class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;Tankery&lt;/em&gt;
                                        &lt;a class=&quot;rich_media_meta rich_media_meta_link rich_media_meta_nickname&quot; href=&quot;##&quot; id=&quot;post-user&quot;&gt;FlyTheCode&lt;/a&gt;
                    &lt;span class=&quot;rich_media_meta rich_media_meta_text rich_media_meta_nickname&quot;&gt;FlyTheCode&lt;/span&gt;

                    &lt;div id=&quot;js_profile_qrcode&quot; class=&quot;profile_container&quot; style=&quot;display:none;&quot;&gt;
                        &lt;div class=&quot;profile_inner&quot;&gt;
                            &lt;strong class=&quot;profile_nickname&quot;&gt;FlyTheCode&lt;/strong&gt;
                            &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;微信号&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;FlyTheCode&lt;/span&gt;
                            &lt;/p&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;功能介绍&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;希望有一天，代码能如风一般飞奔在原野。&lt;/span&gt;
                            &lt;/p&gt;
                            
                        &lt;/div&gt;
                        &lt;span class=&quot;profile_arrow_wrp&quot; id=&quot;js_profile_arrow_wrp&quot;&gt;
                            &lt;i class=&quot;profile_arrow arrow_out&quot;&gt;&lt;/i&gt;
                            &lt;i class=&quot;profile_arrow arrow_in&quot;&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                
                
                
                                                
                                                                
                
                &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;很多时候，我们会碰到一些棘手的问题。我们会从 Google 去寻找答案，然后一个个尝试，发现都不 work，怎么办？又有些时候，幸运的找到了答案，自己依葫芦画瓢的解决了问题，但问题变了个说法，做了一些修改，原来的办法不生效了怎么办？&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;作为一个有(bu)追(yao)求(lian)的码农，我的想法是，刨根问底，找到 root cause，这样才能恍然大悟，融汇贯通。自己的问题解决了，网上那些可怜的提问者的问题，你也知道答案了。所以从这篇文章文章开始，我决定开始一个系列——刨根问底，记录下那些棘手问题的解决过程，希望也能给大家一些启发。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;今日份的问题是这样的：&lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;“怎么将一个 PCM 音频流（或是WAV 文件流），编码成 MP4 格式（或是其他压缩格式）？”&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;带着这个问题，我们第一件要做的事情，当然是去 Google 一下看看是否有现成的方案。搜索 “android pcm to mp4 file“，或者其他类似的一些方案，你会发现这篇博客和这个回答，一个用实际代码告诉你可以用 MediaCodec + MediaMuxer 来实现，很好，这很原生，然鹅 MediaMuxer 只支持 API18+，覆盖的用户变少了；另一个说用 Android AAC Encoder 这个库；还有一些回答是针对具体问题的，并没有详细说明怎么做。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;如果原始接口可以实现的话，我们并不想引入一个音频编码库（特别是包含 native code 的库），这会使得包体积变大，所以我们先试着去找找无需编码库的原生实现方案。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;我们先来看看 MediaMuxer 的方案。假如我们的工程是基于 API16+ 的（Android4.1，几乎就是覆盖了所有用户了），而 MediaMuxer 是 API18 才引入的。那么，MediaMuxer 的方案就很让人纠结，是放弃一部分用户选用这个方案，还是再找找其他办法？没有实践就没有结论，我们先尝试一下这个方案吧。&lt;/p&gt;&lt;h2 style=&quot;box-sizing: border-box;margin: 0.2rem auto 0.5rem;&quot;&gt;Encode with MediaCodec + MediaMuxer&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;尝试这个方案时，发现 GitHub 上有个项目叫 PCMEncoder 对前文提到的博客做了个封装，比较易于使用。详细的实现我就不说了，逻辑都在 PCMEncoder.java 这个类里面。大致的逻辑，就是先配置好 MediaCodec 和 MediaMuxer，之后用 MediaCodec 对输入的原始音频流做编码以后，利用 MediaMuxer 写入到 MP4 文件。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;放入工程中运行以后，发现确实能方便的编码成 mp4。要不我们就放弃那一小部分用户，把 API 支持上调到 18 吧？但是等等，好像有个小问题，为什么原生文件中的最后一个部分的音频不见了？去它的项目上看，发现有一个 issue，和我遇到同样的问题，而两年过去了，作者并没有回复。。（后面的一个 pull request 是我提交的，后文我会详细讲到这个提交的事情）&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;这么看，就只能靠自己了。第一步是搞清楚为什么有一小段音频被丢失了，解决这个问题，我们至少在 API18 以上是可以工作的。于是仔细研究了作者的逻辑，发现主要是两个部分，一部分是使用 MediaCodec 做编码，另一部分是将 MediaCodec 的输出作为 MediaMuxer 的输入，使用 “writeSampleData” 将编码后的数据写入 MediaMuxer，再由 MediaMuxer 生成 MP4。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;那么就一步步检查问提把，首先看看 MediaCodec，根据官方的文档，了解到作者使用的是一个过时的方式，手动获取到 MediaCodec 的 input buffers，将原始音频一段一段的输入到指定的 buffer 上，然后 enqueue，这几段音频会被传送到编码器上进行编码，完事以后会放到 output buffers 上，需要手动的 query，看看是否有编码完成的 buffer 产生，有的话，就取出这几段 output buffer，并释放它。这个工作流程可以用下面的图来表示：&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;png&quot; src=&quot;http://mmbiz.qpic.cn/mmbiz_png/zF3LiaNuTWoXM5bicAicNVdeGoZkibsAFHP7yQUOsnJhRUkAP3UXH1EBoeon5E1X1hln1VDbAibIbSTvoZQIMicKoobQ/0?wx_fmt=png&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.39335664335664333&quot; data-w=&quot;1144&quot;&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;另外，想要 MediaCodec 能够工作，我们需要处理好它的状态。它的状态，分为两个大的部分，一部分是 Stopped 状态，一部分是 Executing 状态。初始化时，处于 Stopped 的 Uninitialized 状态，需要经过配置（设置编码格式、编码率等信息）以后，进入 Configured 状态。start 之后就进入 Executing 的 Flushed 状态了。此后，如果通过 enqueue 输入了第一个音频数据，MediaCodec 会进入 Running 状态进行编码，以后不断的接收 enqueue 的 input buffer，并把编码输入放到 output buffer。直到收到 EOS (End of Stream) 信息后，进入 End of Stream 状态。 stop 后，回到 Uninitialized 的状态。状态变化如下图：&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;png&quot; src=&quot;http://mmbiz.qpic.cn/mmbiz_png/zF3LiaNuTWoXM5bicAicNVdeGoZkibsAFHP7zW28IltDQJOoDYYsg7qJy7xe3BkKcjx3lxgbwteYoPJA0ibByicXhAzw/0?wx_fmt=png&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7035647279549718&quot; data-w=&quot;1066&quot;&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;前文说了。这是一种过时的方式，新的使用姿势，应该是用 async 方式，接收更新回调后做动作，而不是不断的 query。详情可以查看MediaCodec 的官方文档。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;从这个状态图我们看到，有一个 &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;End of Stream&lt;/strong&gt; 状态，需要接收到 EOS 信息，这里有些懵逼，PCMEncoder 作者的代码中也没有体现。但是继续查看文档以后，发现这么一句话：”When you reach the end of the input data, you must signal it to the codec by specifying the BUFFER_FLAG_END_OF_STREAM flag in the call to queueInputBuffer.“ 是啊，这应该就是问题的关键了。作者并没有发送 BUFFER_FLAG_END_OF_STREAM 的 flag，我设置了以后，发现工作正常了，最后那么丢失的音节回来了，棒！&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;回过头想想，作者应该是因为希望可以多次 encode，所以忘记发送这个 flag 了。我们可以在 stop 前，先发送这个flag，就可以解决这个问题了，于是 fork 了作者的项目，修改代码，给他提交了一个 pull request。作者在沉寂了两年以后，终于出现，合并了我的 PR，并对我表达了感谢。&lt;/p&gt;&lt;h2 style=&quot;box-sizing: border-box;margin: 0.2rem auto 0.5rem;&quot;&gt;Encode with MediaCodec&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;这事儿并没完。从字面上理解，MediaCodec 是编码，MediaMuxer 应该是混音。看文档的话，大致也是这样的意思。那么，我们要做的不就是编码么？为啥还需要一个混音呢？而且关键的是 MediaMuxer 才是那个需要 API18 的类。MediaCodec 是只需要 API16 的，这和我们的项目很契合。于是，自然的，我就想是不是去掉 MediaMuxer 试试。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;第一个朴素的想法，是将 MediaCodec 输出直接写入文件。它不是做编码的么？编码完了，写入文件不就行了？于是我就这么做了。然而发现输出的文件并不能播放。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;回想起以前做相关事情的经验，我猜是否因为有些文件头之类的东西没设置导致无法播放？经过以关键词一番搜索，发现原因是 MediaCodec 编码出来的格式 audio/mp4a-latm 实际上是 AAC 的格式，无法直接播放，需要一个容器来承载才可以播放，通常的方法是使用 ADTS 作为容器，为每一帧都增加一些说明字段就可以将 AAC 格式转换成可播放的 mp4 了。相关的 Stack Overflow 的回答，比较好的是这篇，它通过下面的代码来为每一帧 ACC 添加帧信息，使其转换为 ADTS 的一帧：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs cs&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;cm&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;/**
 *  Add ADTS header at the beginning of each and every AAC packet.
 *  This is needed as MediaCodec encoder generates a packet of raw
 *  AAC data.
 *
 *  Note the packetLen must count in the ADTS header itself.
 **/&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;addADTStoPacket&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;//AAC LC&lt;/span&gt;&lt;/span&gt;
                      &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;//39=MediaCodecInfo.CodecProfileLevel.AACObjectELD;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;//44.1KHz&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;//CPE&lt;/span&gt;&lt;/span&gt;

    &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;// fill in ADTS data&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;xFF&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;xF9&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)(((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)(((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;11&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0x7&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;FF&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)(((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;7&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0x1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;xFC&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;再将编码后的 ACC 数据填入该帧的剩余部分，之后写入文件，就能以 mp4 格式播放了。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;其中，比较关键的是选择好配置信息。函数头部的三个变量 &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;profile&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/code&gt; 就是分别用来配置 AAC Profile, 频率索引 和 声道的。&lt;/p&gt;&lt;ul style=&quot;margin-left: auto;margin-right: auto;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;profile 必须与 MediaCodec 的 &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;KEY_AAC_PROFILE&lt;/code&gt; 配置相匹配，其值可以在 &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodecInfo.CodecProfileLevel&lt;/code&gt; 找到。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;freqIdx 采样频率索引，不是具体的频率值，而是有一个频率值的列表，这个 index 代表了指定频率在该列表的索引，该频率需要和输入源的频率匹配。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;chanCfg 声道数目，这个需要和输入源匹配。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;这三个值的取值范围都可以在 MPEG-4 Audio 的文档中找到。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;最终，我将这些配置封装起来，与 MediaCodec 配合，实现了比较方便的，支持到 API16 的 MP4 编码方案。其代码只有一个类，关键代码如下（完整代码可以在我的 Gist 上找到）：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs java&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;cm&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;/**
 * PCMEncoder
 *
 * Encode PCM stream into MP4 file stream.
 *
 * Created by tankery on 11/11/2017.
 */&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-class&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;class&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-class&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-class&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;PCMEncoder&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-class&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;cm&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;/**
     * Creates encoder with given params for output file
     * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@param&lt;/span&gt; bitrate Bitrate of the output file, higher bitrate brings better voice, but
     *                lager file. eg. 64k is enough for speech, its about 28MB/hour after encode.
     * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@param&lt;/span&gt; sampleRate sampling rate of pcm.
     * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@param&lt;/span&gt; channelCount channel count of pcm.
     */&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;PCMEncoder&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;final&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;bitrate&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;final&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;channelCount&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;this&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;bitrate&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bitrate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;this&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;this&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;channelCount&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;channelCount&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;for&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;SUPPORTED_SAMPLE_RATES&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;SUPPORTED_SAMPLE_RATES&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;/**
     * Encodes input stream
     *
     * &lt;span class=&quot;hljs-doctag&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;@throws&lt;/span&gt; IOException
     */&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;encode&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;InputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;OutputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;throws&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;IOException&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;boolean&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;while&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;readInputs&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;writeOutputs&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;prepare&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;Timber&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;&quot;Preparing PCMEncoder&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaFormat&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;createAudioFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;COMPRESSED_AUDIO_FILE_MIME_TYPE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;channelCount&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setInteger&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;KEY_AAC_PROFILE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;COMPRESSED_AUDIO_PROFILE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;setInteger&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;KEY_BIT_RATE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bitrate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;createEncoderByType&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;COMPRESSED_AUDIO_FILE_MIME_TYPE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;CONFIGURE_FLAG_ENCODE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;codecInputBuffers&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;getInputBuffers&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;codecOutputBuffers&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;getOutputBuffers&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;BufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;totalBytesRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;presentationTimeUs&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;tempBuffer&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;catch&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;Timber&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;&quot;Exception while initializing PCMEncoder&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;stop&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;Timber&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;&quot;Stopping PCMEncoder&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;boolean&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;readInputs&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;InputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;throws&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;IOException&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;boolean&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;currentBatchRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;while&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;currentBatchRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;50&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;dequeueInputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;CODEC_TIMEOUT&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;ByteBuffer&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;buffer&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;codecInputBuffers&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;];&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;clear&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;

                &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bytesRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;tempBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;());&lt;/span&gt;
                &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bytesRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;queueInputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;presentationTimeUs&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;BUFFER_FLAG_END_OF_STREAM&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;totalBytesRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bytesRead&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;currentBatchRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bytesRead&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;tempBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bytesRead&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;queueInputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputBufferIndex&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bytesRead&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;presentationTimeUs&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;presentationTimeUs&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1000000L&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;totalBytesRead&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;sampleRate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;hasMoreData&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-meta&quot; style=&quot;box-sizing: border-box;color: rgb(31, 113, 153);&quot;&gt;@SuppressLint&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;&quot;WrongConstant&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;writeOutputs&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;OutputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputStream&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;throws&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;IOException&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;while&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;INFO_TRY_AGAIN_LATER&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;dequeueOutputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;CODEC_TIMEOUT&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;flags&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;BUFFER_FLAG_CODEC_CONFIG&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;releaseOutputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;// Write ADTS header and AAC data to frame.&lt;/span&gt;&lt;/span&gt;
                    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outPacketSize&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;7&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;// 7 is ADTS size&lt;/span&gt;&lt;/span&gt;
                    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outPacketSize&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;];&lt;/span&gt;  &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;//space for ADTS header included&lt;/span&gt;&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;addADTStoPacket&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outPacketSize&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;

                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;ByteBuffer&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encodedData&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;codecOutputBuffers&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;];&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encodedData&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encodedData&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encodedData&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;7&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;bufferInfo&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encodedData&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;clear&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outPacketSize&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;//open FileOutputStream beforehand&lt;/span&gt;&lt;/span&gt;

                    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;releaseOutputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;INFO_OUTPUT_BUFFERS_CHANGED&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;codecOutputBuffers&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;getOutputBuffers&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputBufferIndex&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;MediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;INFO_OUTPUT_FORMAT_CHANGED&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaFormat&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;mediaCodec&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;getOutputFormat&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;cm&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;/**
     *  Add ADTS header at the beginning of each and every AAC packet.
     *  This is needed as MediaCodec encoder generates a packet of raw
     *  AAC data.
     *
     *  Note the packetLen must count in the ADTS header itself.
     **/&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;addADTStoPacket&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;COMPRESSED_AUDIO_PROFILE&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;this&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;channelCount&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;c1&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box;color: rgb(136, 136, 136);&quot;&gt;// fill in ADTS data&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;xFF&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;xF9&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)(((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;freqIdx&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)(((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;chanCfg&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;11&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0x7&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;FF&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)(((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packetLen&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;7&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0x1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;byte&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;xFC&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;调用非常简单，初始化以后，直接 encode 就搞定了：&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs coffeescript&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;PCMEncoder&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;new&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;PCMEncoder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;64000&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;8000&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;inputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;outputStream&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;catch&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;大功告成。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;通过一番刨根问底，我们得到了下面这些收获：&lt;/p&gt;&lt;ol style=&quot;margin-left: auto;margin-right: auto;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;熟悉了 AAC, MP4 等格式；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;了解了如何使用 MediaCodec, MediaMuxer；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;使我们的应用支持在 API16 上进行编码，且不依赖第三方库；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;为一个开源项目贡献了代码（Pull Request）；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;输出了一份 Gist 以帮助他人快速使用；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;输出了这篇文章，将来也许能帮助更多人走出谜团。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;有了这些收获，我觉得我又降低了地球上的熵，让这个世界更美好了一些。✌️&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;script nonce=&quot;1199846452&quot; type=&quot;text/javascript&quot;&gt;
                    var first_sceen__time = (+new Date());

                    if (&quot;&quot; == 1 &amp;&amp; document.getElementById(&#39;js_content&#39;)) {
                        document.getElementById(&#39;js_content&#39;).addEventListener(&quot;selectstart&quot;,function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf(&quot;WindowsWechat&quot;) != -1){
                            var link = document.createElement(&#39;link&#39;);
                            var head = document.getElementsByTagName(&#39;head&#39;)[0];
                            link.rel = &#39;stylesheet&#39;;
                            link.type = &#39;text/css&#39;;
                            link.href = &quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css&quot;;
                            head.appendChild(link);
                        }
                    })();
                &lt;/script&gt;
                
                
                                
                &lt;div class=&quot;ct_mpda_wrp&quot; id=&quot;js_sponsor_ad_area&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;

                
                                &lt;div class=&quot;reward_area tc&quot; id=&quot;js_preview_reward&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p id=&quot;js_preview_reward_wording&quot; class=&quot;tips_global reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;p&gt;
                        &lt;a class=&quot;reward_access&quot; id=&quot;js_preview_reward_link&quot; href=&quot;##&quot;&gt;&lt;span class=&quot;icon-reward&quot;&gt;&lt;/span&gt;赞赏&lt;/a&gt;

                    &lt;/p&gt;
                &lt;/div&gt;
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_preview_reward_qrcode&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;长按二维码向我转账&lt;/p&gt;
                    &lt;p id=&quot;js_preview_reward_ios_wording&quot; class=&quot;reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; src=&quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png&quot;&gt;&lt;/span&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。&lt;/p&gt;
                &lt;/div&gt;
                            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_toobar3&quot;&gt;
                                            &lt;a class=&quot;media_tool_meta meta_primary&quot; id=&quot;js_view_source&quot; href=&quot;##&quot;&gt;阅读原文&lt;/a&gt;
                                &lt;div id=&quot;js_read_area3&quot; class=&quot;media_tool_meta tips_global meta_primary&quot; style=&quot;display:none;&quot;&gt;阅读 &lt;span id=&quot;readNum3&quot;&gt;&lt;/span&gt;&lt;/div&gt;

                &lt;span style=&quot;display:none;&quot; class=&quot;media_tool_meta meta_primary tips_global meta_praise&quot; id=&quot;like3&quot;&gt;
                    &lt;i class=&quot;icon_praise_gray&quot;&gt;&lt;/i&gt;&lt;span class=&quot;praise_num&quot; id=&quot;likeNum3&quot;&gt;&lt;/span&gt;
                &lt;/span&gt;

                &lt;a id=&quot;js_report_article3&quot; style=&quot;display:none;&quot; class=&quot;media_tool_meta tips_global meta_extra&quot; href=&quot;##&quot;&gt;投诉&lt;/a&gt;

            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_sg_bar&quot;&gt;
                                &lt;a class=&quot;media_tool_meta meta_primary&quot; href=&quot;http://blog.tankery.me/development/encode-pcm-to-mp4&quot; target=&quot;_blank&quot;&gt;阅读原文&lt;/a&gt;
                                
            &lt;/div&gt;</description>
<author>Tankery</author>
<guid isPermaLink="false">2017-11-18-1000000004</guid>
<pubDate>Sat, 18 Nov 2017 00:00:00 +0800</pubDate>
</item>
<item>
<title>成为更优秀的开发者</title>
<link>https://henix.github.io/feeds/weixin.sogou.FlyTheCode/2017-09-24-1000000003.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?timestamp=1526112787&amp;amp;src=3&amp;amp;ver=1&amp;amp;signature=UoURoPG9cjs*CZOBjPO*j3n5hIePWel0b4IQzAvD2Dh0ll8uO-Wqz2X2MSiXIPL9utO2NoVvOBSMFFClviDOT*Jm7twEgRaDCyY1WyD8oXwj8NWqFyFoaSuXTRKSFeTE8v1HtXkES9cebmJy-6ep5*M*Oel8js*jTZ4RRhZSNCY=&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div id=&quot;img-content&quot;&gt;
                
                &lt;h2 class=&quot;rich_media_title&quot; id=&quot;activity-name&quot;&gt;
                    成为更优秀的开发者                                    &lt;/h2&gt;
                &lt;div id=&quot;meta_content&quot; class=&quot;rich_media_meta_list&quot;&gt;
                                                            &lt;em id=&quot;post-date&quot; class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;2017-09-24&lt;/em&gt;

                                        &lt;em class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;Tankery&lt;/em&gt;
                                        &lt;a class=&quot;rich_media_meta rich_media_meta_link rich_media_meta_nickname&quot; href=&quot;##&quot; id=&quot;post-user&quot;&gt;FlyTheCode&lt;/a&gt;
                    &lt;span class=&quot;rich_media_meta rich_media_meta_text rich_media_meta_nickname&quot;&gt;FlyTheCode&lt;/span&gt;

                    &lt;div id=&quot;js_profile_qrcode&quot; class=&quot;profile_container&quot; style=&quot;display:none;&quot;&gt;
                        &lt;div class=&quot;profile_inner&quot;&gt;
                            &lt;strong class=&quot;profile_nickname&quot;&gt;FlyTheCode&lt;/strong&gt;
                            &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;微信号&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;FlyTheCode&lt;/span&gt;
                            &lt;/p&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;功能介绍&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;希望有一天，代码能如风一般飞奔在原野。&lt;/span&gt;
                            &lt;/p&gt;
                            
                        &lt;/div&gt;
                        &lt;span class=&quot;profile_arrow_wrp&quot; id=&quot;js_profile_arrow_wrp&quot;&gt;
                            &lt;i class=&quot;profile_arrow arrow_out&quot;&gt;&lt;/i&gt;
                            &lt;i class=&quot;profile_arrow arrow_in&quot;&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                
                
                
                                                
                                                                
                
                &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2bJVicGtJKqBpqtZFy1gTusmM8SSjCctmteR6xiacYptLiaZ3ibYSVklSpA/0?wx_fmt=jpeg&quot; class=&quot;&quot; data-ratio=&quot;0.6486111111111111&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;&lt;span style=&quot;font-size: 14px;color: rgb(136, 136, 136);&quot;&gt;题图来自：https://pixabay.com/en/iceberg-water-blue-ocean-ice-1421411/&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;如何写出更高质量的代码？当你开始问自己这样的问题时，已经走在很多人前面了。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;很多程序员，特别是移动开发程序员，由于技术本身门槛不高，业务发展迅速，再加上之前一波互联网浪潮对移动开发人才的热烈追捧，使得大家觉得，只要能完成任务，就是万事大吉了。还有一些人，也会去学习各种各样的新技术，比如 RxJava，比如插件化，比如 Kotlin，他们以为自己已经跟上了时代的潮流，即使有时候只是了解了一些皮毛的概念。可是，有些东西，那些水面以下的冰山，永远是技术的基石。无论时代的发展，技术的更新换代，不变的，只是那水面以下的东西。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;Amazon 在20年前，创立之初的广告语是”One million titles, consistently low prices.“（百万图书，持续低价），其核心的目标就是丰富的商品，低廉的价格，到现在，仍然如此。当有记者问 Jeff 未来10年会发生什么变化，Jeff 回答：”这个问题问得不错。但是，我们有个更好的问题：在未来10到20年内，什么不会发生变化？“。抓住不变的东西，将精力投入到那些不变的东西上，你会发现自己永远都在历史的潮头。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;对于软件开发，什么是不变的东西？&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;软件工程（团队协作），程序设计，代码质量。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;今天，我们就来说说最最基础的”代码质量“，然而代码质量实际上也是个非常广博的内容，一个月前，我就已经在考虑给团队做一个关于代码质量的分享了，但当我把涉及的内与 Lead 聊过以后，发现内容太广、太细，很难吸收。思前想后，我想我们可以抓住一个关键点 —— 职责分离。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;于是我在上周给团队就做了这么一个技术分享：”上帝的归上帝，凯撒的归凯撒 - 谈谈职责分离“。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;职责分离这么一件看似简单的事情，其实蕴含了非常多的内容。它指导你写出逻辑清晰的代码、健壮的代码，甚至性能优越的代码。下面是我贴出一些关键内容。&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp29MZDiaafe08wJkTXiaKHdqPE7IV1gv2uTIU2TvTohibIQ9tLROOvRV3JA/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp25SY6bRPicBk39Gy895qFWfLEutjMYgYaLgkCmr9ADWhaL5HkFNic4Z9A/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2fiaib20uxBaLnTRrRagXL0WIia8ibX37GVbjZGINTPHvazQCteq5qK6piaQ/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2zfDr8bvicVYGmnQictAGcYdoa5bCfovOzEmBrZdicPZRcYnQlwWMv3MWQ/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2q8yLvhraMy5JVXTX83hCP8xibaKLlNZruQicUN7swtyPyicrLGZxibWeWA/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2jARy1qcibdwicMjibufGWXUBUDQgvJczeDFjia0PvOHsL1Osz43ZToYSOg/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2ZszaSd7Wzxll5Tm6hWZ13IW4SHjI7wkdwZjzAjliaAr4ibJGicELcROrg/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2O1h9fqR2e6awvMC2l4gKdR2SLDaWyicaIJXIj5TSC1Xt7wqd6icRg82Q/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp28j3Dh1vzcm96UXMg0gmSFD2dYnA9XZmzWSg23SrAo14Qzt2DKjVveA/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2KXHh70dGwJ3Eojg429mOuJqgok9fmFrQzXNTuAXsT0YHZ7zCRJ8ZBw/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.6694444444444444&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp21IZ7EnHkNJia1UiaeryZGdFISketCazSC9dmf49tHJutrl65TArnPdOA/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2FfHBgqqjxCW653SAPibAVt51QR3LvOlYib7icYtNvicDuIFHSOx5Umz4vg/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2mBKG8JqsvSOmDbDx14ZBfbfPOc90ekibthv0Q2EQpyg1W1IskicKtAmg/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2zIAF2wpu4rB5YjqBIdSImbEEoaeRKzRFOZB234vzU2JP8gAXibjayCA/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2UIiaeAMSuFibsnC27wYWbk1hZd2ezc9sFKAYv9ibAFJicNMuJBwrRzesvw/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2CpSpHXBmgyllG1Nic0dDIiaD9aCjOpvZzxcIL1tGF1ywsPd4zyVibOxqQ/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2eeQ7xu2YqtDMTiagsE6kxC97ibzXiba0gnaDGU3kQuC1K1ZelcbAictvew/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2olFCjG2TngiaueV4c3eW0WX0Aw0fcTykqILcgfjVruW3tBib0Azv32Bw/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp24sVHsYw6GVPxKFIDGibdSCzREBCuBbKWvjLtTJOEEibgibpnheUZr2sibQ/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2seic1icH4HbOWaBcS2ZhCuqibjrZKNpnLnjwZBLGxx4tod8yickBnH1ic9g/0?wx_fmt=jpeg&quot; style=&quot;&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zF3LiaNuTWoVwR814icwKR3ic6g9oTDnibp2iaWQqTpghOt80ic4jB1WwQWqOds4135MT80VeBCJNLN0KQ2AcdA1qcAg/0?wx_fmt=jpeg&quot; class=&quot;&quot; data-ratio=&quot;0.7291666666666666&quot; data-w=&quot;720&quot;&gt;&lt;/p&gt;&lt;article class=&quot;summer-post-content post&quot; style=&quot;box-sizing: border-box;margin-right: auto;margin-left: auto;color: rgb(34, 34, 34);&quot;&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;font-family: inherit;font-size: 1.125rem;line-height: 1.6;text-rendering: optimizeLegibility;max-width: 56.25rem;&quot;&gt;想查看完整内容，可以看看这里： http://slide.tankery.me/separation-of-duty&lt;/p&gt;&lt;/article&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;script nonce=&quot;580023121&quot; type=&quot;text/javascript&quot;&gt;
                    var first_sceen__time = (+new Date());

                    if (&quot;&quot; == 1 &amp;&amp; document.getElementById(&#39;js_content&#39;)) {
                        document.getElementById(&#39;js_content&#39;).addEventListener(&quot;selectstart&quot;,function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf(&quot;WindowsWechat&quot;) != -1){
                            var link = document.createElement(&#39;link&#39;);
                            var head = document.getElementsByTagName(&#39;head&#39;)[0];
                            link.rel = &#39;stylesheet&#39;;
                            link.type = &#39;text/css&#39;;
                            link.href = &quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css&quot;;
                            head.appendChild(link);
                        }
                    })();
                &lt;/script&gt;
                
                
                                
                &lt;div class=&quot;ct_mpda_wrp&quot; id=&quot;js_sponsor_ad_area&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;

                
                                &lt;div class=&quot;reward_area tc&quot; id=&quot;js_preview_reward&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p id=&quot;js_preview_reward_wording&quot; class=&quot;tips_global reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;p&gt;
                        &lt;a class=&quot;reward_access&quot; id=&quot;js_preview_reward_link&quot; href=&quot;##&quot;&gt;&lt;span class=&quot;icon-reward&quot;&gt;&lt;/span&gt;赞赏&lt;/a&gt;

                    &lt;/p&gt;
                &lt;/div&gt;
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_preview_reward_qrcode&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;长按二维码向我转账&lt;/p&gt;
                    &lt;p id=&quot;js_preview_reward_ios_wording&quot; class=&quot;reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; src=&quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png&quot;&gt;&lt;/span&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。&lt;/p&gt;
                &lt;/div&gt;
                            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_toobar3&quot;&gt;
                                            &lt;a class=&quot;media_tool_meta meta_primary&quot; id=&quot;js_view_source&quot; href=&quot;##&quot;&gt;阅读原文&lt;/a&gt;
                                &lt;div id=&quot;js_read_area3&quot; class=&quot;media_tool_meta tips_global meta_primary&quot; style=&quot;display:none;&quot;&gt;阅读 &lt;span id=&quot;readNum3&quot;&gt;&lt;/span&gt;&lt;/div&gt;

                &lt;span style=&quot;display:none;&quot; class=&quot;media_tool_meta meta_primary tips_global meta_praise&quot; id=&quot;like3&quot;&gt;
                    &lt;i class=&quot;icon_praise_gray&quot;&gt;&lt;/i&gt;&lt;span class=&quot;praise_num&quot; id=&quot;likeNum3&quot;&gt;&lt;/span&gt;
                &lt;/span&gt;

                &lt;a id=&quot;js_report_article3&quot; style=&quot;display:none;&quot; class=&quot;media_tool_meta tips_global meta_extra&quot; href=&quot;##&quot;&gt;投诉&lt;/a&gt;

            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_sg_bar&quot;&gt;
                                &lt;a class=&quot;media_tool_meta meta_primary&quot; href=&quot;http://blog.tankery.me/development/separation-of-duty&quot; target=&quot;_blank&quot;&gt;阅读原文&lt;/a&gt;
                                
            &lt;/div&gt;</description>
<author>Tankery</author>
<guid isPermaLink="false">2017-09-24-1000000003</guid>
<pubDate>Sun, 24 Sep 2017 00:00:00 +0800</pubDate>
</item>
<item>
<title>Solve Jump Game Problem using State Machine</title>
<link>https://henix.github.io/feeds/weixin.sogou.FlyTheCode/2017-09-22-1000000002.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?timestamp=1526112787&amp;amp;src=3&amp;amp;ver=1&amp;amp;signature=UoURoPG9cjs*CZOBjPO*j3n5hIePWel0b4IQzAvD2Dh0ll8uO-Wqz2X2MSiXIPL9utO2NoVvOBSMFFClviDOT2njZQb1FXnGye8B4gDQ8Jp8hgVzDw9XpuVP01GJG5tOmwDLU7sWQAT7ZE48PqZcgVzFs*rEo7za5gQOpXm*wLU=&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div id=&quot;img-content&quot;&gt;
                
                &lt;h2 class=&quot;rich_media_title&quot; id=&quot;activity-name&quot;&gt;
                    Solve Jump Game Problem using State Machine                                    &lt;/h2&gt;
                &lt;div id=&quot;meta_content&quot; class=&quot;rich_media_meta_list&quot;&gt;
                                                            &lt;em id=&quot;post-date&quot; class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;2017-09-22&lt;/em&gt;

                                        &lt;em class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;Tankery&lt;/em&gt;
                                        &lt;a class=&quot;rich_media_meta rich_media_meta_link rich_media_meta_nickname&quot; href=&quot;##&quot; id=&quot;post-user&quot;&gt;FlyTheCode&lt;/a&gt;
                    &lt;span class=&quot;rich_media_meta rich_media_meta_text rich_media_meta_nickname&quot;&gt;FlyTheCode&lt;/span&gt;

                    &lt;div id=&quot;js_profile_qrcode&quot; class=&quot;profile_container&quot; style=&quot;display:none;&quot;&gt;
                        &lt;div class=&quot;profile_inner&quot;&gt;
                            &lt;strong class=&quot;profile_nickname&quot;&gt;FlyTheCode&lt;/strong&gt;
                            &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;微信号&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;FlyTheCode&lt;/span&gt;
                            &lt;/p&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;功能介绍&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;希望有一天，代码能如风一般飞奔在原野。&lt;/span&gt;
                            &lt;/p&gt;
                            
                        &lt;/div&gt;
                        &lt;span class=&quot;profile_arrow_wrp&quot; id=&quot;js_profile_arrow_wrp&quot;&gt;
                            &lt;i class=&quot;profile_arrow arrow_out&quot;&gt;&lt;/i&gt;
                            &lt;i class=&quot;profile_arrow arrow_in&quot;&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                
                
                
                                                
                                                                
                
                &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;This Week I solved an interesting algorithm problem, Jump Game Problem, with State Machine.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;The problem is here:&lt;/p&gt;&lt;blockquote style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 1.25rem;margin-left: auto;padding-top: 0.5625rem;padding-right: 1.25rem;padding-left: 1.1875rem;border-left-width: 1px;border-left-color: rgb(221, 221, 221);line-height: 1.6;color: rgb(111, 111, 111);max-width: 56.25rem;&quot;&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;font-family: inherit;font-size: 1.125rem;line-height: 1.6;text-rendering: optimizeLegibility;max-width: 56.25rem;&quot;&gt;Given an array of non-negative integers, you are initially positioned at the first index of the array.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;font-family: inherit;font-size: 1.125rem;line-height: 1.6;text-rendering: optimizeLegibility;max-width: 56.25rem;&quot;&gt;Each element in the array represents your maximum jump length at that position.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;font-family: inherit;font-size: 1.125rem;line-height: 1.6;text-rendering: optimizeLegibility;max-width: 56.25rem;&quot;&gt;Determine if you are able to reach the last index.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;font-family: inherit;font-size: 1.125rem;line-height: 1.6;text-rendering: optimizeLegibility;max-width: 56.25rem;&quot;&gt;For example: A = &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;[2,3,1,1,4]&lt;/code&gt;, return &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;true&lt;/code&gt;.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;font-family: inherit;font-size: 1.125rem;line-height: 1.6;text-rendering: optimizeLegibility;max-width: 56.25rem;&quot;&gt;A = &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;[3,2,1,0,4]&lt;/code&gt;, return &lt;code class=&quot;highlighter-rouge&quot; style=&quot;box-sizing: border-box;&quot;&gt;false&lt;/code&gt;.&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;I’ve seen some solutions also come with an &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;O(n)&lt;/strong&gt; and constant space performance, but the solution is not easy to understood, and hard to reuse to other problem, but &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;State Machine&lt;/strong&gt; is a really strong and flexible way to solve limited state (like true/false state) problem.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;For this problem, we know that the target is find a way to jump to last index, so we can have a instinct that this problem can be solve by inverse iteration. So let’s have a try in this way.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;First, the last index can be skip, as it already the last index, so the state always &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;true&lt;/strong&gt; no mater what.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;Then we come to the 2nd number, we need to jump to last index, that’s next index for this case, so this number should be 1 or above to jump to next. So if this number is &amp;gt; 0, state keep to &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;true&lt;/strong&gt;, or = 0, state transit to &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;false&lt;/strong&gt;.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;For 3rd number, if 2nd number state is &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;true&lt;/strong&gt;, we only need to jump to next index. But if 2nd number state is &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;false&lt;/strong&gt;, we need to jump across 2nd, so this number needs to be &amp;gt; 1 to jump direct to the end.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;And we can take more round to iterate all numbers.&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;Here is a diagram shows the state transition when iterating:&lt;/p&gt;&lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;png&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zF3LiaNuTWoXqgxuGia6EmmSr0qvG1xibmWxIQFYWZRIqZCOyUKftnnBfQoTUPEomNEeKpQYQicWZIMm98CoiaJhGtw/0?wx_fmt=png&quot; class=&quot;&quot; data-ratio=&quot;0.8599562363238512&quot; data-w=&quot;457&quot; style=&quot;width: 100%;height: auto;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;In this diagram, we can find the simple pattern of state transition:&lt;/p&gt;&lt;ol style=&quot;margin-left: auto;margin-right: auto;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;When current state is &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;true&lt;/strong&gt;, next state can be &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;true&lt;/strong&gt; if &amp;gt; 0, else transit to &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;false&lt;/strong&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;When current state is &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;false&lt;/strong&gt;, next state transit to &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;true&lt;/strong&gt; only if the number is larger than count of continuous &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;false&lt;/strong&gt;s, else, state keep in &lt;strong style=&quot;box-sizing: border-box;line-height: inherit;&quot;&gt;false&lt;/strong&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;So we can write code now:&lt;/p&gt;&lt;pre class=&quot;highlight&quot; style=&quot;box-sizing: border-box;overflow-x: auto;overflow-y: hidden;font-family: monospace, monospace;font-size: 1em;margin: 0px auto 1.5625rem;padding: 1.25rem;background-color: rgba(240, 240, 240, 0.8);max-width: 56.25rem;&quot;&gt;&lt;code class=&quot;hljs cs&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;kd&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;boolean&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);font-weight: bold;&quot;&gt;canJump&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;nums&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;stateCanJump&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;falseCount&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;for&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;box-sizing: border-box;&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;value&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;stateCanJump&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;value&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;stateCanJump&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;falseCount&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;value&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;falseCount&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;stateCanJump&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;falseCount&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: border-box;color: rgb(136, 0, 0);&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;falseCount&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;++;&lt;/span&gt;
            &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;box-sizing: border-box;&quot;&gt;stateCanJump&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;box-sizing: border-box;&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;And problem solved! Congratulations!&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;script nonce=&quot;1637293952&quot; type=&quot;text/javascript&quot;&gt;
                    var first_sceen__time = (+new Date());

                    if (&quot;&quot; == 1 &amp;&amp; document.getElementById(&#39;js_content&#39;)) {
                        document.getElementById(&#39;js_content&#39;).addEventListener(&quot;selectstart&quot;,function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf(&quot;WindowsWechat&quot;) != -1){
                            var link = document.createElement(&#39;link&#39;);
                            var head = document.getElementsByTagName(&#39;head&#39;)[0];
                            link.rel = &#39;stylesheet&#39;;
                            link.type = &#39;text/css&#39;;
                            link.href = &quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css&quot;;
                            head.appendChild(link);
                        }
                    })();
                &lt;/script&gt;
                
                
                                
                &lt;div class=&quot;ct_mpda_wrp&quot; id=&quot;js_sponsor_ad_area&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;

                
                                &lt;div class=&quot;reward_area tc&quot; id=&quot;js_preview_reward&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p id=&quot;js_preview_reward_wording&quot; class=&quot;tips_global reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;p&gt;
                        &lt;a class=&quot;reward_access&quot; id=&quot;js_preview_reward_link&quot; href=&quot;##&quot;&gt;&lt;span class=&quot;icon-reward&quot;&gt;&lt;/span&gt;赞赏&lt;/a&gt;

                    &lt;/p&gt;
                &lt;/div&gt;
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_preview_reward_qrcode&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;长按二维码向我转账&lt;/p&gt;
                    &lt;p id=&quot;js_preview_reward_ios_wording&quot; class=&quot;reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; src=&quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png&quot;&gt;&lt;/span&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。&lt;/p&gt;
                &lt;/div&gt;
                            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_toobar3&quot;&gt;
                                            &lt;a class=&quot;media_tool_meta meta_primary&quot; id=&quot;js_view_source&quot; href=&quot;##&quot;&gt;阅读原文&lt;/a&gt;
                                &lt;div id=&quot;js_read_area3&quot; class=&quot;media_tool_meta tips_global meta_primary&quot; style=&quot;display:none;&quot;&gt;阅读 &lt;span id=&quot;readNum3&quot;&gt;&lt;/span&gt;&lt;/div&gt;

                &lt;span style=&quot;display:none;&quot; class=&quot;media_tool_meta meta_primary tips_global meta_praise&quot; id=&quot;like3&quot;&gt;
                    &lt;i class=&quot;icon_praise_gray&quot;&gt;&lt;/i&gt;&lt;span class=&quot;praise_num&quot; id=&quot;likeNum3&quot;&gt;&lt;/span&gt;
                &lt;/span&gt;

                &lt;a id=&quot;js_report_article3&quot; style=&quot;display:none;&quot; class=&quot;media_tool_meta tips_global meta_extra&quot; href=&quot;##&quot;&gt;投诉&lt;/a&gt;

            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_sg_bar&quot;&gt;
                                &lt;a class=&quot;media_tool_meta meta_primary&quot; href=&quot;http://blog.tankery.me/development/en/jump-game-problem&quot; target=&quot;_blank&quot;&gt;阅读原文&lt;/a&gt;
                                
            &lt;/div&gt;</description>
<author>Tankery</author>
<guid isPermaLink="false">2017-09-22-1000000002</guid>
<pubDate>Fri, 22 Sep 2017 00:00:00 +0800</pubDate>
</item>
<item>
<title>关于我，关于这个公众号</title>
<link>https://henix.github.io/feeds/weixin.sogou.FlyTheCode/2017-09-16-1000000001.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?timestamp=1526112787&amp;amp;src=3&amp;amp;ver=1&amp;amp;signature=UoURoPG9cjs*CZOBjPO*j3n5hIePWel0b4IQzAvD2Dh0ll8uO-Wqz2X2MSiXIPL9utO2NoVvOBSMFFClviDOT3H9c*DVEtGTDLCgddg2iPtfCKbFsIO23r6ybGwzJITx7U9eyanah-8FTI9dj0gjwRSLHVMbe3fp-DlBopQV27o=&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div id=&quot;img-content&quot;&gt;
                
                &lt;h2 class=&quot;rich_media_title&quot; id=&quot;activity-name&quot;&gt;
                    关于我，关于这个公众号                                    &lt;/h2&gt;
                &lt;div id=&quot;meta_content&quot; class=&quot;rich_media_meta_list&quot;&gt;
                                                            &lt;em id=&quot;post-date&quot; class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;2017-09-16&lt;/em&gt;

                                        &lt;em class=&quot;rich_media_meta rich_media_meta_text&quot;&gt;老谭&lt;/em&gt;
                                        &lt;a class=&quot;rich_media_meta rich_media_meta_link rich_media_meta_nickname&quot; href=&quot;##&quot; id=&quot;post-user&quot;&gt;FlyTheCode&lt;/a&gt;
                    &lt;span class=&quot;rich_media_meta rich_media_meta_text rich_media_meta_nickname&quot;&gt;FlyTheCode&lt;/span&gt;

                    &lt;div id=&quot;js_profile_qrcode&quot; class=&quot;profile_container&quot; style=&quot;display:none;&quot;&gt;
                        &lt;div class=&quot;profile_inner&quot;&gt;
                            &lt;strong class=&quot;profile_nickname&quot;&gt;FlyTheCode&lt;/strong&gt;
                            &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;微信号&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;FlyTheCode&lt;/span&gt;
                            &lt;/p&gt;

                            &lt;p class=&quot;profile_meta&quot;&gt;
                            &lt;label class=&quot;profile_meta_label&quot;&gt;功能介绍&lt;/label&gt;
                            &lt;span class=&quot;profile_meta_value&quot;&gt;希望有一天，代码能如风一般飞奔在原野。&lt;/span&gt;
                            &lt;/p&gt;
                            
                        &lt;/div&gt;
                        &lt;span class=&quot;profile_arrow_wrp&quot; id=&quot;js_profile_arrow_wrp&quot;&gt;
                            &lt;i class=&quot;profile_arrow arrow_out&quot;&gt;&lt;/i&gt;
                            &lt;i class=&quot;profile_arrow arrow_in&quot;&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                
                
                
                                                
                                                                
                
                &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;png&quot; src=&quot;http://mmbiz.qpic.cn/mmbiz_png/zF3LiaNuTWoXpQ9Y182YAhxUsSib4WZn6yCAT08CKYJBuQhicqk37TzgMKb4ojDyRBKibJlZyBa8uJw03YicRNroetw/0?wx_fmt=png&quot; class=&quot;&quot; data-ratio=&quot;0.665&quot; data-w=&quot;1200&quot;&gt;&lt;/p&gt;&lt;p style=&quot;text-align: right;&quot;&gt;&lt;span style=&quot;font-size: 14px;color: rgb(136, 136, 136);&quot;&gt;题图来自 Wikipedia: STS-127&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;两年前，我搭建了自己的个人博客，取名 FLY THE CODE。如今，创建了微信公众号，仍然叫做 FlyTheCode。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;怎么说呢，希望自己不仅仅是一个码农，而是一个可以创造令人愉悦的产品的人。从代码开始，追求软件设计，追求产品设计，也追求视觉的设计。希望有一天，代码如风一般，吹遍世界的每个角落，温暖很多的人，拂去些许尘埃。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;开通微信号，一方面是希望自己的文字能被更多人，更方便的看到，能让自己的想法、代码传播得更广泛一些。另一方面，也是希望能更多的听到大家的反馈，激发自己的思考。当然，要是能多收获一些打赏，每天给自己加个茶叶蛋也是极好的。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;一路走来，从高中时的GV Basic，到大学时的焊板子、画PCB、嵌入式编程、MFC、QT；再到毕业后搞Android、写C++的浏览器内核，还搞过服务器的Python、Linux的脚本；后来一段时间的个人开发，学习了产品交互、简单的设计，和 iOS 的一些内容；又由于个人博客的关系，学着搭建了前端的 Jekyll 之类的框架。总之是目力所及之处，都希望能略懂一些东西。而目前呢，主要的工作时间，都在积累 Android 应用开发的能力，闲时也还是四处尝试着新鲜技术的味道。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;也就是说，这个公众号主体的内容还是 Android 开发，以及我自己的一些思考。兴致来了的时候，可能也添加些其他的调料。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;总之，希望这个公众号，能给大家带去一些新鲜空气。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;共勉。&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box;margin-right: auto;margin-bottom: 2em;margin-left: auto;&quot;&gt;哦，对了，这个公众号的 Logo 也是自己设计的呢，o 不 ok 呀？^_^&lt;/p&gt;&lt;p style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;img data-s=&quot;300,640&quot; data-type=&quot;png&quot; src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zF3LiaNuTWoXpQ9Y182YAhxUsSib4WZn6yVQR2VOH3PcmvFm58rEqpyYS0jNyZG71EXvueehY2qmq6Ux027MHr5Q/0?wx_fmt=png&quot; class=&quot;&quot; data-ratio=&quot;1&quot; data-w=&quot;512&quot; width=&quot;120&quot; height=&quot;120&quot; style=&quot;width: 120px;height: 120px;&quot;&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;script nonce=&quot;798391476&quot; type=&quot;text/javascript&quot;&gt;
                    var first_sceen__time = (+new Date());

                    if (&quot;&quot; == 1 &amp;&amp; document.getElementById(&#39;js_content&#39;)) {
                        document.getElementById(&#39;js_content&#39;).addEventListener(&quot;selectstart&quot;,function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf(&quot;WindowsWechat&quot;) != -1){
                            var link = document.createElement(&#39;link&#39;);
                            var head = document.getElementsByTagName(&#39;head&#39;)[0];
                            link.rel = &#39;stylesheet&#39;;
                            link.type = &#39;text/css&#39;;
                            link.href = &quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css&quot;;
                            head.appendChild(link);
                        }
                    })();
                &lt;/script&gt;
                
                
                                
                &lt;div class=&quot;ct_mpda_wrp&quot; id=&quot;js_sponsor_ad_area&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;

                
                                &lt;div class=&quot;reward_area tc&quot; id=&quot;js_preview_reward&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p id=&quot;js_preview_reward_wording&quot; class=&quot;tips_global reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;p&gt;
                        &lt;a class=&quot;reward_access&quot; id=&quot;js_preview_reward_link&quot; href=&quot;##&quot;&gt;&lt;span class=&quot;icon-reward&quot;&gt;&lt;/span&gt;赞赏&lt;/a&gt;

                    &lt;/p&gt;
                &lt;/div&gt;
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_preview_reward_qrcode&quot; style=&quot;display:none;&quot;&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;长按二维码向我转账&lt;/p&gt;
                    &lt;p id=&quot;js_preview_reward_ios_wording&quot; class=&quot;reward_tips&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;
                    &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; src=&quot;//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png&quot;&gt;&lt;/span&gt;
                    &lt;p class=&quot;tips_global&quot;&gt;受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。&lt;/p&gt;
                &lt;/div&gt;
                            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_toobar3&quot;&gt;
                                            &lt;a class=&quot;media_tool_meta meta_primary&quot; id=&quot;js_view_source&quot; href=&quot;##&quot;&gt;阅读原文&lt;/a&gt;
                                &lt;div id=&quot;js_read_area3&quot; class=&quot;media_tool_meta tips_global meta_primary&quot; style=&quot;display:none;&quot;&gt;阅读 &lt;span id=&quot;readNum3&quot;&gt;&lt;/span&gt;&lt;/div&gt;

                &lt;span style=&quot;display:none;&quot; class=&quot;media_tool_meta meta_primary tips_global meta_praise&quot; id=&quot;like3&quot;&gt;
                    &lt;i class=&quot;icon_praise_gray&quot;&gt;&lt;/i&gt;&lt;span class=&quot;praise_num&quot; id=&quot;likeNum3&quot;&gt;&lt;/span&gt;
                &lt;/span&gt;

                &lt;a id=&quot;js_report_article3&quot; style=&quot;display:none;&quot; class=&quot;media_tool_meta tips_global meta_extra&quot; href=&quot;##&quot;&gt;投诉&lt;/a&gt;

            &lt;/div&gt;&lt;div class=&quot;rich_media_tool&quot; id=&quot;js_sg_bar&quot;&gt;
                                &lt;a class=&quot;media_tool_meta meta_primary&quot; href=&quot;http://blog.tankery.me/personal/preface&quot; target=&quot;_blank&quot;&gt;阅读原文&lt;/a&gt;
                                
            &lt;/div&gt;</description>
<author>老谭</author>
<guid isPermaLink="false">2017-09-16-1000000001</guid>
<pubDate>Sat, 16 Sep 2017 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
