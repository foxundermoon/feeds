<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>黑猫Q形态的知乎文章</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/</link>
<description>Q是一条忍辱负重的路</description>
<language>zh-cn</language>
<lastBuildDate>Sun, 04 Nov 2018 12:39:06 +0800</lastBuildDate>
<item>
<title>产品的损益归因分析</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-11-03-48378859.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/48378859&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-582a24682bccd7ddf4d0bdd6325b96c6_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;本系列依旧秉承着完美避开一切有关波动率“预测”，“交易策略”，”期权策略“等一切和量化交易有关的”比较入行“的内容。不感兴趣的知有可以继续右上角了。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;这篇文章将提供以下一系列问题的识别途径：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;“我Delta对冲完了还有好多敞口，怎么调整”&lt;/p&gt;&lt;p&gt;“Vega和Gamma什么关系啊？能互相替代么？”&lt;/p&gt;&lt;p&gt;“Vega对冲不掉波动率的敞口啊？怎么破？”&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;本文不会回答以下问题：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;“什么模型Delta解释度高？”&lt;/p&gt;&lt;p&gt;“Vega解释度低用什么模型？”&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;本文讲general的损益分析，不谈任何具体模型。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;度量损益分析，就是分析每个风险度量（主要是cash度量比如delta，gamma，一般不包括分位数度量比如VaR，ES）对一天的损益的解释度占比。&lt;/p&gt;&lt;p&gt;假设我们t时刻有参数背景 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BF%7D_t&quot; alt=&quot;\mathcal{F}_t&quot; eeimg=&quot;1&quot;&gt; ， 也就是信息集。为什么用信息集而不用价格S_t，因为大量度量会用到多于一天和多于一个标的信息。那么对于任意度量M， 可以计算出当天度量 &lt;img src=&quot;https://www.zhihu.com/equation?tex=M%28%5Cmathcal%7BF_t%7D%29&quot; alt=&quot;M(\mathcal{F_t})&quot; eeimg=&quot;1&quot;&gt; 。&lt;/p&gt;&lt;p&gt;接下来有这么几种损益分析，已知对已知，模型对模型，已知对模型 （一般不存在模型对已知这种业务场景，稍后会做说明）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.已知对已知：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们知道了过去两个时间t和t+dt的产品价格，同时也知道了两个时刻的信息集 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BF_t%7D+%EF%BC%8C%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D+&quot; alt=&quot;\mathcal{F_t} ，\mathcal{F_{t+dt}} &quot; eeimg=&quot;1&quot;&gt; 。那么对于一个度量M，我们可以分析他的历史度量解释度： &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cfrac%7BM%28%5Cmathcal%7BF_t%7D%29%7D%7BC_%7Bt%2Bdt%7D+-+C_t+%7D&quot; alt=&quot;\frac{M(\mathcal{F_t})}{C_{t+dt} - C_t }&quot; eeimg=&quot;1&quot;&gt; ， 这里用下标代表已知。&lt;/p&gt;&lt;p&gt;一般用于历史分析度量的解释效果。 这个使用，对于不同模型下的同一种度量的就可以进行横向对比： &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cfrac%7BM_1%28%5Cmathcal%7BF_t%7D%29%7D%7BC_%7Bt%2Bdt%7D+-+C_t+%7D%2C+%5Cfrac%7BM_2%28%5Cmathcal%7BF_t%7D%29%7D%7BC_%7Bt%2Bdt%7D+-+C_t+%7D+...&quot; alt=&quot;\frac{M_1(\mathcal{F_t})}{C_{t+dt} - C_t }, \frac{M_2(\mathcal{F_t})}{C_{t+dt} - C_t } ...&quot; eeimg=&quot;1&quot;&gt; 。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;当然对于多个度量我们也可以检查总体解释是否逼近1： &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cfrac%7BM%28%5Cmathcal%7BF_t%7D%29%7D%7BC_%7Bt%2Bdt%7D+-+C_t+%7D%EF%BC%8B%5Cfrac%7BN%28%5Cmathcal%7BF_t%7D%29%7D%7BC_%7Bt%2Bdt%7D+-+C_t+%7D%2B%5Cfrac%7BO%28%5Cmathcal%7BF_t%7D%29%7D%7BC_%7Bt%2Bdt%7D+-+C_t+%7D+%2B...%3D1&quot; alt=&quot;\frac{M(\mathcal{F_t})}{C_{t+dt} - C_t }＋\frac{N(\mathcal{F_t})}{C_{t+dt} - C_t }+\frac{O(\mathcal{F_t})}{C_{t+dt} - C_t } +...=1&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;如果总体解释比1小太多，说明已有的度量解释度不足，要么更换一个或者多个度量的定义（一般情况下，度量定义会随产品的模型变化而变化，所以改变度量定义绝大部分情况下意味着更换模型，尤其是dynamic。当然也存在不更换模型的情况下完善度量的定义，比如典型的quanto delta）&lt;/p&gt;&lt;p&gt;括号用俗话说就是：&lt;b&gt;只会BS活该&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;如果总体解释比1大太多（一般很少发生），说明已有度量有交叉解释，常见的发生在delta，gamma和vega中的各种交叉项。一般需要重新定义一些输入的形式（特别是波动率）。具体可以看一下以前写的：&lt;a href=&quot;https://zhuanlan.zhihu.com/p/36942658&quot; class=&quot;internal&quot;&gt;再闲谈波动率1——Vega到底是什么东西&lt;/a&gt;和&lt;a href=&quot;https://zhuanlan.zhihu.com/p/37509695&quot; class=&quot;internal&quot;&gt;再闲谈波动率2——波动曲面参数化&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;对于一整个时间段（多日）来说，也可把对于时间内所有i的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=C_%7Bt_%7Bi%7D%2Bdt%7D+-+C_%7Bt_i+%7D&quot; alt=&quot;C_{t_{i}+dt} - C_{t_i }&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=M%28%5Cmathcal%7BF_%7Bt_i%7D%7D%29%2BN%28%5Cmathcal%7BF_%7Bt_i%7D%7D%29+%2BN%28%5Cmathcal%7BF_%7Bt_i%7D%7D%29+%2B...+&quot; alt=&quot;M(\mathcal{F_{t_i}})+N(\mathcal{F_{t_i}}) +N(\mathcal{F_{t_i}}) +... &quot; eeimg=&quot;1&quot;&gt; 两者之间来做线性回归。 理想的效果是R^2尽量等于1，斜率也尽量等于1，残差绝对值尽量小来检验所有度量的解释度。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.模型对模型：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果想检验的不是度量的历史数据的解释度，而是模型自治的解释度。可以将上面的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=C_%7Bt%2Bdt%7D+-+C_t+&quot; alt=&quot;C_{t+dt} - C_t &quot; eeimg=&quot;1&quot;&gt; 替换成 给定模型H之间的价格差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=H%28%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D%29+-+H%28%5Cmathcal%7BF_%7Bt%7D%7D%29&quot; alt=&quot;H(\mathcal{F_{t+dt}}) - H(\mathcal{F_{t}})&quot; eeimg=&quot;1&quot;&gt; ，然后重复上述检验步骤。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;模型对模型的损益解释和已知对已知一样重要，因为度量函数M,N,O一般都是跟随模型的产物，所以理论上上述线性回归我们会获得一个完美的直线拟合。 但是一般M,N,O当中会存在一些数值法，近似和逼近，所以一旦出现模型对模型的损益分析不通过，则说明在计算度量的时候出现了较大的误差或者遗漏了重要风险属性（少了重要度量）。 &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;之所以一般不做模型对已知损益分析，是因为它的功能被上述两个覆盖，但是不能专门检验到底是本身解释度的问题还是模型计算的问题。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.已知对模型：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;已知对模型的损益检验一般在当天进行，这时t代表现在(估值日）。将上述 &lt;img src=&quot;https://www.zhihu.com/equation?tex=H%28%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D%29+-+H%28%5Cmathcal%7BF_%7Bt%7D%7D%29&quot; alt=&quot;H(\mathcal{F_{t+dt}}) - H(\mathcal{F_{t}})&quot; eeimg=&quot;1&quot;&gt; }替换成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Ctilde%7BH%7D%28%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D%29-+C_t+%3D+H%28%5Cmathcal%7BF_%7Bt%7D%7D%5E%2B%29+-+C_t&quot; alt=&quot;\tilde{H}(\mathcal{F_{t+dt}})- C_t = H(\mathcal{F_{t}}^+) - C_t&quot; eeimg=&quot;1&quot;&gt; 。这里的我们将不再拥有信息集 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D&quot; alt=&quot;\mathcal{F_{t+dt}}&quot; eeimg=&quot;1&quot;&gt; ,因此我们只能获得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=H%28%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D%29&quot; alt=&quot;H(\mathcal{F_{t+dt}})&quot; eeimg=&quot;1&quot;&gt; 的一个估计量&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Ctilde%7BH%7D%28%5Cmathcal%7BF_%7Bt%2Bdt%7D%7D%29&quot; alt=&quot;\tilde{H}(\mathcal{F_{t+dt}})&quot; eeimg=&quot;1&quot;&gt; 。 这种估计量可以通过信信息集的演化来获得，当我们钦定一个信息集演化规则后获得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BF_%7Bt%7D%7D%5E%2B&quot; alt=&quot;\mathcal{F_{t}}^+&quot; eeimg=&quot;1&quot;&gt; 从而进行模拟的损益分析，这个事衍生品交易员经常干的事情。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BF_%7Bt%7D%7D%5E%2B&quot; alt=&quot;\mathcal{F_{t}}^+&quot; eeimg=&quot;1&quot;&gt; 可以是一些假设下的模拟结果（比如在给定dynamic下的一万个明天股票价格的模拟），也可以是一些固定场景下的结果（比如给定压力场景下的结果）。前者比较老生常谈，后者可以视为压力测试下损益分析的变种。&lt;/p&gt;&lt;p&gt;比如给定压力场景 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cpi&quot; alt=&quot;\pi&quot; eeimg=&quot;1&quot;&gt; ，会选覆盖（override）一部分的信息，那么我们取 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BF_t%7D%5E%2B+%3D+%5Cpi%28%5Cmathcal%7BF_t%7D%29&quot; alt=&quot;\mathcal{F_t}^+ = \pi(\mathcal{F_t})&quot; eeimg=&quot;1&quot;&gt; 。 可以看一下”假如明天CCAR成真了，损益解释度会如何？“。这个操作对1和2都可以进行。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;一些觉得可以预测明天价格的读者可以跳过这一步&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;吐槽和骂人：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;写这个是因为发现国内部分”期权从业者“几乎完全不做损益归因分析，然后经常问出一些文章开头的问题。&lt;/p&gt;&lt;p&gt;另外经常发现一些”基本上只学到BS的从业者“，因为意识不到问题，然后说出一些类似&lt;/p&gt;&lt;p&gt;“理论（BS及以下期权知识）都是虚假，我们要在实（操）践（做）中修改这些问题”&lt;/p&gt;&lt;p&gt; 之类的话。 这些话本身没啥问题，问题是需要一些能用来修改的材料。 本文只提供检查的方法，不提供修改的材料和方法，因为那些问题就是大家常说的“&lt;b&gt;虚假理论&lt;/b&gt;”（以前写过不少）。&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-11-03-48378859</guid>
<pubDate>Sat, 03 Nov 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>做梦想到一个吃鸡类游戏，就叫他鬼人山</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-10-24-47579064.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/47579064&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;做梦想到出个吃鸡类游戏，非常有意思，”玩儿“了一晚上，欢迎大家完善细节&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;游戏时间大约10分钟，30个人要一起登山（一条宽阔的直线路，中间会有掩体，房间，树，宝箱，门）人类中混了五个僵尸，他们一开始不会发作伪装成正常人的样子，在大约1分钟后开始尸化。&lt;/p&gt;&lt;p&gt;&lt;b&gt;人类获胜条件：到达山顶或没有僵尸，前者单独判定获胜，后者集体获胜&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;僵尸获胜条件：没有人类存活，集体判定&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;人类初始配有匕首，只能装备一个武器（无论近战远程）和两个道具&lt;b&gt;。所有道具都具有加速，控制，限制，甚至将僵尸推下山崖的强力效果。&lt;/b&gt;初始人类能承受三次僵尸伤害。&lt;b&gt;被击杀的人类会变成僵尸&lt;/b&gt;&lt;/p&gt;&lt;p&gt;僵尸没有武器，只能徒手攻击，但速度和攻击力大于人类。变为僵尸将损失所有道具和武器。僵尸只能战死，&lt;b&gt;被推下山崖的僵尸不会死亡，而是从某一点复活。&lt;/b&gt;初始僵尸能承受十次匕首伤害。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;设定：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;”登山尸化值“：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;僵尸会随着时间和&lt;b&gt;掉落高度&lt;/b&gt;（包括摔落，滑落），累计尸化值。尸化值越高速度越快，伤害越高，但是生命值越少。累计满尸化值的僵尸会变身为王僵尸，速度和伤害为初始的两倍&lt;b&gt;且免疫掉落，&lt;/b&gt;但生命只剩1/5可以被人类匕首秒杀。&lt;/p&gt;&lt;p&gt;成功登上山顶的僵尸会自动变为霸王僵尸，保留王僵尸效果，&lt;b&gt;手臂变长&lt;/b&gt;，&lt;b&gt;且生命值和生命上限恢复最大值&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;掉落：&lt;br&gt;&lt;/b&gt;人类除了击杀僵尸以外，可以使用道具将僵尸推下山崖或者从道路上滑下很长一段距离来避免追赶。掉落山崖的僵尸需要等待复活，尸化越严重的僵尸复活时间越长。滑落不会造成僵尸死亡，但是距离一般很远。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;武器：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;近：&lt;/p&gt;&lt;p&gt;鞭子：伤害等同于匕首但攻击僵尸脚部将造成摔倒和小幅滑落，动作快&lt;/p&gt;&lt;p&gt;巨棍：伤害等同于四倍匕首并能击晕僵尸一秒，动作慢&lt;/p&gt;&lt;p&gt;晾衣杆：伤害等同于两倍匕首，极长，动作中等&lt;/p&gt;&lt;p&gt;弹簧拳：伤害等同于两倍匕首，可以是击退僵尸极长距离，如果在地图边界则会掉落（所有击飞武器同理）。，动作快&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;远：&lt;/p&gt;&lt;p&gt;手枪：伤害等同于三倍匕首，十发&lt;/p&gt;&lt;p&gt;来福：伤害等同于四倍匕首，二十发&lt;/p&gt;&lt;p&gt;撒网器：没有伤害但会困住僵尸极长时间，三张&lt;/p&gt;&lt;p&gt;个人榴弹：范围爆炸等同于四倍匕首，并击飞中等距离，五发，可能误伤人类&lt;/p&gt;&lt;p&gt;rpg：大范围爆炸等同于八次匕首伤害，并击飞极远距离，两发，可能误伤人类&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;道具：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;生物润滑油：喷在地板上，踩中的僵尸会摔倒并向下滑行极长距离，起身后速度降为一般人类，五次&lt;/p&gt;&lt;p&gt;生物电栏：拦住整条上山的路并对人类无效，一只僵尸踩中后会被定住极长时间，一次&lt;/p&gt;&lt;p&gt;背包火箭喷射器：向后喷射推进自己，击飞后方僵尸，三十秒，不占道具并与扩容背包冲突&lt;/p&gt;&lt;p&gt;扩容背包：允许多携带一个武器和两个道具，不占道具并与背包火箭喷射器冲突&lt;/p&gt;&lt;p&gt;钩爪：对地形使用会将人勾去命中目标出，对僵尸使用会勾住僵尸并将其甩下或甩下山崖，五次&lt;/p&gt;&lt;p&gt;跑鞋：速度两倍，无限&lt;/p&gt;&lt;p&gt;僵尸饲料：放置后会吸引附近僵尸强制食用并降低尸化值，五次&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;梦中体验：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;人类方，很难单独存活，虽然独立判定登顶胜利但是几乎必须合作。短期的卖队友可以增加个人存货里但对人类全体比例，最终可能害己。上山非常容易但下山困难。极度依赖道具。&lt;/p&gt;&lt;p&gt;僵尸方，尸化前尽量收集道具，在尸化后可以利用速度优势阻拦人类返回拾取道具。尽量在中段多杀人。离山顶越近掉落损失越大。完全尸化后容错路很低。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-10-24-47579064</guid>
<pubDate>Wed, 24 Oct 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>闲谈：浅谈投资领域不喜欢随机过程的原因</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-10-19-47206747.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/47206747&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;因为是闲谈，所以不收入魔王专栏。&lt;/p&gt;&lt;p&gt;众所周知，随机过程（或者其低配版时间序列）在投资领域可以说是非常不受待见了。这之中除了一些认知偏差意外，还有一些原因是有些道理的.  猫虽然对这个现象表示十分无奈，但是还是凭借自己在买方实习半年的微薄经验谈一个中原因。&lt;/p&gt;&lt;p&gt;抛出一些本身带有认知偏差比如“这些参数化模型的假设都是虚假”（你tm倒是自己去选正确假设啊）和主观因素“太难，太虚假不想学”之外，机制上原因大致上有这两个：&lt;/p&gt;&lt;p&gt;1.投资领域相较于资产路径，更加关注资产终值分布&lt;/p&gt;&lt;p&gt;2.序列样本内精确拟合困难且容易有偏差&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;投资领域相较于资产路径，更加关注资产终值分布：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们经常听到交易员说的一句话就是“只要能赚钱，怎么都行”，这句话的一另一个意思是：我只关注能不能赚钱，而不关注怎么赚钱的。所以两个今天都是5快，下个月都是10块的资产，一个直线上涨一个九曲十八弯，在假设不爆仓的前提下对交易员的最终PnL是一样的。&lt;/p&gt;&lt;p&gt;可是他们在随机过程（或者其低配版时间序列）的观点下完全是两种生物，前者是一个除了时间均值以外其余项全部为零的简单过程，无论什么假设下拟合出来的东西都一样。后者你不知道他除了均值和波动率以外还有什么可怕的东西，而且不同假设拟合出来的结果都不一样。&lt;/p&gt;&lt;p&gt;以上这些对一个看这些都一样的交易员来说自然就是虚假理论，这并非毫无道理。&lt;/p&gt;&lt;p&gt;但是反过来，什么时候路径对投资领域看是有用了呢？自然是在做“路径依赖”的投资方向的时候（这是一句废话）。那么哪些具体方向是需要路径依赖的呢，猫用自己浅薄的经验列几个：&lt;/p&gt;&lt;p&gt;1.基于均值回归的投资（比如配对交易，和本身带有回归性质的资产如波动率衍生品）：&lt;/p&gt;&lt;p&gt;因为回归不仅要考虑或回归到的均值位置本身，还需要考虑回归的速率和回归时的波动率，因此路径（或者叫演化规律，dynamic）就变得比较重要&lt;/p&gt;&lt;p&gt;2.动量投资：&lt;/p&gt;&lt;p&gt;跟很多人想象的不一样，动量是一个非常依赖路径的方式，因为虽然其最终盈利本身只与均值有关，但是其盈利的实时PnL严重受波动率影响。 &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/65c35f508b1bd677362f91e2313b5771&quot; data-hash=&quot;65c35f508b1bd677362f91e2313b5771&quot; data-hovercard=&quot;p$b$65c35f508b1bd677362f91e2313b5771&quot;&gt;@石川&lt;/a&gt; &lt;a href=&quot;https://www.zhihu.com/question/265859197/answer/421732728&quot; class=&quot;internal&quot;&gt;石川：量化择时到底有用吗？&lt;/a&gt; 引用了Roncalli的结果表示动量策略具有负vega&lt;/p&gt;&lt;p&gt;3.回报率干脆是资产dynamic本身的各种方式（主要依赖各种衍生品实现）&lt;/p&gt;&lt;p&gt;典型的有，straddle，risk-reversal， strangle和各类奇异衍生&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;序列样本内精确拟合困难且容易有偏差：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;和期权定价这种有明确拟合目标（市场期权价格）的方向不同，一般投资领域里没有一个明确的拟合目标（机器学习那些人管这个叫“损失函数”），只能在时间序列的样本内自己寻找拟合目标。这就造成了非常大的拟合上的困难：&lt;/p&gt;&lt;p&gt;1.如何把整个时间序列作为多个而不是一样本？需要做假设&lt;/p&gt;&lt;p&gt;2.两个时间戳之间能不能是iid？需要做假设&lt;/p&gt;&lt;p&gt;3.如果不能是iid，那么关于时间的分布变量应该是何种形式？ 需要做假设&lt;/p&gt;&lt;p&gt;4.找到了分布形式，用什么统计量去拟合？ 需要做假设&lt;/p&gt;&lt;p&gt;。。。。&lt;/p&gt;&lt;p&gt;可以看到每做一个假设，拟合的难度就提高一倍，而且一旦假设不小心，很容易就变成虚假的假设了。 这也不难理解为啥投资领域里那么多人青睐号称“完全没有任何假设的data based model”了。 &lt;/p&gt;&lt;p&gt;而且，时间序列的样本内拟合可以说的是一个又深又大又没人愿意碰的野鸡方向（做理论的不惜的搞这些，做实证的都去搞机器学习了），之前猫在试图做一个某个特性levy过程样本内校准时曾经遇到查了一个星期没找到相关论文的窘境。&lt;/p&gt;&lt;p&gt;但是反过来，一旦有不需要做过多假设的明确拟合的目标，时间序列的样本内的拟合就能派上用查。比如快速查看波动率”形状“这种需求，一般最虚假的Garch都能满足的很好。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;总之随机过程（或者其低配版时间序列）在投资领域实现起来总是有这样或那样的局限性，但是不代表他们是毫无用处的虚假模型，只是使用的时候需要格外小心&lt;/p&gt;&lt;p&gt;希望喜爱用”深度学习预测价格“的从业者们对自己喜爱的模型也有这样批判的态度，这样这个时代就能少诞生些想黑猫这样的极端反对者，黑猫期待你们的反思。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-10-19-47206747</guid>
<pubDate>Fri, 19 Oct 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>再闲谈波动率2——波动曲面参数化</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-10-13-37509695.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/37509695&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;本系列依旧秉承着完美避开一切有关波动率“预测”，“交易策略”，”期权策略“等一切和量化交易有关的”比较入行“的内容。不感兴趣的知有可以继续右上角了。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;在上篇 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/36942658&quot; class=&quot;internal&quot;&gt;再闲谈波动率1——Vega到底是什么东西&lt;/a&gt; 讨论Vega的过程中，其实是想表达这么一个观点：Vega只能作为波动率的一种敏感度，而波动率本身有新的敏感度（比如Vanna， Volga）而且不一定能被Vega所囊括，我们希望一个波动曲面能自然的跟需要被一些估计的参数S, K, T, \rho, \eta ....发生关系而不是单纯的在给定期权定价模型（绝大多数是BS）单纯的求出解和敏感度。 因此我们引出一个比较大的话题：&lt;b&gt;波动曲面参数化&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.参数化的一般需求：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;一般来说构建一个波动曲面的时候，我们总是尽可能的满足（或者取舍）以下这些需求：&lt;/p&gt;&lt;p&gt;1.光滑&lt;/p&gt;&lt;p&gt;2.无套利（能满足越多期权定价模型越好&lt;/p&gt;&lt;p&gt;3.能够特征化一些&lt;b&gt;建模者所需求&lt;/b&gt;的重要的市场信息&lt;/p&gt;&lt;p&gt;4.上述信息能够表象为某种上下文以便可以生成自己的曲面&lt;/p&gt;&lt;p&gt;5.尽量简单，易于生成曲面&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;上述这些需求一般情况下无法同时满足（2有的时候也不行），因此经常需要有取舍。比如著名的古老模型dupire local，几乎一定能保证曲面符合dynamic，但是难保证光滑。&lt;/p&gt;&lt;p&gt;跟绝大多数人理解的不同，并不是统一的波动率曲面（形成方式）就一定是好的。因为除了市场上有的报价，波动曲面的其他部分要插值。但是插值所用的生成函数往往会随建模需求而改变。 一般来说，上述的3会作为选择条件来决定用何种参数化方法，然后有1，2，4来限定拟合（校准）过程。&lt;/p&gt;&lt;p&gt;（这里就是一些“databased 拟合主义者“所不太能理解的地方。很多人总觉得建模应该更多的”learn from real world data“所以不能去做任何假设。其实所有模型都是某一种度量，而度量什么则是建模者需求的一部分。因此很多所谓的假设，不如说是建模者的需求。）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;这列举一些比较常见的波动率曲面参数化是的建模者需求：&lt;/p&gt;&lt;p&gt;1.需求生成波动率曲面的形状能被dynamic里的参数主导&lt;/p&gt;&lt;p&gt;2.需求生成波动率曲面的形状能被一些经调整的报价所主导&lt;/p&gt;&lt;p&gt;3.需求生成波动率曲面能满足一些特殊的产品&lt;/p&gt;&lt;p&gt;4.需求生成的波动率曲面有自己的dynamic&lt;/p&gt;&lt;p&gt;5.需求生成波动率曲面的参数能参与对冲行为，进行获利归因&lt;/p&gt;&lt;p&gt;。。。&lt;/p&gt;&lt;p&gt;上面这些需求有些事可以共存的，有些则是互斥的。比如在一些（被普遍认为是虚假理论）框架下134能很好的共存，然后在实际操作过程中25经常互斥。 部分需求是一般香草产品不需要的比如4。 &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;说了这么多想表达的中心思想是，波动曲面参数化是一个非常需求导向的建模过程，不存在绝对完美的参数化方案，只有最适合当前需求的参数化方案&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.参数化的一般过程：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1.从市场获得信息并形成用以生成曲面用的上下文（上下文不一定指数据，也可以指某种特殊的要求和场景，比如ccar）&lt;/p&gt;&lt;p&gt;2.根据建模者的需求，限定参数化方式（选取产品，选取定价模型，选取参数，选取校准方式，选取生成方式，选取曲面演化方式...） &lt;/p&gt;&lt;p&gt;3.根据上下文执行2的种的所有过程，生成曲面&lt;/p&gt;&lt;p&gt;4.执行定价并检验&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.参数化一般检验方式：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了检验参数化出的曲面是入行模型还是虚假模型，我们需要一系列检验。一些通用检验波动曲面的方式包括但不限于：&lt;/p&gt;&lt;p&gt;1.检查曲面的连续性，是否会出现在非常小的到期和strike变化下生成出的波动率值差别过大&lt;/p&gt;&lt;p&gt;2.检查曲面是否存在套利，对于建模不是从无套利dynamic出发的参数化方法，需要检验曲面有没有严重套利。一般检验对象有日历套利，蝴蝶套利和call/put spread套利（中文叫牛市/熊市差价？）。 原则上无套利要对所有定价模型生效，一般对香草产品，默认检验套利定价模型为BS。&lt;/p&gt;&lt;p&gt;3.对于需要曲面参数敏感度进行对冲的需求（要求大于vega的信息），需要进行指定产品波动率参数的获益归因。 这个检验是一般是对产品而不是对曲面的，所以需要特定场景特定讨论。&lt;/p&gt;&lt;p&gt;4.压力测试，检验市场环境变化或者畸形输入下模型的表现。前者是标准风险管理行为，后者是为了避免提取上下文时没有过滤掉一些畸形数据导致曲面畸形（没有通过1，2，3）。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;吐槽和骂人：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;一般来说，有无完善的波动曲面参数化方案是在处理波动曲面这个问题上，作坊式建模和工业化建模的一个分水岭，其工程量和投入是非常庞大的。如果企业不足以支撑这些投入，可以使用一些专业软件比如彭博的信息。但是由于专业软件的曲面一般非常标准化，很难满足上文所说各式各样的&lt;b&gt;建模者所需求。 &lt;/b&gt;一些量身为客户定做这些的咨询公司（比如numerix）也会提供一些服务， 这是一个很大的市场和需求。&lt;/p&gt;&lt;p&gt;本文没有举多少例子，反正以前每次都写具体例子，每次都被说虚假模型，那干脆就写一般性的东西，反正猫不是很在乎是不是更加虚假&lt;/p&gt;&lt;p&gt;关于是不是虚假模型，如果严格进行了这些步骤，猫并不反对某些人用”深度神经网络“生成曲面。但是一般情况下这些人不能理解第一节括号里的那些话。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;按照惯例，希望这些”被时代淘汰的虚假理论&quot;能帮助一些从业者和学习者。&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-10-13-37509695</guid>
<pubDate>Sat, 13 Oct 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>一种对Vol，Skew，Smile建仓的参数化方法</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-09-18-44590087.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/44590087&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-582a24682bccd7ddf4d0bdd6325b96c6_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;本文的动机是向认真回答一下&lt;/p&gt;&lt;a href=&quot;https://www.zhihu.com/question/294457328/answer/491159371&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;期权做多波动率，跨式和宽跨式，哪种更合适？&lt;/a&gt;&lt;p&gt;&lt;b&gt;声明：本文和”量化交易“，”预测“， ”策略”等笔者厌恶的问题没有任何关系，想入行的，觉得本文内容是虚假理论的读者们酌情右上角。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;当投资者对波动率的观点与市场观点不同时应该如何选用什么组合？&lt;/p&gt;&lt;p&gt;一般来说，不考虑非常特殊的敞口，观点一般有三种（以多方为例）：&lt;/p&gt;&lt;p&gt;1.认为Vol的平均水平被市场低估&lt;/p&gt;&lt;p&gt;2.认为Vol和underlying的相关程度被市场低估&lt;/p&gt;&lt;p&gt;3.认为VolofVol被市场低估（一般会导致等距OTMVol的平均水平和ATM不一）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;1对应的是 ATMstraddle，这个ATM可以是单纯的ATM，也可以是远期ATM，也可以是Delta-NeutralATM ，也称一般意义的Vol trade&lt;/p&gt;&lt;p&gt;2对应的是Risk Reversal ，也称Skew trade&lt;/p&gt;&lt;p&gt;3对应的是买入strangle 卖出straddle， 也称 Smile trade(或者butterfly）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;完了么？如果是一般意义上的“理论”那确实完了。那么头寸应该是多少呢？ 接下来一般意义上的实践派会根据自己的经验布置头寸了。 但是如果想从参数化的方法建模头寸呢？&lt;/p&gt;&lt;p&gt;&lt;b&gt;对不起，接下来的东西看起来就更像一般意义上“虚假的理论”了 ：&lt;/b&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;b&gt;一些定义： &lt;/b&gt;&lt;/p&gt;&lt;p&gt;不失一般性的，我们在外汇underlying， BS框架下进行叙述。 参考talk的作者Peter Carr便是在如下环境下讨论。选取BS作为框架比较一般性，选取外汇underlying是因为不少外汇期权的报价中是含RR和STR的。&lt;/p&gt;&lt;p&gt;如果读者觉得BS框架过于虚假可以自行替换别的框架，但是请保留建模目标和过程——我们的目的就是对三种头寸进行参数化。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;定义 &lt;img src=&quot;https://www.zhihu.com/equation?tex=I_t%28K%29+&quot; alt=&quot;I_t(K) &quot; eeimg=&quot;1&quot;&gt; 为隐含波动率， S为即期外汇&lt;/p&gt;&lt;p&gt;因为外汇具有本国对外国或者外国对本国的特殊性，我们定义S所在等价鞅测度为Q_ , 1/S所在等价鞅测度为Q+。 然后我们需要对两个测度进行“配平”来保证来保证一价定理。过程可以参考：&lt;/p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/30542844&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_ipico.jpg&quot; data-image-width=&quot;1024&quot; data-image-height=&quot;1024&quot; class=&quot;internal&quot;&gt;黑猫Q形态：Quanto与Composite 条款&lt;/a&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;在取得一致的等价鞅测度Q^b后，我们做如下假设或者规定。&lt;/p&gt;&lt;p&gt;1.S_t 服从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=dS_t+%3D+%5Csigma_tS_tdW_t&quot; alt=&quot;dS_t = \sigma_tS_tdW_t&quot; eeimg=&quot;1&quot;&gt; (如果觉得虚假可以自行把S切换为F）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;2.定义对数在值度： &lt;img src=&quot;https://www.zhihu.com/equation?tex=l_%5Cpm%28K%2FS%2C%5Csigma+%5Csqrt%5Ctau%29++%5Cequiv+++ln%28K%2FS%29+-+E%5EQ_%7B%5Cpm%7D%5Bln%28S_T%2FS_t%29%7CS_t+%3DS%5D+%3D+ln%28K%2FS%29+%5Cmp+%5Csigma%5E2+%5Ctau%2F2&quot; alt=&quot;l_\pm(K/S,\sigma \sqrt\tau)  \equiv   ln(K/S) - E^Q_{\pm}[ln(S_T/S_t)|S_t =S] = ln(K/S) \mp \sigma^2 \tau/2&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中第二个等式只在BS假设下成立，觉得的BS虚假的读者可以自行在喜欢的假设下计算期望部分&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;3.定义相对Gamma： &lt;img src=&quot;https://www.zhihu.com/equation?tex=R%5CGamma+%3D+S_t%5E2%5Cfrac%7B%5Cpartial%5E2P%28S%2C%5Csigma%2C%5Ctau%2CK%29%7D%7B%5Cpartial+S%5E2%7D&quot; alt=&quot;R\Gamma = S_t^2\frac{\partial^2P(S,\sigma,\tau,K)}{\partial S^2}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;则有对应的相对Vega，相对Vanna，相对Volga，Theta（正常的）表达形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R%5CGamma+%5Csigma%5E2+%5Ctau++++%2C%7ER%5CGamma+l_-+%2C%7ER%5CGamma+l_-+l_%2B+%2C%7E-R%5CGamma%5Csigma%5E2%2F2++%E2%80%94%E2%80%94%E2%80%94%E2%80%94%281%29++&quot; alt=&quot;R\Gamma \sigma^2 \tau    ,~R\Gamma l_- ,~R\Gamma l_- l_+ ,~-R\Gamma\sigma^2/2  ————(1)  &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这一步的目的是作为乘数消除S本身对Greeks的影响。 这些关系只在BS假设下成立，觉得的BS虚假的读者可以自行在喜欢的假设计算&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;4. 隐含波动率I_t服从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=dI_t%28K%29+%3D+%5Comega_tI_t%28K%29dZ_t&quot; alt=&quot;dI_t(K) = \omega_tI_t(K)dZ_t&quot; eeimg=&quot;1&quot;&gt; ， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%3CW%2CZ%3E_t+%3D+%5Crho_tdt&quot; alt=&quot;d&lt;W,Z&gt;_t = \rho_tdt&quot; eeimg=&quot;1&quot;&gt; , 并定义 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cgamma_t+%5Cequiv+%5Csigma_t%5Crho_t%5Comega_t&quot; alt=&quot;\gamma_t \equiv \sigma_t\rho_t\omega_t&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这一步是为了简化头寸的计算使其不带有一般意义上SV里的参数。 一般情况下， SV框架不会对IV进行建模，所以在SV框架下，本文所介绍的参数化方法会发生巨大变化，有兴趣的读者可以自行研究（说不定能发文）。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;5.定义K_atm 或者K^a 为能解出方程 &lt;img src=&quot;https://www.zhihu.com/equation?tex=l_-%28K%5Ea_t%2FSt+%2C++I_%7Batm%7D%5Csqrt%7BT-t%7D%29+%3D0&quot; alt=&quot;l_-(K^a_t/St ,  I_{atm}\sqrt{T-t}) =0&quot; eeimg=&quot;1&quot;&gt;  的K&lt;/p&gt;&lt;p&gt;这一步是为了确定一个model free的ATM strike定义。 &lt;/p&gt;&lt;p&gt;同时定义 &lt;img src=&quot;https://www.zhihu.com/equation?tex=I_%7Bat%7D+%5Cequiv+I_t%28K%5Ea_t%29&quot; alt=&quot;I_{at} \equiv I_t(K^a_t)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;6.假设波动曲面已知，则：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=P_t%28K%5Ep_t%29+%3D+P%5Eb%28S_t%2C+I_%7Bpt%7D%2C+T-t+%3B+K_t%5Ep%29%5C%5C+C_t%28K%5Ec_t%29+%3D+C%5Eb%28S_t%2C+I_%7Bct%7D%2C+T-t+%3B+K_t%5Ec%29+&quot; alt=&quot;P_t(K^p_t) = P^b(S_t, I_{pt}, T-t ; K_t^p)\\ C_t(K^c_t) = C^b(S_t, I_{ct}, T-t ; K_t^c) &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中b表示价格是在上面找到的一致测度下，此时我们可以获得瞬时损益（以put为例）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=gP_t%28K%5Ep_t%29+%5Cequiv+%5BdP%28S_t%2C+I_t%28K%29%2CT-t%2CK%7C_%7BK+%3D+K_t%5Ep%7D%5D&quot; alt=&quot;gP_t(K^p_t) \equiv [dP(S_t, I_t(K),T-t,K|_{K = K_t^p}]&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;7.定义A 为 ATM straddle：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=A%5Eb%28S%2C+%5Csigma%2C+%5Ctau%2C+K%29+%3D+P%5Eb%28S%2C%5Csigma%2C%5Ctau%2CK%29+%2B+C%5Eb%28S%2C%5Csigma%2C+%5Ctau%2C+K%29&quot; alt=&quot;A^b(S, \sigma, \tau, K) = P^b(S,\sigma,\tau,K) + C^b(S,\sigma, \tau, K)&quot; eeimg=&quot;1&quot;&gt; &lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;8.定义组合，组合损益及其对应头寸：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=V_t+%3D+%5Ceta_t%5EpP_t%28K_t%5Ep%29+%2B++%5Ceta_t%5EaA_t%28K_t%5Ea%29+%2B++%5Ceta_t%5EcC_t%28K_t%5Ec%29%5C%5C+gV_t+%3D+%5Ceta_t%5EpgP_t%28K_t%5Ep%29+%2B++%5Ceta_t%5EagA_t%28K_t%5Ea%29+%2B++%5Ceta_t%5EcgC_t%28K_t%5Ec%29&quot; alt=&quot;V_t = \eta_t^pP_t(K_t^p) +  \eta_t^aA_t(K_t^a) +  \eta_t^cC_t(K_t^c)\\ gV_t = \eta_t^pgP_t(K_t^p) +  \eta_t^agA_t(K_t^a) +  \eta_t^cgC_t(K_t^c)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;该头寸可以构成任意Straddle， Strangle和Risk Reversal之间的组合&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;损益拆分：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;定义里8中的组合，由伊藤定理可知：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=gP_%28K_t%5Ep%29+%3D+P_s%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29dS_t+%2B+P_s%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29dI_%7Bpt%7D+%2B+G%5Ep_dt++%E2%80%94%E2%80%94%E2%80%94%E2%80%94%282%29&quot; alt=&quot;gP_(K_t^p) = P_s^b(S_t,I_{pt},T-t;K_t^p)dS_t + P_s^b(S_t,I_{pt},T-t;K_t^p)dI_{pt} + G^p_dt  ————(2)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这里我们用下表示对该变量求偏导，上式中的G在Q_（本币对外币）为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=+P_%7Bss%7D%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29%5Cfrac%7Bd%3CS%3E_t%7D%7B2dt%7D+%2B++P_%7BsI%7D%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29%5Cfrac%7Bd%3CS%2CI_p%3E_t%7D%7B2dt%7D+%2B+%5C%5C+P_%7BII%7D%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29%5Cfrac%7Bd%3CI_p%3E_t%7D%7B2dt%7D+-+%5CTheta_t+%E2%80%94%E2%80%94%E2%80%94%E2%80%94%283%29&quot; alt=&quot; P_{ss}^b(S_t,I_{pt},T-t;K_t^p)\frac{d&lt;S&gt;_t}{2dt} +  P_{sI}^b(S_t,I_{pt},T-t;K_t^p)\frac{d&lt;S,I_p&gt;_t}{2dt} + \\ P_{II}^b(S_t,I_{pt},T-t;K_t^p)\frac{d&lt;I_p&gt;_t}{2dt} - \Theta_t ————(3)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;式2的前两部分都是Q_ 下的鞅，也就是一般人喜欢“预测”的部分。对此随机部分观点的读者可根绝观点自行决定方向。本文不提供决定方向的任何看法，因为本文只介绍头寸配置多少这个问题。（因此本文是“虚假理论”，入行的人判断对方想就能滋滋滋收获PnLCut了）&lt;/p&gt;&lt;p&gt;式3中，Theta的折损不可避免，因此建立头寸的重心不会放在Theta上而主要考虑二次项，四次项（伪，其表象形式为二次）和交叉项带来的各种二次变差&lt;/p&gt;&lt;p&gt;根据S和I各自服从的过程我们易知：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%3CS%3E_t%7D%7Bd_t%7D+%3D+%5Csigma_t%5E2S_t%5E2%2C++%7E%5Cfrac%7Bd%3CS%2C+I_p%3E_t%7D%7Bd_t%7D+%3D+S_t%5Cgamma_tI_%7Bpt%7D%2C++%5Cfrac%7Bd%3CI%3E_t%7D%7Bd_t%7D+%3D+%5Comega_t%5E2I_%7Bpt%7D%5E2&quot; alt=&quot;\frac{d&lt;S&gt;_t}{d_t} = \sigma_t^2S_t^2,  ~\frac{d&lt;S, I_p&gt;_t}{d_t} = S_t\gamma_tI_{pt},  \frac{d&lt;I&gt;_t}{d_t} = \omega_t^2I_{pt}^2&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;觉的服从过程假设虚假，不入行的读者可以自行建模，可以使用你们喜爱的”纯data based深度神经网络“，但要保证各类相关二次项能够被分解出来，否则无法继续。&lt;/p&gt;&lt;p&gt;在根据上节式1中的相对Greeks表达我们分别把put，call，atmstraddle的变差项损益表示为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=G_t%5Ep+%3D+R%5CGamma_t%5Ep%5B%5Csigma%5E2_t%2F2+-+I_%7Bpt%7D%5E2%2F2+%2B%5Cgamma_%7Bt%7D+l%5Ep_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Epl_%7B%2Bt%7D%5Ep%5Ddt+%5C%5C+G_t%5Ec+%3D+R%5CGamma_t%5Ec%5B%5Csigma%5E2_t%2F2+-+I_%7Bct%7D%5E2%2F2+%2B%5Cgamma_%7Bt%7D+l%5Ec_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Ecl_%7B%2Bt%7D%5Ec%5Ddt+%5C%5C+G_t%5Ea+%3D+R%5CGamma_t%5Ea%5B%5Csigma%5E2_t%2F2+-+I_%7Bat%7D%5E2%2F2+%5Ddt++%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%284%29&quot; alt=&quot;G_t^p = R\Gamma_t^p[\sigma^2_t/2 - I_{pt}^2/2 +\gamma_{t} l^p_{-t} +\omega_t^2l_{-t}^pl_{+t}^p]dt \\ G_t^c = R\Gamma_t^c[\sigma^2_t/2 - I_{ct}^2/2 +\gamma_{t} l^c_{-t} +\omega_t^2l_{-t}^cl_{+t}^c]dt \\ G_t^a = R\Gamma_t^a[\sigma^2_t/2 - I_{at}^2/2 ]dt  —————(4)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这一步的目的是为了分解变差损益，首先我们可以看到我们组合中三个成分都是”相对Gamma“的倍数。 其次straddle的变差向收益单纯就是实际波动率和隐含波动的差。 最后我们可以看到put和call分别会有变差项损益: &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cgamma_%7Bt%7D+l%5Ep_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Epl_%7B%2Bt%7D%5Ep+%2C%7E%5Cgamma_%7Bt%7D+l%5Ec_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Ecl_%7B%2Bt%7D%5Ec&quot; alt=&quot;\gamma_{t} l^p_{-t} +\omega_t^2l_{-t}^pl_{+t}^p ,~\gamma_{t} l^c_{-t} +\omega_t^2l_{-t}^cl_{+t}^c&quot; eeimg=&quot;1&quot;&gt; 这些将会构成Risk Reversal和Strangle- Straddle（非随机项）的收益来源&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;头寸建模：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;基于式4的结果我们可以构建三种trading的头寸&lt;/p&gt;&lt;p&gt;对于Straddle，购入每单位：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Ceta_t%5Ep+%3D+0%2C+%7E%5Ceta_t%5Ea+%3D+2%2FR%5CGamma%5Ea_t%2C++%7E%5Ceta_t%5Ec&quot; alt=&quot;\eta_t^p = 0, ~\eta_t^a = 2/R\Gamma^a_t,  ~\eta_t^c&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这一步除以”相对Gamma的目的“是消除方差和gamma本身对收益的缩放，喜欢缩放的读者可以不除&lt;/p&gt;&lt;p&gt;如此，Straddle的瞬时损益期望为：&lt;br&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=G%5Ev_t%5Cequiv%5Csigma%5E2_t+-+I_%7Bpt%7D%5E2&quot; alt=&quot;G^v_t\equiv\sigma^2_t - I_{pt}^2&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;对于Risk Reversal，购入每单位：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Ceta_t%5Ep+%3D+%5Cfrac%7B-1%7D%7B%28l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep%29R%5CGamma%5Ep_t%7D%2C+%7E%5Ceta_t%5Ea+%3D+0%2C++%7E%5Ceta_t%5Ec+%3D%5Cfrac%7B1%7D%7B%28l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep%29R%5CGamma%5Ec_t%7D&quot; alt=&quot;\eta_t^p = \frac{-1}{(l_{-t}^c - l_{-t}^p)R\Gamma^p_t}, ~\eta_t^a = 0,  ~\eta_t^c =\frac{1}{(l_{-t}^c - l_{-t}^p)R\Gamma^c_t}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;除以 &lt;img src=&quot;https://www.zhihu.com/equation?tex=l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep&quot; alt=&quot;l_{-t}^c - l_{-t}^p&quot; eeimg=&quot;1&quot;&gt; 和除以相对Gamma的目的相同，为了消除在值度差缩放作用，喜欢缩放读者可以不除&lt;/p&gt;&lt;p&gt;如此，Risk Reversal的瞬时损益期望为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=G%5E2_t+%5Cequiv+%5Cgamma_t+-+%5Cfrac%7BI%5E2_%7Bct%7D+-I%5E2_%7Bpt%7D%7D%7B2%28l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep%29%7D&quot; alt=&quot;G^2_t \equiv \gamma_t - \frac{I^2_{ct} -I^2_{pt}}{2(l_{-t}^c - l_{-t}^p)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;通俗讲，左边就是交叉相的损益（一般是负的），右边是被在值度的缩放的pc间IV的差&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;对于Strangle- ATMStraddle 购入每单位：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Ceta_t%5Ep+%3D+%5Cfrac%7B1%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2R%5CGamma%5Ep_t%7D%2C+%7E%5Ceta_t%5Ea+%3D++%5Cfrac%7B2%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2R%5CGamma%5Ea_t%7D%2C++%7E%5Ceta_t%5Ec+%3D+%5Cfrac%7B1%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2R%5CGamma%5Ec_t%7D&quot; alt=&quot;\eta_t^p = \frac{1}{\bar{l}_{agt}^2R\Gamma^p_t}, ~\eta_t^a =  \frac{2}{\bar{l}_{agt}^2R\Gamma^a_t},  ~\eta_t^c = \frac{1}{\bar{l}_{agt}^2R\Gamma^c_t}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar%7Bl%7D_%7Bagt%7D%5E2+%3D%28l_%7B-t%7D%5Ec+%2B+%7Cl_%7B-t%7D%5Ep%7C%29%28l_%7B%2Bt%7D%5Ec+%2B+%7Cl_%7B%2Bt%7D%5Ep%7C%29%2F4&quot; alt=&quot;\bar{l}_{agt}^2 =(l_{-t}^c + |l_{-t}^p|)(l_{+t}^c + |l_{+t}^p|)/4&quot; eeimg=&quot;1&quot;&gt;  是为了消除在值度的缩放，喜欢缩放读者可以不除&lt;/p&gt;&lt;p&gt;如此butterfly的收益的瞬时损益期望为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=G%5Ev_t+%3D+%5Comega%5E2_t+-++%5Cfrac%7B%28I_%7Bct%7D%5E2%2BI_%7Bpt%7D%5E2%29%2F2+-+I%5E2_%7Bat%7D%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2+%7D&quot; alt=&quot;G^v_t = \omega^2_t -  \frac{(I_{ct}^2+I_{pt}^2)/2 - I^2_{at}}{\bar{l}_{agt}^2 }&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;通俗讲，左边是波动率的波动率， 右边是被在值度的缩放的strangle平均IV和atmIV的差&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;我们可以发现这个参数化模型的一大优点就是不需要拟合诸如Heston的SV模型就可以对三种涉及到高阶信息的仓位进行拆分和建模。&lt;/p&gt;&lt;p&gt;当然，如果需要对收益期望的大小建模还是需要一个SV模型，由于本文中模型是直接对IV建模，因此嫁接SV模型时会发生非常大的变化（需另对IV和SV的差另外进行建模）。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;吐槽和骂人：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;是，本问不是不入行的”虚假模型“，问题是当交易员一个个都只想着赌方向的时候，有谁会去想应该赌多少呢？怕是连下注都容易下错吧。当然这些都是猫这个低等文职闲的无聊考虑的问题，交易员们可能没时间考虑，忙着滋滋滋赚PnLCut。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;最后，按照惯例，希望这些”被时代淘汰的虚假理论&quot;能帮助一些从业者和学习者。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;模型出处：&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//kolmogorov.fsc.stevens.edu/hff_conference/images/Presentation_File/Peter-Carr_Vol-Skew-and-Smile-Trading.pdf&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;kolmogorov.fsc.stevens.edu&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/hff_conference/images/Presentation_File/Peter-Carr_Vol-Skew-and-Smile-Trading.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-09-18-44590087</guid>
<pubDate>Tue, 18 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>XVA简介</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-06-22-38305988.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38305988&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;动机就是要给人辅导XVA基础，感觉自己讲比较nonsense，所以找了个笔记抄，最后找到了这个&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//www.iruizconsulting.com/wp-content/uploads/2015/04/iRuiz_XVA.pdf&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;iruizconsulting.com/wp-&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;content/uploads/2015/04/iRuiz_XVA.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;感谢 &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/06e1c0cadfaab8dae2fca66aaa30d65f&quot; data-hash=&quot;06e1c0cadfaab8dae2fca66aaa30d65f&quot; data-hovercard=&quot;p$b$06e1c0cadfaab8dae2fca66aaa30d65f&quot;&gt;@消毒纸巾&lt;/a&gt; &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/b240f071fb415d2b7eba9fbfea57052d&quot; data-hash=&quot;b240f071fb415d2b7eba9fbfea57052d&quot; data-hovercard=&quot;p$b$b240f071fb415d2b7eba9fbfea57052d&quot;&gt;@皮皮爸&lt;/a&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;声明：本文和”量化交易“，”预测“， ”策略”等笔者厌恶的问题没有任何关系，想入行的读者酌情右上角。 本文的所涉内容大量业界企业在使用，认为是“理论”的读者也烦请酌情右上角。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;一，切入点：一个对手信用风险建模框架&lt;/b&gt;&lt;/p&gt;&lt;p&gt;虽然价值调整有很多，作为切入点，我们选择最容易解释的对手信用风险。 所谓对手信用风险，就是指不是一般的企业信用风险，而是只有当对这个企业有敞口（他欠我钱）的时候由于违约所造成的敞口对应资产价值损失的风险，才叫做对手风险。&lt;/p&gt;&lt;p&gt;因为这种特殊信用风险只对对手方，不但要衡量违约率，还要衡量违约时间，所以和一般意义上”信用评级“有关的那种信用风险有很大差别，因此需要专门框架。我们称因为这种风险导致的，对手对我们的信用价值调整为CVA，我们对对手的信用价值为DVA（我们欠他们钱的调整），因此CVA是一个双向概念。本文接下来将不区分CVA和DVA而直接成为资产或负债的CVA。&lt;/p&gt;&lt;p&gt;我们考虑在一个时间区间 [t,t+dt]内双方的违约情况：&lt;/p&gt;&lt;p&gt;1.我们和对手方都活到了t+dt;&lt;/p&gt;&lt;p&gt;2.我们活到了t+dt，但是对手方在dt内死了；&lt;/p&gt;&lt;p&gt;3.我们在dt内死了，但是对手方还活着；&lt;/p&gt;&lt;p&gt;4.我们和对手方都在dt内死了。&lt;/p&gt;&lt;p&gt;首先如果要考虑t到t+dt的违约率，其条件是双方都活到t时刻。所以我们先要对生存率建模。这里利用一个性质：发生次数服从的泊松分布的事件，其事件发生第一次的事件分布恰为指数分布。我们可以让违约事件发生的分布和发生时间分布公用一个hazard rate &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Clambda&quot; alt=&quot;\lambda&quot; eeimg=&quot;1&quot;&gt; （单位时间内违约概率）。因此，一方从0活到t的概率为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=S_%7B0%2Ct%7D%3De%5E%7B-%5Cint_0%5Et%5Clambda_udu%7D&quot; alt=&quot;S_{0,t}=e^{-\int_0^t\lambda_udu}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这里有一个建模上讨巧的点。因为我们知道贴现因子DF(形式一般为： &lt;img src=&quot;https://www.zhihu.com/equation?tex=e%5E%7B-%5Cint_0%5Etr_udu%7D&quot; alt=&quot;e^{-\int_0^tr_udu}&quot; eeimg=&quot;1&quot;&gt; )是作为乘数的存在的。而生存率也是作为乘数的，因此hazard rate在形式上完全作为一个利率。实际上，高度流通的信用产品市场里，违约率就是作为“利率”使用的。短期率对应hazard rate，ytm对应信用溢差（credit spread）(中间差个LGD)。&lt;/p&gt;&lt;p&gt;我们分别用our和cpty来表示我们和对手方，这样在上述四种违约状况下，我们有四种发生概率和现金流：&lt;/p&gt;&lt;p&gt;1.发生概率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S_%7Bt%2Ct%2Bdt%7D%5E%7Bour%7DS_%7Bt%2Ct%2Bdt%7D%5E%7Bcpty%7D+&quot; alt=&quot;S_{t,t+dt}^{our}S_{t,t+dt}^{cpty} &quot; eeimg=&quot;1&quot;&gt; ；现金流 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_tdt&quot; alt=&quot;x_tdt&quot; eeimg=&quot;1&quot;&gt; ,( &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t+&quot; alt=&quot;x_t &quot; eeimg=&quot;1&quot;&gt; 表示衍生品在dt内产生的现金流&lt;/p&gt;&lt;p&gt;2.发生概率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S_%7Bt%2Ct%2Bdt%7D%5E%7Bour%7D%5Clambda_t%5E%7Bcpty%7Ddt+&quot; alt=&quot;S_{t,t+dt}^{our}\lambda_t^{cpty}dt &quot; eeimg=&quot;1&quot;&gt; ;  现金流 &lt;img src=&quot;https://www.zhihu.com/equation?tex=-%281-RR_t%5E%7Bcpty%7D%29P_t%5E%2B&quot; alt=&quot;-(1-RR_t^{cpty})P_t^+&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;(RR表示违约发生时的回复率, 因此 1-RR即为违约损失率，P^+表示正敞口&lt;/p&gt;&lt;p&gt;3.发生概率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S_%7Bt%2Ct%2Bdt%7D%5E%7Bcpty%7D%5Clambda_t%5E%7Bour%7Ddt&quot; alt=&quot;S_{t,t+dt}^{cpty}\lambda_t^{our}dt&quot; eeimg=&quot;1&quot;&gt; ;  现金流 &lt;img src=&quot;https://www.zhihu.com/equation?tex=-%281-RR_t%5E%7Bour%7D%29P_t%5E-&quot; alt=&quot;-(1-RR_t^{our})P_t^-&quot; eeimg=&quot;1&quot;&gt;  (P^-表示负敞口&lt;/p&gt;&lt;p&gt;4.发生概率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Clambda_t%5E%7Bour%7Ddt%5Clambda_t%5E%7Bcpty%7Ddt&quot; alt=&quot;\lambda_t^{our}dt\lambda_t^{cpty}dt&quot; eeimg=&quot;1&quot;&gt; ； 现金流 &lt;img src=&quot;https://www.zhihu.com/equation?tex=-%281-RR_t%5E%7Bcpty%7D%29P_t%5E%2B-%281-RR_t%5E%7Bour%7D%29P_t%5E-&quot; alt=&quot;-(1-RR_t^{cpty})P_t^+-(1-RR_t^{our})P_t^-&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;我们知道CVA可以表示为 :&lt;img src=&quot;https://www.zhihu.com/equation?tex=EAD%EF%BC%88%E8%BF%9D%E7%BA%A6%E6%97%B6%E6%95%9E%E5%8F%A3%EF%BC%8C%E6%9C%AC%E6%96%87%E8%80%83%E8%99%91%E5%8F%8C%E5%90%91%29%2APD%EF%BC%88%E8%BF%9D%E7%BA%A6%E5%8F%91%E7%94%9F%E6%A6%82%E7%8E%87%29%2ALGD+&quot; alt=&quot;EAD（违约时敞口，本文考虑双向)*PD（违约发生概率)*LGD &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;再给出双方都活到t时刻的条件概率: &lt;img src=&quot;https://www.zhihu.com/equation?tex=e%5E%7B-%5Cint_0%5Et%5Clambda_u%5E%7Bour%7D%2B%5Clambda_u%5E%7Bcpty%7Ddu%7D&quot; alt=&quot;e^{-\int_0^t\lambda_u^{our}+\lambda_u^{cpty}du}&quot; eeimg=&quot;1&quot;&gt; 我们就会得到了一个衍生品在给定时间段内的考虑对手信用风险的价格的一般性建模。为了结果的简单这里做一些规定。&lt;/p&gt;&lt;p&gt;1.约定“风险贴现率”为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=DF%5E%2A%3De%5E%7B-%5Cint_0%5Et+r_u%2B%5Clambda_u%5E%7Bour%7D%2B%5Clambda_u%5E%7Bcpty%7Ddu%7D&quot; alt=&quot;DF^*=e^{-\int_0^t r_u+\lambda_u^{our}+\lambda_u^{cpty}du}&quot; eeimg=&quot;1&quot;&gt; （这里体现了hazard作为利率的形式）&lt;/p&gt;&lt;p&gt;2.所有违约概率与敞口无关（没有错向风险）&lt;/p&gt;&lt;p&gt;3.定义正敞口的期望为期望正敞口EPE（对应负敞口期望为ENE）&lt;/p&gt;&lt;p&gt;4.短时间内双方同时违约的概率小到可以忽略&lt;/p&gt;&lt;p&gt;则衍生品的价格为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=P%5E%7BCpty%7D_0+%3DP_0+-CVA_%7Bbi%7D+&quot; alt=&quot;P^{Cpty}_0 =P_0 -CVA_{bi} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中双向CVA_bi为资产CVA和负债CVA（也就是DVA，这里取负）之和：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=CVA_%7Basset%2C0%7D%2BCVA_%7Blib%2C0%7D&quot; alt=&quot;CVA_{asset,0}+CVA_{lib,0}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;他们分别能表示为：&lt;br&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=CVA_%7Basset%2C0%7D+%3D%281-RR_t%5E%7Bcpty%7D%29%5Cint_0%5ETDF%5E%2A_%7B0%2Ct%7D%5Clambda_t%5E%7Bcpty%7DEPE_tdt%5C%5C+CVA_%7Blib%2C0%7D+%3D%281-RR_t%5E%7Bour%7D%29%5Cint_0%5ETDF%5E%2A_%7B0%2Ct%7D%5Clambda_t%5E%7Bour%7DENE_tdt&quot; alt=&quot;CVA_{asset,0} =(1-RR_t^{cpty})\int_0^TDF^*_{0,t}\lambda_t^{cpty}EPE_tdt\\ CVA_{lib,0} =(1-RR_t^{our})\int_0^TDF^*_{0,t}\lambda_t^{our}ENE_tdt&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;我们定义信用溢差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_t+%5Csimeq%281-RR%29%5Clambda_t&quot; alt=&quot;s_t \simeq(1-RR)\lambda_t&quot; eeimg=&quot;1&quot;&gt; 则：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=CVA_%7Basset%2C0%7D+%3D%5Cint_0%5ETDF%5E%2A_%7B0%2Ct%7Ds_t%5E%7Bcpty%7DEPE_tdt%5C%5C+CVA_%7Blib%2C0%7D+%3D%5Cint_0%5ETDF%5E%2A_%7B0%2Ct%7Ds_t%5E%7Bour%7DENE_tdt&quot; alt=&quot;CVA_{asset,0} =\int_0^TDF^*_{0,t}s_t^{cpty}EPE_tdt\\ CVA_{lib,0} =\int_0^TDF^*_{0,t}s_t^{our}ENE_tdt&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;该方法是一个一般性的对手信用风险调整法，注意到上述规定中2和4是比较强的假设，因此比较成熟的模型会对这两点进行修正。&lt;/p&gt;&lt;hr&gt;&lt;p&gt;待续……&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-06-22-38305988</guid>
<pubDate>Fri, 22 Jun 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>再闲谈波动率1——Vega到底是什么东西</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-05-17-36942658.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/36942658&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;看到标题想了解：预测”波动率从而形成“交易策略”，如果做Vega“策略“，”量化交易中的Vega“的知友现在可以点右上角了。本文和本系列接下来都是无意义的假设和虚假的理论，仅仅讨论一个问题，Vega是什么？波动率是什么？&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;起因：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;事情的起因是&lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/e04e3a9ebf1e3f8dfa5c71022919d7af&quot; data-hash=&quot;e04e3a9ebf1e3f8dfa5c71022919d7af&quot; data-hovercard=&quot;p$b$e04e3a9ebf1e3f8dfa5c71022919d7af&quot;&gt;@ChristianZhao&lt;/a&gt; 跟猫谈起他的研究，他一直在做基于分数布朗运动的随机波动率期权定价模型的Vega。 最大的困难就是——Vega不存在……所以一度有个蛋疼的困境。 当时猫给他的建议，不妨找到有同样功能的替代品，来完成对冲目的而不是纠结非得计算一个对波动率的偏导。&lt;/p&gt;&lt;p&gt;当然这个研究对象本身就是有问题的，因为SV风险本身就对vega来说就是missing risk。 也就是他研究的东西本身不管Vega。&lt;/p&gt;&lt;p&gt;而这个事情没有这样过去，Vega是个什么东西，本身就是个问题，因为作为函数变量的波动本身村不存在都是个问题？那么说到底Vega是干啥的？&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;几种比较简单的尝试:&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第一种简单的尝试是，当我们获得一个波动率过程的时候，我们能算出他的期望作为一个常数，然后在一个产品期限的条款内，求出对这个期望的敏感度。 问题很明显，该期望对应的常数波动率对产品能正确定价么？波动率的分布非一阶特性会不会对产品的价格有影响？ 我们知道，波动率的分布对于一些路径依赖产品有非常啊的影响，基于这个原因，第一种尝试是不恰当的。同理不恰当的还有用波动率过程生成曲面在期限内取平均。&lt;/p&gt;&lt;p&gt;第二种简单的尝试是，我们不纠结什么是”波动率“，任我们的分布复杂到什么情况，对可能用到的非一阶参数都求敏感度，这样不就不会漏掉任何风险了么？实际上，不止一个人这么做，甚至有人对CGMY的每一个参数都做了敏感度分析，但这些参数没有一个能显示在PnL上。虽然复杂模型模型可以拟合各种复杂分布，但是用来做PnL的只有能够被对冲的。也就是哪怕”波动率“不存在，我们分析了一堆复杂参数的敏感度，到最后还是只能当成波动率来处理。&lt;/p&gt;&lt;p&gt;第三种尝试是，既然必须参数化，还必须简单参数化（BSIV），还不能是常数，那对曲面上每个点求一个Vega，然后看我们需要哪个或者那些”Vega“不就好了？这是一个非常聪明的做法，比较典型的是类似在债券里用PCA分解期限结构一样，《dynamic hedging》也提到了类似的multi factor Vega。 也就是对曲面做一些因子化，然后对每个因子求Vega。&lt;/p&gt;&lt;p&gt;然而有一个问题没有解决，就是这里无论怎么做，都忽略了一个问题：&lt;b&gt;所谓波动率难道不是Spot的一个统计量（即使是IV，也只是model implied的这个统计量罢了）。如果Spot变了，Vol会不会变？&lt;/b&gt; 被连带出的问题还有Vega和Gamma到底是不是同一个东西？&lt;/p&gt;&lt;p&gt;这个问题，很严峻，因为他把上面所有尝试全部挑战了。 因为需要定价，我们不得不去估计Spot的某种分布（过程）；而因为上面尝试二提到的问题，我们还不得不假设他有一个波动率，然后我们希望，这个波动率的分布能揭示分布的某种统计特性（比如heston一类模型，试图对三四阶矩都进行参数化并反映到波动率的分布里，但是做的不那么好）。这些都很苛刻。&lt;/p&gt;&lt;p&gt;那我们不禁问了？这怎么办？难道我们只能放弃所有这些虚假的假设，甚至放弃分布，放弃模型然后用”不用任何假设的纯data based 200层深度在线强化神经网络“去拟合价格么？&lt;/p&gt;&lt;p&gt;实际上上述方法三已经能解决部分问题了，我们确实需要从曲面入手。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Moneyness and Vanna：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;sticky monyness 曲面的提出，实际上部分解决了上面的这些问题。为了避免波动率只跟K发证关系，从而导致上述提出的挑战性问题，人们根据对数收益合理的定义了 log moneyness (对数在值度） ：ln(S/K) 。 这样，在敲定K之后，曲面实际变成了S的曲面，我们希望看到的“波动率和价格发生实质关系”好像得到了实现。&lt;/p&gt;&lt;p&gt;实际上，问题并没有完全解决，因为这里只是替换了K和S的概念而已。为了更进一步解决这个问题，人们提出了一个新Greeks： &lt;img src=&quot;https://www.zhihu.com/equation?tex=Vanna+%3D+%5Cfrac%7B%5Cpartial%5E2V%7D%7B%5Cpartial+S+%5Cpartial+%5Csigma+%7D&quot; alt=&quot;Vanna = \frac{\partial^2V}{\partial S \partial \sigma }&quot; eeimg=&quot;1&quot;&gt; 。 作为“delta的Vega”， 这个敏感度可以一顶程度上解释，“多少波动率变化解释了产品对S的敏感度”这个问题。&lt;/p&gt;&lt;p&gt;那么，聪明的人会这么想： 既然这样，为什么不能让波动率反过来是Spot的函数呢？ 实际上，如果不是因为波动率是Spot的二阶统计量这一尴尬的事实，这么做或许是可行的。那么我们把这个想法修改一下：我们让波动率是在值度的函数，然后我们定义比对数在值度一个更合理的在值度量就好了。&lt;/p&gt;&lt;p&gt;因此，最后一个delta可能就变成了：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+C%7D%7B%5Cpartial+S%7D+%2B+%5Cfrac%7B%5Cpartial+C%7D%7B%5Cpartial+K%7D%5Cfrac%7B%5Cpartial+K%7D%7B%5Cpartial+S%7D+%2B+%5Cfrac%7B%5Cpartial+C%7D%7B%5Cpartial+%5Csigma%7D%5Cfrac%7B%5Cpartial+%5Csigma%7D%7B%5Cpartial+K%7D%5Cfrac%7B%5Cpartial+K%7D%7B%5Cpartial+S%7D&quot; alt=&quot;\frac{\partial C}{\partial S} + \frac{\partial C}{\partial K}\frac{\partial K}{\partial S} + \frac{\partial C}{\partial \sigma}\frac{\partial \sigma}{\partial K}\frac{\partial K}{\partial S}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这年头连搞个delta都不容易啊……&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;希望这些虚假的理论能给一些在职者一定帮助。&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-05-17-36942658</guid>
<pubDate>Thu, 17 May 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>为什么你们那么喜欢咨询”职业，专业，择校“啊？</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-05-16-36897810.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/36897810&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;问猫这个不入行的混子有什么用啊？猫自己的”职业，专业，择校“烂的跟纽约C线里的厕所一样，来问猫真的大丈夫？&lt;/p&gt;&lt;p&gt;一个个都要做量♂化，要做交♂易？ 这年头连做个后台，风险都需要”忍受生活“才能活下去了。 问猫干嘛啊？教你们怎么去”忍受“风险岗位？&lt;/p&gt;&lt;p&gt;反正像猫这种水平差，背景差，能力差还喜欢研究一些”虚假理论“的家伙能混口饭吃已经谢天谢地了？怎么轮得到猫我这种混子来教各位未来的基金经理如何入行呢？&lt;/p&gt;&lt;p&gt;至于专业，对猫是劝退金融，金融不是什么好专业。但是具体怎么办，猫也很绝望啊。因为猫自己就是”金融“出来的，怎么能知道什么专业不受害呢？&lt;/p&gt;&lt;p&gt;然后学校，这年头那些”读了就失败“的MFE硕士都已经是牛的不行的人才去的了得了（反正猫去不了），猫的建议是真的有个学校别太差着真的想出来就别挑了，鸡仔和麻雀比大小没什么意义的真的。&lt;/p&gt;&lt;p&gt;问猫看啥，看命呗，随缘，别再”咨♂询“了，求大家了&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;真的那么想去做那些高大上的事情，教你们一个方法。去请 &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/7228b51dec3b7a67d5e233362a49d24a&quot; data-hash=&quot;7228b51dec3b7a67d5e233362a49d24a&quot; data-hovercard=&quot;p$b$7228b51dec3b7a67d5e233362a49d24a&quot;&gt;@AlgoHeart&lt;/a&gt; 算法之心吃海鲜，他吃高兴了兴许会告诉你们一点行业内幕和口味&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-05-16-36897810</guid>
<pubDate>Wed, 16 May 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Libor Market Model 简介3 ——LMM下的基本利率产品</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-04-24-35850285.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/35850285&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;前言：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;再进一步介绍前，我们需要先介绍LMM下的产品及的构造。 这是因为最基本的贴现率曲构造含有LIBOR的产品，那么产品的结构就会变得无边的复杂。&lt;/p&gt;&lt;p&gt;而如果能把产品在LMM下拆解从而直接校准到一个tenor structure上，含有LIBOR的产品就能被在同一框架下校准，避免了过多无意义的构造(这个我们管他叫做适当约化吧）。&lt;/p&gt;&lt;p&gt;上两篇文章的链接：&lt;/p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/34664049&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_ipico.jpg&quot; data-image-width=&quot;1024&quot; data-image-height=&quot;1024&quot; class=&quot;internal&quot;&gt;黑猫Q形态：Libor Market Model 简介2 ——分离波动率函数和校准（一部分）&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/34562207&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_ipico.jpg&quot; data-image-width=&quot;1024&quot; data-image-height=&quot;1024&quot; class=&quot;internal&quot;&gt;黑猫Q形态：Libor Market Model简介&lt;/a&gt;&lt;p&gt;&lt;b&gt;正文：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;所谓的产品构造，就是在LMM下的定价（不然校准没有目标函数）。本文介绍两个比较基本的产品，更加奇异的可以参考AP或者AP中提到的文献&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Cap/Floor：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Cap和Floor对应的是LMM下的香草产品（Call/Put），他们是一种在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=T_n+&quot; alt=&quot;T_n &quot; eeimg=&quot;1&quot;&gt; 时刻到期， &lt;img src=&quot;https://www.zhihu.com/equation?tex=T_%7Bn%2B1%7D+&quot; alt=&quot;T_{n+1} &quot; eeimg=&quot;1&quot;&gt; 结算（或者处置？）的单期产品。他们的payoff为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=V_c+%28T_%7Bn%2B1%7D%29+%3D+%5Ctau_n%5BL_n%28T_n%29-k%5D%5E%2B%5C%5C+V_p+%28T_%7Bn%2B1%7D%29+%3D+%5Ctau_n%5Bk-L_n%28T_n%29%5D%5E%2B&quot; alt=&quot;V_c (T_{n+1}) = \tau_n[L_n(T_n)-k]^+\\ V_p (T_{n+1}) = \tau_n[k-L_n(T_n)]^+&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;那么他的价值（以cap为例）为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=V_0+%3D+P%280%2CT_%7Bn%2B1%7D%29+%5Ctau_n+E%5E%7BT_%7Bn%2B1%7D%7D%5B%28L_n%28T_n%29-k%29%5E%2B%5D&quot; alt=&quot;V_0 = P(0,T_{n+1}) \tau_n E^{T_{n+1}}[(L_n(T_n)-k)^+]&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中根据文二可“可分离函数”部分的相关性分解法和文一“LIBOR过程构造”中每期tenor的递推式我们可以给出LIBOR过程&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=dL_n%28t%29+%3D+%5Csqrt%7BZ_t%7D+%5Cvarphi%28L_n%28y%29%7C%7C%5Clambda_n%28t%29%7C%7C%29+dY%5E%7Bn%2B1%7D%28t%29%5C%5C+Y%5E%7Bn%2B1%7D%28t%29+%3D%5Cint_0%5Et%5Cfrac%7B%5Clambda_n%28s%29%5E%5Ctop%7D%7B%7C%7C%5Clambda_n%28s%29%7C%7C%7DdW%5E%7Bn%2B1%7D%28s%29&quot; alt=&quot;dL_n(t) = \sqrt{Z_t} \varphi(L_n(y)||\lambda_n(t)||) dY^{n+1}(t)\\ Y^{n+1}(t) =\int_0^t\frac{\lambda_n(s)^\top}{||\lambda_n(s)||}dW^{n+1}(s)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中Z可以是任意波动率过程&lt;/p&gt;&lt;p&gt;其实就是LIBOR过程构造在可分离函数下的直接结果， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cvarphi&quot; alt=&quot;\varphi&quot; eeimg=&quot;1&quot;&gt; 函数可以采用文二中的经验函数（后文同理）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Swaption：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Swaption作为一种比较奇异的产品，特点是他的计价单位是年金系数A(t),虽然定义过很多遍了，仍然要再写一下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=A_%7Bk%2Cm%7D%28t%29+%3D+%5Csum_%7Bn%3Dk%7D%5E%7Bk%2Bm-1%7D%5Ctau_nP%28t%2CT_%7Bn%2B1%7D%29&quot; alt=&quot;A_{k,m}(t) = \sum_{n=k}^{k+m-1}\tau_nP(t,T_{n+1})&quot; eeimg=&quot;1&quot;&gt; 代表&lt;b&gt;t时刻第k个到期日开始，共m期的年金&lt;/b&gt;&lt;/p&gt;&lt;p&gt;那么第j个到期日，swaption的payoff为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=V_%7Bswaption%7D%28T_j%29+%3DA%28T_j%29+%5BS%28T_j%29+-+k%5D%5E%2B&quot; alt=&quot;V_{swaption}(T_j) =A(T_j) [S(T_j) - k]^+&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中互换率S定义为&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=S_%7Bk%2Cm%7D%28t%29+%3D%5Cfrac%7B%5Csum_%7Bn%3Dk%7D%5E%7Bk%2Bm-1%7D%5Ctau_nP%28t%2CT_%7Bn%2B1%7D%29L_n%28t%29+%7D%7BA_%7Bk%2Cm%7D%28t%29%7D&quot; alt=&quot;S_{k,m}(t) =\frac{\sum_{n=k}^{k+m-1}\tau_nP(t,T_{n+1})L_n(t) }{A_{k,m}(t)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;之所以会出现第j个到期日，是因为对于一个swap，我们有很多个tenor。所以进入不同tenor的swaption应该当错不同产品来对待。实际上这也是很好体现LMM模型比一般衍生品模型多了tenor struct这个维度的一个地方。举个例子，五年期的十年swaption（5y-into-10y）意味选择进入一个进入5年到10年的多起互换的权利。当只进入一期（m=1）时，swaption自然退化成了cap和floor&lt;/p&gt;&lt;p&gt;为此，经过一些复杂的符合，我们可以给出A计价单位下互换率的LMM过程：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=dS%28t%29+%3D+%5Csqrt%7BZ%28t%29%7D+%5Cvarphi%28S%28t%29%29+%5Csum_%7Bn%3Dk%7D%5E%7Bn%2Bk-1b%7D%7B%5Comega_n%28t%29%5Clambda_n%28t%29%5E%5Ctop%7DdW%5EA%28t%29&quot; alt=&quot;dS(t) = \sqrt{Z(t)} \varphi(S(t)) \sum_{n=k}^{n+k-1b}{\omega_n(t)\lambda_n(t)^\top}dW^A(t)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Comega_n%28t%29+&quot; alt=&quot;\omega_n(t) &quot; eeimg=&quot;1&quot;&gt; 是一系列权重：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Comega_n%28t%29+%3D+%5Cfrac%7B%5Cvarphi%28L_N%28t%29%29%7D%7B%5Cvarphi%28S%28t%29%29%7D+%5Cfrac%7B%5Cpartial+S%28t%29%7D%7B%5Cpartial%28L_N%28t%29%29+%7D+%5C%5C+%3D+%5Cfrac%7B%5Cvarphi%28L_N%28t%29%29%7D%7B%5Cvarphi%28S%28t%29%29%7D+%5Cfrac%7BS%28t%29%5Ctau%7D%7B1%2B%5Ctau_nL_n%28t%29%7D%5B%5Cfrac%7BP%28t%2CT_%7Bn%2Bk%7D%29%7D%7BP%28t%2CT_k%29-P%28t%2CT_%7Bn%2Bk%7D%29%7D%2B+%5Cfrac%7B%5Csum_%7Bn%3Dk%7D%5E%7Bn%2Bk-1%7D%7B%5Ctau_kP%28t%2CT_%7Bn%2Bk%7D%29%7D%7D%7BA%28t%29%7D%5D&quot; alt=&quot;\omega_n(t) = \frac{\varphi(L_N(t))}{\varphi(S(t))} \frac{\partial S(t)}{\partial(L_N(t)) } \\ = \frac{\varphi(L_N(t))}{\varphi(S(t))} \frac{S(t)\tau}{1+\tau_nL_n(t)}[\frac{P(t,T_{n+k})}{P(t,T_k)-P(t,T_{n+k})}+ \frac{\sum_{n=k}^{n+k-1}{\tau_kP(t,T_{n+k})}}{A(t)}]&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;(可以感受一下Swaption其实是特别奇异的的东西&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;最后，按照惯例，希望这些”被时代淘汰的虚假理论&quot;能帮助一些从业者和学习者。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-04-24-35850285</guid>
<pubDate>Tue, 24 Apr 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Libor Market Model 简介2 ——分离波动率函数和校准（一部分）</title>
<link>https://henix.github.io/feeds/zhihu.posts.yan-guan-lin-20/2018-03-29-34664049.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/34664049&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;前言：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对，这个问题离说完还差很远。建模，校准，产品，风险，这些东西是一套的。当然继续写下去是有契机的。 那天刚刚写完上一篇，本专栏联合编辑之一 &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/06e1c0cadfaab8dae2fca66aaa30d65f&quot; data-hash=&quot;06e1c0cadfaab8dae2fca66aaa30d65f&quot; data-hovercard=&quot;p$b$06e1c0cadfaab8dae2fca66aaa30d65f&quot;&gt;@消毒纸巾&lt;/a&gt; 同学提到了Cap波动率的校准问题。虽然已经被业界大佬精辟地给出了方向，然而这个问题还是要写一些的。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;正文：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;what&amp;why：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在上文构造tenor structure的Libor 率过程的时候我们仅仅给出了Libor过程约化形态的测度变化：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%26dL%28t%2CT%29+%3D+%7E%5Csigma_TdW%5E%7BT%2B%5Ctau%7D_t+%5C%5C%26dW%5ET_t+%3D+%7EdW%5E%7BT%2B%5Ctau%7D_t+-+%5Cfrac%7B%5Ctau%5Csigma_T%7D%7B1%2B%5Ctau+L%28t%2CT%29%7Ddt+%5Cend%7Balign%7D&quot; alt=&quot;\begin{align} &amp;dL(t,T) = ~\sigma_TdW^{T+\tau}_t \\&amp;dW^T_t = ~dW^{T+\tau}_t - \frac{\tau\sigma_T}{1+\tau L(t,T)}dt \end{align}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;问题出在这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csigma_T&quot; alt=&quot;\sigma_T&quot; eeimg=&quot;1&quot;&gt; 是个什么鬼？ 为了回答这个问题，我们需要回到HJM框架下寻找这个（堆）约化参数所对应的结构模型。由此可见HJM框架的重要性，他能保证各类产品之间结构的一致性。（ 题外话，Q系有两大内功：“手术刀”（分解资产），“搭积木”（资产结构）。接下来这套属于“搭积木”的内容）：&lt;/p&gt;&lt;p&gt;还是回到&lt;a href=&quot;https://www.zhihu.com/question/59120463&quot; class=&quot;internal&quot;&gt;HJM 模型框架（又称元模型）和一般的利率过程有什么本质区别？&lt;/a&gt;这个问题下猫那个答案。我们一直了Bond Price在HJM下的dynamic：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=dP%28t%2CT%29%3Dr_tP%28t%2CT%29dt-%5Csigma%5E%2A%28t%2CT%29P%28t%2CT%29dW_t&quot; alt=&quot;dP(t,T)=r_tP(t,T)dt-\sigma^*(t,T)P(t,T)dW_t&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;我们把当初Libor率定义的右半部份定义为“远期债”：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=P%28t%2CT%2CT%2B%5Ctau%29+%3D+P%28t%2CT%2B%5Ctau%29%2FP%28t%2CT%29+&quot; alt=&quot;P(t,T,T+\tau) = P(t,T+\tau)/P(t,T) &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;那么这个远期债的dynamic为（对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=1%2FP%28t%2CT%29&quot; alt=&quot;1/P(t,T)&quot; eeimg=&quot;1&quot;&gt; 使用伊藤定理后用伊藤乘法）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=dP%28t%2CT%2CT%2B%5Ctau%29+%2FP%28t%2CT%2CT%2B%5Ctau%29+%3D+-%5B%5Csigma%5E%2A%28t%2CT%2B%5Ctau%29+-+%5Csigma%5E%2A%28t%2CT%29%5D%5Csigma%5E%2A%28t%2CT%29dt+-+%5B%5Csigma%5E%2A%28t%2CT%2B%5Ctau%29+-+%5Csigma%5E%2A%28t%2CT%29%5DdW_t&quot; alt=&quot;dP(t,T,T+\tau) /P(t,T,T+\tau) = -[\sigma^*(t,T+\tau) - \sigma^*(t,T)]\sigma^*(t,T)dt - [\sigma^*(t,T+\tau) - \sigma^*(t,T)]dW_t&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;熟悉HJM框架的童鞋会看出来这是个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=Q%5ET+&quot; alt=&quot;Q^T &quot; eeimg=&quot;1&quot;&gt; 鞅，于是： &lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=dP%28t%2CT%2CT%2B%5Ctau%29+%2FP%28t%2CT%2CT%2B%5Ctau%29+%3D+-+%5B%5Csigma%5E%2A%28t%2CT%2B%5Ctau%29+-+%5Csigma%5E%2A%28t%2CT%29%5DdW%5E%7BT%7D_t&quot; alt=&quot;dP(t,T,T+\tau) /P(t,T,T+\tau) = - [\sigma^*(t,T+\tau) - \sigma^*(t,T)]dW^{T}_t&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;那么跟Libor定义（其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=L%28t%2CT%29+&quot; alt=&quot;L(t,T) &quot; eeimg=&quot;1&quot;&gt; 沿用上一篇远期单利的定义：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=1%2B%5Ctau+L%28t%2CT%29+%3D%5Cfrac%7BP%28t%2CT%29%7D%7BP%28t%2CT%2B%5Ctau%29%7D&quot; alt=&quot;1+\tau L(t,T) =\frac{P(t,T)}{P(t,T+\tau)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;我们有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=dL%28t%2CT%29%3D+%5Cfrac%7B1%2B%5Ctau+L%28t%2CT%29%7D%7B%5Ctau%7D+%5Csigma%5E%2A%28T%2CT%2B%5Ctau%29dW%5ET&quot; alt=&quot;dL(t,T)= \frac{1+\tau L(t,T)}{\tau} \sigma^*(T,T+\tau)dW^T&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;这个波动率部分就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csigma_T+%2B%5Cfrac%7B%5Ctau%5Csigma_T%7D%7B1%2B%5Ctau+L%28t%2CT%29%7Ddt&quot; alt=&quot;\sigma_T +\frac{\tau\sigma_T}{1+\tau L(t,T)}dt&quot; eeimg=&quot;1&quot;&gt; (想想为什么）&lt;/p&gt;&lt;p&gt;其实邪道第三部的时候问题就很明显了，累计波动率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csigma%5E%2A&quot; alt=&quot;\sigma^*&quot; eeimg=&quot;1&quot;&gt; 是短期率波动率的积分，而短期率的波动率是不可观测到的。这个问题LMM和HJM下都会遇到。因此我们需要一套特殊的参数化方法去“伪造”一个波动率函数。否则根本无法校准（或者只能校准到约化的模型上，不要再问为什么仅仅是约化不行，去读上篇）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;可分离函数：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了技术上校准的方便AP中采用了如下形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csigma_T+%3D%5Clambda%28t%29+%5Cvarphi%28L%28t%2CT%29%29&quot; alt=&quot;\sigma_T =\lambda(t) \varphi(L(t,T))&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;AP中表示，对于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cvarphi&quot; alt=&quot;\varphi&quot; eeimg=&quot;1&quot;&gt; 不要纠结这些技术细节，这些东西就是为了结果校准方便。只需要满足一些非常基本的条件比如李普希兹连续(这不是什么”虚假的假设“，一个利率的波动率要是不李普希兹连续了，那想想都可怕），使用者就可以用自己的经验函数。AP中给出了一组常用经验函数，比如lognormal就用x，CEV用x^p等。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;接下来为了引用方便，猫选会选用AP当中的notation。 我们把第n期远期单利表示为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=L_n%28t%29+%3DL%28t%2CT_n%2CT_n%2B%5Ctau%29&quot; alt=&quot;L_n(t) =L(t,T_n,T_n+\tau)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;那么我们试算一下两个不同期之间远期单利的方差（交互变差）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=d%3CL_k%28t%29%2CL_j%28t%29%3E+%3Dz%28t%29%5Cvarphi%28L_k%28t%29%29%5Cvarphi%28L_j%28t%29%29%5Clambda_k%28t%29%5Clambda_j%28t%29dt&quot; alt=&quot;d&lt;L_k(t),L_j(t)&gt; =z(t)\varphi(L_k(t))\varphi(L_j(t))\lambda_k(t)\lambda_j(t)dt&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=z%28t%29&quot; alt=&quot;z(t)&quot; eeimg=&quot;1&quot;&gt; 可以是任何一种波动率过程，所以上述分离函数可以套进任何随机波动率模型下&lt;/p&gt;&lt;p&gt;那么自然的相关性就有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=corr%28dL_k%28t%29%2CdL_j%28t%29%29+%3D%5Cfrac%7B%3CdL_k%28t%29%2CdL_j%28t%29%3E%7D%7B%5Csqrt%7B%3CdL_k%28t%29%3E%2C%3CdL_j%28t%29%3E%7D%7D&quot; alt=&quot;corr(dL_k(t),dL_j(t)) =\frac{&lt;dL_k(t),dL_j(t)&gt;}{\sqrt{&lt;dL_k(t)&gt;,&lt;dL_j(t)&gt;}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;由于波动率被我们分离掉了，而随机乘数部分不影响相关性，所以我们有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=corr%28dL_k%28t%29%2CdL_j%28t%29%29%3D%5Cfrac%7B%5Clambda_k%28t%29%5Clambda_j%28t%29%7D%7B%7C%7C%5Clambda_k%28t%29%7C%7C%7E%7C%7C+%5Clambda_j%28t%29%7C%7C%7D&quot; alt=&quot;corr(dL_k(t),dL_j(t))=\frac{\lambda_k(t)\lambda_j(t)}{||\lambda_k(t)||~|| \lambda_j(t)||}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;波动率校准问题在这个时候被巧妙转化成了估计不同期限结构下相关性的问题。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;处理相关性：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;一般我们在获得贴现率曲线后（这个所有利率产品的标准校准依据，当然也是最优先的校准目标。我们的LMM需要用到这些先期的校准结果），我们可以根据价格和LIBOR的关系画出远期率曲线（也就是libor curve）。我们需要在这个tenor structure上校准出相关性的参数。&lt;/p&gt;&lt;p&gt;(题外话，关于是先对贴现率曲线插值再转LIBOR曲线，还是先求出LIBOR曲线点再对其插值这个猫并不清楚）&lt;/p&gt;&lt;p&gt;一般处理期限结构的相关性有两种方法：参数和非参&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;参数法：&lt;/p&gt;&lt;p&gt;一些结果如Coffey[2000], Jong[2001] ，Rebonato[2002]给出了一些光滑期限结构估计方法，其中一种是假设了如下函数：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=Corr%28dL_k%28t%29%2C+dL_j%28t%29%29+%3Dq_1%28T_k-t%2C+T_j-t%29&quot; alt=&quot;Corr(dL_k(t), dL_j(t)) =q_1(T_k-t, T_j-t)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中q函数为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+q_2%28x%2Cy%29%26+%3D%5Crho_%5Cinfty%28min%28x%2Cy%29%29+%2B%281-%5Crho_%5Cinfty%28min%28x%2Cy%29%29%29exp%28-a%28min%28x%2Cy%29%29%7Cy-x%7C%29+%5C%5Ca%28z%29%26+%3Da_%5Cinfty+%2B%28a_0+-a_%5Cinfty%29e%5E%7B-kz%7D+%5Cend%7Balign%7D&quot; alt=&quot;\begin{align} q_2(x,y)&amp; =\rho_\infty(min(x,y)) +(1-\rho_\infty(min(x,y)))exp(-a(min(x,y))|y-x|) \\a(z)&amp; =a_\infty +(a_0 -a_\infty)e^{-kz} \end{align}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;我们令\theta为全部参数，那么校准的目标函数为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Ctheta%5E%2A+%3Dargmin_%5Ctheta+%5Cleft%5C%7Btr%5B%28R-R_2%28%5Ctheta%29%29R-R_2%28%5Ctheta%29%29%5ET%5D+%5Cright%5C%7D+&quot; alt=&quot;\theta^* =argmin_\theta \left\{tr[(R-R_2(\theta))R-R_2(\theta))^T] \right\} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中R&lt;i&gt;2为q_&lt;/i&gt;2计算出的模型相关矩阵，R样本相关性矩阵&lt;/p&gt;&lt;p&gt;关于参数法的缺点，就是传统那些过拟合，欠拟合，这里不多表述。（实际上6个参数想过拟合很难，一般会欠拟合。不过考率到LIBOR曲线也不是那么复杂，6个参数拟合的结果不会太坏）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;非参法：&lt;/p&gt;&lt;p&gt;对高度相关的期限结构相估计的一个传统方法是使用PCA（主成分分析）对期限结构进行聚类，在Hull里利率一章提到过，在这里因为tenor structure也是一种期限结构，所以可以采用相同的方法。&lt;/p&gt;&lt;p&gt;对于一条足够光滑的远期曲线，已经可以使用PCA了，步骤就是标准那套：&lt;/p&gt;&lt;p&gt;1.中心化&lt;/p&gt;&lt;p&gt;2.svd&lt;/p&gt;&lt;p&gt;3.取前几个成分（正交的线性组合）&lt;/p&gt;&lt;p&gt;完成之后，取前m个主成分来解释大部分方差。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;PCA在此处的两种使用方法：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在这之后第一种利用上面结果处理相关性的方法就是：不处理。 因为主成分之间互相正交，所以但我们去LIBOR的线性组合主成分进行估计是，可以不用处理相关性。&lt;/p&gt;&lt;p&gt;&lt;b&gt;是的，主成分分析法的一个最大优点就是巧妙的避免了处理相关性的参数。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;此外，其金融上也有明显意义，因为一般对期限结构的前三个主成分都代表了明确的利率曲线变化方式，如“平动”（shifting），“撬动”（twisting），“弯曲”（bowing）。因此该方法被大量应用在期限结构的降维和解释上。&lt;/p&gt;&lt;p&gt;但其缺点有，1.我们只是采用了几个成分，他们并不能完全代表所有tenor structure； 2.LIBOR的线性组合不一定适用于上文的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cvarphi+&quot; alt=&quot;\varphi &quot; eeimg=&quot;1&quot;&gt; ,除非在一些简单的假设下比如lognormal。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;第二种利用方法称为correlation PCA，我们先对相关性矩阵R做如下分解：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R%3DE%28YY%5ET%29+&quot; alt=&quot;R=E(YY^T) &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中Y服从标准正态分布的变量（注意并没有以要求一定是chol分解）&lt;/p&gt;&lt;p&gt;然后我们做如下近似分解：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=Y+%5Capprox+DX&quot; alt=&quot;Y \approx DX&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中D是p×m(p为变量数，m&lt;p）矩阵，X为m×1，元素服从标准正态的向量。 这一步相当于对相关性矩阵做了一个降维。 AP里给出了如下优化技术结果，令：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=h%28D%3BR%29+%3Dtr%5Cleft%5C%7B+%28R-DD%5ET%29%28R-DD%5ET%29%5ET+%5Cright%5C%7D&quot; alt=&quot;h(D;R) =tr\left\{ (R-DD^T)(R-DD^T)^T \right\}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;为优化目标函数，则最优D矩阵为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=D%5E%2A+%3Dargmin_D+h%28D%EF%BC%9BR%29+%2C%7E%7Esubject%7Eto+%7Ediag%28DD%5ET%29%3D1+&quot; alt=&quot;D^* =argmin_D h(D；R) ,~~subject~to ~diag(DD^T)=1 &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;由于X和Y都是标准正态分布矩阵，这里的DD^T达到了一种对R很好的近似，并且降低了相关性矩阵的维度。&lt;/p&gt;&lt;p&gt;AP中还给出，如果给出方程： &lt;img src=&quot;https://www.zhihu.com/equation?tex=diag%28D_%5Cmu+D_%5Cmu%5ET%29+-1+%3D0&quot; alt=&quot;diag(D_\mu D_\mu^T) -1 =0&quot; eeimg=&quot;1&quot;&gt; 的向量解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmu%5E%2A&quot; alt=&quot;\mu^*&quot; eeimg=&quot;1&quot;&gt; 。 则满足该解的的最优 &lt;img src=&quot;https://www.zhihu.com/equation?tex=D_%7B%5Cmu%5E%2A%7D+&quot; alt=&quot;D_{\mu^*} &quot; eeimg=&quot;1&quot;&gt; 可通过优化：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=D_%5Cmu+%3Dargmin_D+h%28D%3B+R%2Bdiag%28%5Cmu%29%29&quot; alt=&quot;D_\mu =argmin_D h(D; R+diag(\mu))&quot; eeimg=&quot;1&quot;&gt; 给出。&lt;/p&gt;&lt;p&gt;由于猫优化不懂，不会，没学过，所以这里有望高人指点。&lt;/p&gt;&lt;p&gt;如果有一个或多个续集，将继续介绍具体在产品在LMM下的建模和更加多的校准细节&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;正文结束&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;吐槽和骂人：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;文中反复提及的书AP名叫《Interest Rate Modeling》，AP是作者的缩写。文中所有内容都是第二册第十四章LMM部分的。这（三）本书被视为利率建模的百科全书，可入门，可进阶，可深入，可前沿。什么前沿？没错，因为利率方面建模其实已经非常完善了，近几年真的没有出现什么特别新的成果了。更多的是些choice of collateral这类特定业务相关的东西。也而这本书内容很全面，所以可以认为是前沿了。&lt;/p&gt;&lt;p&gt;所以对于这部分内容黑猫不想骂什么，校准本身就是一个模型得以应用的最重要的一部分，如果这都有人叫”理论“，那基本跟猫一样，甚至比猫还小学生了。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;最后，按照惯例，希望这些”被时代淘汰的虚假理论&quot;能帮助一些从业者和学习者。&lt;/p&gt;</description>
<author>黑猫Q形态</author>
<guid isPermaLink="false">2018-03-29-34664049</guid>
<pubDate>Thu, 29 Mar 2018 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
