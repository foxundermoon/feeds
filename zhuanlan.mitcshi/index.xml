<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>川流不息</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/</link>
<description>北京量信投资管理有限公司是一家在中国基金业协会备案登记的专业私募基金管理人。本专栏作者石川是量信投资的联合创始人。希望通过这个平台和各位小伙伴分享我们在量化投资领域的知识和心得。原创不易，请保护版权，请在获得授权后转载。已委托“维权骑士”(http://rightknights.com) 为进行维权行动。</description>
<language>zh-cn</language>
<lastBuildDate>Thu, 13 Sep 2018 05:45:59 +0800</lastBuildDate>
<item>
<title>从 CTA 趋势策略的表现看量化投资面临的挑战</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-09-11-44277671.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/44277671&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b98191a9a3d52043d231e018ccdfaac7_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文分析了 CTA 策略近年来的表现，并由此指出量化投资中面临的挑战。在经济存在下行风险的环境下，CTA 策略在未来或大有可为。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2018 年全球经济形势动荡、新兴市场尤甚，中国股市持续下跌探底。在这种背景下，CTA （管理期货）策略的配置价值凸显。在 CTA 策略中，绝大多数都是趋势追踪策略。在下文谈到 CTA 时特指趋势类策略。&lt;/p&gt;&lt;p&gt;其实在今年上半年，CTA 的表现也仅是中规中矩。但是进入 2018 Q3 以来，随着以 PTA 和黑色系为代表的商品期货走出了一波较为流畅的持续上涨行情，加之股市的进一步下跌，此消彼长，使得 CTA 策略脱颖而出。&lt;/p&gt;&lt;p&gt;虽然就 2018 年的前八个月来看，CTA 策略的表现可圈可点（特别是实现了对股票策略的完胜）；但是我们也看到，&lt;b&gt;和几年前（2014 到 2016）CTA 的风光无限相比，其今年的表现其实逊色许多&lt;/b&gt;。此外，持续关注 CTA 策略的小伙伴一定知道，2017 年可谓是 CTA 策略的 nightmare。大部分商品在 2017 年宽幅震荡，但是 CTA 策略却没有什么作为。如此的表现也让人们对“趋势策略是做多波动率”这句话有了新的认识（这句话并不严谨）。&lt;/p&gt;&lt;p&gt;下图是智道管理期货指数（追踪国内 CTA 类私募的整体表现）自 2015 年 以来的表现。不难看出，CTA 策略在 2015 和 2016 年的表现非常优秀，但是到了 2017 年仅仅是在暑期行情中上涨了一波，其他时间都在持续阴跌；而从行业平均而言，CTA 在 2018 年获得的绝对收益也不算高（下图尚未包含今年 7 月中旬开启的一波上涨行情对 CTA 的贡献；在今年前半年，CTA 的表现是非常一般的）。&lt;b&gt;和几年前的大红大紫相比，CTA 在最近两年的表现只能算是差强人意。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c0e3746ca6447392b834ecd191bbeee1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;700&quot; data-rawheight=&quot;303&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c0e3746ca6447392b834ecd191bbeee1&quot; data-watermark-src=&quot;v2-0790794bd91486f8470f5eef4e785e81&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;类似的现象也出现在海外 CTA 市场。下图展示了 Barclay CTA index 和标普 500 指数自 1980 年以来的走势。Barclay CTA index 是行业中较为认可的 CTA 表现指标，自 2010 年之后，海外的 CTA 平均表现也出现了震荡下行的格局，不如其在 2010 年之前的表现。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8a0ee90703be30442843add97d9eefa4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;974&quot; data-rawheight=&quot;388&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8a0ee90703be30442843add97d9eefa4&quot; data-watermark-src=&quot;v2-8010c461308ecd1b6aaca8b850efcedd&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这样的现象促使我们思考：&lt;b&gt;CTA（趋势）策略在这两年怎么了？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文以一个简单的双均线趋势追踪策略为例，简要分析 CTA 趋势追踪策略最近几年在我国商品期货市场上的表现，并&lt;b&gt;探讨市场的变化对量化投资带来的一些挑战。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 双均线趋势追踪策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;双均线是利用两个不同周期均线的关系确定开平仓信号、进行交易的策略。双均线系统由一个短周期趋势和一个长周期趋势构成。投资品的大趋势依然由长周期均线捕捉，而短周期均线起到的是择时的作用。计算长、短周期的时间窗口就是双均线策略的参数。&lt;/p&gt;&lt;p&gt;具体的双均线策略如下：&lt;/p&gt;&lt;p&gt;长、短均线的时间窗口分别为 L 和 S 个交易日。在没有头寸时，如果短均线在自下而上穿越长均线则做多；如果短均线自上而下穿越长均线则做空。当持有多头头寸时，如果短均线自上而下穿越长均线则平仓；当持有空头头寸时，如果短均线自下而上穿越长均线则平仓。为了简化讨论，不考虑止损线。&lt;/p&gt;&lt;p&gt;&lt;b&gt;本文实证的目标是在合理的范围内遍历 S 和 L 的取值，并观察以此构建的双均线趋势策略最近几年在我国商品期货市场的表现。&lt;/b&gt;在实证中，S 的取值范围是 1 到 40，搜索步长为 1；L 的取值范围是 S + 1 到 100，搜索步长为 1。实证中使用以下来自国内三大商品交易所的 15 种商品作为投资标的，它们涵盖了有色、化工、农产品以及黑色系四大类别。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1b8eacd1dcc56e0df2fc9dfa8f1661ff_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;430&quot; data-rawheight=&quot;200&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1b8eacd1dcc56e0df2fc9dfa8f1661ff&quot; data-watermark-src=&quot;v2-db90e774a787de468a7534165959db14&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;为了简化分析，在计算均线以及具体交易时，采用的都是上述商品的合成指数的收盘价。&lt;b&gt;如需实现更精细的实证，在回测交易时应该采用商品的主连数据而非合成指数，但是本文的简化并不定性改变趋势策略的表现。&lt;/b&gt;为了惩罚高换手率策略（S 和 L 的取值比较小、或接近时），假设每次交易的成本是万分之五。最后，回测期为 2010 年 1 月 1 日到 2018 年 9 月 4 日。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 实证分析&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于每组给定的 S 和 L，依照上一节的说明构建双均线策略，就可以得到该策略在回测期内的表现，从而计算策略在每一年的收益率。由于我们想观察趋势策略每年的表现变化，因此对于每一个自然年，将不同 S 和 L 取值的策略收益率按照大小绘制成 heatmap 便可一目了然。&lt;/p&gt;&lt;p&gt;下面将逐年展示不同 S 和 L 取值下双均线策略收益率的 heatmap。考虑到我国商品期货市场早期可交易品种较少、且为了关注近几年的变化，下面的 heatmaps 从 2014 年开始。&lt;/p&gt;&lt;p&gt;下图是 2014 年不同参数 S 和 L 组合下双均线收益率的大小。图中纵坐标为 S 的取值、横坐标为 L 的取值，S 和 L 对应的小方块的热图颜色代表了收益率的大小 —— 深红代表高（正）收益、深蓝代表低（负）收益。&lt;b&gt;2014 可谓 CTA 趋势策略的大年&lt;/b&gt;，图中除了一小部分参数组合外（当 S 和 L 都小于 10 时，很少有人会选择这样的参数构建双均线系统），绝大多数 S 和 L 组合构成的双均线策略都能获得非常可观的收益。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9ff4902a092e9e5ea476743d3593504b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1212&quot; data-rawheight=&quot;665&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9ff4902a092e9e5ea476743d3593504b&quot; data-watermark-src=&quot;v2-58e7da7ad3adca49122ba365d5ebce68&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;进入 2015 年，CTA 趋势策略风光不减。虽然收益率较 2014 有所下降，但绝大多数常见的 S 和 L 组合都可以获得正收益。蓝色部分集中在 S = L 的对角线附近 —— 即长均线周期 L 和短均线周期 S 取值接近 —— 从双均线策略的构建思路出发，很少有人会这么选。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a3bd0a0a6bcb1d0559632bb5e04a8608_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1203&quot; data-rawheight=&quot;665&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a3bd0a0a6bcb1d0559632bb5e04a8608&quot; data-watermark-src=&quot;v2-4e0b2fbda3f6ad3a8d59b9dacb909f3f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;再来看看 2016 年 —— 商品期货扬眉吐气的一年，以黑色系商品为代表，多数商品都迎来了大涨，这也孕育了一大波趋势行情。下图是不同 S 和 L 配对下，双均线策略在 2016 年的收益情况。很明显，蓝色的局部较前两年增多，&lt;b&gt;似乎在传递着某种隐忧 —— 是否趋势策略过热了？&lt;/b&gt;比较 2014 与 2016 的热图，那些 2014 年获得最高收益的参数似乎在 2016 年不够理想。不过好的一方面是，获得正收益的策略的收益很高，相当一部分 S 和 L 组合的策略收益高达 40% 甚至是 60% 以上。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e4018d453612e5c1b5347e7fcd00154b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1206&quot; data-rawheight=&quot;667&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e4018d453612e5c1b5347e7fcd00154b&quot; data-watermark-src=&quot;v2-b21f9ec4e0f70dd308c6a0c50f3d9fe9&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;So far so good?&lt;/p&gt;&lt;p&gt;马上进入让 CTA 策略怀疑人生的 2017 年（下图）。趋势仿佛一下子消失了（至少在我们这个简单实证中）。这个大面积蓝色的热图似乎在诉说想要在 2017 年赚钱就应该和趋势对着干。抛开图中靠近 S = L 附近的那一小片红色区域对应的参数，&lt;b&gt;其他能在 2017 年勉强赚钱的参数中 S 的取值都非常小（≤ 10）。这意味着在 2017 年想要依靠趋势赚钱则需要更短的趋势。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d0f2408f6a22f6cf738bb01830db6326_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1207&quot; data-rawheight=&quot;667&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d0f2408f6a22f6cf738bb01830db6326&quot; data-watermark-src=&quot;v2-1bba9a585a744f87752662bde839d40c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;最后是 2018 年（截至 9 月 4 日）。2018 较 2017 年情况好转，热图中红蓝比例比较正常。但是&lt;b&gt;绝对收益并不高&lt;/b&gt;，大部分 S 和 L 的组合虽然没有亏欠，但也没挣到什么钱。&lt;b&gt;这是否意味着越来越多的策略和资金以趋势追踪的形式涌入商品期货市场，导致市场在趋势方面的非有效性下降了呢？&lt;/b&gt;值得持续关注。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f796349129e61dc01997f3b0ffb1f9e6_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1194&quot; data-rawheight=&quot;668&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f796349129e61dc01997f3b0ffb1f9e6&quot; data-watermark-src=&quot;v2-26e164de702ea3adf9e716c522ce42df&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;4 带给量化投资的挑战&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节上回顾了双均线 CTA 趋势策略在过去五年的表现，下面探讨其表现的变化带给量化投资哪些挑战。&lt;/p&gt;&lt;p&gt;回首过去 5 年，双均线策略在 2017 年的表现对量化策略的构建提出了两个挑战：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;如果策略是在 2017 年之前构建的并已经投放到实盘一段时间、且取得了不错的效果，那么这组参数在 2017 年大概率是要亏损的（个别组参数亏损的恐怕还不低），面对这样的表现，我们会问：&lt;b&gt;策略失效了吗？&lt;/b&gt;&lt;/li&gt;&lt;li&gt;站在 2017 年年末这个时点构建双均线趋势策略并用历史数据回测，如果使用 2017 年作为测试集，而使用更早的数据作为训练集，那么大概率会遇到在训练集中有效的参数在样本外完全失效。这就会落入我在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38256574&quot;&gt;《科学回测中的大学问》&lt;/a&gt;一文中提出的&lt;b&gt;训练集和测试集之纠结。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;对中低频趋势类 CTA 策略而言，一年的亏损表现是非常正常的，我们应尽量客观的看待它。第一个挑战可以从以下几个方面鉴别亏损是源自策略失效还仅仅是暂时不佳表现：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;市场的行为是否发生了变化导致策略失效？&lt;/b&gt;一个资产产生趋势的原因是投资者的 herding 行为，因此它是跨市场的行为。市场可以暂时没有趋势或宽幅震荡，这些会造成 CTA 策略的亏损，但是趋势在今后一定会再次出现的。因此，不太可能是因为市场行为的变化导致策略失效。&lt;/li&gt;&lt;li&gt;&lt;b&gt;策略的（亏损）表现是否在预期之内？&lt;/b&gt;盈亏同源，任何一个策略都不是印钞机。通过历史回测对策略的表现分布有一个合理预期，以此判断策略最新的表现是否在预期之内。&lt;/li&gt;&lt;li&gt;&lt;b&gt;策略构建时是否存在不科学之处？&lt;/b&gt;所有策略都或多或少存在过拟合。过拟合意味着错把历史数据中的噪声当作因果关系来建模，因此回测的表现往往是实盘表现的上限，这意味着实盘外的收益较回测会更低、最大回撤较回测会更大。如果某一年的表现完全不符合预期（且排除了市场问题），那么就要检查构建策略时是否有不科学之处 —— 比如是否单一品种或者单一行业的仓位过重？或者没有充分考虑不同品种之间的相关性，导致相关性过高？（&lt;b&gt;时序动量策略喜欢相关性低的投资品&lt;/b&gt;。）&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;第二个挑战是训练集和测试集的问题。一个经科学回测过的策略应该能够捕捉训练集和测试集数据表现出来的某种市场共性。然而，&lt;b&gt;独立交易数据的匮乏&lt;/b&gt;为实现这个诉求造成了不小困难。交易数据匮乏是针对数据的可交易特征而言。历史数据虽然很长，但满足一个策略假设的样本却十分有限。&lt;/p&gt;&lt;p&gt;本文中双均线策略的结果表明，2017 年的市场中没有出现绝大多数 S 和 L 组合希望的交易特征，造成了它们的亏损。在这种情况下，如果在构建策略时硬把 2017 年当作测试集，一定会不自觉的把策略在测试集中的体现出来的新市场环境反馈到训练过程中，这等价于在整个历史数据中对策略的参数调优了。只要策略交易的市场特征有明确的业务支持而非数据挖掘的产物，那么针对它构建及优化策略参数时，是分别使用训练、测试集，还是使用所有数据来整体优化，并不重要。&lt;/p&gt;&lt;p&gt;再来看看最后一个挑战。下表展示了回测期内净值最高的五组 (S, L) 参数。顺便一提，第二组和第五组的参数很接近，S 和 L 的取值分别是 10 和 20 左右，我猜想市场上有激进的双均线交易者会采取这类的参数，不过这不是本文关注的重点。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e388798bcf364ff123aec1b5f0b0ac7c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;959&quot; data-rawheight=&quot;380&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e388798bcf364ff123aec1b5f0b0ac7c&quot; data-watermark-src=&quot;v2-696f4c144ade3ac03f04b9c791d925b0&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我们关注的重点是，在这些回测期内净值最高的参数中，2016 年的收益率都非常高。换句话说，&lt;b&gt;一波大行情能够对回测带来很大的不平衡因素，如果以净值作为构建策略时评价参数的标准，则会错误放大这种影响。&lt;/b&gt;因此在参数调优时，不应过度考虑策略的收益率大小，还应考察波动率、最大回撤、最长回撤时间、以及夏普率这些考虑了风险的指标。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;有挑战就有机遇。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文虽然客观的指出了趋势 CTA 策略的表现有所下滑，但是我们对它的未来绝不悲观。我只是想强调，市场在变化，策略的表现也有大小年之分。为此，一个科学的量化体系应该做到定期的检查策略，做到未雨绸缪、防患于未然。最理想的情况是策略不管在什么样的市场行情中都能够取得比较稳定的收益。这绝不容易，这需要我们不断学习、思考，调整策略以顺应市场的变化。&lt;/p&gt;&lt;p&gt;从目前的情况来看，在找到新的增长点之前，中国经济难有大的起色，根据货币宽松程度和财政实施力度，未来存在通胀和通缩两大潜在的经济风险，这对股权市场并非好的增长环境。但对于商品期货而言，因为可以同时做多和做空，不论是通胀压力还是通缩环境，CTA 策略都可以通过捕捉商品价格的趋势赚取收益，成为资本市场上博取风险收益的良好投资品种。在经济存在下行风险的环境下，CTA 策略大有可为。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-09-11-44277671</guid>
<pubDate>Tue, 11 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>用 K-means 聚类做市场状态分析：大阳线之后更危险？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-09-07-43872533.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/43872533&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-98c911a4ee0ae36e6b6712e29a506bec_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;1 无监督聚类&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;无监督学习（unsupervised learning）是机器学习中的三大类问题之一，另外两类分别为有监督学习（supervised learning）和强化学习（reinforcement learning）。&lt;/b&gt;在无监督学习问题中，对于给定的观测数据无需（也没有）已知的响应（response），而是希望分析出观测数据本身的结构。&lt;b&gt;在无监督学习中，聚类（clustering）和降维（dimension reduction）是主要的两大应用场景。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;无监督聚类的目的是将观测点按照它们的特征分成若干个子集——这些子集又称为簇（cluster）——以使得每一簇内的观测点有相似的特性，而不同簇之间的观测点有不同的特性。&lt;/b&gt;聚类分析的算法有很多；其中一个常见且有效的算法是 &lt;b&gt;K-means 聚类&lt;/b&gt;（译作 &lt;b&gt;K-均值聚类&lt;/b&gt;），其中 K 代表簇的个数。&lt;/p&gt;&lt;p&gt;今天我们就来说说 K-means 聚类，它在量化投资领域有很多应用。为了说明这一点，本文除了介绍该算法外，还会以上证指数的价格数据为例说明如何利用该算法进行市场状态监测（regime detection）。&lt;/p&gt;&lt;p&gt;本文的写作参考了 &lt;a href=&quot;http://quantstart.com&quot;&gt;quantstart.com&lt;/a&gt; 上的相关文章，特此声明并致谢（&lt;a href=&quot;https://www.quantstart.com/articles/k-means-clustering-of-daily-ohlc-bar-data&quot;&gt;K-Means Clustering of Daily OHLC Bar Data&lt;/a&gt;）。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 K-means 聚类&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;K-means 聚类是一种硬聚类（hard clustering）算法。&lt;/b&gt;所谓硬聚类就是说每一个样本点都必须“非此即彼”的被分到某一个簇中。与硬聚类对应的是&lt;b&gt;软聚类（soft clustering）&lt;/b&gt;。针对每一个样本点，软聚类算法计算该点属于不同簇的概率，这是一种模糊（fuzzy）的概念，它不要求样本点和簇之间“非此即彼”的映射，而是允许样本点以不同的概率所属于不同的簇。&lt;/p&gt;&lt;p&gt;假设 n 维空间中共有 N 个观测数据。在数学上，硬聚类意味着 K 个簇将该 n 维度空间划分为 K 个互斥的区域，每个观测点属于且仅属于这 K 个簇中的某一个。令  代表簇 k，k 属于  ，不同的簇  之间满足如下关系：&lt;/p&gt;&lt;p&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这两个式子说明硬聚类对空间的划分满足 MECE 原则，即 Mutually Exclusive（上面第一个式子）, Collectively Exhaustive（上面第二个式子）。&lt;/b&gt;下图是一个 K-means 聚类的示意图。图中不同的颜色代表着 10 个簇；每一个黑点代表一个观测点。每个簇内的白色叉子代表该簇的质心。这个图的意思是，如果我们有下图中的那些观测点，想采用 K-means 聚类将它们分为 10 个子集，那么就会得到如下的结果。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4d91735c031e320c0cef03778f385e33_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;632&quot; data-rawheight=&quot;491&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4d91735c031e320c0cef03778f385e33&quot; data-watermark-src=&quot;v2-cda035ad30ab005a36114aa5dcc1ee2e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;下面来具体说说 K-means 算法。&lt;b&gt;该算法的目标是，对于给定的簇个数 K，找到关于样本空间的最优化分 &lt;/b&gt; &lt;b&gt;，使得簇内差异（within-cluster variation）最小。簇内差异被定义为簇内的每一个点到该簇质心的距离的平方和，因此簇内差异又称为簇内平方和（within-cluster sum of squares）。由于质心代表着均值，这也是 K-means 聚类名字中 mean 一词的含义。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在数学上，该优化问题可以表示为：&lt;/p&gt;&lt;p&gt; &lt;/p&gt;&lt;p&gt;其中，   代表簇 k 的质心向量，它和观测点一样是 n 维向量。表达式  代表簇 k 内的第 i 个点到质心  的欧氏距离。&lt;/p&gt;&lt;p&gt;在欧几里得空间中，两个 n 维向量    和  的欧氏距离（Euclidean distance）定义如下：&lt;/p&gt;&lt;p&gt; &lt;/p&gt;&lt;p&gt;对该优化问题求解，就可以得到最优的划分  。&lt;b&gt;不幸的是，寻找该问题的全局解（global optimum）是 NP-hard（简单的理解就是复杂度太高，让计算机硬来也算不出来）。&lt;/b&gt;所幸的是，可以使用启发式算法找到局部解（local optimum）。该启发式算法分为两部，思路如下。&lt;/p&gt;&lt;p&gt;&lt;b&gt;第一步：随机的将每个观测点划分到一个簇 &lt;/b&gt;k&lt;b&gt;；&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;第二步：重复本步骤中的过程，直到聚类结果收敛：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;  1. 根据当前的聚类结果，计算每个簇的质心 &lt;/b&gt;  &lt;/p&gt;&lt;p&gt;&lt;b&gt;  2. 根据最新的质心，计算每个观测点到这些质心的欧氏距离，将该点重新划分到距离它最近的质心所处的簇内。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;值得一提的是，局部解十分依赖于求解过程的初始值。&lt;/b&gt;且由于不知道全局解是什么，我们没法证明局部解就是最优的。为了尽可能降低这个问题的影响，可以多次使用该启发式算法找到不同的局部解，然后从它们中间找到最小的，作为最终的解。&lt;/p&gt;&lt;p&gt;在 python 的 sklearn 包里，有实现 K-means 算法的类 sklearn.cluster.KMeans。它的输入参数中，有一个 n_init（默认值为 10），它就决定了求解局部解的次数。该算法会在求出的所有局部解中找到最优的，作为最终的解。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 K-means 聚类算法的不足&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在将 K-means 聚类应用于量化投资之前，有必要知道它的不足。具体来说，特别是针对金融数据，它有以下四点不足之处：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;金融数据信噪比太低，这意味着价格序列中有很多噪声。由于 K-means 是硬聚类，因此每个观测点都被迫分到一个簇中，因此噪声对聚类结果的影响不可忽视。&lt;/li&gt;&lt;li&gt;金融数据中存在异常值（比如黑天鹅事件造成的大跌，或者因为乌龙指造成的价格大幅震荡）。K-means 会把它们当作普通样本处理。因此这些异常值会对聚类结果产生影响。&lt;/li&gt;&lt;li&gt;K-means 对训练集的数据比较敏感。举例来说，如果将历史数据分为两份，分别进行聚类。假如我们知道这两份数据中的观测点 A 和 B 在业务上是相似的。但是，在对这两份数据分别进行聚类分析时，A 和 B 可能会被分配到特性完全不同的两簇中。这说明分类的波动会比较大，即该算法对样本数据敏感。当样本点不足的时候，这个问题尤其严重。&lt;/li&gt;&lt;li&gt;K-means 对 K 的取值（即簇的个数）非常敏感。如果 K 的取值不当，便很难从聚类的结果中得到有益的推断。下一小结的例子就说明这一点。&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;4 K 的取值至关重要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;聚类分析是为了挖掘观测数据自身的结构。&lt;b&gt;如果我们在事前从业务的角度对数据的结构有一个认知、并以此来选取簇的个数，那么聚类分析的结果将会更有意义。反之，如果我们对待分析的数据一无所知，盲目的选择K的取值，那么得到的很可能是无意义的分析结果。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面通过一个例子说明正确选取 K 值的重要性。&lt;/p&gt;&lt;p&gt;假设我们有&lt;b&gt; 3 个二元正态分布&lt;/b&gt;，它们的均值向量、协方差矩阵分别如下所示：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-08f9e5870e18189eeac44c8cff472579_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;512&quot; data-rawheight=&quot;256&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-08f9e5870e18189eeac44c8cff472579&quot; data-watermark-src=&quot;v2-1019e9b1982fa932e17ba87932310170&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;使用这 3 个二元正态分布在二维空间内各随机生成 100 个观测点（即一共有 300 个点），然后使用 K-means 聚类对他们进行划分。由于在这个例子中，我们知道这些点来自 3 个不同的二元正态分布，因此簇数 K 的正确取值应该为 3。为了比较，我们同时考虑 K = 4 的情况。下图展示了 K = 3 和 K = 4 时的 K-means 聚类结果。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-21fb2155bac7c57fe27d4208fe681c97_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;558&quot; data-rawheight=&quot;856&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-21fb2155bac7c57fe27d4208fe681c97&quot; data-watermark-src=&quot;v2-5fb19942d7a05cbe24eb50d4564cdab4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;当 K = 3 时，这 300 个观测点被分为了 3 簇。它们的质心基本位于 (2, 6)、(8, 7) 以及 (6, 12) 这三个点附近——即这三个二元正态分布的均值点。由于 K = 3 和这些点的内在结构吻合（因为在这个例子中我们知道这些点是来自这 3 个不同的二元正态分布！），所以聚类挖掘出了有效的信息。&lt;/p&gt;&lt;p&gt;当 K = 4 时，这 300 个观测点被分为了 4 簇。比较两个聚类结果可知，来自于均值向量 (2, 6)、协方差矩阵 (2.5, 0; 0, 3.5) 这个二元正态分布的样本点被进一步细分为两个不同的簇（这是因为 K = 4，因此算法必须把所有点分为 4 簇！）。基于这样的结果，我们会认为这两簇是不同的。但是在这里例子中，它们事实上来自同一个分布。&lt;/p&gt;&lt;p&gt;这个例子说明，&lt;b&gt;当 K 的取值不当时，我们有可能从聚类的结果中得出错误的推断。因此，在使用 K-means 聚类之前，如能对待分析的数据有一定的了解，并能从业务的角度判断出合适的簇数 K，将大大提高聚类分析结果的可靠性。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 用 K-means 聚类进行市场状态监测&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节使用一个简单的例子将 K-means 聚类应用于量化投资领域。我们使用上证指数日线的开盘、最高、最低、收盘价（即 OHLC 数据）来描述市场所处的（未知）状态，通过聚类将不同的交易日划分到不同的市场状态中，并在聚类的结果上进行进一步的推断。交易日的时间跨度为过去 5 年（本文写作于 2017 年 7 月，因此实证结果仅到写作之前）。&lt;/p&gt;&lt;p&gt;在这样的设定下，每一个交易日的 OHLC 数据就是一个观测点。&lt;b&gt;为了不同的交易日的价格数据有可比性，有必要进行标准化处理。&lt;/b&gt;为此，使用每日的开盘价对其他三个价格进行标准化，得到 H/O，L/O，C/O，即最高价和开盘价之比、最低价和开盘价之比、以及收盘价和开盘价之比。标准化后，每一个观测点实际上是一个三维向量。&lt;/p&gt;&lt;p&gt;接下来就是确定簇数 K 的取值。在本例中，每一簇便代表了市场的一种状态。从这个角度出发，我们假设 K 的取值为 4 —— 即市场存在 4 种状态。&lt;/p&gt;&lt;p&gt;这里取 4 并没有什么特别的含义，作为读者的你也尽可以发挥想象来解读这个取值。从聚类的结果来看，由于我们是用的是标准化后的 OHLC 数据，这 4 类市场状态对应的基本上是大阳线、大阴线、小阳线和小阴线。&lt;/p&gt;&lt;p&gt;由于观测点都是三维的，因此可以方便的在三维空间画出聚类的结果。以不同颜色表示不同的簇，这 4 簇的聚类结果如下图所示。大部分观测点都围绕在 (1.0, 1.0, 1.0) 附近，它们构成了两簇 —— 小阳线和小阴线；少量的观测点在远离 (1.0, 1.0, 1.0) 的位置，构成另外两簇 —— 大阳线和大阴线。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fa62349d025610cc5447c5f4a4731321_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;982&quot; data-rawheight=&quot;730&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fa62349d025610cc5447c5f4a4731321&quot; data-watermark-src=&quot;v2-931c1e1d1164085712d901d3ded2afe2&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;如果我们按照簇把每个交易日的 K 线画出来，则可以更清晰的看出簇与簇之间交易日 K 的差异（下图）。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5a35f5c8f587c9652d5537fd90607162_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1206&quot; data-rawheight=&quot;540&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5a35f5c8f587c9652d5537fd90607162&quot; data-watermark-src=&quot;v2-31799ba1b1866344537dd3253e70b076&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;从这个图中可以看出：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;第一簇中的 K 线大部分都是&lt;b&gt;短的绿色线&lt;/b&gt;，说明这一簇中以&lt;b&gt;小阴线&lt;/b&gt;为主；&lt;/li&gt;&lt;li&gt;第二簇中的 K 线大部分都是&lt;b&gt;长的红色线&lt;/b&gt;，说明这一簇中以&lt;b&gt;大阳线&lt;/b&gt;为主；&lt;/li&gt;&lt;li&gt;第三簇中的 K 线大部分都是&lt;b&gt;长的绿色线&lt;/b&gt;，说明这一簇中以&lt;b&gt;大阴线&lt;/b&gt;为主；&lt;/li&gt;&lt;li&gt;第四簇中的 K 线大部分都是&lt;b&gt;短的红色线&lt;/b&gt;，说明这一簇中以&lt;b&gt;小阳线&lt;/b&gt;为主。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;不过这个结果也清晰的说明，我们的样本是严重的不均衡的，第四簇小阳线内的观测点远超其他三簇。样本严重不均衡对所有的机器学习算法都是一个挑战。&lt;/b&gt;我们会在下面再谈到这个问题。&lt;/p&gt;&lt;p&gt;如果按照时间顺序把每个交易日的市场状态画出来，则得到下图。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-78aa6b5190fc4e5eb54010fef8d71c1b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1075&quot; data-rawheight=&quot;491&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-78aa6b5190fc4e5eb54010fef8d71c1b&quot; data-watermark-src=&quot;v2-5315799e8a1db85521f6f7b3ba2f01a6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我们分几个不同的时期来仔细看看。&lt;/p&gt;&lt;p&gt;在 2014 年底牛市启动之前，市场的状态受第一簇（小阴线）主宰，表现出来一个慢慢阴跌的态势。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a2a7a4def3c779b3d1c9b7e528229431_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1207&quot; data-rawheight=&quot;544&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a2a7a4def3c779b3d1c9b7e528229431&quot; data-watermark-src=&quot;v2-ccefc14de64937854709b5fdc3aa1846&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在 2014 年底到 2015 年底这个牛熊周期中，在牛市中市场状态由第二簇（大阳线）主宰，而在熊市中市场状态由第三簇（大阴线）主宰。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-74cd0378b49832b65782aa3c80edfd95_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1207&quot; data-rawheight=&quot;546&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-74cd0378b49832b65782aa3c80edfd95&quot; data-watermark-src=&quot;v2-61767d920f97a43a08812d948d992f73&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;最后，从 2016 年二季度开始，市场状态由第四簇（小阳线）主宰，呈现出慢牛的走势。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ec07847f0ffeec5fc2cb45940d6e8ee0_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1205&quot; data-rawheight=&quot;550&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ec07847f0ffeec5fc2cb45940d6e8ee0&quot; data-watermark-src=&quot;v2-a3b1ab16a66b03762a6ff2b770e98d48&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在我们有了每个交易日的状态之后，便可以进行一系列的数据分析，得到进一步的推论。&lt;b&gt;这其中最有效的应该是求出市场状态的转移矩阵，它告诉我们在当前的状态 &lt;/b&gt;&lt;b&gt; 下，下一个交易日市场将处于状态 &lt;/b&gt;  &lt;b&gt; 的条件概率。&lt;/b&gt;这对策略择时和风控会有很大帮助。&lt;/p&gt;&lt;p&gt;基于上面的聚类结果，得到市场状态的转移矩阵如下。其中第    行第    列的数值表示在今天的市场状态为    的条件下，明天市场状态为    的条件概率。对于每一个   ，明天最有可能的状态    被用红色粗体表示出来。这个结果说明，除了大阴线外，在其他三种状态下，下一个交易日最有可能出现的都是小阳线，这和前面提到的样本严重不均衡密切相关。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-55927d112ad5ca3f3f2bb8019bbf610f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;629&quot; data-rawheight=&quot;302&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-55927d112ad5ca3f3f2bb8019bbf610f&quot; data-watermark-src=&quot;v2-1ba8e2074208bcef67563961a849e9d3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;本文的标题提出一个问题“大阳线之后更危险？”。这个问题可以通过这个状态转移矩阵回答。如果今天是大阳线，则下一个交易日是大阴线的&lt;b&gt;条件概率&lt;/b&gt;为 4.2%（第二行、第三列的数值）。让我们再来看看大阴线出现的&lt;b&gt;非条件概率&lt;/b&gt;。在回测的 1207 个交易日中，有 30 个交易日属于第三簇，因此大阴线的非条件概率仅为 2.5%，小于前面这个 4.2% 的条件概率。基于这个结果，我们得出“大阳线之后更危险”的推论。&lt;b&gt;这个结论事实上是符合人的认知的。这是因为无论大涨还是大跌，都意味着波动率的上升；而波动率的上升意味着风险的加大；风险加大意味着大跌的可能性增大。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;假如上述聚类分析的结果是有效的，那么使用这个转移矩阵可以回答很多类似的问题、得到很多有益的推论。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;样本不足和样本不均衡是金融数据的两大特色。&lt;/b&gt;这些对于 K-means 聚类算法在量化投资中的应用提出了严峻的挑战。对于待分析的数据，“如何有效的选取特征？”、“适合的簇数 K 是多少？”，这些都属于算法本身之外的问题，但它们又对算法的分析结果至关重要。比如在上面的例子中，使用 OHLC 数据描述市场状态是否恰当？K = 4 是否有足够的依据？要回答这些问题，自然需要更多的研究。&lt;/p&gt;&lt;p&gt;任何机器学习算法都仅仅是工具。在金融领域，核心的问题不是工具的使用，而是从对市场的理解。唯有理解了市场，才能选择正确的工具。掌握一门算法并不需要很长的时间；但要想深刻理解市场则需要时间的积淀。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-09-07-43872533</guid>
<pubDate>Fri, 07 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>那些年，那些错</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-09-04-43736197.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/43736197&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-76a9f52e6363e8489c05a507ee9ef150_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;投资之父 Benjamin Graham 教导我们说“投资者最大的问题、以及他最大的敌人，正是他自己”。本文就来聊聊投资者常犯的错误。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 South Sea Bubble&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1687 年，著名的物理学家 Isaac Newton（牛顿）在《自然哲学的数学原理》中提出了大名鼎鼎的三大运动定律和万有引力定律。三大运动定律的第一条便是惯性定律（即物体维持运动状态不变），而万有引力则是关于重力。然而，在三十年后的南海泡沫事件中，正是“惯性”（对应 price momentum）和“重力”（对应 market crash）让牛顿爵士亏的血本无归。&lt;/p&gt;&lt;p&gt;South Sea Bubble（南海泡沫事件，以下介绍参考 Wikipedia）是英国在 1720 年发生的经济泡沫，与同年的密西西比泡沫事件及 1637 年的郁金香狂热并称欧洲早期三大经济泡沫。&lt;b&gt;“经济泡沫”一词正是源于南海泡沫事件。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;事件起因源于南海公司（South Sea Company）。该公司于 1711 年西班牙王位继承战争仍然进行时创立，表面上是专营英国与南美洲等地贸易的特许公司，但实际是协助政府融资的私人机构，分担政府因战争而欠下的债务。&lt;/p&gt;&lt;p&gt;南海公司依靠夸大业务前景及进行舞弊从而获得外界看好。1720 年，南海公司更是通过贿赂政府，向国会推出以南海股票换取国债的计划，促使南海公司股票大受追捧。1720 年初，其股价由原本约 120 英镑急升至同年七月的 1000 英镑，&lt;b&gt;全民疯狂炒股&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;然而，市场上随即出现不少“泡沫公司”混水摸鱼，试图趁南海股价上升的同时分一杯羹。为监管这些不法公司的出现，英国国会于 1720 年六月通过 Bubble Act（《泡沫法令》）并于同年八月实施，炒股热潮随之减退，并连带触发南海公司股价急挫，在一个月内暴跌到 200 英镑以下（下图为同期公司股票走势图）。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d1304919aa2b3149e711d46c3ca3808d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;578&quot; data-rawheight=&quot;460&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d1304919aa2b3149e711d46c3ca3808d&quot; data-watermark-src=&quot;v2-e8147cf179bc26aef39d68bc96cfb8e3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;回过头来看，人们不禁会问，谁会傻到买在山尖上？但身处泡沫中，即便理性睿智如牛顿爵士，依然无法安然抽身。下图显示了牛顿在南海泡沫事件中购买股票的情况。他深谙自己提出的动量（大趋势），却忘记了重力（最终仍会要跌落人间），导致血本无归、黯然离场。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2b626b1e55e0dce5a86ee0eef226b033_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;544&quot; data-rawheight=&quot;357&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2b626b1e55e0dce5a86ee0eef226b033&quot; data-watermark-src=&quot;v2-247df87d79a30d481ad157b59f566e77&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;泡沫面前，人人平等。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这样的泡沫多么似曾相识？类似的例子还有很多 —— 美国 2000 年前后的 .com 泡沫，日本的房地产泡沫（鼎盛时东京皇宫的那块地价超过加拿大全国的地价），美国的次贷危机，大 A 股 2015 年的泡沫，前不久的比特币泡沫，举不胜举。&lt;/p&gt;&lt;p&gt;但是泡沫过后人们是否真的吃一堑、长一智？继续往下看。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 “明知故犯”的泡沫&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;根据有效市场假说，价格是投资品基本面信息正确反应。因此有人会说“如果价格受到那个时点的基本面的支撑，那便不是泡沫。而基本面反映的内在价值是很难衡量的，因此说泡沫其实也是很难证实的”。&lt;/p&gt;&lt;p&gt;下面就来看看在已知投资品内在价值的前提下，泡沫是否仍然会发生。&lt;/p&gt;&lt;p&gt;在一堂题为 Behavioral Finance and Investment Strategy 的公开课上，来自 Berkeley Hass 商学院的 Greg LaBlanc 介绍了一个泡沫实验（它由 Gaginalp et al. 2001 提出，本文中介绍的模拟交易结果来自 Berkeley 的本科生）。&lt;/p&gt;&lt;p&gt;该实验的设定如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;某资产的投资期限为 15 期（15 期后，资产的内在价值为 0）；&lt;/li&gt;&lt;li&gt;在每一期，该资产向其拥有者发放股息，股息是一个随机变量，每期股息的期望是 24 美元；&lt;/li&gt;&lt;li&gt;实验开始前，为每位参与者发放一定数量的资金和一定数量的资产；&lt;/li&gt;&lt;li&gt;实验开始后，参与者通过模拟交易系统来进行 bid 和 ask 操作，进行资产的买卖。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;由实验的前两点（期数有限、股息期望已知）可计算出该资产的内在价值。&lt;b&gt;其内在价值等于剩余投资期限内全部股息的期望之和。&lt;/b&gt;举例来说，在第一期交易前，它有 15 期可以交易，每期的期望股息是 24 元，因此它的内在价值是 360（= 24 × 15）元；在第二期交易前，它仅剩 14 期可交易，因此内在价值变为 336（= 24 × 14）元，以此类推。&lt;/p&gt;&lt;p&gt;由于内在价值可知，因此我们预期在模拟交易中不应产生泡沫，交易价格应该和资产的内在价值非常接近。然而，交易结果令人嗔目结舌。下图显示了第一次实验中，这些交易者每一期的交易价格（旁边的数字是交易量）。例如，第一期的成交价约为 75 元（交易量为 7），远远低于资产的内在价值（360 元）。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-230a02c4d53b9a857b73375e77214e29_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;846&quot; data-rawheight=&quot;486&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-230a02c4d53b9a857b73375e77214e29&quot; data-watermark-src=&quot;v2-d4518c21fe3860b9c724ba359c40654d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;随着交易的进行，价格逐渐上升，但仍然低于对应期的基本面价值。终于，在第 6 期的时候，交易价格和基本面价值基本一致。然而，从第 7 期开始，神奇的事情出现了 —— &lt;b&gt;泡沫发生了&lt;/b&gt;。在之后的几期里，狂欢远远没有结束，资产的交易价格持续增长并远超其已知的基本面价值。最终，参与者渐渐意识到资产的剩余内在价值远远不值交易的价格，因此争先出场，导致价格迅速下降，泡沫破灭。&lt;/p&gt;&lt;p&gt;为什么在明知内在价值的前提下依然会产生泡沫呢？是因为这些参与者没有经验吗？为了验证这一点，这些参与者进行了第二次实验。第二次实验中各期的交易价格如下图 X 所示（为了对比，保留了第一次交易的价格序列）。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在第二次实验中，依然出现了泡沫。&lt;/b&gt;不过，&lt;b&gt;由于参与者有了一些经验，这次实验中的泡沫比第一次的泡沫在强度（交易价格和基本面价格之差）和持续时间上都减弱了&lt;/b&gt;。这说明经验的提升能够在一定程度上阻止&lt;b&gt;同一批&lt;/b&gt;参与者产生泡沫，这些参与者变得更理性了。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-697a97540d5f44609a078996afd11f75_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;976&quot; data-rawheight=&quot;525&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-697a97540d5f44609a078996afd11f75&quot; data-watermark-src=&quot;v2-a94d1916d7fc66bdb91088cd66b54dd0&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;最终，这批参与者又进行了第三次实验（下图中圆圈虚线表示）。&lt;b&gt;在这次实验中，完全没有产生泡沫，交易价格在所有 15 期都和基本面价值非常接近。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-00c039df653e28b81c51d5814c9b8244_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;522&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-00c039df653e28b81c51d5814c9b8244&quot; data-watermark-src=&quot;v2-520b9aef95a2e7764e430e4c2c897b5a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上面的实验结果说明，当&lt;b&gt;同一批&lt;/b&gt;参与者反复经历了&lt;b&gt;同一个&lt;/b&gt;实验、积累了经验后，泡沫消失了。在泡沫面前，最重要的是经验。&lt;/p&gt;&lt;p&gt;上面这句话中有两个非常强的修饰词：&lt;b&gt;经验的建立指的是“同一批”交易者对于“同一个”资产。&lt;/b&gt;在这种情况下，泡沫便不会再发生。但是，如果这两个条件不满足，泡沫依然会发生。在实验中，学者们观察到了如下现象：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;如果实验参与者换了一拨人，或者是两拨独立进行过该实验的人被混在一起构成新的交易者进行实验，仍然会出现泡沫；&lt;/li&gt;&lt;li&gt;改变资产的设定（比如投资期限从 15 期改成 20 期、或者改变每期股息的分布）也会造成新的泡沫。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;这样的结果说明在真实的市场中，面对基本面价值难以评估的资产和一代又一代不同的投资者，经验的力量也是渺小的，泡沫注定会再次发生。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;那些经历了 .com 泡沫的投资者也许会变得小心并抵触股票投资，但是它们在房地产泡沫和比特币泡沫之前仍然无法免疫。这大概就是人性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 股权溢价之谜&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;聊完了泡沫，我们在聊聊另外一个投资中的大敌：&lt;b&gt;短视损失厌恶（myopic loss aversion）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;1926 年以来，美国股市每年扣除通胀后的平均回报率约为 7%，而政府债券的回报率不足 1%。面对如此巨大的回报率之差，债券投资者的数量却远超股票投资者，造成&lt;b&gt;股权溢价之谜（equity premium puzzle）&lt;/b&gt;。如果将股票的收益率和标准差套入到效用函数中，上述现象的“合理”解释只能是投资者的风险厌恶水平非常高，难以令人信服。&lt;/p&gt;&lt;p&gt;Richard Thaler （Benartzi and Thaler 1995）使用行为经济学先驱 Daniel Kahneman 和 Amos Tversky 提出的 &lt;b&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38526672&quot;&gt;Prospect Theory&lt;/a&gt;（译为前景理论或展望理论）&lt;/b&gt;和他的&lt;b&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38610013&quot;&gt;心理账户理论（Mental Accounting）&lt;/a&gt;&lt;/b&gt;解释了这一现象。&lt;/p&gt;&lt;p&gt;&lt;b&gt;投资者厌恶损失&lt;/b&gt;，且 Prospect Theory 的价值函数指出损失给人造成的效用要强于收益带来的效用。&lt;b&gt;对于投资者来说，亏损的负效用（痛苦）通常是收益的正效用（喜悦）的两倍。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b17ba01cd9ee7fe1e631b7fae9e098d0_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;818&quot; data-rawheight=&quot;560&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b17ba01cd9ee7fe1e631b7fae9e098d0&quot; data-watermark-src=&quot;v2-3c28fb2f03b18005d032a5fd60559638&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;此外，心理账户理论的第三部分是关于评估账户的频率。&lt;b&gt;不成熟的、一般的、大多数的投资者倾向于频繁（如果不是每时每刻，那至少也是每天）的查看自己的股票是赚了还是亏了。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;然而股票的短期走势充满着随机性，股价会上下波动。在这种情况下，投资者频繁查看自己的股票账户，上涨只带来一分的快乐，而下跌造成两倍的伤痛，这就造成了短视损失厌恶：&lt;/p&gt;&lt;p&gt;&lt;b&gt;损失厌恶 + 频繁评估心理账户 = 短视损失厌恶&lt;/b&gt;&lt;/p&gt;&lt;p&gt;资产的波动越大，频繁查看账户带来的心理压力越大，这放大了股票的风险给人们的感受。换句话说，这使得它们更加偏好避险资产 —— 债券。这就是为什么那么多人去投资债券，从而解释了股权溢价之谜。&lt;/p&gt;&lt;p&gt;为了证明短视损失厌恶可以解释股权溢价之谜，Thaler et al. (1997) 报告了一系列实验结果。不同的投资者被要求按照不同的频率（每年 8 次、每年 1 次，每 5 年 1 次）在股票和债券之间进行资产配置。调仓频率低的投资者（即每年 1 次和每 5 年 1 次的）将 67% 的资金配置在股票上，33% 的资金配置于债券；而调仓频率高的投资者（每年 8 次）仅仅将 41% 的资金配置在股票上，而将 59% 的资金配置于债券。&lt;b&gt;调仓频率高的投资者容易受到股票高波动以及近期亏损的影响，出现短视损失厌恶。&lt;/b&gt;即便他们知道，长期来看股票的收益会战胜债券，但是仍然陷入短视损失厌恶的误区。在他们的心理账户中独立看待每一次调仓决策，而非在一个更长的时间尺度下把所有决策一起考虑，这导致了这些投资者将更多的资金配置在债券上。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 投资者的无效择时&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在投资中普遍存在的另一个 puzzle 是&lt;b&gt;投资者购买股票或者基金获得的回报往往不如该股票和基金本身的回报高&lt;/b&gt;（Dichev 2007）。&lt;/p&gt;&lt;p&gt;以基金为例，一个基金的回报率（比如年化收益率）是按&lt;b&gt;时间加权（time-weighted）&lt;/b&gt;计算的。比如我们可以计算一个基金过去 5 年或者 10 年的年化收益率。然而，&lt;b&gt;一个投资该基金的投资者获得的收益率则和他的资金何时流入、何时流出、投入量、赎回量等因素有关。&lt;/b&gt;因此，一般称一个投资者的回报率是&lt;b&gt;资金加权的（dollar-weighted）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;我们知道基金的运行有高峰和低谷（回撤期）。如果投资者都是聪明的且能够准确择时，那么他们会在基金表现不好的时候买入，而在基金表现好的时候赎回，这样做能够使投资者获得超过基金本身的回报率。然而结果恰恰相反。&lt;/p&gt;&lt;p&gt;下图展示了在一个主动型公募基金和一个被动的指数基金中，基金本身的收益率（total return）和投资者的收益率（investor return）的对比情况。不难看出，&lt;b&gt;投资期限越长，投资者实际获得的收益率和基金的收益率相差的越多。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-adfd4cd6dce68aa60bf3f74b029f8dcb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;720&quot; data-rawheight=&quot;564&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-adfd4cd6dce68aa60bf3f74b029f8dcb&quot; data-watermark-src=&quot;v2-fd46ad68ca4e6a78a2b77062cf6a9da0&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这个结果说明，&lt;b&gt;投资者们在基金上的择时通常是错误的：由于 performance chasing 而在基金近期表现好的时候买入；由于恐慌在基金表现不好的时候赎回。&lt;/b&gt;高买低卖，造成亏损。跨期越长，犯错的次数越多，因此实际获得的回报越低。&lt;/p&gt;&lt;p&gt;在挑选基金时，真正聪明的投资者考察的应该是一个基金的团队能力和投资理念、基金如何防控风险等核心要素，而非过分注重短期的表现。当然，鉴别这些核心要素并不容易，这使得近期表现这种看得见的指标格外突出，而市面上流行的各大榜单自然也是火上浇了一把油。回想一下，各类型的基金，是否都是在业绩好的时候猛做一波规模呢？&lt;/p&gt;&lt;p&gt;&lt;b&gt;同样的问题也出现在因子择时上。&lt;/b&gt;在使用因子选股时，人们倾向于通过因子近期的表现来配置因子。但是，Arnott et al. (2016) 指出因子收益率中包括很大的&lt;b&gt;估值溢价&lt;/b&gt;。他们把由估值上升带来的因子收益率称为环境 α。&lt;b&gt;当剔除了因子估值的变化后，很多因子竟然并不能获得超额收益。&lt;/b&gt;Arnott et al. (2017) 的研究发现&lt;b&gt;选择那些估值处于历史低位的因子（即过去表现的不怎么好的因子）比选择那些过去一段时间过热的因子，能够在未来获得更高的收益。&lt;/b&gt;这解释了为什么按照近期表现来配置因子效果并不好。&lt;/p&gt;&lt;p&gt;世界上最大的公募基金 Vanguard 在介绍它们挑选管理人的时候曾说，对于它们认可的管理人，&lt;b&gt;如果它最近的表现不好，Vanguard 的做法是增加配置的资金而非减少！&lt;/b&gt;这背后的深意是规避本小节提到的投资者常犯的错误择时导致 dollar-weighted 回报率低于 time-weighted 回报率。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;投资之父 Benjamin Graham 曾指出：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The investor’s chief problem – and even his worst enemy – is likely to be himself.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：投资者最大的问题、以及他最大的敌人，正是他自己。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;本文简单介绍了一些投资者常犯的错误，希望能引发各位的思考（另外，从认知偏差角度来说，投资中还有很多其他常见的错误，以后我们找机会再聊）。在这些错误面前，人人平等（想想牛顿）；&lt;b&gt;我们能够做的就是反人性的克制自己，坚决按照策略执行。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Renaissance Technologies 的 James Simons 曾说：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;We slavishly follow the model. You do whatever it says no matter how smart or dumb you think it is.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：我们完全忠实于模型；不论我们觉着它聪明还是愚蠢，都坚决执行。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Investing is simple, but not easy.&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Arnott, R. D., N. Beck, V. Kalesnik, and J. West (2016). How Can &#39;Smart Beta&#39; Go Horribly Wrong? &lt;i&gt;SSRN: https://ssrn.com/abstract=3040949.&lt;/i&gt;&lt;/li&gt;&lt;li&gt;Arnott, R. D., N. Beck, V. Kalesnik (2017). Forecasting Factor and Smart Beta Returns (Hint: History Is Worse than Useless). &lt;i&gt;SSRN: https://ssrn.com/abstract=3040953.&lt;/i&gt;&lt;/li&gt;&lt;li&gt;Benartzi, S. and R. H. Thaler (1995). Myopic Loss Aversion and the Equity Premium Puzzle. &lt;i&gt;The Quarterly Journal of Economics&lt;/i&gt;, Vol. 110(1), 73 – 92.&lt;/li&gt;&lt;li&gt;Caginalp, G., D. Porter, and V. Smith (2001). Financial Bubbles: Excess Cash, Momentum, and Incomplete Information. &lt;i&gt;Journal of Psychology and Financial Markets&lt;/i&gt;, Vol. 2(2), 80 – 99.&lt;/li&gt;&lt;li&gt;Dichev, I. (2007). What are stock investors’ actual historical returns? Evidence from dollar-weighted returns. &lt;i&gt;American Economic Review&lt;/i&gt;, Vol. 97, 386 – 401.&lt;/li&gt;&lt;li&gt;Thaler, R. H., A. Tversky, D. Kahneman and A. Schwartz (1997). The effect of myopia and loss aversion on risk taking: an experimental test. &lt;i&gt;The Quarterly Journal of Economics&lt;/i&gt;, Vol. 122(2), 647 – 661.&lt;/li&gt;&lt;li&gt;http://www.mymoneyblog.com/morningstar-investor-returns-another-reason-why-chasing-past-performance-is-bad.html&lt;/li&gt;&lt;li&gt;https://en.wikipedia.org/wiki/South_Sea_Company&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=ERDEozGpV74&quot;&gt;https://www.youtube.com/watch?v=ERDEozGpV74&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-09-04-43736197</guid>
<pubDate>Tue, 04 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>多因子如何玩转加密币？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-09-02-43545668.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/43545668&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-75a1a0a253f1ca4e4ac8bc33dc75573a_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;写在前面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上周休假去了，公众号和知乎专栏没有更新，下周复工。今天先放一篇之前写的关于加密币的老文。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今天要谈到的是&lt;b&gt;用多因子的方法投资加密币。&lt;/b&gt;你没听错，用的手段是多因子，作用的对象不是选股而是选加密币！多因子是在股票市场广为使用的选股方法，经过几十年的发展已经变得非常成熟，常见的能够获得超额收益的风险因子（如动量、价值、质量等）早已深入人心（需要背景知识的小伙伴可以参考&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38281562&quot;&gt;《因子投资 —— “被动的”主动投资》&lt;/a&gt;）。而以比特币为代表的&lt;b&gt;数字加密货币（cryptocurrency，简称加密币）&lt;/b&gt;则是一个新兴玩意儿。虽然比特币已经存在了很多年，但其近两年的疯狂上涨以及区块链概念被大肆炒作让比特币以及各种其他加密币真正走进了大众视野。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c302aecd321aa18ed35a9ff0544d6da1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;785&quot; data-rawheight=&quot;357&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c302aecd321aa18ed35a9ff0544d6da1&quot; data-watermark-src=&quot;v2-534960efd4966d684a01f7ef0a167b16&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;成熟、有效的风险因子和非常年轻的加密币市场能碰撞出怎样的火花？加密币市场是否也像股市一样存在可以获取超额收益的风险因子？近期，Hubrich (2017) 这篇文章走进了我们的视野。该文作者使用股票中常见的动量（Momentum）、价值（Value）、以及 Carry 这三个因子对 11 种加密币进行了分析，即&lt;b&gt;多因子选加密币&lt;/b&gt;，说明了这些因子的有效性，读来让人颇为耳目一新。&lt;/p&gt;&lt;p&gt;本文对 Hubrich (2017) 的发现做一个简单的梳理。&lt;/p&gt;&lt;p&gt;在开始之前我想先唠点别的，即我们应该如何客观的看待加密币的这股热潮。面对如此火爆的加密币，市场上大致有三种人：信徒、鄙视者和吃瓜群众。信徒和鄙视者都希望通过自身的言行来影响吃瓜群众对加密币的看法。从自身的利益来看，鄙视者的动机更强。这是因为即便无法说服吃瓜群众，这些靠着加密币大赚特赚的信徒们的收益也不会有多少影响。而对于鄙视者来说，他们无法享受到加密币带来的财富，那就只能希望通过它来获得名望；鄙视者们自认为洞悉了加密币背后的陷阱和虚幻，希望泡沫幻灭以证明他们的先见之明，像拯救苍生的布道高人一样成为吃瓜群众眼中“神一样的存在”。&lt;/p&gt;&lt;p&gt;这两类人大概都过激了。加密币到底是天使还是魔鬼，恐怕现在没人敢下结论。我们能做的是持有开放的心态，尽量客观的看待它，“存在即合理”。Hubrich (2017) 对加密币的看法是：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;我们应该像动物学家一样来看待这种新的金融物种。我们不知道加密币最终会变成一种入侵性很强的害虫还是一种对生态系统的有益补充，但是我们一定可以通过研究它来更深入的理解自然法则。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;使用风险因子能够获得超额收益就如同金融世界中的自然法则。因此，我们关心的问题是，加密币市场是否能够适应这种法则，或者对这一法则提出新的挑战。&lt;/p&gt;&lt;p&gt;跑偏的有点多，下面言归正传。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 了解加密币市场&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;首先来通过一组数据了解一下加密币市场。在 Hubrich (2017) 的研究中，作者考虑了 11 种加密币：BTC，DASH，DCR，DOGE，ETC，ETH，LTC，PIVX，XEM，XMR 以及 ZEC。每个币种的数据历史、周收益率统计量（考虑到加密币高波动的特性，作者使用周频作为选币、再平衡投资组合的频率）、以及市场统计量汇总于下表。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fa9b1b453c5f689b5a8b86eb2fcd7517_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;956&quot; data-rawheight=&quot;520&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fa9b1b453c5f689b5a8b86eb2fcd7517&quot; data-watermark-src=&quot;v2-f6882e1495275df89468965a6d877289&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我们以比特币（BTC）为例解释一下市场统计量。在 Hubrich 分析时，比特币的最新市值约为 70 亿美元，其价格为 4226.06 美元（远低于今天的价格），已挖出的数量约为 1660 万（依照协议，总共为 2100 万）。每天在全世界所有&lt;b&gt;区块上&lt;/b&gt;交易的比特币交易额的（90 日）均值超过 60 亿美元（平均交易次数超过 24 万次）。注意，这个交易额和交易量&lt;b&gt;不包括&lt;/b&gt;在交易所交易的比特币。这些数据说明加密币（特别是比特币、以太币这种“大币种”）每天在区块上的交易相当活跃。最后，每天新挖出来的比特币占已有比特币数量的 0.012%。&lt;/p&gt;&lt;p&gt;在下一节可以看到，作者之所以关心加密币在区块上的交易量以及每天新挖出来的加密币数量占比，是因为他要以此来定义风险因子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 定义风险因子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Hubrich 考虑了三个因子：&lt;b&gt;Momentum&lt;/b&gt;、&lt;b&gt;Value&lt;/b&gt; 以及 &lt;b&gt;Carry&lt;/b&gt;。至于为什么考虑这三个因子？这里先卖个关子，我们会在本小节的最后说明。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这三个因子都可以在时序上考虑，也可以在截面上考虑。&lt;/b&gt;作者分别考虑了这两种情况，构建了不同的投资组合说明了因子的有效性。本节我们先来看看这些因子是如何定义的；下一节会说明如何在分别从时序和截面的角度使用这些因子来选加密币。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.1 Momentum 因子&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Momentum 即动量因子，是各大类市场中最持久也是最有效的一个因子（当然前提是选对计算动量和持有的周期）。动量因子说的是，前期涨的好的未来还会涨的好；前期跌的多的未来还会跌得多。在构建动量因子的时候，Hubrich 使用了过去 7 天的收益率作为动量因子。&lt;/p&gt;&lt;p&gt;加密币的交易是 24/7 的，一个星期内的 7 天都是交易日，因此在计算周收益率的时候，不好说选择什么时候为起点就更好。在实际计算因子以及构建投资组合时，Hubrich 考虑了以周一到周日这 7 天分别为计算周收益率起点的 7 种情况，并把它们的均值作为因子有效性检验的结果。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.2 Value 因子&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Value 即价值因子，它和动量因子的地位相当，也是一个古老而有效的因子。世界上最著名的量化对冲基金 AQR 曾在顶级期刊 Journal of Finance 上发表过一篇题为“Value and Momentum Everywhere（无处不在的价值和动量）”的文章（Asness et al. 2013），足见 Value 因子的重要性。&lt;/p&gt;&lt;p&gt;Value 因子说的是任何一个金融工具都有根据其基本面得到的 fair value，当它的市场价格（market value）高于 fair value 时它的价值被高估；当它的市场价格低于 fair value 时它的价值被低估。我们应该购买价值被低估的（便宜的）投资品而绕开价值被高估的（昂贵的）投资品。&lt;/p&gt;&lt;p&gt;受此影响，Hubrich 也在对加密币的因子研究中试图引入价值因子。但是，很多金融界的 big names 都直言不讳的说加密币就是个泡沫、没有基本面价值。这就尴尬了，没有基本面价值，又怎么来定义价值因子呢？&lt;/p&gt;&lt;p&gt;别担心，学术界最缺乏的就不是创造力。Hubrich 提出了&lt;b&gt;加密币的“基本面”价值体现在了它们的交易价值上。&lt;/b&gt;还记得本文第二节那个表中，我们提到比特币每天在所有区块上的交易额超过 60 亿美元吗？没错，Hubrich 明确指出区块上的交易（transaction）和交易所上的交易（trading）不同，前者是衡量一个加密币价值的有效指标。&lt;b&gt;一个币种在全世界范围内的交易越活跃、交易额越高，说明它的价值越大。&lt;/b&gt;因此，&lt;b&gt;用市值除以区块上的交易值，Hubrich 定义了 Market-to-Transaction-Value（MTV），以此作为加密币的价值因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;具体的，Hubrich 使用了每个币种当前的最新市值和其过去 7 个交易日在区块上的平均交易额（美元计价）的比值来计算 MTV。下图是这些加密币的价值因子随时间的变化，它确实呈现均值回复的特性，说明市场时而高估、时而低估这些加密币的“基本面”价值。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2cf8e38ba8c2a6c969f392b255e19510_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;603&quot; data-rawheight=&quot;588&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2cf8e38ba8c2a6c969f392b255e19510&quot; data-watermark-src=&quot;v2-1ef92d69d9264659216bd9e6af9572ea&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;3.3 Carry 因子&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后一个考虑的因子是 Carry。由于我实在想不到特别合适的中文翻译，就让我们姑且就用 Carry 好了，但我保证会把它的定义说清楚。&lt;/p&gt;&lt;p&gt;&lt;b&gt;一个资产的 Carry 定义为：当该资产的价格在一定时间内不发生变化时，持有该资产能够获取的收益。&lt;/b&gt;Carry 最早来源于外汇交易，旨在从低利率的市场借入货币，买入高利率市场货币，获取套息收益，即 Carry。后来，更广义的 Carry 被推广到股票、债券以及商品市场之中。&lt;/p&gt;&lt;p&gt;以股票为例，Carry 收益是什么呢？假如我们买入一支股票并一直持有，如果股票的价格不变，那么我们获得的收益率就是该股票的分红。股息率（dividend yield）就是 Carry 收益率，它就是我们的 Carry 因子。顺便说一句，&lt;b&gt;股息率因子是一个非常好使的量化选股因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;把 Carry 的定义应用到加密币当中，假设加密币的交易价值不变，它的收益体现在哪里呢？Hubrich 认为&lt;b&gt;加密币的 Carry 收益由它的供需决定。&lt;/b&gt;俗话说，“物以稀为贵”。大多数加密币的发行总数都有个上限且&lt;b&gt;不能随意增发&lt;/b&gt;，因此&lt;b&gt;未来还能被挖出来的币的数量越少，这个币的 Carry 收益率就越高。&lt;/b&gt;因此，Hubrich 使用 7 日内挖出的币的总个数除以该 7 日窗口开始时市场上该币的个数作为 Carry 因子的代理指标，这个比值越高说明 Carry 因子越低。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5c669b16ce4f144ac8435a7eac31b67b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;514&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5c669b16ce4f144ac8435a7eac31b67b&quot; data-watermark-src=&quot;v2-89503e250a7f6f6b21df81e3d8d97e5d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;然而，加密币的紧缩不仅体现在不能随意增发。想象一下这样的情景，Alice 拥有 5 枚比特币。一天她的电脑寿终正寝导致她的私钥丢失，且她没有备份。这意味着这些比特币将永远“死去”。随着时间的推移，像 Alice 一样的人会越来越多，“死去”的比特币（以及其他的加密币）会越来越多，这也将加剧加密币的紧缩，增加其 Carry 收益。显然，加密币的“死去”是非常难以量化的，因此 Hubrich 并没有考虑这方面的影响。&lt;/p&gt;&lt;p&gt;上面分别介绍了 Momentum、Value 和 Carry 因子。Hubrich 选择这三个因子不仅仅因为它们三个在其他市场中太有名了，更是因为它们代表了&lt;b&gt;三个互补的维度&lt;/b&gt;：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Momentum：&lt;/b&gt;动量因子考察的是&lt;b&gt;当市场沿着过去的轨迹继续运动时&lt;/b&gt;（即价格上涨的还会涨，价格下跌的还会跌），我们能够获得的收益；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Value：&lt;/b&gt;价值因子考察的是&lt;b&gt;当市场回复到之前的某种均衡状态时&lt;/b&gt;（即价格围绕基本面价值往复运动），我们能够获得收益；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Carry：&lt;/b&gt;Carry 因子考察的是&lt;b&gt;当市场不发生变化时&lt;/b&gt;（即从供需的角度来看，加密币的需求端不发生变化），我们能够获得的收益。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;从这个意义上说，以这三个因子为起点，研究因子投资在加密币这个新兴市场中的有效性，是非常合理的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;最后需要说明的是，在对每个币种各自计算了因子后，必须考虑因子的标准化，否则无法保证因子在跨币种之间的可比性。&lt;/b&gt;以价值因子为例，不同币种的 MTV 可能都不是一个量级，不标准化的话根本没有可比性。 在标准化时，Hubrich 采用了每个币种自身的时序数据计算 Z-score（减去均值再除以标准差）的方式。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 实证结果&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节来介绍用因子选加密币的效果如何。上一节提到 Hubrich 分别考虑了时序和截面两个角度：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;在时序方面，&lt;/b&gt;每个加密币被独立考虑。在每个调仓节点，对于一个给定的加密币 X 和因子 A，如果 A 当期的取值大于该因子在此节点之前的历史均值，则在因子 A 的投资组合中做多加密币 X，反之则做空加密币 X。&lt;/li&gt;&lt;li&gt;&lt;b&gt;在截面方面，&lt;/b&gt;这些加密币被放在一起比较它们之间的相对强弱关系。在每个调仓节点，对于一个给定的加密币 X 和因子 A，如果 A 当期的取值大于所有加密币的因子 A 在当期取值的均值，则在因子 A 的投资组合中做多加密币 X，反之则做空加密币 X。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;上述定义说明，虽然都考虑了多空对冲，但时序策略更接近一个 β 策略，而截面策略更像是一个纯 α 策略。在定性确定每个因子中加密币的多、空之后，还必须选择具体的权重。为此，作者考虑了等权重和按风险加权这两种方法。&lt;/p&gt;&lt;p&gt;由于时序策略的 β 属性，为了说明因子的有效性必须把来自市场的收益率剔除。我们知道过去几年加密币几乎呈现单边上涨行情，因此即便是一个纯多头的买入、持有这 11 个加密币的组合也会有不错的收益。为了说明因子的有效性，Hubrich 构建了纯多头的基准组合，并用基准组合的收益率对这两个策略进行回归。&lt;b&gt;策略的收益率在回归中无法被基准组合的收益率解释的部分就是来自因子的超额收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于有时序 vs 截面两种策略，以及等权 vs 风险加权两种配置方式，我们一共有四个策略。这四个策略的净值如下图所示。&lt;b&gt;作者充分考虑了策略的风险，因此资金量在加密币上的暴露其实非常低，即便如此时序策略仍然获得了可观的收益。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7302908b62547d99e89ce6701d5d7dbc_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;628&quot; data-rawheight=&quot;403&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7302908b62547d99e89ce6701d5d7dbc&quot; data-watermark-src=&quot;v2-5d65329e5ce7a8b14427532dd7c0d748&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;图中，实线为策略净值、虚线为用基准组合回归后无法解释的超额收益的净值。&lt;b&gt;无论是在时序还是截面策略中，这三个风险因子都发挥了作用，选出的多空加密币组合可以获得跑赢基准的超额收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后，Hubrich 将因子的策略组合和基准组合相结合构建了纯多头的策略（因为加密币市场的做空机制也有限），这四个策略加上基准组合之后的表现如下图所示。其中虚线是基准组合净值，实线是因子 + 基准组合的净值曲线。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-411bf705d5af9eeedbc3f18c5efd09e9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;635&quot; data-rawheight=&quot;393&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-411bf705d5af9eeedbc3f18c5efd09e9&quot; data-watermark-src=&quot;v2-62e0ed7f6d06400a1fc018e882089081&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;由于加密币自身的上涨，基准组合的收益率很高。因此因子组合和基准组合两者叠加后，策略的收益率更是进一步提升。不过在文章的最后，Hubrich 也给出“警告”，加密币单边上涨的行情也许在未来无法持续，因此最后这张图中两个策略的叠加效果可能对未来没有太多的借鉴意义。但不可否认的是，以动量、价值和 Carry 这三个因子构建的加密币投资组合战胜了市场。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这两天，全球最大对冲基金桥水的创始人 Ray Dalio 携他的新书《原则》来到中国，掀起了一股 Dalio 热浪。从金融街到陆家嘴，人手一本“黑宝书”、张口闭口就是原则。在接触这本书之前，Dalio（以及桥水）最令我钦佩的是他们在面对市场时求真的态度，他们时时保持着谦逊，孜孜不倦的探究市场的真谛，就像 Dalio 和他的合伙人在介绍桥水著名的全天候策略时写到的那样（如下）。看完《原则》这本书之后，我的这个印象进一步加深：&lt;b&gt;永远怀有开放和包容的心态来追寻市场的真相。&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;找出[投资中的]真相是我们双方的责任。我们[桥水]应该将我们认为正确的观点诚实的表达出来，而你们则应努力地、公开地探究我们的想法，以便我们一起学习什么是正确的。当我们进行了如此高质量的交流之后，我们可以决定真相到底是什么，以及我们应该怎么做。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在面对加密币这个新兴市场时，Dalio 和桥水的这种求真的态度非常值得学习。我们无需急于给加密币贴上“天使”或者“魔鬼”的标签，也无需着急“站队”、表明自己对加密币的（过激）立场。一个针对加密币的量化策略在严格控制风险后可以是一个非常好的投资途径。难道就因为它投资的是加密币，而非传统意义的股票、债券、商品、外汇市场，就应该被视为“过度投机”或“无视风险”吗？答案显然是否定的。&lt;/p&gt;&lt;p&gt;在时间面前，人类任何的进程都不过沧海一粟。几十年后，后人自会对加密币的存在作出定论。而当下的我们，应该秉持客观、严谨、求实的态度去探索、学习加密币市场，并争取以此来推动我们对其他市场的理解和认知，这才是一个量化投资践行者应有的态度。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Asness, C. S., T. J. Moskowitz, and Pedersen, L. H. (2013). Value and momentum everywhere. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 68(3), 929 – 985.&lt;/li&gt;&lt;li&gt;Hubrich, S. (2017). Know When to Hodl &#39;Em, Know When to Fodl &#39;Em: An Investigation of Factor Based Investing in the Cryptocurrency Space. &lt;i&gt;SSRN&lt;/i&gt;: https://ssrn.com/abstract=3055498.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-09-02-43545668</guid>
<pubDate>Sun, 02 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>模型复杂度随想</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-08-23-42734509.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/42734509&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-38a0cdd6cadb8f387d3240e4e928dcb4_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当模型复杂度一样时，人们偏好风险收益特性更高的策略；当风险收益特性一样时，人们偏好模型复杂度更低的策略。各种复杂模型带来的边际超额收益能否 justify 它们的复杂度呢？拭目以待。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;一个初入量化投资的分析师经过了一个月的奋斗开发出了一个双均线趋势追踪模型后，兴冲冲的跑来和他的基金经理汇报，于是便有了下面这段对话。&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;分析师（一脸兴奋）：&lt;/b&gt;我开发出了一个双均线系统，绝对没有数据挖掘，只有计算均线的两个参数，该参数对绝大多数商品期货都有效、适应性极强。&lt;/li&gt;&lt;li&gt;&lt;b&gt;基金经理：&lt;/b&gt;做趋势追踪还有其他的方法，比如时间序列分析、其他技术分析手段、以及机器学习里面的各种复杂算法。你的系统和这些比较过吗？&lt;/li&gt;&lt;li&gt;&lt;b&gt;分析师（心说“一猜你就会问这个”）：&lt;/b&gt;常见的这些方法我都仔细试过了，它们的效果都没有双均线系统好。&lt;/li&gt;&lt;li&gt;&lt;b&gt;基金经理：&lt;/b&gt;……&lt;/li&gt;&lt;li&gt;&lt;b&gt;分析师：&lt;/b&gt;真的！我做了非常详细的对比，逐笔分析了各种不同策略的交易记录，双均线是最好的。&lt;/li&gt;&lt;li&gt;&lt;b&gt;基金经理：从你排除其他策略、挑出双均线系统的那一刻，你就已经过拟合了。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;分析师（一脸迷茫）：&lt;/b&gt;……&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;上面这段对话当然是我杜撰的。想通过它表明的观点是，&lt;b&gt;我们将不同的量化技术应用到同样的数据上构建某一类（比如趋势追踪、反转、套利）策略时，最终会挑出来表现最好的量化技术，无论这个技术复杂与否（线性的、非线性的），这个过程本身就是在过拟合。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最终被挑出来的，注定是因为在样本内战胜了其他的。从“超参数”（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38256574&quot;&gt;《科学回测中的大学问》&lt;/a&gt;）的意义上说，这个模型难逃 data mining 之嫌，因为&lt;b&gt;它比别的模型更好很可能是因为它对样本数据内的噪音刻画的更精准，而非发现了一些被其他策略忽视到的真实存在于数据之间的因果关系。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以上这点粗浅的认识当然不是鼓励大家放弃回测中表现好的、使用表现差的量化技术。就我自己有限的经验来看，任何策略都或多或少存在数据挖掘的问题，而这个问题随着模型复杂度的增加更加突出。&lt;/p&gt;&lt;p&gt;今天就简单聊聊模型复杂度。讨论主要从以下两个角度展开：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;模型复杂度和过拟合程度&lt;/b&gt;：定量分析模型复杂度和构建策略时 data mining 的程度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;模型复杂度和损失带来的主观感受&lt;/b&gt;：回答诸如“面对实盘中同等大小 —— 比如 -10% ——的回撤，不同复杂度的模型是否能给我们带来同样的主观感受”这样的问题。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;这两个角度的研究都是很大的课题，本文仅仅是做一点抛砖引玉的探讨。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 模型复杂度和过拟合程度&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在构建一个量化投资策略时，一旦确定了模型复杂度，就要进行参数优化。只要是参数优化，无论再怎么小心，都会存在过拟合。本节使用趋势策略阐述&lt;b&gt;在给定的模型复杂度进行参数优化&lt;/b&gt;和&lt;b&gt;过拟合程度&lt;/b&gt;之间的关系。分析流程如下：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7ba6576c5316b73466cbce402fd83d3b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;572&quot; data-rawheight=&quot;582&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7ba6576c5316b73466cbce402fd83d3b&quot; data-watermark-src=&quot;v2-42859f663c812c53adfc14892285035d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;分析中采用的趋势追踪策略是均线多头排列策略。它的定义和模型复杂度介绍如下。&lt;/p&gt;&lt;p&gt;在市场有大趋势的时候，均线一般呈现多头或者空头结构，即不同周期 T 的均线排序和 T 的排序非常一致（比如上涨时，通常有 MA5 &amp;gt; MA15 &amp;gt; MA30）。当投资品从上涨向下跌转换、或由下跌向上涨转换时，短周期均线会先于长周期均线发生变化。在前者发生时，短周期均线开始逐步下穿长周期均线；在后者发生时，短周期均线开始逐步上穿长周期均线。在发生由涨转跌或由跌转涨时，不同周期均线的排序和时间窗口 T 大小的排序关系被打乱，不再完全一致。&lt;/p&gt;&lt;p&gt;&lt;b&gt;使用秩相关系数计算均线排序和时间窗口 T 排序之间的一致性，并使用它择时、构建趋势追踪策略（这里只考虑多头策略）。&lt;/b&gt;当均线多头排列时，均线和 T 之间的秩相关性为 1；当均线空头排列时，均线和 T 之间的秩相关性为 -1。由涨转跌时，短期均线开始下穿，秩相关性从 1 开始下降；由跌转涨时，短期均线开始上穿，秩相关性从 -1 开始上升。由此，可以构建策略如下：&lt;/p&gt;&lt;p&gt;使用给定的均线参数周期，各自计算指数平均，进而计算均线排序和参数排序的秩相关系数。空仓时，如果秩相关系数上穿 -TH 则满仓；满仓时，如果秩相关系数下穿 TH 则空仓。不考虑任何成本。&lt;/p&gt;&lt;p&gt;在这个策略中，模型复杂度由如下两组参数刻画：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;计算均线的周期参数个数；&lt;/li&gt;&lt;li&gt;判断空仓和满仓时，秩相关系数的阈值。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;这两组参数各自从不同层面增加了模型的复杂程度。在分析中，它们的取值如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;均线参数的个数从 2 到 5 递增，依次增加模型的复杂度。第一个均线周期取值范围是 10 到 100，步长 10；从第二个均线周期开始，在搜索参数时，其取值范围似是前一个均线的取值与 100 之间，步长 10。此外，允许新加入的均线对策略不产生作用。这保证了随着均线个数增加，求解的空间是递增的，从而保证了最优目标函数的单调性。&lt;/li&gt;&lt;li&gt;在分析时，首先仅考虑均线参数个数造成的影响，因此假设阈值为 TH = 0.5 恒定。之后，为了同时考察阈值对过拟合程度的影响，允许阈值 TH 从 0.1 到 0.9 之间（步长 0.1）选择。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;依照上述描述进行实验，得到的模型复杂度和过拟合程度的关系如下图所示。其中蓝色圆圈表示仅考虑均线参数个数这一种模型复杂度时的情况，而黄色十字表示同时考虑阈值作为模型复杂度的情况。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-94b8a9427d48de4533fcb4960c769797_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;425&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-94b8a9427d48de4533fcb4960c769797&quot; data-watermark-src=&quot;v2-4256bd1c5921955e195c12fe6d86eab5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;当我们使用真实的交易数据进行策略的参数优化时，尽管使用了训练集和测试集、考虑了参数平原、从各种业务层面解释了参数的选择，依然无法消除参数优化中过拟合的影响。&lt;b&gt;更不幸的是，对于真实交易数据，由于不知道它其中哪些是因果关系、哪些是噪音，因此我们甚至无法评价参数优化造成的过拟合程度。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;然而在上述实验中，由于价格序列由随机游走生成，因此随着实验个数的增加，我们预期它们的基础夏普率均值是 0。这正是使用 random walks 来验证策略的好处，因为它的“正确答案”是已知的 —— &lt;b&gt;一个不存在过拟合的策略在随机游走价格序列上不应该能持续的赚到钱。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这 100 个 random walks 的基础夏普率均值为 -0.03。如果参数优化中没有过拟合，那么策略夏普率均值和基础夏普率均值相差不远。然而，分析的结果远非如此。上图表明，随着参数的增多，模型的过拟合程度（100 个策略夏普率均值于基础家谱率均值之差）也在上升；而随着模型复杂度从多维度的提升（即加入阈值参数），模型的过拟合程度产生了跳变。&lt;/p&gt;&lt;p&gt;&lt;b&gt;上述结果说明模型的过拟合程度随模型的复杂度递增。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 模型复杂度和损失带来的主观感受&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节来看看模型复杂度和策略损失带来的主观感受之间的关系。&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38417800&quot;&gt;《追求卓越，但接受交易中的不完美》&lt;/a&gt;一文曾阐述了如下观点：一个策略投放到实盘时最大的敌人是交易者的心理关。&lt;b&gt;这个心理关指的是交易者能否克服实盘中的心理压力从而坚持使用这个策略。&lt;/b&gt;对于任何一个量化投资策略，几乎可以确定的是它在回测中的表现是其在实盘中表现的上限。在实际交易中，价格时刻在波动，充斥着噪音的各路消息以远超过我们能够接受的速度涌来，使人快步踏入行为金融学中的各种认知偏差陷阱、丧失冷静；&lt;b&gt;面对真金白银的亏损，交易者会比想象的更脆弱、更容易怀疑策略的开发中是否存在没有考虑到的问题（对于复杂策略更是如此）、自我动摇想要放弃这个系统 —— 这就是损失带来的主观感受。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;当一个策略持续出现回撤，亏损超过回测中最大回撤时，复杂度是否对亏损带给我们的痛苦程度（以及对策略不自信的程度）造成影响呢？&lt;/p&gt;&lt;p&gt;为了回答这个问题，自然要建模。建模的流程如下图所示。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-247d59a129732ccb0917e5b68e0ca542_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;456&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-247d59a129732ccb0917e5b68e0ca542&quot; data-watermark-src=&quot;v2-4fd21563db72cd2ef48c4f6df54be0a8&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这个流程中有三处需要建模：（1）模型复杂度和胜率的关系；（2）胜率和收益率分布均值的关系；（3）模型复杂度和最大回撤与亏损造成的痛苦的关系。下面分别说明。&lt;/p&gt;&lt;p&gt;假设模型复杂度和胜率的关系如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;w=w_0+0.003k+0.01\mbox{NL}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中  &lt;equation&gt;w_0&lt;/equation&gt;  是基础胜率（假设等于 0.5）， &lt;equation&gt;k&lt;/equation&gt;  代表模型中参数的个数，NL 为 binary 变量，取值 0 或者 1，代表模型是否为非线性的（NL = 1 表示非线性）。Disclaimer：本模型没有任何 reference，只是我为了得到量化分析结果选用的一个简单模型。&lt;/p&gt;&lt;p&gt;假设单期收益率满足标准差为 1% 的正态分布，均值则和胜率有关。胜率代表着单期收益率大于等于零的概率，因此我们必须选择均值以满足  &lt;equation&gt;\mbox{prob}(r ≥ 0) = w&lt;/equation&gt; 。根据这个关系，可以求出均值为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mu=-\mbox{ISF}(w)\times\sigma&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 ISF 表示标准正态分布的 inverse survival function。&lt;/p&gt;&lt;p&gt;得到单期收益率的分布之后，就可以构建任意长度的收益率序列。分析中，我们构建长度为 1000 的序列，以此作为该复杂度下假想策略的收益曲率序列的一个实现，并计算出它的 NAV。有了 NAV 就可以计算出它的最大回撤（max drawdown，MDD）。假设亏损造成的痛苦（记为  &lt;equation&gt;H&lt;/equation&gt; ）和最大回撤以及模型复杂度的关系如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;H=e^{(k-1+10\mbox{NL})/C}\times\mbox{MDD}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上述模型（disclaimer：同样没有任何 reference）说明 &lt;equation&gt;H&lt;/equation&gt; 由两部分组成：模型复杂度和最大回撤。由该模型的表达式可知，在同样的最大回撤下，不同的模型复杂度给人的主观感受是不一样的，&lt;b&gt;模型复杂度非线性的放大了亏损造成的痛苦&lt;/b&gt;。当  &lt;equation&gt;k = 1&lt;/equation&gt; （模型至少有一个参数）且模型为非线性（NL = 0）时， &lt;equation&gt;H&lt;/equation&gt;  的第一项为 1，因此它仅由最大回撤决定。当模型复杂度上升时，对复杂模型的惩罚程度由参数 &lt;equation&gt;C&lt;/equation&gt; （非负实数）控制。 &lt;equation&gt;C&lt;/equation&gt;  越小说明对模型复杂度的惩罚越高（即复杂模型会显著放大最大回撤造成的痛苦程度）。&lt;/p&gt;&lt;p&gt;结合上述胜率和痛苦程度的模型可知，模型复杂度可以增加胜率（hopefully），但它是以提高亏损造成的主观痛苦为代价的。因此，在这二者之间存在一个平衡。&lt;/p&gt;&lt;p&gt;下面来看一些实验结果。对于每一个给定的模型复杂度，随机产生 2000 个长度各为 1000 的收益率序列，并计算它们的最大回撤以及痛苦程度  &lt;equation&gt;H&lt;/equation&gt; ，取这 2000 个实验的均值作为该模型复杂度下损失造成的痛苦程度的度量。&lt;/p&gt;&lt;p&gt;首先考虑线性模型，即 NL = 0 的情况。下面三张图分别显示了  &lt;equation&gt;C&lt;/equation&gt;  取不同数值时，参数个数  &lt;equation&gt;k&lt;/equation&gt;  和  &lt;equation&gt;H&lt;/equation&gt;  的关系：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9693ba67ae9f313c90b56e6cb1283703_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1254&quot; data-rawheight=&quot;330&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9693ba67ae9f313c90b56e6cb1283703&quot; data-watermark-src=&quot;v2-d78bcad440cc4840a5ae4311512ddb98&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;当  &lt;equation&gt;C&lt;/equation&gt;  很大时，我们对模型复杂度的惩罚很低，模型复杂度的作用单边体现在提高胜率上。更高的胜率意味着更低的最大回撤，因此随着模型参数的增加，痛苦程度逐渐降低。当  &lt;equation&gt;C&lt;/equation&gt;  很小时，情况正好相反。模型每增加一个参数，造成的痛苦程度非线性急速攀升，大大的抵消掉高胜率造成的低回撤的影响，痛苦程度随模型复杂度单调上升。当 &lt;equation&gt;C&lt;/equation&gt; 取值中规中矩时，从上面中间的图中能够观察到胜率和痛苦程度之间的取舍，在理论上存在最佳的模型复杂度。&lt;/p&gt;&lt;p&gt;当 NL = 1 时，可以观察到和前面类似的结果（下图）。由于在  &lt;equation&gt;H&lt;/equation&gt;  的建模中，我们对 NL 的惩罚较高（系数为 10），因此对于同样的  &lt;equation&gt;C&lt;/equation&gt;  和  &lt;equation&gt;k&lt;/equation&gt; ，NL = 1 比 NL = 0 意味着更大的亏损痛苦。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f5237aec0e48ffa1ab6c29b46865be58_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1268&quot; data-rawheight=&quot;328&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f5237aec0e48ffa1ab6c29b46865be58&quot; data-watermark-src=&quot;v2-b5536ccc4cd78fa458ef9d3a3f100341&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上面的分析都是探索性的，并没有实证数据作为依据（难以找到使用不同模型复杂度策略的投资者并统计它们面对亏损时的不同感受）。我分析的初衷是，&lt;b&gt;在构建投资策略时，任何决定都要在得与失之间取舍。&lt;/b&gt;复杂模型在提高胜率的同时，也一定在某种程度上有它的弊端。从我有限的经验来说，在实盘中出现同样程度的亏损时，复杂的模型比简单的模型更让人不安。&lt;/p&gt;&lt;p&gt;在当下，我们越来越崇尚各种复杂的模型。本小节仅仅希望从一个完全不同的角度来提出一些思考：&lt;b&gt;我们在样本外是否 100% 做好了准备接受复杂模型？交易中存在各种认知偏差，如果我们连最简单的按一根均线做趋势追踪都无法坚决的执行，那又有什么来保证我们在面对实盘亏损时能够坚守复杂模型呢？如果我们不能坚守复杂模型，那么开发复杂模型所付出的心血和努力是否付之东流呢？&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;前不久我听了 Vanguard 题为《先锋领航多资产 FOF 策略及外部管理人选聘概览》的报告。感触最深的是当谈到对策略的看法时，先锋的观点是&lt;b&gt;策略的理念一定要简单 —— 能用一句话说清楚策略赚的什么钱，就不要用两句描述；策略的程序一定要可理解、完全透明。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;大道至简。&lt;/p&gt;&lt;p&gt;借用老罗的一句话那就是：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Simplicity is the hidden complexity.&lt;/i&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;当模型复杂度一样时，人们偏好风险收益特性更高的策略；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;当风险收益特性一样时，人们偏好模型复杂度更低的策略。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;各种复杂模型带来的边际超额收益能否 justify 它们的复杂度呢？拭目以待。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-08-23-42734509</guid>
<pubDate>Thu, 23 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>沙钢调价，市场是否买账？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-08-21-42573426.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/42573426&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-64616479e1bb5f8813da4dbcb7d777bf_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;写在前面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今天（8 月 21 日），沙钢对 8 月下旬螺纹钢上调 150 元/吨。虽然上调了价格，但是幅度却不及市场预期，前期大涨的螺纹钢期货出现了回调迹象。作为螺纹钢市场主要参考价格之一的沙钢，市场对它每月三次调价是否买账呢？我之前做过一些简单的实证如下。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 大红大紫螺纹钢&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今天我们聊聊商品期货，主角是在过去两年商品期货市场上大红大紫的一个品种 —— 螺纹钢。&lt;/p&gt;&lt;p&gt;2016 年的限产使得以螺纹钢、热卷、铁矿石以及绝代双焦（焦煤、焦炭）为代表的黑色商品经历了疯狂的一年；持续的上涨使得监管不得不出来及时给黑色系降温，这同时也吸引了大量的资金争先恐后的投入到了黑色商品的投资（机）中。而在黑色商品当中，最引人注目的无疑是螺纹钢。下图是来自券商报告统计的 2017 年我国不同商品期货的日均成交额，螺纹钢当仁不让，遥遥领先。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-84c9ec13033871162e977d7970f941fb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;455&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-84c9ec13033871162e977d7970f941fb&quot; data-watermark-src=&quot;v2-f8bb83f9e3a534f3f8ce2437cb5b0698&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;经济学上把投资、出口和消费比喻为拉动 GDP 增长的三驾马车。在未来的一段时间，投资恐怕仍然是拉动经济增长的主要动力。而无论是房地产还是基建，这些固定投资都要使用螺纹钢，它对经济发展的重要性不言而喻。&lt;/p&gt;&lt;p&gt;本文的目的是对螺纹钢期货市场做一个关于&lt;b&gt;事件驱动策略&lt;/b&gt;的简单实证，看看这个商品期货市场中的掌上明珠是否存在某种非有效性。&lt;/p&gt;&lt;p&gt;为了介绍这个实证，接下来首先看看本文的另一个主角 —— 沙钢集团。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 沙钢集团&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于任何一个商品期货，影响其价格走势的有四方面因素：&lt;b&gt;库存&lt;/b&gt;、&lt;b&gt;供应&lt;/b&gt;、&lt;b&gt;需求&lt;/b&gt;以及&lt;b&gt;现货价格&lt;/b&gt;。&lt;b&gt;对于螺纹钢来说，在市场中占重要地位的钢企的价格正是现货价格的风向标。&lt;/b&gt;那么，在我国有哪些重要钢企呢？它们之中又是谁的价格比较受市场关注呢？&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;世界的钢产看中国、中国的钢产看河北。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这是业内的一句顺口溜。在京津冀地区，有诸如河钢、首钢这些重要钢铁企业，而在华东地区，有一个非常重要的钢企：&lt;b&gt;江苏沙钢集团&lt;/b&gt;。世界钢铁协会发布的《世界钢铁统计数据 2017》根据粗钢产量评选出了全球 50 大钢铁企业，其中来自中国的宝武集团（宝钢吸收了武钢）、河钢、沙钢、鞍钢和首钢分列第 2、3、6、7 和 9 位。而前三者更是连续进入《财富》杂志评选的世界 500 强榜单，足见它们的地位。&lt;/p&gt;&lt;p&gt;这些大钢企对不同的品种有着各自的影响。比如对于板材来说，市场关注的是宝钢的价格。而对于螺纹钢来说，市场关注的则是沙钢的价格。如今，沙钢的调价不仅仅是华东地区，它在全国范围内也有一定的影响，对期货市场的后续走势有一定参考意义。&lt;/p&gt;&lt;p&gt;按照惯例，沙钢每个月逢 1 调价，即在每月的 1、11 和 21 号会给出最新的指导价格。比如下图就是我的钢铁网报道的 2016 年 11 月 11 号沙钢发布的最新价格信息（我们仅节选出了针对螺纹钢的部分）。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a8c6a865e7773506a512a98461a48fa9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;634&quot; data-rawheight=&quot;352&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a8c6a865e7773506a512a98461a48fa9&quot; data-watermark-src=&quot;v2-fd49d0d0deab22de1710b12399c652d4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在螺纹钢中有很多不同的规格，其中最常见的规格就是 HRB400 直径 16 – 25 mm 的这种（更细或者更粗都不是最常见规格，也都更贵）。因此，我们在实证中使用的就是沙钢对这种最常见规格的螺纹钢的调价信息。&lt;/p&gt;&lt;p&gt;在沙钢每旬调价时，一般的措辞是“上调 XXX”（比如上图例子中的“螺纹钢价格上调 500 元/吨”）、“下调 XXX”、以及“平稳”（说明较上一期没有变化）。按照正常的逻辑：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;上调意味着现货价格上升，期货价格继而会上涨；&lt;/li&gt;&lt;li&gt;下调意味着现货价格下降，期货市场继而会下跌；&lt;/li&gt;&lt;li&gt;不变意味着现货市场平稳，期货价格无显著反映。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;按照这个思路就可以构建一个事件驱动策略，来看看能否根据沙钢的调价相应的做多或做空螺纹钢期货，并获得收益。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 数据准备和策略构建&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;基于上面的说明，每次沙钢调价就是一个新的事件，而策略要对这个事件作出相应的反映。因此，事件发生后及时获取最新调价就格外重要。&lt;/p&gt;&lt;p&gt;&lt;b&gt;对于普通交易者来说，我们处于信息链的底端，在信息获取上没有速度优势。&lt;/b&gt;正因如此，我们对调价的准确性更加关注。毕竟，新的调价信息在不同投资者之间的传播速度不同，而人们对发生的事情的反应速度和程度也不同，这说明我们可以预期重大调价信息需要一定的时间才能充分反应到市场的价格中。实证中使用的信息来源就是我的钢铁网关于沙钢调价的报道。&lt;/p&gt;&lt;p&gt;上一节的例子中，该报道的发布时间是 2016 年 11 月 11 日，上午 10:13。则我们认为该事件于该时点发生，因此可以在这之后（从 10:14 开始）进行交易。在有些情况下，调价日（1、11、21 号）可能是个假日。由于假日休市且没有夜盘（正常交易日是有夜盘的；t 日的夜盘和 t + 1 日的日盘构成了一个完整交易日），在这种情况下，我的钢铁网通常会在下一个交易日早盘开盘前报道调价消息，这时便可以从早盘开盘时（上午 9 点）进行交易。&lt;/p&gt;&lt;p&gt;在投资品数据方面，实证中使用了螺纹钢主连的 1 分钟数据。&lt;b&gt;所谓主连就是把主力合约连起来构成的价格序列。每个商品都有多个不同到期月的合约，而它们之中持仓量最大的那个合约被称为主力合约。&lt;/b&gt;比如当前螺纹钢的主力合约就是 1810（即 2018 年 10 月份交割的合约），下一个主力合约将是 1901（即 2019 年 1 月份交割的合约）。随着 1810 合约交割月的临近，投资者将逐渐从交易 1810 合约切换到交易 1901 合约，那时 1901 合约就会变成主力合约。在这个主连序列中，当主力合约转换时，价格是不连续的；直接使用转换前后的价格计算收益率是有问题的。所幸的是，本文考虑的事件驱动策略持仓不会隔夜，一定会在收盘前平仓，因此主力合约切换时的价格跳变对它没有影响。&lt;/p&gt;&lt;p&gt;基于上面的描述，我们构建针对沙钢调价的螺纹钢事件驱动策略如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;每月追踪我的钢铁网报道的沙钢三次调价（1、11 和 21 日）；如果调价当天是个交易日则在调价后的下一分钟开始交易；如果调价当天休市，则在下一个交易日早盘开盘后第一时间交易。&lt;/li&gt;&lt;li&gt;具体的，如果价格上调，则做多螺纹钢主力合约；如果价格下调则做空螺纹钢主力合约；如果价格不变则不交易；以分配的资金对于螺纹钢收益暴露为 1 这个原则（即如果螺纹钢收益率变化 1%，我们的净值也变化 1%）计算仓位。&lt;/li&gt;&lt;li&gt;开仓后，持仓到收盘（下午 3 点）平仓。在不受沙钢调价影响的其他交易日，空仓。不考虑任何交易成本或滑点。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;实证中使用的螺纹钢主连 1 分钟数据范围是从 2015 年 12 月 21 日到 2018 年 4 月 20 日。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 实证结果&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节来看看这个针对沙钢调价的策略的效果。回测期内，该策略&lt;b&gt;在不考虑任何交易费用的前提下&lt;/b&gt;取得了年化收益率 9.38%、最大回撤 -4.01%、夏普率 1.22（假设无风险收益率为 0；因此这个数值更多的体现的是一个收益风险比），它的净值曲线如下图所示。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6f96a7678f7c10e0c10416e4ed94c39a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;464&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6f96a7678f7c10e0c10416e4ed94c39a&quot; data-watermark-src=&quot;v2-595850f1ac5fc9895ce0874f8f31470b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上述这个基础版的策略中假设在每天收盘时平仓。下面我们对持仓时间的长短如何影响策略的收益做进一步实验。假设开仓后，持有一段固定的时间；但如果固定的时间超过当日收盘，则在收盘时平仓。举两个例子：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;假如 10:35 开仓，持仓 30 分钟（交易时间、排除中午休市和上午 10:15 到 10:30 的休息），则平仓时间为上午 11:05。&lt;/li&gt;&lt;li&gt;假如 10:35 开仓，持仓 210 分钟（交易时间、排除中午休市和上午 10:15 到 10:30 的休息），则持有 210 分钟将会超过收盘，因此在下午 15:00 收盘时平仓。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在实证中考虑的持仓时间长度为 30、60、90、120、150、180、210 以及 240 分钟。在不同的持仓时间取值下运行上述事件驱动策略，然后统计它们的收益和风险。该策略的年化收益率、最大回撤以及夏普率随持仓时间的变化如下图所示。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a52ccb4ef01e0bfabed6f47aa39f4054_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1002&quot; data-rawheight=&quot;728&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a52ccb4ef01e0bfabed6f47aa39f4054&quot; data-watermark-src=&quot;v2-ba23e5d542f6fb4d556866ba81e1ff5d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;随着持仓时间的增加，收益率和夏普率基本上单调递增，我们对此的猜测是它可能反应了市场对沙钢调价信息的持续消化过程。当然，随着持仓时间的增加，风险（波动）也增大，因此策略的最大回撤增大。&lt;/b&gt;这些定量的数据反映出来的策略的定性特征符合预期。&lt;/p&gt;&lt;p&gt;上述结果说明该策略似乎有效。不过，先别激动。&lt;/p&gt;&lt;p&gt;细心的读者也许发现了，这个策略的绝大部分收益都是在 2016 年获得的，而从 2017 年开始却鲜有作为（直到 2018 年 4 月份开始才又有一些收益）。如果从 2017 开始运行策略，该策略的收益率、最大回撤以及夏普率随持仓时间的变化如下图所示 —— &lt;b&gt;收益非常低。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1cd82de6926389b21ed7698434ebf903_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1003&quot; data-rawheight=&quot;722&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1cd82de6926389b21ed7698434ebf903&quot; data-watermark-src=&quot;v2-95a7711bd693e693d3292ea4fab93827&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这两个结果的对比是否说明该策略在 2016 年有效而在之后失效了呢？答案也是否定的 —— &lt;b&gt;因为这个策略即便是在赚钱的 2016 年，似乎也不是那么有效。&lt;/b&gt;请接着往下看。&lt;/p&gt;&lt;p&gt;正如本文开头提到的，2016 年可谓黑色产业链扬眉吐气的一年，所有黑色系的品种在去产能的基调下都疯狂的大涨。为了验证沙钢调价是否能带来超额收益，必须把上涨的趋势从策略的收益中剥离出来。&lt;/p&gt;&lt;p&gt;为此，对于 2016 年，我们的做法是先找出所有沙钢上调价格的交易日，记为集合 U；再找出所有上涨的交易日并排除掉属于 U 的，即那些和沙钢上调价格无关的上涨交易日，记为集合 X。同理，找出沙钢下调价格的交易日，记为集合 D；再找出所有和沙钢下调价格无关的下跌交易日，记为集合 Y。由于策略仅在日盘持仓，因此计算这四个集合内交易日的平均日盘收益率（即用当日的 15 点的收盘价和当日 9 点的开盘价计算出的收益率）。如果沙钢调价策略在 2016 年有效，则我们希望看到：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;U 集合内交易日的日盘收益率均值 &lt;b&gt;&amp;gt;&lt;/b&gt; X 集合内交易日的日盘收益率均值；&lt;/li&gt;&lt;li&gt;D 集合内交易日的日盘收益率均值 &lt;b&gt;&amp;lt;&lt;/b&gt; Y 集合内交易日的日盘收益率均值。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;事实是否如此呢？&lt;/p&gt;&lt;p&gt;数据显示，在 2016 年，在沙钢上调价格的交易日，日盘平均收益率为 0.87%，而在其他上涨的交易日，日盘平均收益率为 1.50%，因此上述第一个结果被推翻。同样的，在沙钢下调价格的交易日，日盘平均收益率为 -0.54%，而在其他下跌的交易日，日盘平均收益率为 -1.35%，上述第二个结果依然不成立。因此，&lt;b&gt;即便策略在 2016 年取得了正收益，也无法认为沙钢调价本身带来了超额收益。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语和讨论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;从量化的角度来说，沙钢调价对螺纹钢市场可以算是个事件驱动。然而数据分析表明，市场似乎早已对此有所反应，基于调价本身构建的策略并不能十分有效的获取超额收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于“沙钢调价，市场是否买账”这个问题，我曾询问过一位黑色商品交易经验丰富的前辈的看法，得到的回答是：&lt;b&gt;等沙钢最新调价信息出来后，市场已经反映的差不多了。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;库存、供给和需求都可以影响螺纹钢以及其他黑色商品的现货（及期货）价格。沙钢调价是从它自身的立场对其他三个因素的综合反应。换句话说，市场上的交易者也会根据其他三方面的变化提前作出判断，而绝非仅仅依赖沙钢的最新报价。&lt;/p&gt;&lt;p&gt;此外，人们会对沙钢的调价有一定的预期，&lt;b&gt;只有当实际的调价和预期不符时，它对市场的价格才会有比较重大的影响。&lt;/b&gt;比如，市场预期上涨 50 块，结果沙钢上调 100 块，这是会造成市场上涨的；而如果仅仅是上调 10 块，则可能会造成下跌，因为它没有到达人们的预期。&lt;/p&gt;&lt;p&gt;上述问题说明了针对这类信息直接构建策略的复杂性。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;p&gt;吴先兴 (2018). 商品期货 CTA 专题报告（五）：我国商品期货分类及异质性基本面分析概述. 天风证券.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-08-21-42573426</guid>
<pubDate>Tue, 21 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>跟着靠谱基金经理学选股</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-08-17-42267694.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/42267694&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-085acfe4080285de2c22f4cd8ee4c381_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;写在前面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;继续从公众号搬砖，本文写于 2018 年 5 月，因此实证结果仅到写作日期之前。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今年春节期间，朋友给我推荐了一个公众号：金融街老裘（ID：jinrongjielaoqiu）。根据公众号的说明，作者现任某知名私募合伙人，尤其擅长基本面选股，国内财报分析中的翘楚。这位老裘曾先后做过 10 年行业分析师以及 5 年基金经理，平均每年看 500 份上市公司的财务报告。&lt;/p&gt;&lt;p&gt;在我开始关注这个公众号之初，它先后推出了八篇文章，分别从&lt;b&gt;现金收入比&lt;/b&gt;、&lt;b&gt;净资产收益率&lt;/b&gt;、&lt;b&gt;人均创收和人均创利&lt;/b&gt;、&lt;b&gt;总资产周转率&lt;/b&gt;、&lt;b&gt;季度收入增长率&lt;/b&gt;、&lt;b&gt;商誉净资产比&lt;/b&gt;、&lt;b&gt;毛利率&lt;/b&gt;、以及&lt;b&gt;研发支出&lt;/b&gt;这些角度说明专业的基金经理是如何选股的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这八篇文章每篇介绍一个选股标准，既用通俗易懂的语言（通常都是小故事，直接拉近了这些财报指标和非专业读者之间的距离）说明每个指标背后的业务含义，又给出正、反两方的代表，有理有据，深入浅出，干货十足、颇有诚意。&lt;/b&gt;以现金收入比为例，老裘认为好的公司过去 5 年的现金收入比应均大于 100%，他给出的正方代表是贵州茅台，也是他的重仓股；而反方代表是乐视网。&lt;/p&gt;&lt;p&gt;就我个人的观点来看，对于做基本面分析的基金经理的文章，通常在阅读之前都是持有怀疑态度的。但是（一个大大的但是），&lt;b&gt;don&#39;t get me wrong&lt;/b&gt;。我绝对不怀疑市场上有做基本面分析非常优秀的人，他们也为客户带来和非常优秀的收益（比如这位老裘，据他自己介绍，2017 年的收益率在 40% 以上）。但让我略感不安的是，这类文章中所分析的内容 —— 无论是产业链分析还是公司研究 —— 都需要结合写文章时特定的宏观环境、经济政策。这些基本面分析的文章固然是原作者思想精华的总结，但是其中的方法论却难以被复现或者扩展，对于读者来说，读完了也就读完了，难以借鉴。&lt;/p&gt;&lt;p&gt;但这八篇不同，它们明确给出了在一个优秀的基金经理眼中，好的股票应该具备的特质。&lt;b&gt;我们能不能把这八个标准转换成八个选股因子呢？这是我关心的问题。在前面现金收入比的例子中，“现金收入比”可以被视为一个选股因子；而“过去五年现金收入比均大于 100%”则是基于这个因子的选股标准。&lt;/b&gt;也许我们无法仅仅根据五年现金收入比均大于 100% 而选出贵州茅台，但是如果大部分优秀的公司如果都具备该特征，那么使用现金收入比作为因子来选股，应该会让我们大概率挑出值得投资的股票。&lt;/p&gt;&lt;p&gt;所以，这篇实证应运而生。我想简单的在 A 股上对这八大标准做些分析，看看它们是否能成为优秀的选股因子。&lt;/p&gt;&lt;p&gt;最后强调一点，我不认识也从未见过这位老裘前辈，甚至连他是否真的姓裘都不清楚（因为圈子就那么大，做得好的早已是家喻户晓，所以有人可能不愿意用真名）。[金融街老裘] 这个公众号有着大量的拥趸，也无需我的顶或踩。我只是希望对这八条选股指标做一个客观的评价，希望它们都好使，这样便能为我所用。&lt;/p&gt;&lt;p&gt;由于八篇原作的目的不是选股，因此并没有明确给出构建选股因子的方法。在这方面，我需要根据老裘使用的八大标准来自由发挥，尽量贴近业务逻辑的构建八个因子。&lt;b&gt;如果因为我的理解或使用有误造成对因子效果解读的偏差，责任自然在我。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 八大标准&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;下表汇总了老裘的八大选股标准（&lt;b&gt;标准那一列&lt;/b&gt;）；另外本文的最后给出了原作的八篇文章的链接，感兴趣的朋友不妨读一读。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0ae27bcc4914aa6cc8180d2d6ea66cd1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;837&quot; data-rawheight=&quot;544&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-0ae27bcc4914aa6cc8180d2d6ea66cd1&quot; data-watermark-src=&quot;v2-caf46c480244deb2608b9b840439b23d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这些因子对应的计算公式如下，它们都可以从上市公司的财报中找到。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fea5a125207210e8962d03702bcd400b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;653&quot; data-rawheight=&quot;377&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fea5a125207210e8962d03702bcd400b&quot; data-watermark-src=&quot;v2-cb37bdab716fa34f875965182951b26d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;为了使用这八个标准选股，就必须把每一个视作一个选股因子，并围绕它在每个固定的时间点，使用个股的截面数据来构建因子投资组合，然后再在时序上来评价该因子投资组合的收益和风险情况。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面就来看看如何围绕着些选股标准来构建因子投资组合。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 构建因子组合&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在将选股标准转化为选股因子并构建因子投资组合的过程中，有几个客观存在的困难。&lt;/p&gt;&lt;p&gt;&lt;b&gt;首先是数据。&lt;/b&gt;在实证中，我们采用的是果仁网的回测平台 —— 用它来做因子选股性价比很好且容易事后评测。果仁网中并没有上市公司员工数的数据，因此第三个指标中的人均创收和人均创利就无法计算。所以我放弃了这个指标。&lt;/p&gt;&lt;p&gt;&lt;b&gt;第二个困难是构建投资组合时选股的依据。&lt;/b&gt;仔细观察不难发现，&lt;b&gt;老裘的八条标准都是用来筛选股票的，而非用来给股票排序的。&lt;/b&gt;比如中国石油和贵州茅台，它们都满足过去五年现金收入比均大于 100%；如果仅从这个因子考虑，它们之间又是孰优孰略呢？为了构建因子投资组合，必须能够以某种相对优劣关系对满足筛选标准的股票进行排序。从这个角度出发，对于标准 6 商誉净资产比和标准 8 研发支出就比较困难了。商誉净资产比以及研发支出并不是越大或者越小越好，它们的最优值更是无从说起。出于这个原因，我也放弃了这两个指标。&lt;/p&gt;&lt;p&gt;最终能构建因子组合的还剩下五个（当然，仍然需要解决如何排序的问题）：现金收入比、净资产收益率、总资产周转率、季度收入增长率、毛利率。&lt;/p&gt;&lt;p&gt;构建因子投资组合的主流方法中包括 Barra 的纯因子组合；或者业内常用的按因子将个股排序，然后做多最好的一些并做空最差的一些。在本次实证中，由于原作对这些因子有特定的使用方法（比如过去五年的 XX 超过 XX%），因此 Barra 的那一套并不适用，故我们采用传统的排序法。这种方法的缺点是无法排除因子之间的相关性，所以围绕目标因子构建的因子组合可能对别的因子有微弱的（但是不可避免的）暴露。&lt;/p&gt;&lt;p&gt;由于果仁网在回测中无法直接做空个股，因此我们“曲线救国”分别构建 top 和 bottom 组合（分别对应按照某个因子选出来的最好的和最差的股票组合），并用它们的收益率&lt;b&gt;之差&lt;/b&gt;模拟“做多 top 组合、做空 bottom 组合”。&lt;b&gt;在实证中，这两个组合的选股频率是动态的，但是它们的金额再平衡频率是按月的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于每个因子，构建因子投资组合的思路如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;按照原作中的标准来筛选出满足的股票；然后将这些股票按照该因子最新一期的取值从好到差排序；动态选择前 n 支股票（与具体投资组合的构建逻辑有关，会在本文第 4 节说明）构建一个 top 组合；&lt;/li&gt;&lt;li&gt;按照与原作中业务逻辑&lt;b&gt;相反&lt;/b&gt;的标准筛选出满足的股票；将这些股票按照该因子最新一期的取值从差到好排序；动态选择前 n 支股票（方法同上）构建一个 bottom 组合；&lt;/li&gt;&lt;li&gt;使用 top 组合和 bottom 组合的收益差作为该因子的收益率（这相当于同时做多 top 组合、做空 bottom 组合）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;按照上述主导思想，对每个因子组合具体的 top 和 bottom 组合的选股依据如下：&lt;br&gt;&lt;b&gt;现金收入比&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Top 组合：&lt;/b&gt;使用“过去五年现金收入比均&lt;b&gt;大于&lt;/b&gt; 100%”筛选；使用“过去 12 个月的现金收入比”&lt;b&gt;从大到小&lt;/b&gt;排序；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Bottom 组合：&lt;/b&gt;使用“过去五年现金收入比均&lt;b&gt;小于&lt;/b&gt; 100%”筛选；使用“过去 12 个月的现金收入比”&lt;b&gt;从小到大&lt;/b&gt;排序。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;净资产收益率&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Top 组合：&lt;/b&gt;使用“过去五年净资产收益率均&lt;b&gt;大于&lt;/b&gt; 15%”筛选；使用“过去 12 个月的净资产收益率”&lt;b&gt;从大到小&lt;/b&gt;排序；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Bottom 组合：&lt;/b&gt;使用“过去五年净资产收益率均&lt;b&gt;小于&lt;/b&gt; 15%”筛选；使用“过去 12 个月的净资产收益率”&lt;b&gt;从小到大&lt;/b&gt;排序。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;总资产周转率&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Top 组合：&lt;/b&gt;使用“过去五年总资产周转率均&lt;b&gt;大于&lt;/b&gt; 100%”筛选；使用“过去 12 个月的总资产周转率”&lt;b&gt;从大到小&lt;/b&gt;排序；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Bottom 组合：&lt;/b&gt;使用“过去五年总资产周转率均&lt;b&gt;小于 50%&lt;/b&gt;”筛选；使用“过去 12 个月的总资产周转率”&lt;b&gt;从小到大&lt;/b&gt;排序。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;季度收入增长率&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Top 组合：&lt;/b&gt;使用“过去八个季度每季度收入同比增长均&lt;b&gt;大于&lt;/b&gt; 15%”筛选；使用“最新季度收入同比增长”&lt;b&gt;从大到小&lt;/b&gt;排序；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Bottom 组合：&lt;/b&gt;使用“过去八个季度每季度收入同比增长均&lt;b&gt;小于&lt;/b&gt; 15%”筛选；使用“最新季度收入同比增长”&lt;b&gt;从小到大&lt;/b&gt;排序。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;毛利率&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Top 组合：&lt;/b&gt;使用“过去五年的毛利率均&lt;b&gt;大于&lt;/b&gt; 20%”筛选；使用“过去 12 个月的毛利率”&lt;b&gt;从大到小&lt;/b&gt;排序；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Bottom 组合：&lt;/b&gt;使用“过去五年的毛利率均&lt;b&gt;小于&lt;/b&gt; 20%”筛选；使用“过去 12 个月的毛利率”&lt;b&gt;从小到大&lt;/b&gt;排序。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;最后需要说明的是，考虑到银行和非银金融的特殊性，在构建因子投资组合时，无论是 top 组合还是 bottom 组合，均排除了这两个行业。&lt;/b&gt;此外，如果&lt;b&gt;新选出来&lt;/b&gt;的是 ST，则跳过；如果已经在组合中的股票变成 ST 则不做特殊处理。如果&lt;b&gt;新选出来&lt;/b&gt;的股票停牌则跳过，以免对应仓位空置；如果已经在投资组合中的股票被停牌，则不做特殊处理。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 在 A 股上的实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;有了因子投资组合，我们就可以对这些因子在 A 股上进行实证。在为每个因子构建 top 和 bottom 投资组合时，采用如下的交易模型：&lt;/p&gt;&lt;p&gt;每日更新因子并重新排名，新股理想仓位为 5%，上下各浮动 1.5%（因此组合中股票数量为 20 到 29 支）；空闲资金购买银华日利（货币基金）；卖出条件为股票按因子的最新排名超过 20；为了避免换手率过高，要求每个股票买入后必须持有不少于 20 个交易日 （事实上，由于财报数据更新的很慢，选入投资组合的股票都会被持有较长时间，平均持仓时间超过 80 个交易日），且在卖出时不考虑涨停的股票；单边交易费用为千分之一、假设按照收盘价交易。&lt;/p&gt;&lt;p&gt;按上述交易模型就可以在回测期内得到每个因子 top 和 bottom 组合的表现。对这两个组合的资金按月再平衡，它们的收益差就是因子投资组合的收益。回测期为 2011 年 1 月 3 日到 2018 年 5 月 3 日。使用回测期内的因子组合的时序收益率就可以评价因子的表现。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在老裘的原文中，并没有特别说明这些因子是否主要是针对蓝筹股（尽管我猜测可能是更适合蓝筹股），也没有说明这些因子在历史中的哪个时间段有效（因子都有周期性，因此这些因子不太可能一直有效）。&lt;/b&gt;为此，我们先使用果仁网上所有的股票池测试（下称全集测试）、然后再仅用沪深 300 的成分股作为选股池测试（下称蓝筹测试）。所有的股票池以下指数的成分股（有重叠）：上证 50、沪深 300、中证 500、中证 1000、中小板、创业板、中证红利。&lt;/p&gt;&lt;p&gt;这五个因子在全集测试中的表现如面五张图所示。每张图中，蓝色为 top 组合的净值、黄色为 bottom 组合的净值、&lt;b&gt;绿色&lt;/b&gt;为因子组合的净值。&lt;b&gt;我们最关注的是绿色曲线。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-86a17a534d83604fc14adfbc32a20027_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1116&quot; data-rawheight=&quot;584&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-86a17a534d83604fc14adfbc32a20027&quot; data-watermark-src=&quot;v2-892b24ca83104da1517144870fb6f889&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-7d3f88dd1a8087c39d6dcd5a506c4160_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1126&quot; data-rawheight=&quot;582&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7d3f88dd1a8087c39d6dcd5a506c4160&quot; data-watermark-src=&quot;v2-2bd7a379c2ea18a6e72e91bfc0d57a82&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-eaccef6ede1a4dd142499dbfba8473e2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1119&quot; data-rawheight=&quot;580&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-eaccef6ede1a4dd142499dbfba8473e2&quot; data-watermark-src=&quot;v2-b20ca92f2260d051e85b48daade46a61&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4e4cab0d2067c16e4f4c6a43e0245c91_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1125&quot; data-rawheight=&quot;582&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4e4cab0d2067c16e4f4c6a43e0245c91&quot; data-watermark-src=&quot;v2-23cf223bdd99c2156cbbf67521f58d0a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-682306283ca58325a13cd1b11d401cb2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1125&quot; data-rawheight=&quot;573&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-682306283ca58325a13cd1b11d401cb2&quot; data-watermark-src=&quot;v2-70923d3ef8c70d664d1b3d3fd23c37da&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我们的回测期从 2011 年到 2018 年，这其中 2016 年前后可以做一个分界：自 2016 年开始，价值投资回归。观察这些因子在&lt;b&gt;全集测试&lt;/b&gt;上的表现可以得到如下结论：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;现金收入比持续有效；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;净资产收益率在价值投资回归后有效；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;总资产周转率持续无效；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;季度收入增长率在2014年之前有效、之后无效；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;毛利率基本无效，波动较大，算是一个风险因子而非 α 因子。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;再来看看这些因子在沪深 300 上的表现（同样排除了银行和非银金融，图中黑色浅实线为沪深 300 自身的走势）。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c955705098bd9560bafe919400cbc5a2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1120&quot; data-rawheight=&quot;563&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c955705098bd9560bafe919400cbc5a2&quot; data-watermark-src=&quot;v2-84e4c23b3806f787e6a77c093205c48d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6318434d1d9ca9c3acced8c783b0a5a4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1137&quot; data-rawheight=&quot;570&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6318434d1d9ca9c3acced8c783b0a5a4&quot; data-watermark-src=&quot;v2-1bc749c7333c2d76df065442ef44e972&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8a92fcea4db480266b2f32aabf5e24f2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1120&quot; data-rawheight=&quot;574&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8a92fcea4db480266b2f32aabf5e24f2&quot; data-watermark-src=&quot;v2-62a4444a20923ec050663de768864bfe&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6bfbe56f93a063be000df2f0efe7099a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1134&quot; data-rawheight=&quot;570&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6bfbe56f93a063be000df2f0efe7099a&quot; data-watermark-src=&quot;v2-f01f949ef96b251a2495bba7f8ca719e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d8a9224dd0540467436ae42c8b4dcf7f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;573&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d8a9224dd0540467436ae42c8b4dcf7f&quot; data-watermark-src=&quot;v2-bcd06d2580f220277f3899ee400b874e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;观察这些因子在&lt;b&gt;蓝筹股&lt;/b&gt;测试上的表现可以得到如下结论：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;现金收入比、净资产收益率和总资产周转率这三个因子均在价值投资回归后非常有效；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;季度收入增长率持续无效；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;毛利率收益大、波动大，更像是一个风险因子而非 α 因子。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;由于在现实中无法做空，因此除了因子收益率之外，我们更关注 top 组合。在这五个因子中，除了净资产收益率，其他四个因子的 top 组合都无法显著跑赢指数本身。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;从本文的实证来看，大部分考察的因子是能够取得超额收益的 —— 特别是在价值投资回归之后。因此可以说靠谱基金经理的选股逻辑从业务上说是站得住脚的。但是，仅仅使用这些因子，我们是无法选出贵州茅台、格力电器的。我们需要对这些因子的作用有正确的认识。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;15+ 年的从业经历，每年 500+ 篇财报的分析，这相当于分析了 7500 到 10000 篇研报。这些日复一日、年复一年的努力构成了老裘对行业的深刻理解和财报的敏锐洞察力。&lt;b&gt;这种功底不是我们精读区区八篇公众号文章能获得的。&lt;/b&gt;但是这些文章对于我们的价值不仅仅是教给我们八个因子，更重要的是它们背后传递出的作者在挖掘优秀上市公司时秉承的逻辑。&lt;/p&gt;&lt;p&gt;这位老裘非常勤奋而且高产，公众号基本上每天一篇。虽然篇幅不长且言简意赅，但对我来说还是有些 overwhelming。但是，坚持读下来还是能从字里行间感受到一个优秀基金经理对财报解读的特有视角，这种潜移默化也许在某一天能够帮助我们积跬步而致千里。而坚持原创、对知识无偿分享的 [金融街老裘] 也是令人钦佩的。&lt;/p&gt;&lt;p&gt;投资中并无捷径。&lt;/p&gt;&lt;p&gt;最后附上这八个选股标准的原文链接：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483697&amp;amp;idx=1&amp;amp;sn=701bf7d304ac1c9fc869e81d8ecc81df&amp;amp;scene=21#wechat_redirect&quot;&gt;现金收入比&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483703&amp;amp;idx=1&amp;amp;sn=fe9302929ec9aa3c3d75224ef6091120&amp;amp;scene=21#wechat_redirect&quot;&gt;净资产收益率&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483707&amp;amp;idx=1&amp;amp;sn=8e78ccd970390372a8dc139742aa8d1f&amp;amp;scene=21#wechat_redirect&quot;&gt;人均创收、人均创利&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483710&amp;amp;idx=1&amp;amp;sn=8b16efb739ce874dc80a775acac4bb5f&amp;amp;scene=21#wechat_redirect&quot;&gt;总资产周转率&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483714&amp;amp;idx=1&amp;amp;sn=b8dfd0b44bb392ee77f8ef1735644927&amp;amp;scene=21#wechat_redirect&quot;&gt;季度收入增长率&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483719&amp;amp;idx=1&amp;amp;sn=ec773c01c1e5e63eda34e5647545b7dc&amp;amp;scene=21#wechat_redirect&quot;&gt;商誉净资产比&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483723&amp;amp;idx=1&amp;amp;sn=5fabafab9653e559006af60ea3e4a51f&amp;amp;scene=21#wechat_redirect&quot;&gt;毛利率&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUyMTExNDYyMQ==&amp;amp;mid=2247483727&amp;amp;idx=1&amp;amp;sn=937ff90628ae0004ab401aa2b206fc6b&amp;amp;scene=21#wechat_redirect&quot;&gt;研发支出&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-08-17-42267694</guid>
<pubDate>Fri, 17 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>为什么要进行因子正交化处理？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-08-14-41993542.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41993542&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ffeb3a745e02996636484b501d9b0604_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;选股多因子模型中常进行因子正交化处理。如果因子之间不满足正交性，则它们会相互影响各自的回归系数，这可能造成回归系数过大的估计误差，对因子的评价产生负面影响。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 多因子模型求解&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在选股多因子模型中，人们常提到的一个概念是&lt;b&gt;因子正交化处理&lt;/b&gt;。本文就从多因子截面回归求解的角度来简单说说为什么我们喜欢相互正交的因子，以及如果因子之间不正交对回归系数会有什么影响。&lt;/p&gt;&lt;p&gt;一个多因子模型可以写成如下的形式：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf y=\mathbf X\mathbf b+\mathbf ε&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;\mathbf y&lt;/equation&gt; 是 &lt;equation&gt;N × 1&lt;/equation&gt; 阶股票下一期的收益率向量， &lt;equation&gt;\mathbf X&lt;/equation&gt; 为 &lt;equation&gt;N × K&lt;/equation&gt; 阶当期的因子暴露矩阵， &lt;equation&gt;\mathbf b&lt;/equation&gt; 为 &lt;equation&gt;K × 1&lt;/equation&gt; 阶待通过回归求解得到的因子收益率向量， &lt;equation&gt;\mathbf ε&lt;/equation&gt;  为 &lt;equation&gt;N × 1&lt;/equation&gt; 阶残差向量。假设  &lt;equation&gt;\mathbf X&lt;/equation&gt; 满足列满秩，则上述模型的 OLS（ordinary least squares）回归求解为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf b=\left(\mathbf X^T\mathbf X\right)^{-1}\mathbf{X}^T\mathbf y&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;需要注意的是，在上面这个模型以及  &lt;equation&gt;\mathbf b&lt;/equation&gt;  的表达式中，&lt;b&gt;因子向量 &lt;/b&gt;&lt;equation&gt;\mathbf X&lt;/equation&gt;&lt;b&gt; 已经包括了所有的 regressors，因此回归模型右侧没有额外的截距项&lt;/b&gt;。这意味着，如果我们假设截距项也是一个因子，则它对应的 &lt;equation&gt;N × 1&lt;/equation&gt; 阶向量 &lt;equation&gt;[1,1,…,1]^T&lt;/equation&gt; 已经作为  &lt;equation&gt;\mathbf X&lt;/equation&gt;  的某一列（通常是第一列）存在于  &lt;equation&gt;\mathbf X&lt;/equation&gt;  之中了；如果我们假设截距项不是一个因子，则  &lt;equation&gt;\mathbf X&lt;/equation&gt;  中没有 &lt;equation&gt;[1,1,…,1]^T&lt;/equation&gt; 这一列。&lt;/p&gt;&lt;p&gt;在 Barra 的多因子模型 CNE5 中考虑了国家因子，所有个股在该因子上的暴露都是 1，因此它的作用就相当于一个截距因子； &lt;equation&gt;[1,1,…,1]^T&lt;/equation&gt; 这个向量在 Barra 模型中正是  &lt;equation&gt;\mathbf X&lt;/equation&gt;  的第一列。另外，对于我们最熟悉的 simple regression model，它的右侧只有一个截距和一个解释变量：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;y_i=a+bx_i+\varepsilon_i&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;按照上述说明，该模型对应的矩阵  &lt;equation&gt;\mathbf X&lt;/equation&gt;  包括两列：一列对应截距，一列对应真正的解释变量  &lt;equation&gt;\mathbf x&lt;/equation&gt; ：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf X=\left[ \begin{array}{cc} 1&amp;amp;x_1\\ 1&amp;amp;x_2\\ \vdots&amp;amp;\vdots\\ 1&amp;amp;x_N \end{array} \right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;从  &lt;equation&gt;\mathbf b&lt;/equation&gt;  的表达式来看，它和 &lt;equation&gt;\mathbf X^T\mathbf X&lt;/equation&gt; 有关。&lt;b&gt;当 &lt;/b&gt;&lt;equation&gt;\mathbf X&lt;/equation&gt;&lt;b&gt; 的各列（即回归模型中的不同解释变量，或我们研究问题中的不同因子暴露向量）之间不正交时，则在计算&lt;/b&gt; &lt;equation&gt;\mathbf X^T\mathbf X&lt;/equation&gt;&lt;b&gt; 乃至最终的 &lt;/b&gt;&lt;equation&gt;\mathbf b&lt;/equation&gt;&lt;b&gt; 时，&lt;/b&gt; &lt;equation&gt;\mathbf X&lt;/equation&gt; &lt;b&gt; 不同列之间是相互影响的，而这种影响不是什么好事儿。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 简单一元回归&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;让我们从最简单的一元回归（simple univariate regression）说起。&lt;/p&gt;&lt;p&gt;假设有一元回归模型 &lt;equation&gt;\mathbf y = b\mathbf x + \mathbf ε&lt;/equation&gt; （模型右侧只有一个解释变量，&lt;b&gt;没有截距项&lt;/b&gt;）。对于两个同阶向量 &lt;equation&gt;\mathbf m&lt;/equation&gt; 和  &lt;equation&gt;\mathbf n&lt;/equation&gt; ，令 &lt;equation&gt;\langle\mathbf m, \mathbf n\rangle&lt;/equation&gt; 表示它们的內积，即 &lt;equation&gt;\langle\mathbf m, \mathbf n\rangle=\sum m_in_i&lt;/equation&gt; ，则该一元回归模型的 OLS 解为（求解对象就是标量  &lt;equation&gt;b&lt;/equation&gt; ）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle b=\frac{\langle\mathbf x,\mathbf y\rangle}{\langle\mathbf x,\mathbf x\rangle}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;这个结论非常简单，但是它十分重要。在上一节中，我们给出了多元回归 OLS 求解的表达式：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf b=\left(\mathbf X^T\mathbf X\right)^{-1}\mathbf{X}^T\mathbf y&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;比较一元回归模型的标量  &lt;equation&gt;b&lt;/equation&gt;  和多元回归模型的向量  &lt;equation&gt;\mathbf b&lt;/equation&gt;  不难发现如下现象：在多元回归模型中，如果所有的解释变量两两正交，即 &lt;equation&gt;\langle\mathbf x_i, \mathbf x_j\rangle=0,i\ne j&lt;/equation&gt; ，则向量  &lt;equation&gt;\mathbf b&lt;/equation&gt;  中的每一个系数  &lt;equation&gt;b_i&lt;/equation&gt;  恰恰等于：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle b_i=\frac{\langle\mathbf x_i,\mathbf y\rangle}{\langle\mathbf x_i,\mathbf x_i\rangle}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;这是因为 &lt;equation&gt;\langle\mathbf x_i, \mathbf x_j\rangle=0&lt;/equation&gt; 保证了 &lt;equation&gt;\mathbf X^T\mathbf X&lt;/equation&gt; 的所有非对角元素都是 0，因此它是一个对角阵。对角阵的逆矩阵就是把该对角阵对角线上的元素都取倒数，所以逆矩阵仍然是对角阵。因此， &lt;equation&gt;\mathbf X^T\mathbf X&lt;/equation&gt;  的第 &lt;equation&gt;i&lt;/equation&gt; 个对角元素为 &lt;equation&gt;1/\langle\mathbf x_i, \mathbf x_i\rangle&lt;/equation&gt; 。另一方面， &lt;equation&gt;\mathbf X^T\mathbf y&lt;/equation&gt; 是一个 &lt;equation&gt;K × 1&lt;/equation&gt; 向量，它的第 &lt;equation&gt;i&lt;/equation&gt; 个元素是 &lt;equation&gt;\mathbf x_i&lt;/equation&gt; &lt;equation&gt;\mathbf y&lt;/equation&gt; 和 &lt;b&gt;y&lt;/b&gt; 的內积，即 &lt;equation&gt;\langle\mathbf x_i, \mathbf y\rangle&lt;/equation&gt; 。最终，多元回归的 &lt;equation&gt;b_i&lt;/equation&gt; 正是 &lt;equation&gt;\langle\mathbf x_i, \mathbf y\rangle/\langle\mathbf x_i, \mathbf x_i\rangle&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;怎么样？ &lt;equation&gt;b_i&lt;/equation&gt; 和一元回归中的 &lt;equation&gt;b&lt;/equation&gt; 的表达式一模一样，说明&lt;b&gt;当所有解释变量相互正交时，不同的因子（即 &lt;/b&gt;&lt;equation&gt;\mathbf x_i&lt;/equation&gt; &lt;b&gt;）对彼此的参数估计（即&lt;/b&gt; &lt;equation&gt;b_i&lt;/equation&gt; &lt;b&gt;，因子收益率）没有任何影响。&lt;/b&gt;这便是正交的好处。&lt;/p&gt;&lt;p&gt;那么，当因子（解释变量）之间不正交时又会怎样呢？为了回答这个问题，我们首先来看看回归的几何意义。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 回归的几何意义&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;将  &lt;equation&gt;\mathbf b&lt;/equation&gt;  的表达式代入回归模型得到  &lt;equation&gt;\mathbf ε&lt;/equation&gt;  的表达式，并计算  &lt;equation&gt;\mathbf X&lt;/equation&gt;  和  &lt;equation&gt;\mathbf ε&lt;/equation&gt;  的內积有；&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} \mathbf X^T\mathbf\varepsilon&amp;amp;=&amp;amp;\mathbf X^T(\mathbf y-\mathbf X\mathbf b)\\ &amp;amp;=&amp;amp;\mathbf X^T(\mathbf y-\mathbf X\left(\mathbf X^T\mathbf X\right)^{-1}\mathbf{X}^T\mathbf y)\\ &amp;amp;=&amp;amp;\mathbf X^T\mathbf y-\left(\mathbf X^T\mathbf X\right)\left(\mathbf X^T\mathbf X\right)^{-1}\mathbf{X}^T\mathbf y\\ &amp;amp;=&amp;amp;\mathbf X^T\mathbf y-\mathbf X^T\mathbf y\\ &amp;amp;=&amp;amp;\mathbf 0 \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式说明，OLS 的残差  &lt;equation&gt;\mathbf ε&lt;/equation&gt;  和解释变量  &lt;equation&gt;\mathbf X&lt;/equation&gt;  正交。来看看这在几何上意味着什么。&lt;/p&gt;&lt;p&gt;首先考虑最简单的情况，即一元回归 &lt;equation&gt;\mathbf y = b\mathbf x + \mathbf ε&lt;/equation&gt; （再次提醒，没有截距项）。它的几何意义如下图所示：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-185db899e9c6f53b227b89ad493572d3_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;554&quot; data-rawheight=&quot;251&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-185db899e9c6f53b227b89ad493572d3&quot; data-watermark-src=&quot;v2-0f1ed0d3b9202ea4cd7de3fd6908685f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这个图说明，OLS 回归实际上将  &lt;equation&gt;\mathbf y&lt;/equation&gt; &lt;b&gt;垂直投影到（orthogonally projected onto）&lt;/b&gt; &lt;equation&gt;\mathbf x&lt;/equation&gt; &lt;b&gt; 之上&lt;/b&gt;，使得 &lt;equation&gt;\mathbf y&lt;/equation&gt; 和其在 &lt;equation&gt;\mathbf x&lt;/equation&gt; 上的投影之间的距离（ &lt;equation&gt;\mathbf ε&lt;/equation&gt;  的长度）最短（残差平方和最小）。这就是 OLS 的几何意义。&lt;/p&gt;&lt;p&gt;再来看看二元回归 &lt;equation&gt;\mathbf y = b_1\mathbf x_1 + b_2\mathbf x_2 + \mathbf ε&lt;/equation&gt; ，并首先&lt;b&gt;假设 &lt;/b&gt;&lt;equation&gt;\mathbf x_1&lt;/equation&gt; &lt;b&gt;和 &lt;/b&gt;&lt;equation&gt;\mathbf x_2&lt;/equation&gt; &lt;b&gt;之间是正交的&lt;/b&gt;。该回归的几何意义如下：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ccc579278e4407ffdb1f948524cfc859_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;601&quot; data-rawheight=&quot;442&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ccc579278e4407ffdb1f948524cfc859&quot; data-watermark-src=&quot;v2-567923869b016a6a04053f7258459c2b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;对于二元回归，它的几何意义是将 &lt;equation&gt;\mathbf y&lt;/equation&gt; 垂直投影到由 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_2&lt;/equation&gt; 生成的超平面内，其投影正如上图中绿色向量所示。此外，我们可以分别、独立的将  &lt;equation&gt;\mathbf y&lt;/equation&gt;  投影到 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_2&lt;/equation&gt; 上（图中两个橘黄色向量）。在本例中，&lt;b&gt;由于 &lt;/b&gt;&lt;equation&gt;\mathbf x_1&lt;/equation&gt; &lt;b&gt;和 &lt;/b&gt;&lt;equation&gt;\mathbf x_2&lt;/equation&gt; &lt;b&gt;相互正交（垂直），因此绿色向量恰好等于两个橘黄色向量之和。&lt;/b&gt;这说明当 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_2&lt;/equation&gt; 正交时，回归系数 &lt;equation&gt;b_i&lt;/equation&gt; 仅由 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和 &lt;equation&gt;\mathbf y&lt;/equation&gt; 决定、其他任何解释变量 &lt;equation&gt;\mathbf x_j (j ≠ i)&lt;/equation&gt; 对 &lt;equation&gt;b_i&lt;/equation&gt; 均没有影响。&lt;/p&gt;&lt;p&gt;下面来看看 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_2&lt;/equation&gt; &lt;b&gt;非正交&lt;/b&gt;的情况。该二元回归的几何意义如下：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-63a95ce036a4d0c955e92dfc0d6d2458_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;552&quot; data-rawheight=&quot;444&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-63a95ce036a4d0c955e92dfc0d6d2458&quot; data-watermark-src=&quot;v2-0884ca75f3adae05eb3615cdd6e9ea4d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;它和前一种情况最大的区别是，&lt;b&gt;当 &lt;/b&gt;&lt;equation&gt;\mathbf x_1&lt;/equation&gt; &lt;b&gt;和 &lt;/b&gt;&lt;equation&gt;\mathbf x_2&lt;/equation&gt; &lt;b&gt;非正交时，&lt;/b&gt; &lt;equation&gt;\mathbf y&lt;/equation&gt; &lt;b&gt; 在由 &lt;/b&gt;&lt;equation&gt;\mathbf x_1&lt;/equation&gt; &lt;b&gt;和 &lt;/b&gt;&lt;equation&gt;\mathbf x_2&lt;/equation&gt; &lt;b&gt;生成的超平面内的投影不等于 &lt;/b&gt; &lt;equation&gt;\mathbf y&lt;/equation&gt; &lt;b&gt; 分别在 &lt;/b&gt;&lt;equation&gt;\mathbf x_1&lt;/equation&gt; &lt;b&gt;和 &lt;/b&gt;&lt;equation&gt;\mathbf x_2&lt;/equation&gt; &lt;b&gt;上的投影之和。&lt;/b&gt;在这种情况下，解释变量之间对各自的回归系数有不同的作用，因此 OLS 的回归系数 &lt;equation&gt;b_i&lt;/equation&gt; &lt;b&gt;不再等于&lt;/b&gt; &lt;equation&gt;\langle\mathbf x_i, \mathbf y\rangle/\langle\mathbf x_i, \mathbf x_i\rangle&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;非正交 &lt;equation&gt;\mathbf x_i&lt;/equation&gt; 之间的相互作用如何影响回归系数 &lt;equation&gt;b_i&lt;/equation&gt; 呢？通过连续正交化来求解多元线性回归可以回答这个问题。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 用正交化过程求解多元回归&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;还是拿我们最熟悉的 simple regression model 为例；该模型有两个解释变量 —— 截距项和  &lt;equation&gt;\mathbf x&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;&lt;equation&gt;y_i=a+bx_i+\varepsilon_i&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;令 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; 表示截距项对应的解释变量，即 &lt;equation&gt;\mathbf x_0 = [1,1,…,1]^T&lt;/equation&gt; ； &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 表示上式中的解释变量  &lt;equation&gt;\mathbf x&lt;/equation&gt; 。假设 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 非正交（正交的话我们就不用费劲了）。对于简单回归模型，回归系数  &lt;equation&gt;a&lt;/equation&gt; （对应 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; ）和 &lt;equation&gt;b&lt;/equation&gt; （对应 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; ）的解为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} b&amp;amp;=&amp;amp;\displaystyle\frac{\sum x_iy_i-\frac{1}{n}\sum x_i\sum y_i}{\sum x_i^2-\frac{1}{n}(\sum x_i)^2}\\ a&amp;amp;=&amp;amp;\displaystyle\frac{1}{n}\sum y_i-b\left(\frac{1}{n}\sum x_i\right) \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;下面就来看看如何通过正交化求解 &lt;equation&gt;a&lt;/equation&gt; 和 &lt;equation&gt;b&lt;/equation&gt; 。由于 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 非正交，首先需要构造出一组正交向量。令 &lt;equation&gt;\mathbf z_0 = \mathbf x_0&lt;/equation&gt; 为其中的一个向量，将 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 用 &lt;equation&gt;\mathbf z_0&lt;/equation&gt; 进行一元回归（不带截距）得到的残差就是和 &lt;equation&gt;\mathbf z_0&lt;/equation&gt; 互相垂直（正交）的向量，记为 &lt;equation&gt;\mathbf z_1&lt;/equation&gt; 。由一元回归的性质可知：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf z_1=\displaystyle\mathbf x_1-\frac{\langle\mathbf z_0,\mathbf x_1\rangle}{\langle\mathbf z_0,\mathbf z_0\rangle}\mathbf z_0=\mathbf x_1-\bar x\mathbf 1&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;\bar x&lt;/equation&gt; 表示  &lt;equation&gt;\mathbf x&lt;/equation&gt;  的均值， &lt;equation&gt;\mathbf 1&lt;/equation&gt; 表示列向量 &lt;equation&gt;[1,1,…,1]^T&lt;/equation&gt; ，即 &lt;equation&gt;\mathbf z_0&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;So far so good？接下来，注意了：&lt;/p&gt;&lt;p&gt;&lt;b&gt;将 &lt;/b&gt; &lt;equation&gt;\mathbf y&lt;/equation&gt; &lt;b&gt; 用上面得到的 &lt;/b&gt;&lt;equation&gt;\mathbf z_1&lt;/equation&gt; &lt;b&gt;进行一元回归（不带截距），得到的回归系数就是上述 simple regression model 中解释变量 &lt;/b&gt; &lt;equation&gt;\mathbf x&lt;/equation&gt; &lt;b&gt; 的回归系数&lt;/b&gt; &lt;equation&gt;b&lt;/equation&gt; &lt;b&gt;！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} b&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_1,\mathbf y\rangle}{\langle\mathbf z_1,\mathbf z_1\rangle}=\displaystyle\frac{\langle\mathbf x_1-\bar x\mathbf 1,\mathbf y\rangle}{\langle\mathbf x_1-\bar x\mathbf 1,\mathbf x_1-\bar x\mathbf 1\rangle}\\ &amp;amp;=&amp;amp;\displaystyle\frac{\sum x_iy_i-\bar x\sum y_i}{\sum(x_i-\bar x)^2}=\displaystyle\frac{\sum x_iy_i-\frac{1}{n}\sum x_i\sum y_i}{\sum(x_i^2-2x_i\bar x+\bar x^2)}\\ &amp;amp;=&amp;amp;\displaystyle\frac{\sum x_iy_i-\frac{1}{n}\sum x_i\sum y_i}{\sum x_i^2-2(\sum x_i)\bar x+n\bar x^2}=\displaystyle\frac{\sum x_iy_i-\frac{1}{n}\sum x_i\sum y_i}{\sum x_i^2-2n\bar x^2+n\bar x^2}\\ &amp;amp;=&amp;amp;\displaystyle\frac{\sum x_iy_i-\frac{1}{n}\sum x_i\sum y_i}{\sum x_i^2-n\bar x^2}=\displaystyle\frac{\sum x_iy_i-\frac{1}{n}\sum x_i\sum y_i}{\sum x_i^2-\frac{1}{n}(\sum x_i)^2} \end{array}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;怎么样？我们并没有直接对该模型求解，而是通过正交化的方式就求出了解释变量 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 的回归系数  &lt;equation&gt;b&lt;/equation&gt; 。反应快的小伙伴也许马上会问  &lt;equation&gt;a&lt;/equation&gt;  呢？ &lt;equation&gt;a&lt;/equation&gt;  是否等于 &lt;equation&gt;\langle\mathbf z_0, \mathbf y\rangle/\langle\mathbf z_0, \mathbf z_0\rangle&lt;/equation&gt; 呢？别急，我们一会儿就聊 &lt;equation&gt;a&lt;/equation&gt; ，但是在那之前先来看一个&lt;b&gt;通过连续正交化求解多元回归的算法&lt;/b&gt;（Hastie et al. 2016）：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4ebccf87b8461860673a45e28cc187e5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;924&quot; data-rawheight=&quot;499&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4ebccf87b8461860673a45e28cc187e5&quot; data-watermark-src=&quot;v2-48dc8bfabe3410e71700b618533b16f9&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;该算法的核心是通过连续的正交化计算把一组非两两正交的向量 &lt;/b&gt;&lt;equation&gt;\mathbf x_i&lt;/equation&gt; &lt;b&gt;转换成一组两两正交的向量 &lt;/b&gt;&lt;equation&gt;\mathbf z_i&lt;/equation&gt; &lt;b&gt;，并以此方便的求出最后一个被正交化的解释变量的多元回归系数。&lt;/b&gt;虽然它只有三步，但是每一步都值得解读一下：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 第一步是初始化，在所有解释变量中（如果回归中有截距项，就把 &lt;equation&gt;[1,1,…,1]^T&lt;/equation&gt; 看做一个解释变量）任意挑选一个当作 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; 进行初始化 &lt;equation&gt;\mathbf z_0 = \mathbf x_0&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 第二步是&lt;b&gt;根据我们自己选定的递归顺序（任意顺序都可以）&lt;/b&gt;，对 &lt;equation&gt;\mathbf x_1, \mathbf x_2,\cdots, \mathbf x_p&lt;/equation&gt; 依次进行正交化。例如，对 &lt;equation&gt;\mathbf x_j&lt;/equation&gt; 的正交化处理就是用它和之前已经被处理过后的正交向量 &lt;equation&gt;\mathbf z_0, \mathbf z_1,\cdots, \mathbf z_{j-1}&lt;/equation&gt; &lt;b&gt;逐一独立&lt;/b&gt;一元回归得到系数  &lt;equation&gt;\langle\mathbf z_k, \mathbf x_j\rangle/\langle\mathbf z_k, \mathbf z_k\rangle, k=0,1,\cdots,j-1&lt;/equation&gt; ，进而用  &lt;equation&gt;\mathbf x_j&lt;/equation&gt;  减去 &lt;equation&gt;(\langle\mathbf z_k, \mathbf x_j\rangle/\langle\mathbf z_k, \mathbf z_k\rangle)\mathbf z_k, k=0,1,\cdots,j-1&lt;/equation&gt; 之和，得到的残差就是最新的正交化后的向量  &lt;equation&gt;\mathbf z_j&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 使用  &lt;equation&gt;\mathbf y&lt;/equation&gt;  和 &lt;equation&gt;\mathbf z_p&lt;/equation&gt; 进行一元回归，得到的系数 &lt;equation&gt;\langle\mathbf z_p, \mathbf y\rangle/\langle\mathbf z_p, \mathbf z_p\rangle&lt;/equation&gt; 正是这个多元回归 OLS 求解中原始解释变量 &lt;equation&gt;\mathbf x_p&lt;/equation&gt; 的回归系数 &lt;equation&gt;b_p&lt;/equation&gt; 。注意，这一结论仅对&lt;b&gt;最后一个&lt;/b&gt;（第 &lt;equation&gt;p&lt;/equation&gt; 个）被正交化后的解释变量成立。换句话说，对于别的解释变量 &lt;equation&gt;j&amp;lt;p&lt;/equation&gt; ， &lt;equation&gt;\langle\mathbf z_j, \mathbf y\rangle/\langle\mathbf z_j, \mathbf z_j\rangle&lt;/equation&gt; 并不是多元回归中原解释变量 &lt;equation&gt;\mathbf x_j&lt;/equation&gt; 的回归系数。&lt;/p&gt;&lt;p&gt;看到这里，有的小伙伴可能会问，这个算法确实不错，但是费了半天劲算出了一大堆相互正交的向量 &lt;equation&gt;\mathbf z_j&lt;/equation&gt; ，但是求解回归系数的结论仅对最后一个被正交化的解释变量成立，这不是坑爹吗？&lt;/p&gt;&lt;p&gt;答案是并不坑爹！这是因为上述算法中的关键一点是，&lt;b&gt;正交化这些解释变量的顺序是任意的&lt;/b&gt;。我们可以选任何一个来初始化，也可以选任何一个作为最后一个被正交化的解释变量。无论我们怎么选，上述过程都保证了最后一个被正交化的解释变量的回归系数满足 &lt;equation&gt;b_p=\langle\mathbf z_p, \mathbf y\rangle/\langle\mathbf z_p, \mathbf z_p\rangle&lt;/equation&gt; 。因此，&lt;b&gt;我们只需要依次挑选这些解释变量作为最后一个被正交化的，就可以通过上述步骤方便的求出它们的回归系数。&lt;/b&gt;而它所反映出来的本质是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;在多元线性回归中，解释变量 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt; &lt;b&gt;的回归系数 &lt;/b&gt;&lt;equation&gt;b_j&lt;/equation&gt; &lt;b&gt;等于 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt; &lt;b&gt;在被其他 &lt;/b&gt;&lt;equation&gt;\mathbf x_0, \mathbf x_1,\cdots, \mathbf x_{j-1}, \mathbf x_{j+1},\cdots, \mathbf x_p&lt;/equation&gt; &lt;b&gt;调整之后（即正交化，从而排除其他 &lt;/b&gt;&lt;equation&gt;\mathbf x_i&lt;/equation&gt; &lt;b&gt;对 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt; &lt;b&gt;的影响）仍能够对 &lt;/b&gt; &lt;equation&gt;\mathbf y&lt;/equation&gt; &lt;b&gt; 产生的增量贡献。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;这个算法叫作多元回归的 Gram-Schmidt（格拉姆-施密特）正交化过程。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本小节开始的 simple regression model 已经验证了上述结论。我们使用 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; 将 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 正交化处理得到 &lt;equation&gt;\mathbf z_1&lt;/equation&gt; ，然后用 &lt;equation&gt;\mathbf y&lt;/equation&gt; 和 &lt;equation&gt;\mathbf z_1&lt;/equation&gt; 回归得到的正是 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 的回归系数  &lt;equation&gt;b&lt;/equation&gt; ；如果将 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 选为 &lt;equation&gt;\mathbf z_0&lt;/equation&gt; ，然后用它正交化 &lt;equation&gt;\mathbf x_0 = [1,1,…,1]^T&lt;/equation&gt; ，就可以方便的求出回归系数  &lt;equation&gt;a&lt;/equation&gt; 。&lt;/p&gt;&lt;p&gt;让我们来好好审视一下这个结论，即：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle b_p=\frac{\langle\mathbf z_p,\mathbf y\rangle}{\langle\mathbf z_p,\mathbf z_p\rangle}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式说明，解释变量 &lt;equation&gt;\mathbf x_p&lt;/equation&gt; 的回归系数 &lt;equation&gt;b_p&lt;/equation&gt; 和正交化后的 &lt;equation&gt;\mathbf z_p&lt;/equation&gt; 的大小（ &lt;equation&gt;\mathbf z_p&lt;/equation&gt; 自己的內积为分母）有关。&lt;b&gt;如果 &lt;/b&gt;&lt;equation&gt;\mathbf x_p&lt;/equation&gt; &lt;b&gt;和其他解释变量高度相关（即非常不正交），那么 &lt;/b&gt;&lt;equation&gt;\mathbf z_p&lt;/equation&gt; &lt;b&gt;就会很小，则会导致&lt;/b&gt; &lt;equation&gt;b_p&lt;/equation&gt; &lt;b&gt;非常不稳定（一点点样本数据的变化都会导致&lt;/b&gt; &lt;equation&gt;b_p&lt;/equation&gt; &lt;b&gt;的大幅变化）。&lt;/b&gt;当 &lt;equation&gt;y_i&lt;/equation&gt; 满足独立同分布时，假设它的方差为 &lt;equation&gt;\sigma^2&lt;/equation&gt; ，可以证明回归系数 &lt;equation&gt;b_p&lt;/equation&gt; 的方差和 &lt;equation&gt;\mathbf z_p&lt;/equation&gt; 的大小成反比，即 &lt;equation&gt;\|\mathbf z_p\|^2&lt;/equation&gt; 越小， &lt;equation&gt;b_p&lt;/equation&gt; 的误差越大：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{var}(b_p)=\frac{\sigma^2}{\langle\mathbf z_p,\mathbf z_p\rangle}=\frac{\sigma^2}{\|\mathbf z_p\|^2}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在多因子模型中， &lt;equation&gt;b_p&lt;/equation&gt; 代表的是因子  &lt;equation&gt;p&lt;/equation&gt;  的收益率。&lt;b&gt;为避免因子收益率的估计非常不稳定，要求不同的因子之间尽量满足正交化。&lt;/b&gt;举例来说，在 Barra 的 CNE5 模型中，非线性规模因子和规模因子之间进行了正交化处理；残差波动率因子和规模以及 BETA 因子也进行了正交化处理。&lt;/p&gt;&lt;p&gt;在结束本小节的讨论之前，我还想介绍一个有意思也有用的特性。本节的论述说明我们可以任选一个解释变量作为最后一个，然后根据连续正交化方便的求出它的回归系数。这意味着如果我们有 20个解释变量，需要进行 20 次上述操作。那么，&lt;b&gt;是否存在什么办法仅通过进行一次连续正交化就求出所有的回归系数&lt;/b&gt; &lt;equation&gt;b_j, j = 0, 1,\cdots, p&lt;/equation&gt; &lt;b&gt;呢？答案是肯定的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;假设我们按照某给定顺序 &lt;equation&gt;\mathbf x_0, \mathbf x_1,\cdots, \mathbf x_p&lt;/equation&gt; 进行了连续正交化过程，得到了 &lt;equation&gt;\mathbf z_0, \mathbf z_1,\cdots, \mathbf z_p&lt;/equation&gt; ，且我们现在知道 &lt;equation&gt;b_p=\langle\mathbf z_p,\mathbf y\rangle/\langle\mathbf z_p,\mathbf z_p\rangle&lt;/equation&gt; 。由于 &lt;equation&gt;b_p&lt;/equation&gt; 正是解释变量 &lt;equation&gt;\mathbf x_p&lt;/equation&gt; 的回归系数，因此 &lt;equation&gt;b_p\mathbf x_p&lt;/equation&gt; 正是 &lt;equation&gt;\mathbf x_p&lt;/equation&gt; 所解释的 &lt;equation&gt;\mathbf y&lt;/equation&gt; 的部分。如果从 &lt;equation&gt;\mathbf y&lt;/equation&gt; 中剔除 &lt;equation&gt;b_p\mathbf x_p&lt;/equation&gt; ，并把得到的 &lt;equation&gt;\mathbf y-b_p\mathbf x_p&lt;/equation&gt; 用 &lt;equation&gt;\mathbf x_0, \mathbf x_1,\cdots, \mathbf x_{p-1}&lt;/equation&gt; 回归，则结果就和 &lt;equation&gt;\mathbf x_p&lt;/equation&gt; 无关了。在这个新的回归中， &lt;equation&gt;\mathbf x_{p-1}&lt;/equation&gt; 就变成了最后一个被正交化的解释变量，其对应的正交向量为 &lt;equation&gt;\mathbf z_{p-1}&lt;/equation&gt; 。因此， &lt;equation&gt;\mathbf x_{p-1}&lt;/equation&gt; 的回归系数就是用新的 &lt;equation&gt;\mathbf y-b_p\mathbf x_p&lt;/equation&gt; 和 &lt;equation&gt;\mathbf z_{p-1}&lt;/equation&gt; 回归的结果：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle b_{p-1}=\frac{\langle\mathbf z_{p-1}, \mathbf y-b_p\mathbf x_p\rangle}{\langle\mathbf z_{p-1}, \mathbf z_{p-1}\rangle}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;以此类推，我们可以按照 &lt;equation&gt;b_p, b_{p-1},\cdots, b_0&lt;/equation&gt; 的&lt;b&gt;倒序&lt;/b&gt;求解出多元回归中所有解释变量的回归系数 &lt;equation&gt;b_j&lt;/equation&gt; （Drygas 2011）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} b_p&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_{p}, \mathbf y\rangle}{\langle\mathbf z_{p}, \mathbf z_{p}\rangle}\\ \displaystyle b_{j}&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_{j}, \mathbf y-\sum_{i=j+1}^p b_i\mathbf x_i\rangle}{\langle\mathbf z_{j}, \mathbf z_{j}\rangle},~j=p-1,p-2,\cdots,0 \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;最后用本小节开始的 simple regression model 检验一下。我们用上述方法求解截距项的回归系数  &lt;equation&gt;a&lt;/equation&gt;  看看。根据定义有 &lt;equation&gt;\mathbf z_0 = \mathbf 1&lt;/equation&gt; 并假设已知  &lt;equation&gt;b&lt;/equation&gt; 。则根据上面的表达式可得：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} a&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf 1,\mathbf y-b\mathbf x\rangle}{\langle\mathbf 1,\mathbf 1\rangle}\\ &amp;amp;=&amp;amp;\displaystyle\frac{\sum y_i-b\sum x_i}{n}\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{n}\sum y_i-b\left(\frac{1}{n}\sum x_i\right) \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;这正是直接求解 simple regression model 得到的回归系数  &lt;equation&gt;a&lt;/equation&gt; （请往前滚屏比较看看）。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 一个例子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节用一个例子来验证一下上一节的各种公式。假设有四个解释变量 &lt;equation&gt;\mathbf x_0&lt;/equation&gt; 到 &lt;equation&gt;\mathbf x_3&lt;/equation&gt; ，以及  &lt;equation&gt;\mathbf y&lt;/equation&gt; ：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf x_0=\left[\begin{array}{c} 1\\1\\1\\1\\1\\1\\1\\1 \end{array}\right], \mathbf x_1=\left[\begin{array}{c} 1\\2\\4\\3\\7\\6\\3\\5 \end{array}\right], \mathbf x_2=\left[\begin{array}{c} 0\\1\\2\\8\\9\\4\\6\\2 \end{array}\right], \mathbf x_3=\left[\begin{array}{c} 1\\3\\3\\2\\5\\8\\0\\4 \end{array}\right], \mathbf y=\left[\begin{array}{c} 3\\1\\4\\1\\5\\9\\2\\6 \end{array}\right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;直接使用回归系数  &lt;equation&gt;\mathbf b&lt;/equation&gt;  的表达式求解，则它们的回归系数分别为：&lt;equation&gt;b_0 = 0.38548073&lt;/equation&gt;, &lt;equation&gt;b_1 = 0.96332683&lt;/equation&gt;, &lt;equation&gt;b_2 = -0.36300685&lt;/equation&gt;, &lt;equation&gt;b_3 = 0.37189391&lt;/equation&gt;。按照 &lt;equation&gt;\mathbf x_0, \mathbf x_1, \mathbf x_2, \mathbf x_3&lt;/equation&gt; 的顺序进行连续正交化，得到的正交向量为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} \mathbf z_0&amp;amp;=&amp;amp;\mathbf x_0\\ \mathbf z_1&amp;amp;=&amp;amp;\displaystyle\mathbf x_1-\frac{\langle\mathbf x_1,\mathbf z_0\rangle}{\langle\mathbf z_0,\mathbf z_0\rangle}\mathbf z_0\\ \mathbf z_2&amp;amp;=&amp;amp;\displaystyle\mathbf x_2-\frac{\langle\mathbf x_2,\mathbf z_0\rangle}{\langle\mathbf z_0,\mathbf z_0\rangle}\mathbf z_0-\frac{\langle\mathbf x_2,\mathbf z_1\rangle}{\langle\mathbf z_1,\mathbf z_1\rangle}\mathbf z_1\\ \mathbf z_3&amp;amp;=&amp;amp;\displaystyle\mathbf x_3-\frac{\langle\mathbf x_3,\mathbf z_0\rangle}{\langle\mathbf z_0,\mathbf z_0\rangle}\mathbf z_0-\frac{\langle\mathbf x_3,\mathbf z_1\rangle}{\langle\mathbf z_1,\mathbf z_1\rangle}\mathbf z_1-\frac{\langle\mathbf x_3,\mathbf z_2\rangle}{\langle\mathbf z_2,\mathbf z_2\rangle}\mathbf z_2 \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf z_0=\left[\begin{array}{c} 1\\1\\1\\1\\1\\1\\1\\1 \end{array}\right], \mathbf z_1=\left[\begin{array}{r} -2.875\\-1.875\\ 0.125\\-0.875\\3.125\\ 2.125\\ -0.875\\ 1.125 \end{array}\right], \mathbf z_2=\left[\begin{array}{r} -1.51082251\\-1.37662338\\-2.10822511\\ 4.75757576\\2.29437229\\-1.83982684\\2.75757576\\-2.97402597 \end{array}\right], \mathbf z_3=\left[\begin{array}{r} -0.00844984\\1.08972192\\-1.02611768\\1.06099247\\-0.48286987\\2.17022584\\-1.56337379\\-1.24012905 \end{array}\right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;使用 Drygas (2011) 提出的解法按照 &lt;equation&gt;b_3, b_2, b_1, b_0&lt;/equation&gt; 的顺序求解各个回归系数 &lt;equation&gt;b_j&lt;/equation&gt; ：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} b_3&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_3,\mathbf y\rangle}{\langle\mathbf z_3,\mathbf z_3\rangle}\\ b_2&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_2,\mathbf y-b_3\mathbf x_3\rangle}{\langle\mathbf z_2,\mathbf z_2\rangle}\\ b_1&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_1,\mathbf y-b_3\mathbf x_3-b_2\mathbf x_2\rangle}{\langle\mathbf z_1,\mathbf z_1\rangle}\\ b_0&amp;amp;=&amp;amp;\displaystyle\frac{\langle\mathbf z_0,\mathbf y-b_3\mathbf x_3-b_2\mathbf x_2-b_1\mathbf x_1\rangle}{\langle\mathbf z_0,\mathbf z_0\rangle} \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上述公式求出 &lt;equation&gt;b_0 = 0.38548073&lt;/equation&gt;, &lt;equation&gt;b_1 = 0.96332683&lt;/equation&gt;, &lt;equation&gt;b_2 = -0.36300685&lt;/equation&gt;, &lt;equation&gt;b_3 = 0.37189391&lt;/equation&gt;，和使用回归系数  &lt;equation&gt;\mathbf b&lt;/equation&gt;  的表达式求解的结果完全一致。另外，我们也可以分别选择 &lt;equation&gt;\mathbf x_0, \mathbf x_1, \mathbf x_2&lt;/equation&gt; 替换 &lt;equation&gt;\mathbf x_3&lt;/equation&gt; 作为最后一个被正交化的解释变量（前三个变量的顺序也不重要），并利用 &lt;equation&gt;b_p=\langle\mathbf z_p,\mathbf y\rangle/\langle\mathbf z_p,\mathbf z_p\rangle&lt;/equation&gt; 求解，得出的 &lt;equation&gt;b_j&lt;/equation&gt; 也和上面的完全相同。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 正交等于不相关？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在我们平常说因子之间正交的时候，另一个常用的词汇是因子之间“不相关”（这里不相关指的是不同因子的 Pearson 相关系数为零）。那么“正交”和“不相关”是否等价呢？&lt;/p&gt;&lt;p&gt;从定义出发，两个因子向量 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和  &lt;equation&gt;\mathbf x_2&lt;/equation&gt;  正交意味着它们的內积，即 &lt;equation&gt;\langle\mathbf x_1, \mathbf x_2\rangle&lt;/equation&gt; 为零。而 &lt;equation&gt;\mathbf x_1&lt;/equation&gt; 和 &lt;equation&gt;\mathbf x_2&lt;/equation&gt; 的相关系数为零则意味着 &lt;equation&gt;\langle\mathbf x_1-\mbox{E}[x_1]\cdot \mathbf 1, \mathbf x_2-\mbox{E}[x_2]\cdot \mathbf 1\rangle&lt;/equation&gt; 为零，因为在计算相关系数时，必须先分别减去其均值，这就是个 centering 的过程。由于 &lt;equation&gt;\langle\mathbf x_1, \mathbf x_2\rangle&lt;/equation&gt; 为零不一定意味着 &lt;equation&gt;\langle\mathbf x_1-\mbox{E}[x_1]\cdot \mathbf 1, \mathbf x_2-\mbox{E}[x_2]\cdot \mathbf 1\rangle&lt;/equation&gt; 也为零，因此正交不一定等于不相关。&lt;/p&gt;&lt;p&gt;举个例子， &lt;equation&gt;[4, 2]^T&lt;/equation&gt; 和 &lt;equation&gt;[3, -6]^T&lt;/equation&gt; 的內积为零，这两个向量正交。而各自减去均值后， &lt;equation&gt;[4, 2]^T&lt;/equation&gt; 和 &lt;equation&gt;[3, -6]^T&lt;/equation&gt; 分别变为 &lt;equation&gt;[1, -1]^T&lt;/equation&gt; 和 &lt;equation&gt;[4.5, -4.5]^T&lt;/equation&gt; 。这两个新向量在一条直线上、內积不为零，因此 &lt;equation&gt;[4, 2]^T&lt;/equation&gt; 和 &lt;equation&gt;[3, -6]^T&lt;/equation&gt; 的相关系数不为零（事实上，它们的相关系数等于 1）。从多元回归求解的角度来说，我们在乎的是他们是否正交，而非 centering 之后的內积是否为零（即是否不相关）。&lt;/p&gt;&lt;p&gt;不过对于因子暴露向量来说，因为个股在每个因子上的暴露都经过 demean 处理了，所以每个因子向量的均值已经是零了（这里考虑的就是简单等权均值的情况，而不是像 Barra 那种用市值作为权重进行去均值的情况）。从这个意义上说，因子向量之间正交和它们之间不相关等价。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;一不留神又写了这么长。从阅读体验来说，实在抱歉。&lt;/p&gt;&lt;p&gt;本文掰扯了一大堆公式其实就是想说明下面这句话：&lt;/p&gt;&lt;p&gt;&lt;b&gt;在多元线性回归中，解释变量 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt;&lt;b&gt;的回归系数 &lt;/b&gt;&lt;equation&gt;b_j&lt;/equation&gt;&lt;b&gt;等于 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt;&lt;b&gt;在被其他 &lt;/b&gt;&lt;equation&gt;\mathbf x_0, \mathbf x_1,\cdots, \mathbf x_{j-1}, \mathbf x_{j+1},\cdots, \mathbf x_p&lt;/equation&gt;&lt;b&gt;调整之后（即正交化，从而排除其他 &lt;/b&gt;&lt;equation&gt;\mathbf x_i&lt;/equation&gt;&lt;b&gt;对 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt;&lt;b&gt;的影响）仍能够对 &lt;/b&gt;&lt;equation&gt;\mathbf y&lt;/equation&gt;&lt;b&gt; 产生的增量贡献。如果 &lt;/b&gt;&lt;equation&gt;\mathbf x_j&lt;/equation&gt; &lt;b&gt;和其他解释变量高度相关，则它的回归系数&lt;/b&gt; &lt;equation&gt;b_j&lt;/equation&gt; &lt;b&gt;会有很大的估计误差。这对于多因子模型中评价因子收益非常不利。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果看完之后你对这句话有一定的体会，那我的功夫就没白花。&lt;/p&gt;&lt;p&gt;在计算机算法进行多元回归求解的时候，并不是试图按照  &lt;equation&gt;\mathbf b&lt;/equation&gt;  的公式计算  &lt;equation&gt;\mathbf X^T\mathbf X&lt;/equation&gt;  的逆矩阵，而采用的正是正交化的思路。在正交化的过程中可以非常容易的得到  &lt;equation&gt;\mathbf X&lt;/equation&gt;  的 QR 分解，其中 &lt;equation&gt;\mathbf Q&lt;/equation&gt; 是正交阵、 &lt;equation&gt;\mathbf R&lt;/equation&gt;  是上三角阵。这也极大的化简了回归系数  &lt;equation&gt;\mathbf b&lt;/equation&gt;  以及 &lt;equation&gt;\mathbf y&lt;/equation&gt; 预测值的求解。由于篇幅原因（我也好意思说篇幅……），本文就不给出 QR 分解的具体表达式了，感兴趣的读者请参考 Hastie et al. (2016)。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Drygas, H. (2011). On the Relationship between the Method of Least Squares and Gram-Schmidt Orthogonalization. &lt;i&gt;Acta et Commentationes Universitatis Tartuensis de Mathematica&lt;/i&gt;, Vol. 15(1), 3 – 13.&lt;/li&gt;&lt;li&gt;Hastie, T., R. Tibshirani, and J. Friedman (2016). &lt;i&gt;The Elements of Statistical Learning: Data Mining, Inference, and Prediction&lt;/i&gt;, 2nd Ed. Springer.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-08-14-41993542</guid>
<pubDate>Tue, 14 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>中国股市日历异象之换月效应</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-08-09-41687401.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41687401&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9885c41660b29ff5fc65baf5ec865b95_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;写在前面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文写于 2018 年 2 月 8 日，因此实证数据仅到该日期之前。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;股市中有许多流传已久的&lt;b&gt;日历效应（calendar effect）&lt;/b&gt;，它指的是市场的收益率在一年中的一些特定日子或者特定月份有高于平时的收益率。这其中最大名鼎鼎的当属&lt;b&gt;换月效应（turn-of-the-month effect）&lt;/b&gt;，它指的是&lt;b&gt;股票在每月的最后 1 个交易日到下一个月的第 3 个交易日这个窗口内的收益率显著高于一个月中的其他交易日&lt;/b&gt;（具体的换月窗口可以和上述略有不同，但一般的实证中使用的是从每月的最后一个交易日到下月的第三个交易日这四天）。&lt;/p&gt;&lt;p&gt;以美股为例，Xu and McConnell (2016) 指出在 1926 到 2005 间，仅在上述换月窗口内买入标普 500 指数的 ETF 就可以取得年化 7.20% 的收益率且该策略的夏普率高达 1.04（在非换月窗口内的其他交易日，它们的均值几乎为零）。Carchano and Pardo Tornero (2011) 以美国标普 500 指数、德国法兰克福指数和日经指数为研究对象，分析了潜在的 188 中日历效应，并发现&lt;b&gt;在统计上和经济上同时显著的只有换月效应。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;研究中国股市换月效应的文献也自不在少数。大量针对A股的实证说明，中国股市确实存在换月效应。&lt;b&gt;但我们也看到，换月效应的作用正在减弱（2017 年开始就几乎消失），且换月的时间窗口也似乎在收窄。&lt;/b&gt;针对换月效应，学术界和业界一直在努力寻找各种合理的解释，包括&lt;b&gt;更多现金流假说、额外风险假说、流动性假说，以及基金经理在月末的窗饰（window dressing）现象。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文就来使用我国股市的六大指数（上证指数、上证 50、沪深 300、中证 500、中小板、创业板）来对换月效应进行实证。具体的实证内容包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;指数在全部十二个月的换月效应。&lt;/li&gt;&lt;li&gt;指数在换年月（12 月底到 1 月初）和非换年月（其他 11 个月）内的换月效应。&lt;/li&gt;&lt;li&gt;指数在换季月（3 月底到 4 月初、6 月底到 7 月初、9 月底到 10 月初、12 月底到 1 月初）和非换季月（其他 8 个月）内的换月效应。&lt;/li&gt;&lt;li&gt;换月效应是否可以被交易量解释（更多现金流假说）。&lt;/li&gt;&lt;li&gt;换月效应是否被额外风险解释。&lt;/li&gt;&lt;li&gt;换月效应是否被更高的无风险收益率解释（流动性假说）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;此外，文章会简单讨论基金经理的窗饰效应，并在最后就换月效应是否足以成为一个交易策略给出我们的看法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 换月窗内的“超额”收益&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节以上证指数为例，通过假设检验来分析其在换月窗口内的收益率是否显著为正。上证指数的实证期全长为 2001 年 1 月 1 日至 2018 年 2 月 6 日。在这段窗口中，月内不同交易日内的收益率均值如下：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-287756dde54cf333d09641467ae15058_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;551&quot; data-rawheight=&quot;298&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-287756dde54cf333d09641467ae15058&quot; data-watermark-src=&quot;v2-3b8d64f72a4a81ac06fe080c8c4a4f67&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;从上图直观来看，换月窗口内的 4 个交易日的收益率均值明显大于零且高于其他交易日。下面就是用假设检验定量看看。为了探究换月效应是否在不同的时期持续有效，我们把回测期分为三部分：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;第一部分：2001 年 1 月 1 日 – 2010 年 12 月 31 日&lt;/li&gt;&lt;li&gt;第二部分：2011 年 1 月 1 日 – 2016 年 12 月 31 日&lt;/li&gt;&lt;li&gt;第三部分：2017 年 1 月 1 日 – 2018 年 2 月 6 日&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;假设检验的原假设为这换月窗内的交易日的收益率以及这 4 个交易日的收益率均值为零。&lt;/b&gt;我们看看能否拒绝原假设。假设检验的结果如下。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e2303af2f5d310bd77329ddda500fe24_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;423&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e2303af2f5d310bd77329ddda500fe24&quot; data-watermark-src=&quot;v2-14af95110e83a3379fb2b0fec3d5af3d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上面的结果表明，在 2017 年之前上证指数在换月窗口内的平均收益率均值为正，其显著性水平在 5% 以下。然而从 2017 年开始，换月效应似乎在统计上失效。当然，在 2017 年之后其 t 统计值较小的另外一个原因是样本点较少，因此均值估计中 standard error 较大。&lt;/p&gt;&lt;p&gt;对于其他五大指数的分析见附录 A 和 B，从中也可总结出类似的结论。&lt;b&gt;这说明换月效应对各市值的股票均有效，而非仅仅是小市值股的特性。但是，从 2017 年开始换月效应在统计意义上失效，且切换月窗口由 -1 到 +3 缩窄至 -1 到 +1（即每月的最后一个交易日到下个月的第一个交易日），这种现象在小市值板块上更加明显。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 换年和换季能否解释换月？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;接下来，我们尝试将换季和换年效应从换月中剥离开，从而分析换年和换季是否对能够解释换月收益率。同样，以上证指数为例，对于换年效应，考察 12 月底到下一年 1 月初这个换月窗口内指数的收益率均值，以及除了换年之外的 11 个换月窗口内的收益率均值；对于换季效应，考察 4 个换季窗口（3 月底到 4 月初、6 月底到 7 月初、9 月底到 10 月初、以及 12 月底到下一年 1 月初）内和非换季时的 8 个换月窗口内的收益率均值。&lt;/p&gt;&lt;p&gt;上证指数换年效应假设检验结果如下：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f701a6de9e8b34d0cce8f9355c450c57_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;632&quot; data-rawheight=&quot;315&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f701a6de9e8b34d0cce8f9355c450c57&quot; data-watermark-src=&quot;v2-3cb85eb39604c2947e74df7d5ea86883&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上证指数换季效应假设检验结果如下：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7f3ee4a8220aaa18eaca3821c4ec6e48_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;628&quot; data-rawheight=&quot;322&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7f3ee4a8220aaa18eaca3821c4ec6e48&quot; data-watermark-src=&quot;v2-7b0f016c3e97229da3e667eaf95e9cd4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;其他五个指数的假设检验结果见附录 C。对于&lt;b&gt;换年&lt;/b&gt;是否能够解释换月效应的假设检验结果如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;六大指数&lt;b&gt;均没有&lt;/b&gt;表现出统计意义上显著的换年月窗口间正收益（部分原因是因为样本比较少）。由于 2016 年 1 月初由熔断造成的大跌，创业板甚至在换年月窗口内表现出了负收益。&lt;/li&gt;&lt;li&gt;在除去换年月的剩余 11 个月中，六大指数均表现出统计意义上显著性水平 5% 以下的换月正收益（大多数显著性水平在 1% 以下）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;上述结果说明，换年效应无法为换月效应提供解释。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于&lt;b&gt;换季&lt;/b&gt;是否能够解释换月效应的假设检验结果如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;当仅考虑换季的 4 个月份时，六大指数体现出了统计意义上的显著正收益（显著性多为 5% 以下）。&lt;/li&gt;&lt;li&gt;当考虑除换季之外的 8 个月份时，六大指数体现出了统计意义上更加显著的正收益（显著性多为 1% 以下）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;上述结果说明，换季效应在换季月份中与换月效应重合，但是它无法为非换季月的换月效应提供解释。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 解释换月效应的假说&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上面的实证表明，A 股中确实存在换月效应。学术界和业界对这个日历异象的解释主要从以下四个方面：&lt;b&gt;更多现金流假说、额外风险补偿假说、流动性假说，以及基金经理在月末的窗饰现象。&lt;/b&gt;下面逐一介绍。&lt;/p&gt;&lt;p&gt;&lt;b&gt;4.1 更多现金流假说&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;流动性假说假设月末个人投资者有更多的资金（可能是发了工资或者奖金），从而会在换月期内购买股票，造成上涨。&lt;/b&gt;按照这个逻辑，我们预期在换月窗口内股市的成交量明显高于月内其他日的成交量。&lt;/p&gt;&lt;p&gt;以下为六大指数的月内平均交易量。计算时，我们将每日的交易量用包含它的 30 日窗口的均值做了归一化。&lt;b&gt;可以看到，月内每日的交易量基本非常平均，说明更多现金流假说无法解释换月效应。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ea2c8f4fb08f28cc5a9647499eb77a90_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;867&quot; data-rawheight=&quot;732&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ea2c8f4fb08f28cc5a9647499eb77a90&quot; data-watermark-src=&quot;v2-ecd6e873139c3195a86ee0309546b05a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;4.2 额外风险补偿假说&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;换月效应的另一个假说是股票在换月窗口内承担了更高的风险，因此有更高的风险溢价。&lt;/b&gt;采用收益率的标准差来衡量风险可计算出月内不同日期的收益率波动率。结果表明（下图），&lt;b&gt;波动率在换月窗口内并没有高于月内其他日期，这种假说也不成立。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d9439102eee25254d0ac125ae74ed15b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;728&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d9439102eee25254d0ac125ae74ed15b&quot; data-watermark-src=&quot;v2-2d2b62130b7dc1b75904a94b6325329e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;4.3 流动性假说&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;流动性假说假设换月窗口内有流动性风险，导致无风险利率上升，从而引发风险资产收益率上升。通过考察 GC001 的收益率（国债逆回购利率，流动性风险的代理指标）发现，在换月窗口内其收益率并不高，因此这种解释也不成立。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;不过值得注意的是，在换月窗口的前一天，即每个月的倒数第二个交易日，GC001 的收益率显著的高于其他日期。对于此，可能的解释是月底最后一天是发工资结账的时候，真正最紧的是各种筹措准备发工资结账的倒数第二天。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-59ab8e7684ed6ab33a351de190ba73fc_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;526&quot; data-rawheight=&quot;295&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-59ab8e7684ed6ab33a351de190ba73fc&quot; data-watermark-src=&quot;v2-cbb44d8b37a3689ae36cd760622d58b4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;4.4 基金经理的窗饰现象&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;窗饰（window dressing）现象指的是基金经理在季末以及年末，由于有需要向投资人进行业绩汇报的压力，通过卖出自己投资组合中亏损的股票而买入市场中大涨的股票、或者通过拉升自己投资组合中股票的价格，来达到粉饰业绩目的的非理性投资行为。&lt;/b&gt;基金经理与投资者之间存在信息不对称，基金管理人往往为了个人利益（如个人薪酬、名誉等），牺牲投资者的利益，实现自身利益的最大化（Jiao 2011）。&lt;/p&gt;&lt;p&gt;Jiao (2011) 通过研究中国的开放是股票基金，发现了&lt;b&gt;市场中存在着显著的季度窗饰现象&lt;/b&gt;，在不同时间区间，窗饰程度不一。此外，窗饰现象与基金经理的工作经验、任职时间长短有密切关系；对于基金特征变量而言，窗饰现象更容易发生在规模小、以往表现差的基金中，而成立时间、投资风格、赎回压力等变量对窗饰程度并无显著影响。&lt;/p&gt;&lt;p&gt;&lt;b&gt;虽然窗饰现象可以从一定程度上解释季末股票的“超额”收益，但它仍然不能完全解释月末的换月效应，因为基金经理在普通的换月窗口内并无进行窗饰业绩的动机。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 换月效应是否值得成为独立策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节来看看既然换月效应在 A 股中存在，那么我们利用它来构建策略会有怎样的表现。利用换月效应，构建策略如下：&lt;b&gt;在每个月的换月窗口内持有指数（即每个月的最后倒数第二个交易日收盘时买入，在下个月的第三个交易日收盘时卖出），在其他交易日空仓。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下图反应了该策略于 2005 年到 2016 年 2 月底之间在这六大指数上的表现。&lt;b&gt;很明显，换月策略无法捕捉大牛市，在大牛市中远远跑输市场。&lt;/b&gt;这很容易理解，因为牛市中市场几乎天天涨，而该策略在每个月的 23 个交易日中的绝大多数选择空仓。&lt;b&gt;从行为金融学的角度来说，在大牛市中依本策略操作、看着指数“绝尘而去”是非常痛苦的，这种痛苦足以让投资者放弃该策略。&lt;/b&gt;可喜的是，在 2010 年至 2014 年市场震荡下行的时候，该策略却呈现出了十足的韧性，稳健上行。&lt;b&gt;如果未来市场仍然是震荡下行，那么只要换月效应不失效，这个策略就会战胜市场本身。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f50469ea10933ab0ef59aea6ed74b706_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;881&quot; data-rawheight=&quot;660&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f50469ea10933ab0ef59aea6ed74b706&quot; data-watermark-src=&quot;v2-76ab9f7e785a22449bfb2d241c506390&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;再来看看股灾 3.0 之后（即从 2016 年 3 月 1 日开始），换月策略的表现（下图）。&lt;b&gt;虽然换月效应在这六大指数上均能录得正收益，但是不难发现这些收益主要来自 2016 年，而其在 2017 年几乎失效，特别是对于大盘股如上证 50 和沪深 300。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bcf610bd29bea2c56e903c83596451fd_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;882&quot; data-rawheight=&quot;684&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-bcf610bd29bea2c56e903c83596451fd&quot; data-watermark-src=&quot;v2-033bb427e12af8f5ca46aba99e997143&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;对于上证 50 和沪深 300，换月策略的表现远远差于指数本身。换月策略本质上是一种“择时”。Jusselin et al. (2017) 的研究表明，对于市场上最流行的趋势追踪择时策略，&lt;b&gt;如果标的本身的夏普率高于 0.35，那么择时策略的净值就无法战胜标的本身了。&lt;/b&gt;换月策略虽然不是趋势追踪，但由于也是一种择时，因此类似的结论也对它有效。在股灾 3.0 之后，上证 50 和沪深 300 经历了近两年的牛市，这两者的夏普率都高达 1 以上，因此换月策略大幅跑输指数本身实属必然。对于中证 500、中小板以及创业板，由于指数本身的表现很差，换月策略战胜了指数。&lt;/p&gt;&lt;p&gt;&lt;b&gt;随着价值投资理念的回归，人们对大盘股在可预见的未来抱有“长期慢牛”的判断。在这种判断下，从获得尽量高的收益率来说，任何择时都是没有必要的。&lt;/b&gt;因此，如果我们未来以上证 50、沪深 300 的成分股为投资标的，那么换月策略显然远不如买入持有策略。在这种预期下，正确的路子无疑是选股。&lt;/p&gt;&lt;p&gt;由于每个月仅仅交易 4 天（或者由于换月窗口的缩窄而更少），换月策略的风险和波动率远低于指数本身。这也是显而易见的，因为它毕竟是一种择时，是一个 β 策略。交易次数少、低波动是它的优点，但对一些活跃交易者来说这也是它的缺点。毕竟，如果市场在非换月窗内的交易日上涨时，我们只能眼巴巴看着。此外，由于一年只有 12 个换月窗口，这意味着一年只有 12 个交易样本。因此，想要判断这个换月效应是否失效需要几年的时间。从这些角度来说，&lt;b&gt;换月效应虽然有不错的统计意义，但是作为独立策略来说，它的交易结构有些逆人性（交易次数太少，需要很长时间判断其是否有效或者失效）、收益率不够吸引人（特别是在对标具备长期慢牛走势的标的时），实在是有些“食之无味”。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;换月效应代表着市场的某种非有效性。本文的实证表明这种异象存在于 A 股之中且尚未完全失效，现存的各种假说也无法很好的解释它。因此，我们应该对它保持开放的心态，关注它的表现。虽然它不足以成为一个独立的策略，但是努力理解它背后揭示出来的市场的非有效性，有助于我们加深对市场的理解。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Carchano, O. and A. Pardo Tornero. (2011). &lt;i&gt;Calendar Anomalies in Stock Index Futures.&lt;/i&gt; SSRN, https://ssrn.com/abstract=1958587.&lt;/li&gt;&lt;li&gt;Jiao, L. (2011). Research on window-dressing of fund and its influencing factors – evidence from Chinese open-end stock fund market. &lt;i&gt;Science Technology and Engineering&lt;/i&gt;, Vol. 11(35), 1671 – 1815 (in Chinese).&lt;/li&gt;&lt;li&gt;Jusselin, P., E. Lezmi, H. Malongo, C. Masselin, T. Roncalli, and T-L. Dao. (2017). &lt;i&gt;Understanding the momentum risk premium: an in-depth journey through trend-following strategies.&lt;/i&gt; SSRN, https://ssrn.com/abstract=3042173.&lt;/li&gt;&lt;li&gt;Xu, W. and J. J. McConnell (2006). &lt;i&gt;Equity Returns at the Turn of the Month.&lt;/i&gt; SSRN, https://ssrn.com/abstract=917884.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;附录&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;A. 其他指数在月内不同交易日的平均收益率&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-95f61580ba73199a5355ecf102db6a0a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;775&quot; data-rawheight=&quot;647&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-95f61580ba73199a5355ecf102db6a0a&quot; data-watermark-src=&quot;v2-6020c94bdd1609a74196b89555a2dd77&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;B. 其他指数的换月效应假设检验结果&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8132fdda0130b0698552cab1eecb62c2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;442&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8132fdda0130b0698552cab1eecb62c2&quot; data-watermark-src=&quot;v2-11d8d056092c547c7e0aa6ee6d25e75b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f84b08e43e1b8bef17f45f29a782ce60_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;442&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f84b08e43e1b8bef17f45f29a782ce60&quot; data-watermark-src=&quot;v2-7c2eb723da3e6a2237bec6e762b5298c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e1b8510639f0120a3e736ad1e65d5c4f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;767&quot; data-rawheight=&quot;446&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e1b8510639f0120a3e736ad1e65d5c4f&quot; data-watermark-src=&quot;v2-e178c9bce0ea7092dcdd2eb4987e5b8f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9f8edfb32be6bd73b54bf213aee36cd1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;769&quot; data-rawheight=&quot;447&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9f8edfb32be6bd73b54bf213aee36cd1&quot; data-watermark-src=&quot;v2-ab04cae3b334dc0819ddff01b366fd2b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1c6bece30271504f0d8e80928502b572_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;715&quot; data-rawheight=&quot;305&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1c6bece30271504f0d8e80928502b572&quot; data-watermark-src=&quot;v2-03dead93f97ee9c2d627d6266f208856&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;C. 其他指数的换年及换季效应对换月效应的解释&lt;/b&gt;&lt;/p&gt;&lt;p&gt;上证 50：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-77971de345bed54dc8d0dc09049642b0_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;641&quot; data-rawheight=&quot;313&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-77971de345bed54dc8d0dc09049642b0&quot; data-watermark-src=&quot;v2-1cb8445cd5f942070ec87dd305be0f9f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ca78d4a1c2278f50e8a80f937b657f25_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;628&quot; data-rawheight=&quot;322&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ca78d4a1c2278f50e8a80f937b657f25&quot; data-watermark-src=&quot;v2-1adfc326321d1e24a34141c5d2480fcc&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;沪深 300：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3470a676dd6ac468528b405b15b8be78_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;634&quot; data-rawheight=&quot;313&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3470a676dd6ac468528b405b15b8be78&quot; data-watermark-src=&quot;v2-f7b928ab9e253670f01b43871e8db9f6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0cbf214724c4a5a535110d215ecdd45f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;628&quot; data-rawheight=&quot;321&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-0cbf214724c4a5a535110d215ecdd45f&quot; data-watermark-src=&quot;v2-dee3e2c08f42876112f897261298572a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;中证 500：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bbcf388c8cd9fedbe978092f07b366df_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;632&quot; data-rawheight=&quot;308&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-bbcf388c8cd9fedbe978092f07b366df&quot; data-watermark-src=&quot;v2-3577f8e95de709681265eeec38a959a6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-68767d61959570baabd5d0346c09eb29_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;629&quot; data-rawheight=&quot;324&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-68767d61959570baabd5d0346c09eb29&quot; data-watermark-src=&quot;v2-2e2c384efa5f7f8c9e0d6b88a0b1b493&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;中小板：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a4cc31bb7f3ef7496d80b12bdc9d6ba7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;304&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a4cc31bb7f3ef7496d80b12bdc9d6ba7&quot; data-watermark-src=&quot;v2-d2fc8253722a7129b57b7df0caf5e722&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4e669b895ca6535d83380a8b56a4f865_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;627&quot; data-rawheight=&quot;323&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4e669b895ca6535d83380a8b56a4f865&quot; data-watermark-src=&quot;v2-98be9df28452c8dcf5ec4722f1c97049&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;创业板：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-239bc40f9047e7e3b305bc99ac8c1821_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;629&quot; data-rawheight=&quot;304&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-239bc40f9047e7e3b305bc99ac8c1821&quot; data-watermark-src=&quot;v2-5cf089658ec51ee681135fe5de2499d6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7d39113cfb1b6f53d67099ab7143b042_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;632&quot; data-rawheight=&quot;321&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7d39113cfb1b6f53d67099ab7143b042&quot; data-watermark-src=&quot;v2-d38780bf7ff5451bf7b8ae0b5663cb48&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-08-09-41687401</guid>
<pubDate>Thu, 09 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>用 IC 评价因子效果靠谱吗？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-08-07-41454197.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41454197&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1d73f8816ba49ace8d28e63e225fc73a_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;传统的 IC 或者 Rank IC 在评价因子选股效果时不够合理，有一些陷阱。基于 IC 进行因子配置不十分靠谱。本文提出对 IC 的一些改进，并建议使用加权 IC 来评判因子效果。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 IC 和 Rank IC&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在多因子选股实务中，人们热衷于动态评价因子在单期截面上的选股效果。为实现这个目标，&lt;b&gt;通常的做法是用当期个股的因子取值（记为 &lt;/b&gt; &lt;equation&gt;x&lt;/equation&gt; &lt;b&gt;）和下一期个股的收益率（记为 &lt;/b&gt; &lt;equation&gt;y&lt;/equation&gt; &lt;b&gt;）在截面上计算信息系数（information correlation），简称 IC。&lt;/b&gt;IC 的计算方法通常有两种： &lt;equation&gt;x&lt;/equation&gt;  和 &lt;equation&gt;y&lt;/equation&gt; 的相关系数，以及 &lt;equation&gt;x&lt;/equation&gt; 和  &lt;equation&gt;y&lt;/equation&gt;  的秩相关系数（见下图）。第一种就是我们常说的 IC，第二种可以称作 Rank IC。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-87d9081b7aa994ea073a5c87b4d9a05f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1117&quot; data-rawheight=&quot;509&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-87d9081b7aa994ea073a5c87b4d9a05f&quot; data-watermark-src=&quot;v2-59b9763e140b5a16a0b295f01fb2b4d3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这里简单介绍下秩相关系数。&lt;/p&gt;&lt;p&gt;&lt;b&gt;秩相关系数（rank&lt;/b&gt; &lt;b&gt;correlation coefficient）&lt;/b&gt;和相关系数类似，不同的是它考察的是两个随机变量之间的&lt;b&gt;单调相关性（monotonic correlation）&lt;/b&gt;。秩相关性对变量之间的线性或非线性相关性不做假设。在计算秩相关系数时，使用的并不是观测值本身的数值，而是它们在各自样本中的排序。秩相关系数的取值在 -1 到 1 之间。&lt;/p&gt;&lt;p&gt;在统计学中，有多种计算秩相关系数的方法，其中最流行的要数 Spearman 秩相关系数，它以 Charles Spearman 命名。假设有两个随机变量 &lt;equation&gt;x&lt;/equation&gt; 和  &lt;equation&gt;y&lt;/equation&gt;  的  &lt;equation&gt;n&lt;/equation&gt;  对儿观测值，Spearman 秩相关系数 &lt;equation&gt;r_s&lt;/equation&gt; 的计算过程如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;首先将 &lt;equation&gt;x&lt;/equation&gt; 和  &lt;equation&gt;y&lt;/equation&gt;  的观测值转换成它们对应的排序 &lt;equation&gt;x_r&lt;/equation&gt; 和 &lt;equation&gt;y_r&lt;/equation&gt; 。&lt;/li&gt;&lt;li&gt;对 &lt;equation&gt;x_r&lt;/equation&gt; 和 &lt;equation&gt;y_r&lt;/equation&gt; 采用传统的线性相关系数公式，则可得到 &lt;equation&gt;r_s&lt;/equation&gt; ：&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;equation&gt;r_s=\displaystyle\frac{\mbox{cov}(x_r,y_r)}{\sigma_{x_r}\sigma_{y_r}}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;下图是某因子在一段时间内的滚动 Rank IC 移动平均，从中我们能对常见选股因子 IC 的取值范围有个大概的了解。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-68999c31c32f5ba25a76ac81ecb50c75_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1441&quot; data-rawheight=&quot;401&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-68999c31c32f5ba25a76ac81ecb50c75&quot; data-watermark-src=&quot;v2-62f1823cd7f8021c3d23e262852265b7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;从上面的定义可知，&lt;b&gt;无论使用 IC 还是 Rank IC，都希望它越大越好，越大说明因子选股的能力越强（也可以越小越好，那就反过来用因子）。&lt;/b&gt;我们也经常能在一些策略中看到使用 IC（或者 IR，即 IC 的均值除以标准差）的高低来动态进行因子的配置。&lt;/p&gt;&lt;p&gt;上面这些用法的核心前提是 IC 能够正确反映因子选股的能力。然而，真的是这样吗？&lt;b&gt;如果这个核心前提不成立，那么基于 IC 的各种因子择时、因子配置、因子打分恐怕难言靠谱。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 IC 中的陷阱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节通过一个假想的例子说明 IC 和 Rank IC 计算中存在的陷阱。假设有十支股票，它们的因子取值从大到小如下表所示。此外，考虑这十支股票的两组假想的收益率序列。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f41cebaac8efa9160d431f3528073074_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;534&quot; data-rawheight=&quot;390&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f41cebaac8efa9160d431f3528073074&quot; data-watermark-src=&quot;v2-f97c224ecc58c48b38ab2fdac22daf83&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;很容易计算该因子和这两组收益率序列的相关系数均为 0.2909。&lt;b&gt;如果仅仅看 IC 这个单一指标的话，我们会认为该因子在当期的选股能力很不错。&lt;/b&gt;但 IC 背后还有很多故事可讲。我们不妨把因子和这两组收益率序列画出来，并各自做一条线性回归线来看一看。&lt;/p&gt;&lt;p&gt;另 &lt;equation&gt;y&lt;/equation&gt; 代表收益率， &lt;equation&gt;x&lt;/equation&gt; 代表因子，则线性回归表达式为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;y=a+b x+\varepsilon&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式中斜率  &lt;equation&gt;b&lt;/equation&gt;  和 &lt;equation&gt;x&lt;/equation&gt; 与 &lt;equation&gt;y&lt;/equation&gt; 的相关系数 &lt;equation&gt;ρ&lt;/equation&gt; 满足如下关系：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;b=\displaystyle\rho\frac{\sigma_y}{\sigma_x}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;由于这两组收益率和因子的相关系数均为 0.2909，因此我们也以预期它们和因子的线性回归斜率相同。事实上，结果也正是如此（下图，斜率均为 0.0058）：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e7347071a9297ffe1710d17b7941d413_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;979&quot; data-rawheight=&quot;358&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e7347071a9297ffe1710d17b7941d413&quot; data-watermark-src=&quot;v2-a2fa84b1638a1b9f51d754b5320ce143&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;虽然 IC 一样，但是画出图来才看到这两组收益率序列和因子的关系大相径庭。假设从业务逻辑来说，个股的收益率和因子呈正相关，因此我们要选因子取值大的股票。但是，这个逻辑在上面两组收益率序列中会得到截然不同的结果：对于序列一，使用最大的因子取值可以选出收益率最高的股票；而对于序列二，使用最大的因子取值却选出了收益率相当差的股票。面对如此结果，IC 无辜吗？&lt;/p&gt;&lt;p&gt;如果使用 Rank IC 代替 IC，得到的也是同样的结论。这两组收益率和因子的秩相关系数均等于 0.3212。从这个数字背后解读不出任何超过这个数字本身的东西。&lt;/p&gt;&lt;p&gt;在量化投资中，我们喜欢并追寻能够精确计算出的数字。但这么做的前提是该数字有意义。在统计学家中流传着一个说法：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Numerical calculations are exact, but graphs are rough.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：数值计算是精确的，而图形是粗糙的。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;单一的统计量，比如上面的 IC 或者 Rank IC 却难以体现出图形反映出来的因子和收益率之间更多的关系。这说明如果我们仅仅看中 IC，可能会步入数据的陷阱。&lt;/p&gt;&lt;p&gt;仅关注统计量而忽视图形信息本身最著名的例子当属&lt;b&gt;安斯库姆四重奏（Anscombe’s quartet）&lt;/b&gt;。安斯库姆四重奏是四组基本的统计特性一致的数据，但由它们绘制出的图形则截然不同。每一组数据都包括了 11 个 &lt;equation&gt;(x_i, y_i)&lt;/equation&gt; 点。这四组数据由统计学家弗朗西斯·安斯库姆（Francis Anscombe）于 1973 年构造，他的目的是用来说明在分析数据前先绘制图表的重要性，以及离群值对统计的影响之大。&lt;/p&gt;&lt;p&gt;下图就是这四组数据绘制出来的图形，可见它们截然不同：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;第一组描绘了  &lt;equation&gt;x&lt;/equation&gt;  和  &lt;equation&gt;y&lt;/equation&gt;  之间近似的线性关系；&lt;/li&gt;&lt;li&gt;第二组中  &lt;equation&gt;x&lt;/equation&gt;  和  &lt;equation&gt;y&lt;/equation&gt;  表现出了明显的非线性关系；&lt;/li&gt;&lt;li&gt;第三组中  &lt;equation&gt;x&lt;/equation&gt;  和 &lt;equation&gt;y&lt;/equation&gt; 之间存在线性关系，但由于一个明显的 outlier 的存在改变了数据的统计结果；&lt;/li&gt;&lt;li&gt;第四组  &lt;equation&gt;x&lt;/equation&gt;  和  &lt;equation&gt;y&lt;/equation&gt;  本来没有线性关系，但由于一个显著 outlier 的存在也使得它们“好像有线性关系”。&lt;/li&gt;&lt;/ol&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1d73f8816ba49ace8d28e63e225fc73a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;659&quot; data-rawheight=&quot;292&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1d73f8816ba49ace8d28e63e225fc73a&quot; data-watermark-src=&quot;v2-603319976d3591b965c47b2f2396c128&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这四组数据和它们的统计特征如下图所示。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-00f5dc2d9078923a7fa50dd0cabca6ac_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1069&quot; data-rawheight=&quot;424&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-00f5dc2d9078923a7fa50dd0cabca6ac&quot; data-watermark-src=&quot;v2-f27776ae5997508bd4e237a2ede18197&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;这个例子完美的诠释了统计量（比如本文的 IC）不能反映出数据的全部信息。更危险的是，一旦它们被错误解读和使用，将会导致完全错误的结果。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 改进的 IC&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节的例子是为了说明当使用个股的因子取值和下期收益率在截面上回归时，得到的 IC 或者 Rank IC 不能很好的反映出因子选股的效果。对于这种情况，可以考虑以下两种改进方法。&lt;/p&gt;&lt;p&gt;&lt;b&gt;第一种方法是按照因子取值把个股分成 &lt;/b&gt; &lt;equation&gt;n&lt;/equation&gt; &lt;b&gt; 档（比如十档），然后将每一档视作一个投资组合，计算投资组合收益率和投资组合因子在截面上的 IC 或 Rank IC。&lt;/b&gt;每一个投资组合中，可以按照等权或者市值加权来计算投资组合的收益率和因子取值。&lt;/p&gt;&lt;p&gt;&lt;b&gt;因子描述的是一揽子股票所共同承担（或者暴露于的）的某一方面的系统性风险。使用因子选股是为了规避个股特异性收益率的风险。&lt;/b&gt;因此，比起个股，我们更应该关注一揽子股票的收益率和相应因子取值之间的相关性。这就是使用因子构建投资组合、再计算 IC 的初衷。投资组合的收益率是一揽子股票的均值，也可以更好的消除收益率上的噪音。&lt;/p&gt;&lt;p&gt;&lt;b&gt;第二种方法仍然从个股收益率和因子取值的 IC 出发，但是在计算时根据因子的业务逻辑（大到小、还是小到大的关系）来给 &lt;/b&gt; &lt;equation&gt;x&lt;/equation&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;equation&gt;y&lt;/equation&gt; &lt;b&gt; 的取值赋权，从而得到&lt;/b&gt; &lt;b&gt;weighted IC。&lt;/b&gt;由于结合了从业务逻辑出发的权重，这个加权 IC 能更好的反映因子的选股能力。&lt;/p&gt;&lt;p&gt;下面以上一节的因子取值和两组收益率序列为例解释这一做法。假设从业务出发，因子取值越大越好。将十组 &lt;equation&gt;(x_i, y_i)&lt;/equation&gt; 样本点按照因子值  &lt;equation&gt;x&lt;/equation&gt;  从大到小排序，并假设它们的权重按指数衰减，系数为 0.9。这十组样本点的权重为：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-70463357eb8a7819473bdcd4e09caaef_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;576&quot; data-rawheight=&quot;394&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-70463357eb8a7819473bdcd4e09caaef&quot; data-watermark-src=&quot;v2-e9a22d5f0ed869e0f26abf5dfe177005&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;有了权重向量（记为 w），就可以计算  &lt;equation&gt;x&lt;/equation&gt;  和  &lt;equation&gt;y&lt;/equation&gt;  之间的&lt;b&gt;加权均值、加权方差、加权协方差、以及加权相关系数（weighted correlation coefficient）&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} \mbox{E}_w[x]&amp;amp;=&amp;amp;\sum_i w_ix_i\\ \mbox{E}_w[y]&amp;amp;=&amp;amp;\sum_i w_iy_i\\\\ \mbox{cov}(x,y,w)&amp;amp;=&amp;amp;\sum_iw_i(x_i-\mbox{E}_w[x])(y_i-\mbox{E}_w[y])\\ &amp;amp;=&amp;amp;\sum_iw_ix_iy_i-\left(\sum_iw_ix_i\right)\left(\sum_iw_iy_i\right)\\\\ \mbox{var}(x,w)&amp;amp;=&amp;amp;\sum_iw_ix_i^2-\left(\sum_iw_ix_i\right)^2\\ \mbox{var}(y,w)&amp;amp;=&amp;amp;\sum_iw_iy_i^2-\left(\sum_iw_iy_i\right)^2\\\\ \rho(x,y,w)&amp;amp;=&amp;amp;\displaystyle\frac{\sum_iw_ix_iy_i-\left(\sum_iw_ix_i\right)\left(\sum_iw_iy_i\right)}{\sqrt{\sum_iw_ix_i^2-\left(\sum_iw_ix_i\right)^2}\sqrt{\sum_iw_iy_i^2-\left(\sum_iw_iy_i\right)^2}} \end{array} &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;根据上述定义，很容易计算出因子和这两组收益率序列的加权相关系数。它们分别为 0.4494（因子和第一组收益率序列），以及 0.0908（因子和第二组收益率序列）。从加权 IC 来看，显然&lt;b&gt;第一组的收益率序列比第二组收益率序列更能说明因子的选股能力。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;同样的，为了绘图说明加入权重的优势，对  &lt;equation&gt;x&lt;/equation&gt;  和 &lt;equation&gt;y&lt;/equation&gt; 进行 &lt;b&gt;weighted least squares 回归（WLS）&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\left[\begin{array}{c} y_1\\\vdots\\y_{10} \end{array}\right]= \left[\begin{array}{cc} 1&amp;amp;x_1\\ \vdots&amp;amp;\vdots\\ 1&amp;amp;x_{10} \end{array}\right]\left[\begin{array}{c} a\\b \end{array}\right]+\left[\begin{array}{c} \varepsilon_1\\\vdots\\\varepsilon_{10} \end{array}\right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;令  &lt;equation&gt;\bf X&lt;/equation&gt;  代表系数矩阵（包括截距项系数 1 和  &lt;equation&gt;x&lt;/equation&gt; ）， &lt;equation&gt;\bf W&lt;/equation&gt;  表示由权重 &lt;equation&gt;w_i&lt;/equation&gt; 作为第  &lt;equation&gt;i&lt;/equation&gt;  个对角元素构成的对角矩阵，则带权重回归的解为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\left[\begin{array}{c} a\\b \end{array}\right]=(\mathbf{X^TWX})^{-1}(\mathbf{X^TWy}) &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;利用线性代数的运算法则，不难求出上式右侧的第一项逆矩阵为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;(\mathbf{X^TWX})^{-1}=\left[ \begin{array}{cc} \displaystyle\frac{\sum w_ix_i^2}{\sum w_ix_i^2-(\sum w_ix_i)^2},&amp;amp;\displaystyle\frac{\sum w_ix_i}{(\sum w_ix_i)^2-\sum w_i x_i^2}\\ \displaystyle\frac{\sum w_ix_i}{(\sum w_ix_i)^2-\sum w_ix_i^2},&amp;amp;\displaystyle\frac{1}{\sum w_i x_i^2-(\sum w_ix_i)^2} \end{array} \right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;回归式中右侧第二项为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;(\mathbf{X^TWy})=\left[ \begin{array}{cc} \displaystyle\sum w_iy_i\\ \displaystyle\sum w_ix_iy_i \end{array} \right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;因此，加权回归的系数为（其中  &lt;equation&gt;a&lt;/equation&gt;  为截距， &lt;equation&gt;b&lt;/equation&gt; 为斜率）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\left[\begin{array}{cc} \displaystyle a\\ \displaystyle b \end{array}\right]=\left[ \begin{array}{cc} \displaystyle\frac{(\sum w_ix_i^2)(\sum w_iy_i)-(\sum w_ix_i)(\sum w_ix_iy_i)}{\sum w_ix_i^2-(\sum w_ix_i)^2}\\ \displaystyle\frac{\sum w_ix_iy_i-(\sum w_ix_i)(\sum w_iy_i)}{\sum w_ix_i^2-(\sum w_ix_i)^2} \end{array} \right] &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;费了半天劲写出了  &lt;equation&gt;a&lt;/equation&gt;  和  &lt;equation&gt;b&lt;/equation&gt;  的表达式（其实从求解的角度，给出矩阵形式的求解足够了）只是想说明下面这件事儿。如果我们比较加权相关系数 &lt;equation&gt;ρ(x, y, w)&lt;/equation&gt; 以及加权方差（标准差） &lt;equation&gt;\mbox{var}(x, w)&lt;/equation&gt; 和 &lt;equation&gt;\mbox{var}(y, w)&lt;/equation&gt; ，以及斜率  &lt;equation&gt;b&lt;/equation&gt; ，则不难发现，和 OLS 一样，在加权回归中， &lt;equation&gt;\rho&lt;/equation&gt; 和  &lt;equation&gt;b&lt;/equation&gt;  仍然满足如下关系：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;b=\displaystyle\rho(x,y,w)\frac{\sigma(y,w)}{\sigma(x,w)}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;下面就来画图比较一下 WLS 回归和上一节 OLS 回归的结果。对于这两组收益率序列，OLS 回归的结果相同。但从选股的角度，我们知道如果因子对应的是第一组收益率，则该因子远比其对应第二组收益率有效。但是 OLS 回归（和普通的 IC）无法体现这一点。而采用改进的 WLS（以及 weighted IC）来衡量的话，如果因子产生了第一组收益率序列，则它的 WLS 回归斜率为 0.01（大于 OLS 的斜率 0.0058）；如果因子产生了第二组收益率序列，则它的 WLS 回归斜率仅为 0.0017（小于 OLS 的斜率）。&lt;b&gt;这说明通过使用基于因子业务规则的权重系数，WLS 比 OLS 更能判断因子和收益率之间的关系。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-15e96b468c9ddc02f9d2b9c217c30e43_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;979&quot; data-rawheight=&quot;351&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-15e96b468c9ddc02f9d2b9c217c30e43&quot; data-watermark-src=&quot;v2-22e6a9f09e02d6b1ae0139a8cff931b9&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在我上统计课的时候，教授总是反复强调，拿来数据先画出来看一看。&lt;b&gt;我们之所以能够相信统计量，是以搞清楚了数据内在的结构、形态为前提的。&lt;/b&gt;如果没有这个前提，盲目的相信统计量就会导致错误的判断。金融数据已经信噪比极低了，我们当然不希望因为自己使用不当再加入不必要的噪音。&lt;/p&gt;&lt;p&gt;&lt;b&gt;很多时候数据关系越复杂，统计量传递出来的信息可能越失真。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;2017 年，来自 Autodesk Research 的 Matejka 和  Fitzmaurice 构建了当代版的“安斯库姆四重奏”（Matejka and Fitzmaurice 2017）。他们用计算机算法可以生成  &lt;equation&gt;x&lt;/equation&gt;  均值、 &lt;equation&gt;y&lt;/equation&gt;  均值、 &lt;equation&gt;x&lt;/equation&gt;  标准差、 &lt;equation&gt;y&lt;/equation&gt;  标准差、以及  &lt;equation&gt;x&lt;/equation&gt;  和 &lt;equation&gt;y&lt;/equation&gt; 相关系数相同的复杂数据集。比如下图中的 12 个完全不同的数据集就在上述五个统计量中取值完全一致 —— &lt;equation&gt;x&lt;/equation&gt; 均值 54.26， &lt;equation&gt;y&lt;/equation&gt; 均值 47.83， &lt;equation&gt;x&lt;/equation&gt;  标准差 16.76， &lt;equation&gt;y&lt;/equation&gt;  标准差 26.93， &lt;equation&gt;x&lt;/equation&gt; 和 &lt;equation&gt;y&lt;/equation&gt; 相关系数 -0.06。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d858e7c1b50f974667594aa68514b05c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1175&quot; data-rawheight=&quot;611&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d858e7c1b50f974667594aa68514b05c&quot; data-watermark-src=&quot;v2-b0361c86019735eda70e2407ea81d3f5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;先别忙着惊讶，上述这些数据集都是由下面这张恐龙数据集（也有同样的统计量）构建来的（请点击 GIF 看动画）！&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2346918863d4dfe069a0531271e0420e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;544&quot; data-rawheight=&quot;195&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2346918863d4dfe069a0531271e0420e&quot; data-watermark-src=&quot;v2-b1ac47228cdd28ac63bd4dc4e9258f18&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-30d91e04235f12b644fcdf15081d164b_r.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;827&quot; data-rawheight=&quot;332&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-30d91e04235f12b644fcdf15081d164b_b.jpg&quot;&gt;&lt;p&gt;有的朋友也许会说，IC 不够，再引入更多的统计量就行了。我们当然可以计算更高阶矩的统计量，但是因为数据的信噪比极低，这些样本数据计算出来的高阶统计量也存在大量误差。本文提出的改进方法属于从因子和收益率之间的内在逻辑出发 —— 比如分档构建组合、或者给不同的权重。这些都是&lt;b&gt;以内在的逻辑为先验&lt;/b&gt;，以期更好的判断因子的选股能力。&lt;/p&gt;&lt;p&gt;如果你在使用 IC 或者 Rank IC（以及 IR）来动态的评价、配置因子，那么本文希望能引发你的思考。在评价因子选股效果的道路上，我们也许还有很长的路要走。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Matejka, J. and G. Fitzmaurice (2017). &lt;i&gt;Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics through Simulated Annealing.&lt;/i&gt; CHI 2017 Conference proceedings: ACM SIGCHI Conference on Human Factors in Computing Systems.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-08-07-41454197</guid>
<pubDate>Tue, 07 Aug 2018 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
