<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>川流不息</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/</link>
<description>北京量信投资管理有限公司是一家在中国基金业协会备案登记的专业私募基金管理人。本专栏作者石川是量信投资的联合创始人。希望通过这个平台和各位小伙伴分享我们在量化投资领域的知识和心得。原创不易，请保护版权，请在获得授权后转载。已委托“维权骑士”(http://rightknights.com) 为进行维权行动。</description>
<language>zh-cn</language>
<lastBuildDate>Tue, 24 Jul 2018 17:26:00 +0800</lastBuildDate>
<item>
<title>给你的动量选股策略加点“料”</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-24-40468929.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40468929&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2a498f325ae45d29690ea71bfbe7058f_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于那些过程驱动、以长期盈利为目标、能够严格遵守交易纪律的投资者来说，动量策略值得配置。本文介绍两个改进动量策略的技巧，让动量变成高质量动量。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 动量策略的一点历史&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2013 年，Asness、Moskowitz 以及 Pedersen 在著名的 Journal of Finance 上发表了一篇影响深远的文章，题为 Value and Momentum Everywhere（无处不在的价值和动量，Asness et al. 2013）。这篇长度为 57 页的文章从最初提交到最终发表历时 4 年，通过大量实证指出价值和动量存在于全球所有市场中（股票、外汇、固定收益、商品期货等）。比如，下表展示了美国、英国、欧洲和日本四个股票市场上的动量策略结果。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-dd2dea628b91d3ac78f2f09fe70f09a1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;767&quot; data-rawheight=&quot;345&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-dd2dea628b91d3ac78f2f09fe70f09a1&quot; data-watermark-src=&quot;v2-673b124ce71c487e8d2efeb3be71094c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;在股票市场，动量策略指的是挑选过去一段时间涨幅高的那些股票在未来持有，从而获取超额收益。&lt;/b&gt;在能够做空的市场，也可以通过做多过去一段时间涨幅高的并且做空跌幅高的来对冲市场风险。对于纯多头的策略，在选股时可以考虑时序动量、截面动量、又或二者皆而有之。&lt;/p&gt;&lt;p&gt;&lt;b&gt;如今，动量（momentum）已经作为一个风格因子被市场广泛接受。此外，由于动量和价值这两个因子在长期来看存在负相关性，动量因子的配置价值就显得格外重要。&lt;/b&gt;然而，在最初的那段岁月里，市场对动量却是嗤之以鼻。&lt;/p&gt;&lt;p&gt;动量策略最初进入人们的视线是在 1967 年。当年，Robert Levy 在 Journal of Finance 上发表了一篇题为 Relative Strength as a Criterion for Investment Selection 的文章（当年动量 —— momentum —— 一词还没有被造出来）。在该文中，Levy 给出的结论是：&lt;b&gt;通过买入过去一段时间最强势的股票要比随机选股获得更高的收益。&lt;/b&gt;这个发现令人惊喜，但关于动量的研究并没有因此而拉开大幕。因为在同时期，&lt;b&gt;有效市场假说（efficient-market hypothesis，EMH）&lt;/b&gt;诞生了。&lt;/p&gt;&lt;p&gt;在 19 世纪 60 到 70 年代，在金融领域占有举足轻重地位的芝加哥大学（具体的，Eugene Fama）提出了有效市场假说。从 EMH 的观点出发，Levy 的发现根本不值一提，一定是搞错了。在 EMH 被提出之后的 25 多年里，该理论被学术界广泛认可、获得了飞速发展。&lt;b&gt;而这段 EMH 的繁荣时期恰恰是动量策略的一段黑暗时刻。&lt;/b&gt;在那 25 年里，学术界的顶级期刊上的所有篇幅都预留给了 EMH 的追随者；任何挑战 EMH 的发现都被禁止。&lt;/p&gt;&lt;p&gt;这期间唯一的例外大概要数价值投资。从 19 世纪 70 年代开始，一些和价值投资相关的异象逐渐被发表和接受。这里面有两个主要原因。第一个原因是以 Ben Graham 和 Warren Buffett 为代表的价值投资取得了巨大的成功 —— 巨大到学术界那些 EMH 的守护者们根本无法忽视它。第二个原因是以 Daniel Kahneman 和 Amos Tversky 为代表的心理学家在行为金融学的研究上取得了巨大进展，将人们的行为偏差和市场上观察到的各种异象完美的结合起来。终于，EMH 变的不再那么“权威”。&lt;/p&gt;&lt;p&gt;然而，上述这些突破并没有为动量投资带来任何帮助。颇为讽刺的是，在对动量策略的看法上，价值投资的先知们和 EMH 的拥趸持有完全相同的看法 —— &lt;b&gt;动量投资是“一种黑色艺术，一种巫术魔力，只有愚人和异端者才会尝试”。&lt;/b&gt;这其实不难理解，在价值投资者看来，价值投资是对基本面的充分挖掘、从而找到价值和价格的背离，这需要对行业和公司的深入理解、这是一门科学；而动量呢？只需要傻买过去涨的猛的就行了，毫无技术含量。&lt;/p&gt;&lt;p&gt;但是，就像所有真理一样，事实胜于雄辩、更胜于诡辩。1993 年 Narasimhan Jegadeesh 和 Sheridan Titman 在 Journal of Finance 上发表了一篇对于动量策略来说是里程碑式的文章，题为 Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency。在大量的实证数据分析之下，动量策略终于走上台面；所有否定者都明白，如果再忽视它就只能说明自己的无知与傲慢。&lt;/p&gt;&lt;p&gt;如今，动量选股广泛被人接受。就连 EMH 之父 Eugene Fama 也承认动量的存在。在 2008 年，美国金融协会的金融大师系列访谈节目中，Fama 坦言“动量策略确实存在于世界各国，除了日本”（下图）。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9769424e1b3b4b9d02e98ede17ca3c4c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;839&quot; data-rawheight=&quot;464&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9769424e1b3b4b9d02e98ede17ca3c4c&quot; data-watermark-src=&quot;v2-33ebfb98db311bd35e28e5e0d55103d6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;颇有意思的是， Fama 的学生 Clifford Asness（在上面的这个访谈中，Fama 评价 Asness 是近 20 年内最好的学生）似乎非要和他当年的恩师唱唱反调。在 2011 年，Asness 发表了一篇题为 Momentum in Japan 的文章，和 Fama 隔空喊话。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-87d3edcb4c08b072973d037a2304671d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;739&quot; data-rawheight=&quot;225&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-87d3edcb4c08b072973d037a2304671d&quot; data-watermark-src=&quot;v2-7aef97d121f76f20e61e200ec7d5de97&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;不过，在这篇文章中，Asness 指出日本市场的动量策略的价值更多的体现在它在投资组合中的配置作用。具体的，动量和价值因子长期负相关，因此在日本市场的投资组合中同时配置这两种因子可以取得性价比更高的风险收益。此外，Asness 在讨论日本动量策略的时候考虑的是多空对冲的组合，并没有对纯多头的动量组合进行太多的探讨。&lt;/p&gt;&lt;p&gt;这似乎稍显不足，但是在 Gray and Vogel (2016) 所著的一本名为&lt;b&gt;量化动量（Quantitative Momentum）&lt;/b&gt;的书中，作者用 Asness 的数据复制了纯多头的日本动量策略，并指出即使是纯多头策略也能战胜市场，从而说明了动量存在于日本市场（本文最开始表格中日本市场的动量策略结果就来自 Gray and Vogel 2016）。&lt;/p&gt;&lt;p&gt;本文的题目为“给你的动量选股策略加点料”，是为了介绍 Gray and Vogel (2016) 提出的两种改进动量策略的技巧，从而把动量变成“高质量”动量（有条件的话，我同时非常推荐大家读一读这本 Quantitative Momentum）。为此，我们会在下文中介绍这两个小技巧，并以中证 500 成分股为选股池进行动量策略的实证。&lt;/p&gt;&lt;p&gt;在介绍这两个小技巧之前，先来看一个基础版的动量策略。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 基础版动量策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我之前写过一篇文章验证 Jegadeesh 和 Titman 的思路，当初的结论是，在大 A 股，反转要明显强于动量。但我们今天既然聊动量，那就无论如何要找个合适的基础版动量策略（在美股上动量策略的效果更明显，而下文介绍的改进也是针对美股提出的，因此有条件交易美股的小伙伴更应该关注）。&lt;/p&gt;&lt;p&gt;本文实证以中证 500 的成分股为选股池。对于中证 500，过去 60 个交易日风险调整后的涨幅（即累积涨幅减去风险厌恶系数 50 乘以这段时间内日收益率的方差）是个不错的动量指标（这么做的主要目的是为了排除小市值的影响）。以此为动量选股的依据，并使用如下的交易策略：&lt;/p&gt;&lt;p&gt;每日更新动量指标并重新对股票排名，新股理想仓位为 1%、等权配置；卖出条件为最新动量排名超过 100；为降低换手率，要求每支股票买入后持有不少于 40 个交易日，假设单边交易费用为千分之一、假设按照收盘价交易。排除 ST 股票并考虑因停牌不能买、卖的股票。&lt;/p&gt;&lt;p&gt;假设回测期为 2009 年 1 月 1 日到 2018 年 7 月 23 日。在这段时期内，上述动量选股策略和中证 500 指数的表现如下表所示，&lt;b&gt;动量策略战胜了指数&lt;/b&gt;（动量策略是等权配置，相当于偏向小市值，因此用等权的 500 指数作为基准更合理；但经分析发现动量策略的因子和小市值因子的相关性仅为 0.085，因此认为使用市值加权的中证 500 指数作为基准是可以接受的）。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c9182b05e88278b9f269bf6fe4d981f9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;588&quot; data-rawheight=&quot;254&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c9182b05e88278b9f269bf6fe4d981f9&quot; data-watermark-src=&quot;v2-23441da94819a461f1e63370dc951eb4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;下图为基准版动量因子的选股效果。可见，它的单调性还不错，但是在截面上的区分度不够。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-17b9c9fbec45d599f4b0e0f6cd7bfc45_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1107&quot; data-rawheight=&quot;464&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-17b9c9fbec45d599f4b0e0f6cd7bfc45&quot; data-watermark-src=&quot;v2-3bd5adbcd33d8408baf26e5b16cc0a00&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;以上就是我们的基础版动量策略。下一节就来看看如何提高它。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 对动量策略的两点改进&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Gray and Vogel (2016) 提出的对动量的改进方法源自一个信仰：&lt;b&gt;the path matters（动量积累的路径很重要）。&lt;/b&gt;为了说明这一点，他们给出了一个例子。考察下面两只股票，它们的动量因子是相同的（Gray and Vogel 2016 采用了海外常见的过去 12 个月排除最近 1 个月的收益率作为衡量动量的标准；排除最近 1 个月的原因是观察到最近 1 个月的收益率容易在样本外出现反转）。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-74987f6a7ade690ea85c41b38a116251_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;654&quot; data-rawheight=&quot;520&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-74987f6a7ade690ea85c41b38a116251&quot; data-watermark-src=&quot;v2-81fa5d58288b31a17f2a5095b7ae265a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在上图中，选股时点是 2000 年 3 月 31 日，计算动量的窗口是 1999 年 3 月 31 日到 2000 年 2 月 29 日。&lt;b&gt;这两支股票的动量相同，然而它们动量累积的路径却大相径庭。&lt;/b&gt;图中，实线对应公司的股价涨幅明显更加平滑，而虚线对应公司的股价涨幅则更加无序。在过去一年内，实线公司有 55% 的时间上涨，而虚线公司则仅有 49% 的时间上涨。&lt;/p&gt;&lt;p&gt;不同的路径带来了样本外的不同走势（当然，这个例子是精心挑选的，从而最大化的说明路径的重要性）。这两支动量相同、路径不同的股票在样本外的三个月，实线对应的公司涨幅高达 46.9%，而虚线对应的公司则惨跌 24.7%。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b091bd99948940261cb6376d6fa7720b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;648&quot; data-rawheight=&quot;531&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b091bd99948940261cb6376d6fa7720b&quot; data-watermark-src=&quot;v2-ef3e1369f5419716c48f9517554845b8&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这个例子强调了从动量到高质量动量所需的两个技巧（其实是同一问题的两面）：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;寻找依靠价格缓慢增长实现的高动量；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;避免大波动造成的高动量。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;价格稳定缓慢增长带来的高动量在样本外更有可能持续走高，而依靠大波动造成的高动量则在样本外难有作为。&lt;b&gt;这两点其实和行为金融学中的两个行为偏差有关。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;先说第一点。我们都熟悉温水煮青蛙这个故事：如果将一只青蛙放进沸水中，它会马上跳出来；但如果将它放进冷水中慢慢加热，将会察觉不到危险而被煮死。这个故事经常被用来比喻&lt;b&gt;人们不能注意逐渐产生的变化，因此无法对此做出适当的反应。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在行为金融学中，人的这种缺陷叫做 &lt;b&gt;limited attention（有限注意力）&lt;/b&gt;。由于人们的认知资源是有限的，在任何给定的时刻，我们的大脑都偏好去处理那些最显著、最重要的信息，而忽视那些不显著的、经济效应微弱的因素。针对这个偏差，Da et al. (2014) 提出了一个假设：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;A series of frequent gradual changes attracts less attention than infrequent dramatic changes. Investors therefore underreact to continuous information.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;它说的是&lt;b&gt;一系列频繁但微小的变化对于人的吸引力远不如少数却显著的变化；因此投资者对于连续信息造成的股价变化反应不足。&lt;/b&gt;针对这个假设，作者提出了&lt;b&gt;信息离散性（information discreteness，ID）&lt;/b&gt;这个概念，并猜想 &lt;b&gt;ID 低（说明信息连续性强）的动量才是高质量动量&lt;/b&gt;，而 ID 高（信息离散性高）的动量是低质量动量。作者使用如下这个代理指标来计算信息离散性：&lt;/p&gt;&lt;p&gt;ID = sign(过去一段时间的收益率) × (这段时间内下跌交易日% - 这段时间内上涨收益日%)&lt;/p&gt;&lt;p&gt;Da et al. (2014) 通过实证说明 ID 是一个优秀的选股因子（越低越好），且它能获得 Fama-French 三因子无法解释的超额收益。&lt;b&gt;与传统动量相比，通过 ID 因子删选找到的高质量动量能够获得更高的超额收益，且该收益在样本外的持续性更强（这有助于我们降低调仓频率、减少换手率、节约交易成本）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;再来看第二点 —— 避免大波动造成的高动量。&lt;b&gt;我们经常观察到某些股票的收益率分布是明显右偏的（positively skewed），这些股票称为“lottery-like”股票。&lt;/b&gt;行为金融学中重要的理论 —— 前景理论 —— 指出，&lt;b&gt;人们对于极小概率事件发生的主观感受存在认知偏差，会高估它们发生的概率。&lt;/b&gt;Barberis (2012) 总结了人们在赌场中的这一行为偏差。而人们在股市中的行为也比在赌场中好不了哪去。&lt;b&gt;对于小概率事件发生可能性的高估导致投资者会过度追逐具有正偏度分布的股票，造成它们的高动量。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Bali et al. (2011) 使用一个称作 MAX 的代理指标研究了这个问题。MAX 是过去 1 个月内日收益率的最大值（美股不设涨跌停板限制，因此更能反映人们对 lottery-like 股票追逐的疯狂程度）。使用 MAX 将股票分成 10 组，MAX 值最高的那一组为 lottery-like 股票，而 MAX 值最低的那一组称为“无聊”股票。&lt;b&gt;数据显示，“无聊”股票能显著跑赢 lottery-like 股票。在挑选高动量股票时，我们可以主动避免那些 lottery-like 股票。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;通过以上的说明，我们接下来尝试使用信息离散性和 lottery-like 股票的代理指标来改进基础版动量策略。经过我的简单实测，对于中证 500，Da et al. (2014) 一文给出的 ID 定义作用不大。为此我们按照这个思路来选择其他的代理指标。&lt;b&gt;考虑到目标是为了挑选平时投资者关注度低的股票，我们选择三个月内日换手率的标准差作为 ID 的代理指标，其越低越好。&lt;/b&gt;对于 lottery-like 的代理指标，我们则就选用 MAX 指标，即过去 20 天的日收益率最大值，它也是越低越好。&lt;/p&gt;&lt;p&gt;将原始的 120 天收益率（动量因子）结合上面这两点改进就得到了升级版的“高质量动量”策略。使用这三个标准的合成因子选股，大大提升了不同档投资组合收益率的单调性，同时显著提升了因子 IC 和 IR。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-841e804f0972c399584c7857d18293a5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1095&quot; data-rawheight=&quot;462&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-841e804f0972c399584c7857d18293a5&quot; data-watermark-src=&quot;v2-efe4e89ad45abacbbe8bcd4e381680fe&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在回测期内，该升级版动量策略和中证 500 指数以及基础版策略的效果如下。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5293d3e247a5e788cdb782180b04e51d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;709&quot; data-rawheight=&quot;254&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5293d3e247a5e788cdb782180b04e51d&quot; data-watermark-src=&quot;v2-05109aa765a444949a77cd09f7b79131&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;可见，加入两个改进让我们获得了更高质量的动量；它们提升了动量策略的收益风险比。升级版的策略获得了更高的收益率、夏普率以及更低的波动率和最大回撤。&lt;/p&gt;&lt;p&gt;最后需要强调的是，上面的实证仅仅是为了给大家介绍改进的思路。具体是否使用上述代理指标以及参数需要结合不同的动量选股策略来考量。比如我观察到同样的指标和参数在沪深 300 的成分股上的效果就不如它们在中证 500 上的效果，但是这个思路是值得借鉴的。此外，如果单加入 MAX 的话并不能战胜基础版动量策略，但是加入 MAX 后可以提升最终因子的 IC 和 IR。&lt;/p&gt;&lt;p&gt;路径很重要！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 动量策略并不适合所有人&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;高质量动量策略打败了市场。这样的结果令人振奋。这是因为动量非常简单，只需要买过去涨的多的就行了，它不像价值投资那样需要投资者深谙上市公司的基本面。&lt;/p&gt;&lt;p&gt;但是，在这里必须适时地泼一盆冷水。&lt;b&gt;动量投资虽然简单，但它并不容易。动量投资并不适合所有人。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;上面提到的这个升级版动量策略，它在过去十年和中证 500 指数的收益率比较如下：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d621300b6c21432cde987dc22ab88cfb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;582&quot; data-rawheight=&quot;393&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d621300b6c21432cde987dc22ab88cfb&quot; data-watermark-src=&quot;v2-50eba7d3b246e2ccf1ba95cb06bc9570&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;可见，&lt;b&gt;动量策略并不能每年都跑赢指数&lt;/b&gt;，而且在最近的两年里均跑输指数。这样的特点说明，&lt;b&gt;要想交易动量策略，必须 100% 从心理上接受它的 down time，但这无疑是一种煎熬。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在面对一个策略低潮的时候，我们非常容易动摇，怀疑市场风格已经切换了，它不再适用。那么，动量策略的背后到底有没有站得住脚的原因呢？任何一个策略要想在逻辑上说的通都需要满足两个条件：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;噪音交易者的行为（基于认知偏差）造成了市场的错误定价；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;聪明投资者有很高的套利成本因此无法及时消除错误定价。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;我们来看看动量投资是否满足这两点。&lt;/p&gt;&lt;p&gt;对于第一点，Barberis、Shleifer、以及 Vishny 研究了投资者情绪（现在这被称为著名的 BSV 模型，Barberis et al. 1998），并指出：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;当好的盈利消息接二连三出现时，会引起投资者的过度反应，&lt;/b&gt;因为他们会出现 &lt;b&gt;representative bias&lt;/b&gt;，过度看中最近发生的这些连续的利好消息、并把这种预期外推到对公司未来股价的预测上；一旦未来的盈利没有达到预期，就会引起他们的恐慌，造成股价的下跌，这恰恰是&lt;b&gt;成长投资（growth investment）&lt;/b&gt;的特点。&lt;/li&gt;&lt;li&gt;另一方面，&lt;b&gt;当好的盈利消息离散的、非连续的出现时，投资者会对它们反应不足。&lt;/b&gt;这时投资者会出现 &lt;b&gt;conservatism bias（保守主义）&lt;/b&gt;。他们会对这个利好持怀疑态度、不情愿更新他们对于该公司基本面的认知，这导致他们无法有效的对股价做出调整。随着时间的推移，当该公司又逐渐出现新的盈利利好时，其股价才会慢慢对其新的基本面反映到位，这就是动量投资。Bernard 和 Thomas 于 1989 提出了&lt;b&gt;盈余动量现象（post-earnings-announcement drift，PEAD）&lt;/b&gt;，也是投资者对利好消息反应不足的体现、符合上面这种解释。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;再来看看第二点。既然对于利好消息的反应不足导致了错误定价，那么为什么聪明的投资者（通常是机构）没有去充分套利消除这个定价错误呢？原因是这么做涉及到高昂的&lt;b&gt;套利成本（arbitrage cost）&lt;/b&gt;。假设 A 和 B 两地都卖苹果，A 地价格 5 块一斤，B 地价格 10 块一斤；苹果 B 地存在错误定价。面对这个情况，&lt;b&gt;理论上&lt;/b&gt;的做法是从 A 地买苹果然后拿到 B 地去卖，赚取 5 块钱一斤的差价。这么做的人多了，就会造成 B 地价格下降，最终消除定价错误。&lt;/p&gt;&lt;p&gt;但那仅仅是理论上。在现实中，套利者必须考虑各种成本，比如 A 和 B 两地的运输成本，对苹果的储藏成本，两地出租商铺的不同开销甚至是所得税的区别；此外，还要有苹果价格下跌的风险 —— 在它把苹果从 A 运到 B 的过程中，可能苹果在 B 地已经下跌了，甚至跌破他的成本，那无疑就是“赔了夫人又折兵”。正是由于各种各样的成本，使得任何聪明的人都不敢毫无顾虑的套利，这在学术上被称为 &lt;b&gt;limits to arbitrage（有限套利）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;凯恩斯（Keynes）曾经说过一句非常著名的话：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Markets can remain irrational longer than you can remain solvent.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;对于动量策略，错误定价是由于噪音交易者对好的盈利消息反应不足造成的。长期来看，这个错误虽然一定会被修正，但是就短期而言，它不一定会修复，而且可能还会进一步扩大（remain irrational）。对于聪明交易者来说，&lt;b&gt;交易动量策略最大的套利风险是由于动量策略在短期相对于基准指数的弱势表现而造成的职业风险（career risk）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;职业风险产生的原因是，市场上的资金委托专业机构代表他们管理自己的资本。不幸的是，这些资金大多都是 short-sighted performance chasers，他们往往仅根据&lt;b&gt;短期&lt;/b&gt;相对于基准的表现来评估基金经理的业绩。这让基金经理于进退两难的局面。一方面，基金经理希望利用错误定价机会交易动量策略，因为长期来看这么做的期望收益能够战胜基准；但另一方面，他们这样做的前提是，利用错误定价在短期不会威胁到他们手中的资金 —— 投资者不会因为业绩短期跑输基准而撤回资金。&lt;/p&gt;&lt;p&gt;上面的分析说明，认知偏差存在于噪音交易者中间，而有限套利摆在聪明交易者面前。这二者导致了动量策略如下的特点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;动量策略在短期可能会（大幅）跑输市场，因此并不适合所有人（资金）；&lt;/li&gt;&lt;li&gt;长期来看，动量策略会战胜市场。对于那些过程驱动、以长期盈利为目标（而忽视短期波动）、能够严格遵守交易纪律的投资者来说，动量策略值得配置。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;如果动量策略是你的菜，那么也许本文介绍的提高动量质量的方法值得一试。&lt;/p&gt;&lt;p&gt;&lt;b&gt;动量和价值是 Barra（现 MSCI）因子库中的两个雷打不动因子。&lt;/b&gt;下图来自 MSCI 的文章 What is Going on with Factor Returns? 该文分析了 2018 年以来一些因子在美股上的表现，从中我们能够观察到价值（enhanced value）和动量因子之间的负相关性。颇有意思的是在今年六月，两个因子双双跑输市场，这造成了一定的“恐慌”，这就是 MSCI 出来写此文的原因，安抚大家说这样的表现也实属正常。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-78f510364059581a4cdfdc1a62df74c4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;851&quot; data-rawheight=&quot;432&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-78f510364059581a4cdfdc1a62df74c4&quot; data-watermark-src=&quot;v2-0a330feef7bc062cbf9f5dff8fc5a7bf&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;也许正如 Value and Momentum Everywhere 一文指出的那样，&lt;b&gt;动量策略的最好归宿是和价值策略配合在一起&lt;/b&gt;，提高投资组合的风险收益特征。&lt;/p&gt;&lt;p&gt;这也正应了市场中的那句老话：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Buy&#39;em cheap, buy&#39;em strong; and hold&#39;em long.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;如果你想躲避市场下跌时多头策略的亏损，那就再加一句：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;but only when the trend is your friend.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Asness, C. S., T. J. Moskowitz, and L. H. Pedersen (2013). Value and Momentum Everywhere. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 68(3), 929 – 985.&lt;/li&gt;&lt;li&gt;Bali, T. G., N. Cakici, and R. F. Whitelaw (2011). Maxing Out: Stocks as Lotteries and the Cross-section of Expected Returns. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 99(2), 427 – 446.&lt;/li&gt;&lt;li&gt;Barberis, N. (2012). A Model of Casino Gambling. &lt;i&gt;Management Science&lt;/i&gt;, Vol. 58(1), 35 – 51.&lt;/li&gt;&lt;li&gt;Barberis, N., A. Shleifer, and R. Vishny (1998). A Model of Investor Sentiment. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 49(3), 307 – 343.&lt;/li&gt;&lt;li&gt;Bernard, V. L. and J. K. Thomas (1989). Post-Earnings-Announcement Drift: Delayed Price Response or Risk Premium? &lt;i&gt;Journal of Accounting Research&lt;/i&gt;, Vol. 27, 1 – 36.&lt;/li&gt;&lt;li&gt;Da, Z., U. Gurun, and M. Warachka (2012). &lt;i&gt;Frog in the Pan: Continuous Information and Momentum&lt;/i&gt;. AFA 2012 Chicago Meetings Paper. Available at SSRN: https://ssrn.com/abstract=1777988.&lt;/li&gt;&lt;li&gt;Gray, W. R. and J. R. Vogel (2016). &lt;i&gt;Quantitative Momentum, a Practitioner’s Guide to Building a Momentum-Based Stock Selection System&lt;/i&gt;. John Wiley &amp;amp; Sons, Inc., Hoboken, New Jersey.&lt;/li&gt;&lt;li&gt;Jegadeesh, N. and S. Titman (1993). Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 48(1), 65 – 91.&lt;/li&gt;&lt;li&gt;Levy, R. (1967). Relative Strength as a Criterion for Investment Selection. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 22(4), 595 – 610.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-24-40468929</guid>
<pubDate>Tue, 24 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>什么样的收益率特性适合趋势追踪策略</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-23-40358079.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40358079&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5463408f8e23ba5e3651c0c59a5433d2_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在交易中如果想挣钱，就必须借助市场的“大势”：在牛市中做多；在熊市中做空。事实上，在商品期货交易中的大部分 CTA 策略都是趋势追踪策略。在股票交易中，虽然不易做空，但是只做多的趋势策略依然有很好的效果。&lt;/p&gt;&lt;p&gt;听起来，趋势追踪像是“包治百病的良药”。不过，来看两个例子。&lt;/p&gt;&lt;p&gt;&lt;b&gt;例子 1：上证指数&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以上证指数为标的，下图为某个纯做多的简单&lt;b&gt;日频&lt;/b&gt;趋势追踪策略的净值曲线（这其中采用收盘价进行信号触发的计算，用第二天开盘价作为交易价格；每笔交易考虑了千分之一的成本）。可见它有效的捕捉到了 2006 至 2007 年和 2015 年的两拨大趋势。该策略在十五年中净值从 1 涨到 7 以上，远超同期指数。毋庸置疑，在 2015 年股灾之前的中国股市（或者更严谨的说：上证指数）是非常适合上述趋势追踪策略的（至于今后怎么样，这里先卖个关子，看完本文您就知道了）。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6f0729696e98d04aa4ed5f2139415c2a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;637&quot; data-rawheight=&quot;247&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6f0729696e98d04aa4ed5f2139415c2a&quot; data-watermark-src=&quot;v2-22a8a42422c63d1fa317d079c979b078&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;例子 2：标普 500&lt;/b&gt;&lt;/p&gt;&lt;p&gt;让我们再来看看以标普 500 指数为标的的情况。在同样的回测期内，该趋势追踪策略的净值曲线如下（同样采用收盘价计算信号，用第二天开盘价作为交易价格；每笔交易考虑了千分之一的成本）。令人大跌眼镜的是，它几乎稳健下行，逐步迈向万丈深渊，远远跑输同期的标普指数（不要忘了，标普 500 可是经历了 .com 泡沫和金融危机呢！）。标普 500 指数在回测的这段时间内至少是不适合我们这个趋势追踪策略的。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7c657e8b1303fa94fa56e7cf8734d5a9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;677&quot; data-rawheight=&quot;244&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7c657e8b1303fa94fa56e7cf8734d5a9&quot; data-watermark-src=&quot;v2-7ca219ea4016ad6c03fa3831eb5e71f7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这两个例子说明&lt;b&gt;每个趋势跟踪策略都有着特定的参数；参数的背后是使用者对于投资品（对数）收益率的基本假设。&lt;/b&gt;比如该投资品在什么频率上有趋势？分钟线？小时线？日线？周线？月线？年线？又如该收益率的趋势相对于噪声的强弱程度等。在上面这两个例子中，显然上证指数符合该策略的假设，而标普 500 和它的假设背道而驰。&lt;/p&gt;&lt;p&gt;&lt;b&gt;任何一个趋势追踪策略仅对收益率符合其假设的投资品适用。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;那么，投资品的收益率一般有哪些特性呢？我们又如何利用它们来选择合适的趋势追踪策略呢？这就是本文的话题。需要说明的是，虽然下文中定义了严谨的数学模型，且包含了大量的仿真实验，但是本文仍属于&lt;b&gt;定性&lt;/b&gt;的文章。文中并没有给出太过定量的结论，我们的重点是想从定性的角度来回答提出的问题。另外，为了简化讨论，我们仅考虑只能做多的趋势追踪策略&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 均值、自相关、白噪声&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;投资品的收益率一般包含三个部分：（长期）均值，自相关性和白噪声。&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;长期均值：&lt;/b&gt;它代表长期下来，单位时间内收益率的均值。&lt;/li&gt;&lt;li&gt;&lt;b&gt;自相关性：&lt;/b&gt;为了简化讨论我们这里仅考虑间隔为 1 的自相关性；它代表相邻两个单位时间内收益率的相关性。&lt;/li&gt;&lt;li&gt;&lt;b&gt;白噪声：&lt;/b&gt;每个单位时间内收益率自身的随机波动；不同时刻的随机波动相互独立。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在这三部分中，白噪声是随机扰动；对于另外两个部分，&lt;b&gt;当长期均值越高，自相关性越强，趋势追踪策略的效果则越好&lt;/b&gt;。那么长期均值和自相关性这两个因素之间哪个更重要呢？它们分别又对趋势追踪策略有什么样的影响呢？&lt;/p&gt;&lt;p&gt;为了便于分析，我们利用数学模型来人工合成&lt;b&gt;对数&lt;/b&gt;收益率。这些对数收益率满足给定的长期均值  &lt;equation&gt;μ&lt;/equation&gt; ，自相关性  &lt;equation&gt;ρ&lt;/equation&gt; ，以及白噪声的波动率 &lt;equation&gt;σ&lt;/equation&gt; 。该数学模型如下所示：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\left\{ \begin{array}{rll} b_0&amp;amp;\sim&amp;amp;\mathcal{N}(0,\sigma)\\ e_t&amp;amp;\sim&amp;amp;\mathcal{N}(0,\sigma)\\ b_t&amp;amp;=&amp;amp;\rho\times b_{t-1}+e_t,~~~t=1,2,\cdots\\ r_t&amp;amp;=&amp;amp;b_t-\mu_b+\mu,~~~t=0,1,2,\cdots \end{array} \right.&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;equation&gt;e_t&lt;/equation&gt; 是白噪声序列，它满足均值为 0，标准差为 &lt;equation&gt;σ&lt;/equation&gt; 的正态分布。 &lt;equation&gt;r_t&lt;/equation&gt; 是我们构造的人工对数收益率序列。为了使它满足给定的长期均值 &lt;equation&gt;μ&lt;/equation&gt; 和自相关性 &lt;equation&gt;ρ&lt;/equation&gt; ，构造过程中使用了辅助序列 &lt;equation&gt;b_t&lt;/equation&gt; 。首先利用迭代构造出满足自相关性 &lt;equation&gt;ρ&lt;/equation&gt; 的序列 &lt;equation&gt;b_t&lt;/equation&gt; 。由于在构造 &lt;equation&gt;b_t&lt;/equation&gt; 时可能会引入意外的均值 &lt;equation&gt;μ_b&lt;/equation&gt; ，因此在利用 &lt;equation&gt;b_t&lt;/equation&gt; 构造 &lt;equation&gt;r_t&lt;/equation&gt; 时，将 &lt;equation&gt;μ_b&lt;/equation&gt; 去除并把给定的均值 &lt;equation&gt;μ&lt;/equation&gt; 加回来。这样最终生成的对数收益率序列 &lt;equation&gt;r_t&lt;/equation&gt; 同时满足的长期均值 &lt;equation&gt;μ&lt;/equation&gt; 和自相关性 &lt;equation&gt;ρ&lt;/equation&gt; 。这就是上面四个式子所表述的过程。&lt;/p&gt;&lt;p&gt;利用这个数学模型，以 &lt;equation&gt;μ&lt;/equation&gt; 、 &lt;equation&gt;ρ&lt;/equation&gt; 、 &lt;equation&gt;σ&lt;/equation&gt;  作为输入，就可以人工生成对数收益率序列。当然，为了使这个研究对投资实践有借鉴意义，这三个参数的取值需要贴近实际。此外，由于研究的重点是收益率的 &lt;equation&gt;μ&lt;/equation&gt; 和 &lt;equation&gt;ρ&lt;/equation&gt; 对趋势策略的影响，研究中将  &lt;equation&gt;σ&lt;/equation&gt;  的取值固定。&lt;/p&gt;&lt;p&gt;假设我们合成的是日收益率序列，则 &lt;equation&gt;σ&lt;/equation&gt; 的合理取值为 0.01。在决定 &lt;equation&gt;μ&lt;/equation&gt; 和 &lt;equation&gt;ρ&lt;/equation&gt; 的取值时，考虑如下一些参照（本文最早写于 2017 年，因此下面的数据只到 2017 年）：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;参照 1：&lt;/b&gt;过去十二年的上证指数（2005 年 5 月 26 日至 2017 年 5 月 25 日）：均值 0.00037，自相关 0.023。&lt;/li&gt;&lt;li&gt;&lt;b&gt;参照 2：&lt;/b&gt;2015 年大牛市中的上证指数（2015 年 2 月 9 日至 2015 年 6 月 12 日）：均值 0.006，自相关 0.09。&lt;/li&gt;&lt;li&gt;&lt;b&gt;参照 3：&lt;/b&gt;股灾 3.0 之后的上证指数（2016 年 3 月 1 日至 2017 年 5 月 25 日）：均值 0.00049，自相关 0.048。&lt;/li&gt;&lt;li&gt;&lt;b&gt;参照 4：&lt;/b&gt;金融危机之后的标普 500 指数（2010 年 1 月 1 日至 2017 年 1 月 1 日）：均值 0.0004，自相关 -0.049。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;可见，除了 A 股的大牛市那段神一样的存在外（&lt;b&gt;注意，那一段收益率的均值比平时高出了一个数量级！我们后面会针对这点来特别论述&lt;/b&gt;），其他时候对数日收益率的均值在 0.0004 左右。在自相关性方面，除了标普为负之外（虽然是负的，但是事实也非常接近 0），A 股不同阶段的自相关性在 0.02 到 0.1 之间。鉴于以上的数据，我们决定  &lt;equation&gt;μ&lt;/equation&gt;  和  &lt;equation&gt;ρ&lt;/equation&gt;  的取值如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;equation&gt;μ&lt;/equation&gt; &lt;b&gt;：0.0001，0.0005，0.001&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;equation&gt;ρ&lt;/equation&gt; &lt;b&gt;：0.01，0.1，0.2&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;将它们两两组合便得到 9 组不同的 &lt;equation&gt;μ&lt;/equation&gt; 和 &lt;equation&gt;ρ&lt;/equation&gt; ，由此便可以根据上述数学模型构建任意长度的对数收益率序列。在实验中，每一组序列包括 2500 个点（假设一年有 250 个交易日，则这个长度相当于十年）。此外，由于生成的是对数收益率，因此该序列的累加和就是其对应的（以初始价格的对数值为偏移量的）对数价格曲线，将该偏移量消除并将对数价格曲线的每一项进行指数运算就可以得到价格曲线。在实验中，假设投资品的原始价格为 100。&lt;/p&gt;&lt;p&gt;下图为这 9 组 &lt;equation&gt;μ&lt;/equation&gt; 和 &lt;equation&gt;ρ&lt;/equation&gt; 参数下生成的一组样本人造价格曲线（由于在生成对数收益率的过程中引入了随机误差，因此即便是给定了 &lt;equation&gt;μ&lt;/equation&gt; 和 &lt;equation&gt;ρ&lt;/equation&gt; ，每次生成的价格曲线也不相同。因此下图仅仅是每组参数下的一条样本价格曲线）。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-043276aee1793633f724012f0f56ff63_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;751&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-043276aee1793633f724012f0f56ff63&quot; data-watermark-src=&quot;v2-c4aabd3597ae20dd6851e37ec6d6d97a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;从这 9 条人造价格曲线中可以看出：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;当均值 &lt;/b&gt;&lt;equation&gt;μ&lt;/equation&gt;&lt;b&gt; 相对于波动 &lt;/b&gt; &lt;equation&gt;σ&lt;/equation&gt; &lt;b&gt; 很小时（小两个数量级左右），价格曲线的局部走势由自相关性 &lt;/b&gt;&lt;equation&gt;ρ&lt;/equation&gt; &lt;b&gt;（以及随机噪声）主宰：&lt;/b&gt; &lt;equation&gt;ρ&lt;/equation&gt;&lt;b&gt; 越大，局部波动越频繁。由于 &lt;/b&gt;&lt;equation&gt;μ&lt;/equation&gt;&lt;b&gt; 相对于随机噪声 &lt;/b&gt;&lt;equation&gt;σ&lt;/equation&gt;&lt;b&gt; 太小，在任何就局部的尺度上都观测不到明显的上涨趋势，这种现象在 &lt;/b&gt;&lt;equation&gt;ρ&lt;/equation&gt;&lt;b&gt; 变大时更加明显。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;当均值 &lt;/b&gt;&lt;equation&gt;μ&lt;/equation&gt;&lt;b&gt; 比 &lt;/b&gt; &lt;equation&gt;σ&lt;/equation&gt; &lt;b&gt; 小一到两个数量级之间时（这是一般市场的情况，就像上面提到的参照 1、3 和 4），&lt;/b&gt; &lt;equation&gt;μ&lt;/equation&gt; &lt;b&gt; 对价格走势的重要性逐渐增加。这时，小的自相关性 &lt;/b&gt; &lt;equation&gt;ρ&lt;/equation&gt; &lt;b&gt; 对价格的影响较小；当自相关性 &lt;/b&gt; &lt;equation&gt;ρ&lt;/equation&gt; &lt;b&gt; 足够大时，它仍然能引起局部的阶段性涨跌区间。我们能够在某些尺度下观察到明显的上涨趋势。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;当均值 &lt;/b&gt; &lt;equation&gt;μ&lt;/equation&gt; &lt;b&gt; 变大到仅比波动 &lt;/b&gt; &lt;equation&gt;σ&lt;/equation&gt; &lt;b&gt; 小一个数量级甚至更大时（这是大牛市的情况，如同上面提到的参照 2），均值对价格的影响将使得任何合理的自相关性 &lt;/b&gt; &lt;equation&gt;ρ&lt;/equation&gt; &lt;b&gt; 对价格的影响微乎其微。在如此大的趋势面前，自相关性 &lt;/b&gt;&lt;equation&gt;ρ&lt;/equation&gt; &lt;b&gt;（和随机噪声）的影响几乎可以忽略不计；在价格序列的整段范围内，它基本呈现持续的上涨。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;这些不同的参数对趋势追踪策略有什么样的影响呢？下面就来看看一个给定的趋势追踪策略会在不同的参数下有什么样的表现。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 不同 μ 和 ρ 参数下的趋势追踪策略效果&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在展开本节的讨论之前，必须说清楚两个问题：&lt;/p&gt;&lt;p&gt;1. 本节的标题事实上是一个非常“宏伟”的课题。如果想要系统的考察 &lt;equation&gt;μ&lt;/equation&gt; 和  &lt;equation&gt;ρ&lt;/equation&gt;  如何影响趋势追踪策略，则必须考虑不同的趋势追踪策略，并且对于每个策略考察不同时间尺度下的参数。这显然远远超出本文的范畴。&lt;b&gt;在本文中，我们仅考虑一个技术分析领域中非常常见的趋势追踪策略 —— 双均线策略；以及该策略的一组非常常见的参数：慢均线为 50 日简单均值；快均线为 13 日简单均值。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于价格曲线是人工生成的，因此每个交易日只有一个价格数据，我们假设它就是收盘价。由于仅有收盘价而没有其他数据，我们无法使用诸如“以收盘价计算，以下个开盘价购买”这种更合理的方式构建策略；我们只能以收盘价作为交易价格，而通过考虑足够大的交易成本来使得仿真实验更加接近现实。具体策略为：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;空仓时，在每个交易日收盘，如果快均线上穿慢均线则按收盘价满仓买入；交易成本千分之一。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;满仓时，在每个交易日收盘，如果快均线下穿慢均线则按收盘价卖出清仓；交易成本千分之一。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;2. 前文提到，由于在生成人造价格曲线时引入了随机噪声，因此即便对于给定  &lt;equation&gt;μ&lt;/equation&gt;  和  &lt;equation&gt;ρ&lt;/equation&gt; ，每次生成的价格曲线也都完全不同。这意味着，对于任一组参数，我们都必须生成足够多的样本价格曲线，然后使用上面的趋势追踪策略来对它们逐一进行交易，以此统计该策略的收益和风险分布情况。唯有这样才能客观的评价该策略在这组参数下的表现。为此，对于每组 &lt;equation&gt;μ&lt;/equation&gt; 和  &lt;equation&gt;ρ&lt;/equation&gt; ，我们进行 500 次实验。&lt;/p&gt;&lt;p&gt;在评价策略时，考察六个指标，它们分别为：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;策略&lt;b&gt;绝对&lt;/b&gt;年化复合收益率；&lt;/li&gt;&lt;li&gt;策略&lt;b&gt;绝对&lt;/b&gt;夏普率；&lt;/li&gt;&lt;li&gt;策略&lt;b&gt;绝对&lt;/b&gt;最大回撤；&lt;/li&gt;&lt;li&gt;策略&lt;b&gt;相对&lt;/b&gt;年化复合收益率；&lt;/li&gt;&lt;li&gt;策略&lt;b&gt;相对&lt;/b&gt;夏普率；&lt;/li&gt;&lt;li&gt;策略&lt;b&gt;相对&lt;/b&gt;最大回撤。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;所谓相对，是指策略较价格曲线本身的表现。&lt;/b&gt;下面就分别来看看在这 9 组参数下，上述双均线策略的表现。对于每一组参数，我们使用六张图分别显示 500 次实验后上述六个指标的分布。上面三张图为绝对指标；下面三张图为相对指标。黄色的竖线为每个指标的均值。接下来首先呈现 9 组参数的指标分布，然后总结它们传达的信息。&lt;/p&gt;&lt;p&gt;&lt;b&gt;第一组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.0001&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.01&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-517ed8c524fb69bff4c8143fd9c24b7f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1134&quot; data-rawheight=&quot;727&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-517ed8c524fb69bff4c8143fd9c24b7f&quot; data-watermark-src=&quot;v2-58b39d18cc699477c33d667beccb2dd7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第二组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.0001&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.1&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9a0604836be5de4f0e26a226bb326c26_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1135&quot; data-rawheight=&quot;728&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9a0604836be5de4f0e26a226bb326c26&quot; data-watermark-src=&quot;v2-e0d15e89e914a00e72ef1147eba55114&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第三组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.0001&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.2&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-dee948236f30b946cc11ebe118bab40f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;661&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-dee948236f30b946cc11ebe118bab40f&quot; data-watermark-src=&quot;v2-24c8ea951ab0d748712e329e7c3c9ccc&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第四组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.0005&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.01&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e5c520917812709509bb71dbfed38bd9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1140&quot; data-rawheight=&quot;727&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e5c520917812709509bb71dbfed38bd9&quot; data-watermark-src=&quot;v2-def78dfb0d7191c73b33643772a4ffa7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第五组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.0005&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.1&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1a55c6953c01eb10d4d24d092b3daa95_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1091&quot; data-rawheight=&quot;695&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1a55c6953c01eb10d4d24d092b3daa95&quot; data-watermark-src=&quot;v2-8430a4ca45504c0154b52d3ac8ed5db4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第六组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.0005&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.2&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-69fde7e606b136b6f3658b1d446abd41_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1089&quot; data-rawheight=&quot;699&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-69fde7e606b136b6f3658b1d446abd41&quot; data-watermark-src=&quot;v2-f84cc0992054dd5e172119d08bd8f065&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第七组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.001&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.01&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-81a7cc98df3c997328e777ece63f4673_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1085&quot; data-rawheight=&quot;697&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-81a7cc98df3c997328e777ece63f4673&quot; data-watermark-src=&quot;v2-30299e5088548855c312b6524ac16abd&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第八组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.001&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.1&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bac242131ca7e9764975211aecdfe260_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1094&quot; data-rawheight=&quot;698&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-bac242131ca7e9764975211aecdfe260&quot; data-watermark-src=&quot;v2-0cb6b2c1f1b2a8349f9cf91dc4f46a37&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;第九组参数：&lt;/b&gt; &lt;equation&gt;μ = 0.001&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;ρ = 0.2&lt;/equation&gt; &lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-147eae4c121c89e17e16eebd11007be1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1087&quot; data-rawheight=&quot;700&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-147eae4c121c89e17e16eebd11007be1&quot; data-watermark-src=&quot;v2-38b47539f9429a5e0f80c3017691f578&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这 9 组参数的实验结果说明：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;第一组到第三组参数中，由于长期均值较随机噪声小两个数量级，长期来看价格曲线在不同的时间尺度上均呈现频繁的波动。由此双均线趋势策略产生了错误的信号。无论从绝对收益率还是相对收益率来看，该策略的平均水平在这三组参数下均无法获得有效的正收益。&lt;/li&gt;&lt;li&gt;第四组到第六组参数中，随着长期均值的增大，均值和自相关性配合作用使得价格曲线克服随机噪声、并在不同的时间尺度上呈现出明显的上涨趋势。当上涨趋势的尺度满足双均线策略的参数设定时，该策略可以取得显著的正收益。虽然从相对收益率分布图中看到策略的收益率仍然大概率的跑输价格曲线本身，但是仍然可以有一小部分策略的夏普率大于价格曲线本身的夏普率。这说明对于这些价格曲线，趋势策略有效的降低了最大回撤。&lt;/li&gt;&lt;li&gt;第七组到第九组参数中，由于长期均值的数量级进一步增大，趋势策略的效果也有所改进。但有意思的是，在所有这三组参数中的一共 1500 个价格曲线中，趋势策略无一例外全部跑输价格曲线本身。可见，当长期均值足够大时，价格曲线本身就在整段时间范围内呈现出强大的上涨趋势，无需再用任何趋势策略来“捕捉”趋势。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;下面就来总结一下这九组实验带给我们的启发。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 长期均值主宰自相关，趋势尺度需满足策略参数&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于“如何根据收益率的特性选择适合的趋势追踪策略”这个问题，上面九组实验说明以下两点：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;长期均值主宰自相关性；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;趋势尺度需满足策略参数。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;首先来看第一条。实验结果说明，当投资品的长期均值较随机波动的数量级太小时，无论它表现出多么强的自相关性，趋势策略都无法有效获得正收益。换句话说，&lt;b&gt;均值决定了趋势的强弱（尽管我们不知道确切的时间尺度），而一个趋势策略有效的必要条件是该趋势不能被随机波动所抵消。&lt;/b&gt;如果这一点无法满足，那么趋势追踪显然是徒劳。&lt;/p&gt;&lt;p&gt;第七组到第九组的参数接近 A 股大牛市时的情况。在那种盛世下，趋势追踪显然能够获得非常不错的效果。尽管在大牛市阶段，趋势追踪不能够战胜基准本身，但是考虑到大牛市之后往往伴随着大熊市的一落千丈，因此&lt;b&gt;在一个完整的牛熊周期之后，趋势追踪策略必然会战胜基准。在过去的十几年中，正因为 A 股有这样的特性（3 波牛熊周期），才使得趋势追踪策略脱颖而出。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;第四组到第六组的参数其实很接近股灾 3.0 后的 A 股和金融危机后美股标普 500 指数的特性。&lt;/b&gt;在这种特性下，价格曲线呈现一个长期慢牛的形态，但收益率的波动率较均值仍然较大。&lt;b&gt;由于无法保证阶段性上涨的趋势一定满足趋势策略的参数假设，因此趋势策略的效果就无法保证。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这边引出了我们的第二点：&lt;b&gt;趋势尺度需满足策略参数&lt;/b&gt;。来看下面三个例子。它们的收益率长期均值均为 0，而自相关系数为 0.3（非常强的自相关）。在这三个例子中，同样的双均线趋势策略表现出了完全不同的效果。而趋势策略的效果完全取决于趋势的尺度是否满足策略的参数。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d9df763426554ad0004268864d49ef49_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;349&quot; data-rawheight=&quot;754&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d9df763426554ad0004268864d49ef49&quot; data-watermark-src=&quot;v2-9f8c18ca3e8cae527a0de4485465cf0c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;在这三个价格序列中，由于随机噪声的影响，趋势持续的时间尺度自上而下逐渐减小，从而离策略假设的时间尺度相差的越来越远，这便直接造成策略的效果越来越差。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这个结果对策略研发非常重要。因为在实际中，我们的历史数据仅仅是未知分布的一个实现（比如，我们仅仅会有上面三个价格曲线的一个）。假设第一个价格曲线是真实的历史数据，而我们针对它开发了一个趋势策略，那么我们能否预期它在样本外有同样的表现呢？答案是否定的。其原因正是因为没有更多的历史样本，我们根本无法在统计上正确的评价该策略的参数对这个未知收益率分布是否有效。我们得到的“有效”的结论仅仅源于对一个来自该分布的特定样本价格序列优化的结果。因此，该策略在样本外的表现也很有可能和其在样本内的表现大相径庭。&lt;/p&gt;&lt;p&gt;因此，对于第四组到第六组的参数所描述的价格曲线采用趋势追踪是有风险的。&lt;b&gt;风险来自于无法合理的评价该策略在未来的效果。&lt;/b&gt;那么我们应该怎么办呢？&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语：对 A 股的启示&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;股灾 3.0 后，上证指数的日收益率均值、方差、自相关性这些指标乃至是走势都和金融危机之后的标普 500 有些类似。&lt;b&gt;这说明在短时间尺度内，随机的扰动对于日收益率的均值影响比较大。这就迫使我们把投资周期拉长，从而把扰动略去。周期拉长什么意思？就是迫使我们把持仓时间变长。如果我们原来做短线，那么现在就只能变成长线。这么做的结果就是，投机者被迫变成投资者。价值投资就回归了！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;因此，股灾 3.0 后的 A 股应该怎么搞？&lt;b&gt;美股怎么搞，我们就应该怎么搞。&lt;/b&gt;在这种收益率特征下，趋势追踪很难超过买入持有策略。国外有很多策略针对美股搞趋势类择时并且声称战胜了指数。但仔细想想不难发现，用标普 500 做回测，只要能把金融危机躲过去，就几乎一定跑赢指数（而且那些策略还在金融危机的时候做空美股），但那叫耍流氓。如果从 2010 年后对美股使用仅做多的趋势追踪策略，那么想要超过买入持有策略难度堪比登天。&lt;b&gt;因此，美股对我们的第一个借鉴就是买入持有。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果我们想在买入持有的基础上更进一步，那么巴菲特的价值投资无疑是黑夜中的一盏明灯。&lt;b&gt;在价值投资回归的背景下，通过选股做指数增强是更好的选择。&lt;/b&gt;较趋势追踪无法保证跑赢基准，指数增强可以稳定的赚取  &lt;equation&gt;α&lt;/equation&gt;  收益率（或者说是结构性的  &lt;equation&gt;β&lt;/equation&gt;  收益率）。&lt;/p&gt;&lt;p&gt;这篇文章是我在 2017 年写的。而今天，2018 年 7 月 23 日，有条最新消息称股指期货交易将恢复常态！这无疑为选股策略提供了更好的生存环境。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-23-40358079</guid>
<pubDate>Mon, 23 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Greenblatt 的神奇公式及其改进</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-18-40032563.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40032563&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-47fee2135b86e5b288024c05b540042b_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;单次优势 + 大数定律 = 长期成功。&lt;/b&gt;价值投资二者皆有，久经市场考验，是在股市中取得成功的不二法则。Greenblatt 的神奇公式用两个简单的量化指标执行价值投资，值得仔细品味。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 Joel Greenblatt&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;Joel Greenblatt（乔尔·格林布拉特）&lt;/b&gt;在华尔街家喻户晓。他是&lt;b&gt;特殊事件投资（special situation investing）&lt;/b&gt;的旗帜性人物。&lt;b&gt;特殊事件投资就是投资那些因为企业拆分、公司并购、资产重组、破产清算等而被低估的证券。&lt;/b&gt;他的基金 Gotham Capital 在 1985 年到 1995 年间取得了费前 40% 的惊人年化收益率（在 1995 年之后他退回了所有外部投资者的钱，但继续用自己的钱进行特殊事件投资）。1999 年，Greenblatt 写了一本《You can be a stock market genius》（Greenblatt 1999）介绍他的投资方法。毫无意外的，该书在推出后迅速成为畅销书，它一举奠定了 Greenblatt “明星投资人”的地位，并成为特殊事件投资领域的经典之作。&lt;/p&gt;&lt;p&gt;然而，让 Greenblatt 的声望到达顶峰的却是他的第二本书《The little book that beats the market》（Greenblatt 2005）。该书源自他的一个设想 —— &lt;b&gt;能否使用简单的量化手段来复制巴菲特的价值投资。&lt;/b&gt;在巴菲特的诸多名言中，对 Greenblatt 影响最深的要数下面这句：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;It&#39;s far better to buy a wonderful company at a fair price than a fair company at a wonderful price.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：用合理的钱买到好公司远远好于用一个好价钱买到一个普通的公司。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;从这句至理名言中，Greenblatt 总结出巴菲特的成功之处在于两点：&lt;b&gt;好公司 + 价格便宜&lt;/b&gt;。按照这个思路，他开始了自己的尝试，并最终找到了&lt;b&gt;两个量化指标&lt;/b&gt;来代表这两个方面。&lt;b&gt;根据这两个量化指标选出来的股票在历史长河中远远跑赢了基准指数。&lt;/b&gt;Greenblatt 将这个由这两个量化指标构成的选股系统称作&lt;b&gt;神奇公式（the Magic Formula）&lt;/b&gt;，并把它公布在上面提到的《The little book that beats the market》这本书中。在随后的 5 年中，Greenblatt 继续进行着他的价值投资实践，并推出了该书的升级版《The little book that &lt;b&gt;still&lt;/b&gt; beats the market》（Greenblatt 2010，升级版中加入了更多的数据和最新 5 年的回测），而这本书最终也被翻译成中文版引入了中国，并有一个非常响亮的名字：《股市稳赚》。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6a115423dd9268d31b67acdbab2d5f0f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;982&quot; data-rawheight=&quot;435&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6a115423dd9268d31b67acdbab2d5f0f&quot; data-watermark-src=&quot;v2-43933f2d7ad383e1fb72b8f648032162&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;神奇公式在华尔街名声大噪。而随着最近两年价值投资逐渐成为 A 股市场的主旋律，它在国内的知名度也越来越高。Greenblatt 在神奇公式中使用的两个量化指标究竟是什么呢？它们有没有改进的空间呢？这就是本文关注的问题。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 神奇公式&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在好公司这个维度，从巴菲特每年写给股东的 Chairman&#39;s letters 中，不难觅出蛛丝马迹。在巴菲特看来，一个优秀公司应该能够“earns a high return on equity capital”，即&lt;b&gt;好公司的资本回报率要高&lt;/b&gt;。为此，Greenblatt 选择了他的第一个量化指标 —— &lt;b&gt;ROC（Return on Capital）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;具体的，ROC 的定义为：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;&lt;b&gt;ROC = Earnings before Interest and Taxes (EBIT) / Capital&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;i&gt;&lt;b&gt;译：ROC = 息税前利润 / 资本&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在上式中，资本的定义为 Net Working Capital + Net Fixed Assets，即净营运资金和固定资产净额之和。&lt;b&gt;值得注意的是，计算 ROC 的时候应该和常见的 ROE 以及 ROA 一致，资本应该是期初的值，而利润应该是在期初到期末这段时间内由期初资本产生的利润。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;假如做同种生意的两个公司 A 和 B 它们的初期投资都是 400,000 美元，而公司 A 产生的利润是 200,000，是公司 B 的两倍。则从 ROC 的角度来说，公司 A 的回报更高（50%），因此它比公司 B 更值得拥有。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-cbe191b264ba73c197739185d8d0fc23_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;580&quot; data-rawheight=&quot;211&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-cbe191b264ba73c197739185d8d0fc23&quot; data-watermark-src=&quot;v2-975d33f68726ba0674c3756968ac3470&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;ROC 度量了上市公司在公司运营中利用资本的效率。ROC 越高说明单位资本产生的利润更高，公司越优秀。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;再来看看价格便宜这个维度。Greenblatt 选择的是 Earnings Yield（回报率），和我们常说的 P/E 的倒数类似。具体的，Earnings Yield 的定义为：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;&lt;b&gt;Earnings Yield = EBIT / Total Enterprise Value&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;i&gt;&lt;b&gt;译：Earnings Yield = 息税前利润 / 企业总价值&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;企业总价值（TEV）是购买整个公司需要的价格，可以近似的理解为总市值 + 总负债 – 总现金。&lt;/b&gt;举个例子，假如我们可以花 100 块买公司 A 或者公司 B，而公司 A 每年能给我们产生 20 块的利润，公司 B 仅能在每年产生 5 块钱的利润。因此 A 的回报率是 20%，远远超过 B 的 5%。显然，A 公司比 B 公司更好。从“便宜”的角度，我们花同样的钱，买到了 20% 回报率的公司，而不是那个仅仅有 5% 回报率的公司。物有所值！所以，&lt;b&gt;Earnings Yield 越大说明公司越便宜。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;有了 ROC 和 Earnings Yield 这两个量化指标，Greenblatt 分别使用它们给股票排序（每个指标下表现最好的公司排名为 1，最差的排名最后）。在每支股票得到两个维度的排名后，把它们相加得到最终的排名，Greenblatt 选出名次靠前的 30 支股票，持有一年，每年调仓。&lt;/p&gt;&lt;p&gt;在实证中，Greenblatt 排除了公用事业和金融行业的公司，以及流动性特别差的公司。他指出在这个神奇公式在 1988 到 2004 年之间可以取得 30.8% 的年化收益率，远超同期市场的 12.3%。最新的满足神奇公式的股票实时公布在 magicformulainvesting.com 这个网站上，感兴趣的小伙伴不妨关注下（需要注册）。&lt;/p&gt;&lt;p&gt;不妨来看看这个神奇公式在 A 股上是否也如此神奇。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 神奇公式在 A 股上的实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节使用果仁网简单的在 A 股上验证神奇公式。具体的，我们把投资标的限制在沪深 300 的成分股以及中证 500 的成分股（分别测试，并排除金融和公用事业）。回测时间是 2009 年 1 月 2 日到 2018 年 6 月 6 日。&lt;/p&gt;&lt;p&gt;在 ROC 方面，我们可以采用默认的 TTM（trailing twelve months）作为期初和期末的窗口，也可以用最新一季度的季报数据。从回测来看，基于季报数据的结果更好，因此本文使用基于季报的 ROC。具体的，ROC 的定义为最新一季息税前利润与上一季资本的比值，这里上一季资本等于该季的流动资产 – 流动负债 + 固定资产 – 固定资产折旧。在 Earnings Yield 方面，使用相关财务指标的 TTM 数据计算。&lt;/p&gt;&lt;p&gt;首先来看在沪深 300 上的回测结果。按上述两个指标排序，将股票分成 10 档，每 20 天调仓。这 10 档的收益率如下图所示，单调性为 0.89 —— &lt;b&gt;说明这两个指标非常有效的区分了这些股票，且正的单调性说明按照这两个因子选出的排名高的股票确实能获得更高的收益。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-dd01f9a5ac929c973c6a68b8d76d20d4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1063&quot; data-rawheight=&quot;471&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-dd01f9a5ac929c973c6a68b8d76d20d4&quot; data-watermark-src=&quot;v2-583711f43a9406e4a90fd2b8b78df5f7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;接下来考虑一个简单的选股策略：&lt;/p&gt;&lt;p&gt;每日更新上述两个指标并重新对股票排名，新股理想仓位为 4%，上下各浮动 0.4%；卖出条件为股票按神奇公式的最新排名超过 20；为降低换手率，要求每支股票买入后持有不少于 20 个交易日，且在卖出时不考虑涨停的股票；单边交易费用为千分之一、假设按照收盘价交易。&lt;/p&gt;&lt;p&gt;在这个选股策略的净值和沪深 300 的对比如下。高下立判。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-73a214c505074b4afa4d6b891f19733b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;442&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-73a214c505074b4afa4d6b891f19733b&quot; data-watermark-src=&quot;v2-cda4b7bfd12bebd319d133edbb53072b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;再来看看神奇公式在中证 500 上的效果，它分类的单调性为 0.84。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a747991e2625b60ab167246354e47db0_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1059&quot; data-rawheight=&quot;466&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a747991e2625b60ab167246354e47db0&quot; data-watermark-src=&quot;v2-b4b28dabb5ad8af367e442f6141d2a43&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;选股策略的效果和中证 500 的比较如下。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33c992b351f5eeb0708df4e5b6018c75_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;719&quot; data-rawheight=&quot;445&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-33c992b351f5eeb0708df4e5b6018c75&quot; data-watermark-src=&quot;v2-ea07731d26332eba171255d4c57a4e2e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;自 2016 年价值投资回归后，该策略在中证 500 上的绝对收益似乎不够优秀。但这是因为中证 500 本身太差。如果我们来看相对收益率（下图），还是能明显的看出这二者的差异 —— 矬子里拔将军，神奇公式依旧神奇。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6a0b15232596f0e98777bca6a3b9fc4e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1046&quot; data-rawheight=&quot;416&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6a0b15232596f0e98777bca6a3b9fc4e&quot; data-watermark-src=&quot;v2-1f4c0a14e6e289dce84f6eb3714d3ea8&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;4 来自学术界的改进&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;自因子投资发展以来，学术界发现了大量可用于价值投资的优秀因子。因此，我们想看看能否根据学术界的这些发现来让神奇公式更上一层楼。&lt;/p&gt;&lt;p&gt;&lt;b&gt;当然，这么做的动机除了希望学术界能够证明自己以外，还有一个非常现实的原因。&lt;/b&gt;在神奇公式中， EBIT 是一个核心财务指标，它被同时用在 ROC 和 Earnings Yield 中。&lt;b&gt;然而在财报中，EBIT 存在被篡改的可能，因此它有时是失真的。&lt;/b&gt;正如 Novy-Marx (2010) 指出的那样：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The farther down the income statement one goes, the more polluted profitability measures become, and the less related they are to true economic profitability.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：当我们沿着利润表（income statement）往下看的时候，利润这一项变得越来越不纯粹（polluted），且越来越无法有效的反映该公司真正的经济利润。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;为此，Novy-Marx (2010) 提出了另一个指标：&lt;b&gt;Gross Profit to Total Assets（GPA）&lt;/b&gt;。&lt;b&gt;这被认为是学术界发现的衡量公司盈利能力的最有效指标之一。&lt;/b&gt;我们用它来代替神奇公式中的 ROC。GPA 和 ROC 的结构差不多，但是在分子方面，它用 Gross Profit 代替了 EBIT，而在分母上用 Total Assets 代替了 Capital。&lt;/p&gt;&lt;p&gt;&lt;b&gt;毛利（gross profit）是利润最纯粹的度量，它处于 income statement 的最上端，被操纵的可能最小。&lt;/b&gt;毛利是公司经营的基础。该公司卖产品能获得多少销售额？生产该产品的费用又是多少？毛利高的公司有机会就如何分配资本（再投资、减少债务、回报股东）做出更明智的决定；而毛利较低的公司成功的可能性也较低。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在分母方面，使用 Total Assets（资产总计）的好处是，该数值和公司的资产结构无关。这和毛利相对应，因为毛利也是和公司的资本结构无关。&lt;/b&gt;因此，使用 GPA 代替 ROC 可以让我们在不同的公司之间进行 apples to apples 的比较。&lt;/p&gt;&lt;p&gt;在价格便宜方面，为了替换掉 EBIT，我们使用学术界最著名的一个估值因子，来自 Fama 和 French 三因子（Fama and French 1992）中的 Book-to-Market Value，即常说的 B/P。Fama 和 French 喜欢这个因子的原因是账面价值相比于其他基本面指标更加稳定，和有助于保证投资者组合的低换手率：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;We like [book-to-market capitalization] because the book value in the numerator is more stable over time than earnings or cashflow, which is important for keeping turnover down in a value portfolio.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;总结一下，在本节提出的改进使用 GPA 替换神奇公式中的 ROC；只用 B/P 代替神奇公式中的 Earnings Yield。&lt;/b&gt;马上来看看是来自华尔街的智慧（神奇公式）厉害，还是来自学术界的智慧（利用 GPA 和 B/P）更胜一筹。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 改进后的神奇公式在 A 股上的实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在 GPA 方面，我们同样测试了单季数据和 TTM 数据计算的指标。结果显示单季的效果更好。具体的，GPA 定义为单季的毛利除以上一季度的资产总计。&lt;/p&gt;&lt;p&gt;对于沪深 300，使用改进后的指标把股票分成 10 类，单调性为 0.92，&lt;b&gt;高于神奇公式，且各档之间的区分度更明显。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-858ac2386549f6468878784f37e099a2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1055&quot; data-rawheight=&quot;466&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-858ac2386549f6468878784f37e099a2&quot; data-watermark-src=&quot;v2-08b844f1a44aafdf80ac360bae107768&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;选股策略的效果如下 —— &lt;b&gt;年化收益、夏普率以及最大回撤都要优于神奇公式&lt;/b&gt;：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-305182cd9825e704762cbde8987aea10_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;721&quot; data-rawheight=&quot;447&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-305182cd9825e704762cbde8987aea10&quot; data-watermark-src=&quot;v2-d4e08fc9a6f7640a5824c389cf68430f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;最后来看看对中证 500 的结果。使用改进后的指标把股票分成 10 类，单调性为 0.93，同样高于神奇公式。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c1ba3360777d7f155793a00208324757_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1054&quot; data-rawheight=&quot;465&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c1ba3360777d7f155793a00208324757&quot; data-watermark-src=&quot;v2-6b799eeaed995e15f81d9c9a213cddb7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;选股策略的效果如下。&lt;b&gt;在中证 500 上，来自学术界的改进版神奇公式效果远超于来自华尔街的神奇公式（相对收益率的曲线也变得更加平滑，且在 2018 年的表现也非常好）。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-993c7e0f523edc030510efe5b6dd54b7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;718&quot; data-rawheight=&quot;730&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-993c7e0f523edc030510efe5b6dd54b7&quot; data-watermark-src=&quot;v2-0853fd80e37a0714acfe902e5ebc6002&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;6 结语 —— 价值投资为什么能成功？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Greenblatt 对于价值投资的信仰绝不仅仅表现为他写了两本畅销书。&lt;b&gt;2010 年，他的基金 Gotham Capital 决定放弃之前赖以成名的特殊事件投资，转而专注于价值投资。行胜于言，Greenblatt 的这个决定比任何溢美之词都更能说明价值投资的意义。&lt;/b&gt;而这个决策的背后，无疑是 Greenblatt 对“价值投资这一套体系一定能取得成功”所秉持的坚定不移的态度。&lt;/p&gt;&lt;p&gt;在实践层面，Greenblatt 的神奇公式还有另外一个意义。早在 80 年前，在 Benjamin Graham 和 David Dodd 合著的第一版价值投资圣经《证券分析》中，Graham 就给出了 10 条选股标准，它们很好的诠释了“优质 + 便宜”这个核心思想。&lt;b&gt;但 Graham 的方法有个小问题，那就是它选的是绝对指标而非相对指标。&lt;/b&gt;因此在某些历史阶段，很难选出足够多的满足那 10 条标准的股票，这会造成策略在那些时间内仓位很低或者重仓投资于少数几支股票上。&lt;b&gt;神奇公式的优势在于它考虑的是股票之间的相对强弱，因此我们总能选出足够多的股票。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;无论是 Graham、Dodd、Buffett 还是 Greenblatt，他们的传奇似乎都在诉说着市场中一个最平凡的真谛：&lt;b&gt;价值投资久经考验，是想要在股市中取得成功的不二法则。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;那么，价值投资为什么能成功？&lt;/p&gt;&lt;p&gt;如同价值投资中有它的神奇公式，在市场中想要成功也有它自己的“神奇公式”：&lt;/p&gt;&lt;p&gt;&lt;b&gt;单次优势 + 大数定律 = 长期成功。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在一个不确定性的博弈中（可以是一个赌局，或者一项投资），&lt;b&gt;单次优势是说我们需要在概率上有获胜的优势，或者我们的期望收益为正。&lt;/b&gt;一个概率为 50/50 的扔硬币赌局，如果赢了给你 10 块，输了让你赔 11 块，你是不会玩的。为什么？因为它的期望收益为负！&lt;b&gt;“高质量 + 低价格”的公司是大概率优于“低质量 + 高价格”的公司的，因此价值投资给了我们单次优势。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;不幸的是，单次优势仅仅是成功的必要条件。在上面这个成功的食谱中，最重要的是第二项：大数定律。哪怕单次优势再明显，仅仅进行一次、两次也是无法保证最终获胜的。&lt;b&gt;唯有我们一直坚持下去，参与的回合足够多，大数定律才能保证我们的长期实际收益收敛于理论上的期望收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;价值投资的难点从来就不是用哪个因子来选股，而是“大数定律” —— 持之以恒的坚持。&lt;/b&gt;那些善于逆向交易、耐得住寂寞的交易者，才更有可能取得成功。成功是对坚持价值投资的巴菲特们的巨大褒奖。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;向前跑 迎着冷眼和嘲笑&lt;/p&gt;&lt;p&gt;市场的广阔不经历磨难怎能感到&lt;/p&gt;&lt;p&gt;价格它无法让我们跪地求饶&lt;/p&gt;&lt;p&gt;就算魅力股占据头条&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;继续跑 带着赤子的骄傲&lt;/p&gt;&lt;p&gt;价值的闪耀不坚持到底怎能看到&lt;/p&gt;&lt;p&gt;与其朝三暮四不如长期持有吧&lt;/p&gt;&lt;p&gt;为了心中的美好&lt;/p&gt;&lt;p&gt;不妥协直到变老&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Fama, E. F. and K. R. French (1992). The cross-section of expected stock returns. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 47(2), 427 – 465.&lt;/li&gt;&lt;li&gt;Greenblatt, J. (1999). &lt;i&gt;You Can Be a Stock Market Genius.&lt;/i&gt; Touchstone.&lt;/li&gt;&lt;li&gt;Greenblatt, J. (2005). &lt;i&gt;The little book that beats the market.&lt;/i&gt; John Wiley &amp;amp; Sons.&lt;/li&gt;&lt;li&gt;Greenblatt, J. (2010). &lt;i&gt;The little book that still beats the market.&lt;/i&gt; John Wiley &amp;amp; Sons.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. (2010). The other side of value: good growth and the gross profitability premium. NBER Working Paper No. w15940, available at &lt;i&gt;SSRN http://ssrn.com/abstract=1598056.&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-18-40032563</guid>
<pubDate>Wed, 18 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Barra 因子模型截面回归求解</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-17-39922829.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/39922829&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5c03ba2ed8205aab863ec84ec39fb241_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Barra 因子模型求解采用了带权重和约束条件的最小二乘回归。本文解释这个回归求解的数学过程，并通过简单实证说明求解的正确性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我似乎对 Barra 的因子模型过分钟爱了？&lt;/p&gt;&lt;p&gt;That was a joke.&lt;/p&gt;&lt;p&gt;钟爱谈不上，Barra 的模型在中国市场有多大作用、在什么使用情景下有用（因为没有可投资性，它无法直接用来选股）也仍在摸索中。但是，这么多年一代代模型的推出和改进代表着 Barra 自身的思考；一步步的构建一个逐步完善的多因子投资体系。这个框架足以引发我们的思考并学习。&lt;/p&gt;&lt;p&gt;之前我们分三篇文章介绍了 Barra 的因子模型，它们分别是&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38280638&quot;&gt;《正确理解 Barra 的纯因子模型》&lt;/a&gt;、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38506157&quot;&gt;《协方差矩阵的 Newey-West 调整》&lt;/a&gt;、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38895499&quot;&gt;《Barra 因子模型中的风险调整》&lt;/a&gt;。&lt;/p&gt;&lt;p&gt;这些文章虽然对模型介绍的比较细，但一直忽视了一个问题 —— 模型的求解。Barra 因子模型求解采用了带&lt;b&gt;权重&lt;/b&gt;和&lt;b&gt;约束条件&lt;/b&gt;的最小二乘回归，求解起来并不是那么直观，有一定的复杂性。所以本文就来介绍截面回归的求解过程。&lt;/p&gt;&lt;p&gt;在那之前，我们再次来重申截面回归所用到的暴露和收益率数据在时间上的关系。截面回归的输入显然对求解至关重要。根据 Barra Risk Model Handbook 的说明，因子暴露和因子收益率数据的正确解读为：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;... the previous steps have defined the exposures of each asset to the factors &lt;b&gt;at the beginning&lt;/b&gt; of every period in the estimation window. The factor excess returns &lt;b&gt;over the period&lt;/b&gt; are then obtained via a cross-sectional regression of asset excess returns on their associated factor exposures ...&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这意味着，对于给定某一期截面数据（记为 T 期），在截面回归时采用期初的因子暴露取值（等价于 T - 1 期期末的因子暴露取值）和股票在 T 期内的收益率进行截面回归。在 USE4 模型中，因子收益率是日频的，因此截面回归也应该是日频的，所以按照上述说明，在 T - 1 日结束后更新因子的暴露，并利用 T 日的股票收益率和因子暴露做截面回归。&lt;/p&gt;&lt;p&gt;下面就来介绍截面回归的求解。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 数学推导&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在下文中，粗体小写字母表示向量、粗体大写字母表示矩阵。使用矩阵和向量，多因子模型可以表示为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf{r} = \mathbf{Xf}+\mathbf{u}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;\bf X&lt;/equation&gt; 是期初因子暴露矩阵。假设一共有 1 + P + Q = K 个因子（包括 1 个国家因子、P 个行业因子以及 Q 个风格因子），则 &lt;equation&gt;\bf X&lt;/equation&gt; 是一个 N × K 阶矩阵（其中 N 为股票个数）。在行文中，我会不厌其烦的写明矩阵的阶数，这有助于编程复现这个求解过程。具体的，&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\bf X = \left[\begin{array}{ccccccc} \displaystyle 1&amp;amp;X_1^{I_1}&amp;amp;\cdots&amp;amp;X_1^{I_P}&amp;amp;X_1^{S_1}&amp;amp;\cdots&amp;amp;X_1^{S_Q}\\\\ \displaystyle 1&amp;amp;X_2^{I_1}&amp;amp;\cdots&amp;amp;X_2^{I_P}&amp;amp;X_2^{S_1}&amp;amp;\cdots&amp;amp;X_2^{S_Q}\\\\ \displaystyle \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\\\ \displaystyle1&amp;amp;X_N^{I_1}&amp;amp;\cdots&amp;amp;X_N^{I_P}&amp;amp;X_N^{S_1}&amp;amp;\cdots&amp;amp;X_N^{S_Q} \end{array} \right]&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;下文中用 C 代表国家因子，在  &lt;equation&gt;\bf X&lt;/equation&gt;  中，所有股票在该因子上的暴露均为 1，因此 &lt;equation&gt;\bf X&lt;/equation&gt;的第一列的所有元素都是 1。P 个行业因子用 &lt;equation&gt;I_1&lt;/equation&gt; 到 &lt;equation&gt;I_P&lt;/equation&gt; 表示；Q 个风格因子用 &lt;equation&gt;S_1&lt;/equation&gt; 到 &lt;equation&gt;S_Q&lt;/equation&gt; 表示。&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\bf r&lt;/equation&gt; （N × 1 阶）是当期个股超额收益率向量； &lt;equation&gt;\bf f&lt;/equation&gt;（K × 1 阶）是待求的当期因子收益率向量，即 &lt;equation&gt;\mathbf f = [f_C, f_{I_1}, …, f_{I_P}, f_{S_1}, …, f_{S_Q}]^T&lt;/equation&gt; ； &lt;equation&gt;\bf u&lt;/equation&gt; 为 N × 1 阶个股特异性收益率向量。&lt;/p&gt;&lt;p&gt;令  &lt;equation&gt;\bf\Omega&lt;/equation&gt;  为待求解的纯因子投资组合权重矩阵。它是一个 K × N 阶矩阵，它的每一行对应某个因子的纯因子投资组合中所有 N 支股票的权重。 &lt;equation&gt;\bf\Omega&lt;/equation&gt;  具体可以表达为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf{\Omega} = \left[\begin{array}{cccc} \displaystyle \omega_{C1} &amp;amp;\omega_{C2}&amp;amp;\cdots&amp;amp;\omega_{CN}\\ \displaystyle \omega_{I_11} &amp;amp;\omega_{I_12}&amp;amp;\cdots&amp;amp;\omega_{I_1N}\\ \displaystyle \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \displaystyle \omega_{I_P1} &amp;amp;\omega_{I_P2}&amp;amp;\cdots&amp;amp;\omega_{I_PN}\\ \displaystyle \omega_{S_11} &amp;amp;\omega_{S_12}&amp;amp;\cdots&amp;amp;\omega_{S_1N}\\ \displaystyle \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \displaystyle\omega_{S_Q1} &amp;amp;\omega_{S_Q2}&amp;amp;\cdots&amp;amp;\omega_{S_QN} \end{array} \right]&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;为了求解  &lt;equation&gt;\bf\Omega&lt;/equation&gt; ，我们还需要用到另外两个矩阵，即回归权重矩阵  &lt;equation&gt;\bf V&lt;/equation&gt;  和约束矩阵 &lt;equation&gt;\bf R&lt;/equation&gt; 。约束矩阵对应的是下面这个因为国家和行业共线性造成的约束条件（不考虑这个约束的话，截面回归的求解不唯一）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;s_{I_1}f_{I_1}+s_{I_2}f_{I_2}+\dots+s_{I_P}f_{I_P}=0&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;先来看看这个回归权重矩阵  &lt;equation&gt;\bf V&lt;/equation&gt;  是什么。&lt;/p&gt;&lt;p&gt;回归权重矩阵  &lt;equation&gt;\bf V&lt;/equation&gt;  是一个 N × N 阶对角阵，第 n 个对角元素代表着股票 n 的权重 &lt;equation&gt;v_n&lt;/equation&gt; 。 &lt;equation&gt;v_n&lt;/equation&gt; 和股票 n 的市值 &lt;equation&gt;s_n&lt;/equation&gt; （在本文第三节的实证中考虑流通市值）的平方根成正比，并满足权重值和为 1。因此可得：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;v_n = \frac{\sqrt s_n}{\sum_{i=1}^N\sqrt s_i}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;而 &lt;equation&gt;\bf V&lt;/equation&gt; 的表达式为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\bf V = \left[\begin{array}{cccc} \displaystyle v_{1} &amp;amp;0&amp;amp;\cdots&amp;amp;0\\ \displaystyle 0 &amp;amp;v_2&amp;amp;\cdots&amp;amp;0\\ \displaystyle \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \displaystyle 0 &amp;amp;0&amp;amp;\cdots&amp;amp;v_N \end{array} \right]&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;Barra 采用回归权重矩阵的初衷是为了降低个股特异性收益率的风险对风险因子收益估计的误差。因此通过合理的回归权重降低个股特异性风险。&lt;/b&gt;关于这点，Menchero et al. (2011) 中有相关的说明：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Factor returns in USE4 are estimated using&lt;/i&gt; &lt;i&gt;&lt;b&gt;weighted least-squares regression&lt;/b&gt;, assuming that the variance of specific returns is&lt;/i&gt; &lt;i&gt;&lt;b&gt;inversely proportional to the square root of total market capitalization&lt;/b&gt;. This regression-weighting scheme reflects the empirical observation that the idiosyncratic risk of a stock decreases as the market capitalization of the firm increases.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这段话的意思是，股票的特异性收益率的风险是不同的。然而，股票的特异性风险是不可测的。&lt;b&gt;经验表明，股票的特异性风险与它的总市值平方根成反比。&lt;/b&gt;在构建纯因子投资组合时，应该加以考虑这一点。这在数学上可以通过在回归时，给股票加上基于特异性风险的回归权重，即带权重的最小二乘回归。&lt;/p&gt;&lt;p&gt;基于上述考虑，Menchero (2010) 指出&lt;b&gt;回归应该和市值的平方根成正比&lt;/b&gt;：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;In order to reduce estimation error in the factor returns, regression weights are used so that “noisy” stocks (i.e., those with high specific risk) are down-weighted. In practice,&lt;/i&gt; &lt;i&gt;&lt;b&gt;regression weights are often taken as proportional to the square root of market capitalization&lt;/b&gt;, although other weighting schemes are possible.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这就是使用回归权重矩阵  &lt;equation&gt;\bf V&lt;/equation&gt;  的意义。&lt;/p&gt;&lt;p&gt;再来看看约束矩阵 &lt;equation&gt;\bf R&lt;/equation&gt; 。约束矩阵  &lt;equation&gt;\bf R&lt;/equation&gt;  是代表上文提到的约束条件（即所有行业的因子组合收益率线性相关）在求解时对行业因子收益率的限制条件。根据 Ruud (2000) 提出的理论，K 个因子收益率之间的约束条件（在此我们仅有一个约束条件）可以由以下等式表达：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\left[\begin{array}{c} f_C\\f_{I_1}\\\vdots\\f_{I_P}\\f_{S_1}\\\vdots\\f_{S_Q} \end{array} \right] = \left[\begin{array}{cccccccc} \displaystyle 1 &amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ \displaystyle 0 &amp;amp;1&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ \displaystyle \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \displaystyle 0&amp;amp;\displaystyle-\frac{s_{I_1}}{s_{I_P}} &amp;amp; \displaystyle-\frac{s_{I_2}}{s_{I_P}}&amp;amp;\cdots&amp;amp;\displaystyle-\frac{s_{I_{P-1}}}{s_{I_P}}&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ \displaystyle 0 &amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\cdots&amp;amp;0\\ \displaystyle \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \displaystyle 0 &amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;1 \end{array} \right] \left[\begin{array}{c} f_C\\f_{I_1}\\\vdots\\f_{I_{P-1}}\\f_{S_1}\\\vdots\\f_{S_Q} \end{array} \right]+ \left[\begin{array}{c} 0\\0\\\vdots\\0\\0\\\vdots\\0 \end{array} \right]&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;上式中，等号右边的矩阵就是约束矩阵  &lt;equation&gt;\bf R&lt;/equation&gt; ，它是一个 K × K - 1 阶矩阵，这是因为所有 K 个因子收益率变量之间有一个约束条件，因此它们的自由度为 K - 1。不失一般性，在构造 &lt;equation&gt;\bf R&lt;/equation&gt; 时，我们将行业 P 的因子组合收益率 &lt;equation&gt;f_{I_P}&lt;/equation&gt; 用其他行业的收益率的线性组合来表达。&lt;/p&gt;&lt;p&gt;在有了  &lt;equation&gt;\bf X&lt;/equation&gt; ， &lt;equation&gt;\bf R&lt;/equation&gt; 以及  &lt;equation&gt;\bf V&lt;/equation&gt;  之后，利用带权重、带约束条件的最小二乘回归求解即可得到纯因子投资组合的股票权重矩阵  &lt;equation&gt;\bf \Omega&lt;/equation&gt; 。以下求解公式来自 Menchero and Lee (2015) 中附录 A 的 (A.7) 式，感兴趣的朋友可进一步参考。&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf \Omega=\mathbf R\left(\mathbf R^T\mathbf X^T\mathbf V\mathbf X\mathbf R\right)^{-1}\mathbf R^T\mathbf X^T\mathbf V&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 -1 表示矩阵的逆矩阵。&lt;/p&gt;&lt;p&gt;由前文可知， &lt;equation&gt;\bf\Omega&lt;/equation&gt; 的每一行是一个 1 × N 向量；它就代表着第 k 个因子的纯因子投资组合中所有股票的权重。得到  &lt;equation&gt;\bf\Omega&lt;/equation&gt;  之后，可通过下式计算出所有因子在当期的因子收益率：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;f_k = \displaystyle\sum_{n=1}^N\omega_{kn}r_n&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;以上就是 Barra 因子模型截面回归的求解。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 简单实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节对上述求解过程做一个简单的实证，最主要的目的是检验 &lt;equation&gt;\bf\Omega&lt;/equation&gt; 求解公式是否正确。此外，通过构建的纯因子组合，我们也可以验证在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38280638&quot;&gt;《正确理解 Barra 的纯因子模型》&lt;/a&gt;谈到的三类因子（国家因子、行业因子、风格因子）的特性是否成立。&lt;/p&gt;&lt;p&gt;我们选用中证 500 指数的成分股在 2016 年 5 月 31 日的截面数据和这些股票在 2016 年 6 月 1 日的收益率作为回归的输入。除国家因子外，行业因子考虑了 27 个申万行业，并考虑以下 11 种风格因子（再次重申，本实证的目的是为了验证  &lt;equation&gt;\bf\Omega&lt;/equation&gt; 的求解，因此对于如何构建这些风格因子不做描述）：GROWTH，EP，BP，LIQ，SCALE，SCALENL，BETA，RESIDSTD，MOM，REV 以及 LIB2ASSET。&lt;/p&gt;&lt;p&gt;根据上一节的求解方法，得到这 39 个因子（1 个国家 + 27 个行业 + 11 个风格）的投资组合在 2016 年 6 月 1 日的因子收益率如下。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f8b81bd4884e42a58a28bf86e3c2ebe7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;885&quot; data-rawheight=&quot;391&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f8b81bd4884e42a58a28bf86e3c2ebe7&quot; data-watermark-src=&quot;v2-c0c7d32745c545f05ab7ad495bd86d91&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;观察不同因子的收益率可知，它们的数量级大致相当。结果显示，国家因子的收益率为 0.429%，当日中证 500 的收益率是 0.44%。这两个数字满足&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38280638&quot;&gt;《正确理解 Barra 的纯因子模型》&lt;/a&gt;提到的&lt;b&gt;国家因子组合近似的等于市场组合。&lt;/b&gt;比较国家因子组合中个股的权重和中证 500 指数中个股权重，权重差别的均值为 3.2%，权重差别的分布如下图所示（提醒，这仅仅是当期的结果）：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a33dfd5829dc7748de6204d540c55b4b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;585&quot; data-rawheight=&quot;255&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a33dfd5829dc7748de6204d540c55b4b&quot; data-watermark-src=&quot;v2-83a015f56c0980bc27d6de01e656d57d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;再来看看行业因子收益率。行业因子投资 100% 做多该行业，100% 做空市场，因此它表示行业相对市场的超额收益。然而，&lt;b&gt;行业因子的投资组合收益率并不等于申万这些行业指数和中证 500 指数收益率的差值。&lt;/b&gt;这是因为行业纯因子投资组合对所有风格因子的暴露为零，而申万行业指数无法满足这个限制，所以二者中个股的权重是不同的，因此它们的收益率也会有出入。&lt;/p&gt;&lt;p&gt;使用因子投资组合的权重矩阵 &lt;equation&gt;\bf\Omega&lt;/equation&gt; （K × N 阶）乘以当期的因子暴露矩阵  &lt;equation&gt;\bf X&lt;/equation&gt; （N × K 阶），就得到一个 K × K 阶的矩阵，&lt;b&gt;该矩阵的每一行都是其对应的因子投资组合在其他因子上的暴露&lt;/b&gt;。检查这个矩阵的结果可以帮助我们检验 Barra 纯因子组合的性质。下图就是 &lt;equation&gt;\bf \Omega&lt;/equation&gt; 乘以  &lt;equation&gt;\bf X&lt;/equation&gt;  得到的矩阵。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e5e4d7d5423ce6a4c821f2a1156dabca_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1254&quot; data-rawheight=&quot;298&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e5e4d7d5423ce6a4c821f2a1156dabca&quot; data-watermark-src=&quot;v2-fc6cf2355d50ff48e82d59cc839b9632&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;图中（看的不是太清楚，我尽量解释），排除列名所在的最上面一行不考虑，第一行是国家因子；蓝色长方形框出来的部分是行业因子；红色长方形框出来的部分是风格因子。白色的单元格表示的数字是 0 —— 因此我们很容易看出，&lt;b&gt;国家因子和任一个行业因子组合在所有风格因子上的暴露都是 0；而任何一个风格因子纯因子组合在国家、所有行业以及其他风格因子上的暴露也都是 0。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面再来具体看看不是零的单元格（我们从图中分别针对国家和行业因子、以及风格因子截取一部分解释）。&lt;/p&gt;&lt;p&gt;下图显示了该矩阵左上角的部分，包括国家因子和几个行业因子。&lt;b&gt;第一行&lt;/b&gt;（除了列名外）为国家因子，每一列对应的单元格中的数字是国家因子在相应因子上的暴露。可见，国家因子对自身的暴露为 1，因为它近似的等于市场，而市场包含了所有行业，因此它在每个行业上都有一定程度的暴露（比如，国家因子在 801010 行业上的暴露为 0.033，在 801020 行业上的暴露为 0.020）。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2d2fcf5f58980a558e4527e7154e8852_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;809&quot; data-rawheight=&quot;197&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2d2fcf5f58980a558e4527e7154e8852&quot; data-watermark-src=&quot;v2-8bc32283bebeabf12029a061a17cfc40&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;再来看看行业因子。以 801010 这个行业为例（即排除列名外的第二行）。前文反复强调过，&lt;b&gt;行业的纯因子组合等价于 100% 做多该行业，100% 做空国家因子。&lt;/b&gt;因此，对于 801010 这个行业来说，它在所有行业（包括它自己）上的暴露应该是行向量 [1, 0, 0, … ,0]（第一个 1 代表对它自己的 100% 多头）和国家因子在这些行业上的暴露 —— 即向量 [0.033, 0.020, 0.059, … ] —— 的&lt;b&gt;差&lt;/b&gt;（做差就相当于做空国家因子）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;[1, 0, 0, … ,0] - [0.033, 0.020, 0.059, … ] = [0.967, -0.020, -0.059, …]&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;而如果我们考察 801010 所在的第二行的数值，则上面计算得到的这个向量 [0.967, -0.020, -0.059, …]（忽略计算误差）中的数值正是对应 801010 在不同行业（包括它自己）上的暴露！&lt;/p&gt;&lt;p&gt;扩展一下上述结论，&lt;b&gt;对于给定的行业，它在其他行业的暴露等于向量&lt;/b&gt; [0, 0, …, 0, 1, 0, …, 0] &lt;b&gt;—— 假设该行业在所有行业中的位置为&lt;/b&gt; p&lt;b&gt;，则这个向量中的位置&lt;/b&gt; p &lt;b&gt;为&lt;/b&gt; 1&lt;b&gt;，其他位置为 &lt;/b&gt;0 &lt;b&gt;—— 与国家因子在这些行业上的暴露向量之差。&lt;/b&gt;这也解释了为什么在上图中我们观察到，任何其他行业在行业 p 上的暴露都相等（在误差范围内），且等于国家因子在行业 p 上暴露加个负号。&lt;/p&gt;&lt;p&gt;最后来看看风格因子的纯因子组合。下图证实，对于每个风格因子，其纯因子组合只对它本身有 1 个单位的暴露，而对其他风格因子没有任何暴露。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f75f631cab683d6c7212c251ea59404_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;884&quot; data-rawheight=&quot;216&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3f75f631cab683d6c7212c251ea59404&quot; data-watermark-src=&quot;v2-412b629a79f1fb32f246c926f83b2d0f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;以上我们从多个角度检验了截面回归的求解结果。得到的数据和 Barra 对于纯因子组合的构建相符合，这说明了 &lt;equation&gt;\bf\Omega&lt;/equation&gt; 求解过程的正确性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文介绍了截面回归的求解。结合之前的几篇文章，对 Barra 模型的介绍基本比较完整了。然而，我们对它的思考和实践应远不止于此。&lt;/p&gt;&lt;p&gt;在国内的一些优秀券商金工报告中，已经开始使用最优化的思想，加上各种可投资性的限制，利用 Barra 的这套纯因子模型来构建投资组合了。这无疑是一种很好的尝试。&lt;/p&gt;&lt;p&gt;另外，有朋友反馈说，使用了 Newey-West 调整后，协方差矩阵的 bias statistic 反而变差。还有其他各种各样的问题。在我自己的实践中，尚未遇到所有小伙伴们遇到的问题，因此暂时无法对所有问题都给出靠谱的评论。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论我们是否使用 Barra 模型，最重要的是理解它内在的含义和它使用的各种统计手段。切莫把 Barra 当作多因子投资的“标准姿势”，误以为把它套用到 A 股数据上就会产生什么神奇的化学反应。&lt;/b&gt;那无疑是本末倒置。正确的做法是理解其含义，并针对 A 股数据的特点有的放矢、灵活应用。让我们在践行多因子选股的道路上，为找到收益风险比更佳的投资组合而努力。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Menchero, J. (2010). &lt;i&gt;Characteristics of Factor Portfolios&lt;/i&gt;. MSCI Barra Research Notes.&lt;/li&gt;&lt;li&gt;Menchero, J., D. J. Orr, and J. Wang (2011). &lt;i&gt;The Barra US Equity Model (USE4)&lt;/i&gt;. MSCI Barra Research Notes.&lt;/li&gt;&lt;li&gt;Menchero, J. and J.-H. Lee (2015). Efficiently combining multiple sources of alpha. &lt;i&gt;Journal of Investment Management&lt;/i&gt;, Vol. 13(4), 71 - 86.&lt;/li&gt;&lt;li&gt;Ruud, P. A. (2000). &lt;i&gt;An Introduction to Classical Econometric Theory&lt;/i&gt;. New York, NY: Oxford University Press.&lt;/li&gt;&lt;li&gt;Barra Risk Model Handbook (2007). MSCI.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-17-39922829</guid>
<pubDate>Tue, 17 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>“法定砸盘日”一说站不住脚</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-12-39594162.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/39594162&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ebbb2dce94abd3989b3828e7c979d6b2_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;写在前面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当地时间 2018 年 7 月 11 日，美国国会参议院以 88 : 11 的压倒性表决结果通过了一项针对特朗普政府贸易政策的非约束性提案，寻求限制特朗普以国家安全为由加征进口商品关税的总统权力。虽然这仅仅是一个非约束性提案，但大 A 股（以及其他亚洲市场）无疑将其解读为一个利好，在今天（12日）市场情绪高涨、出现了久违的反弹。&lt;/p&gt;&lt;p&gt;这个反弹不一般，因为它发生在星期四。对于 A 股市场，坊间流传着&lt;b&gt;星期四是法定砸盘日&lt;/b&gt;一说。我去年关于这个说法做过一个实证，&lt;b&gt;从统计角度、经济角度以及执行层面抨击了这个说法&lt;/b&gt;。正好结合今天的反弹，把它发到专栏来。&lt;/p&gt;&lt;p&gt;我并不否认 A 股（以及全球市场）中存在某些日历异象。由于人们的认知偏差，有时会被有限次异象蒙蔽。从长期来看、从统计意义上来看、以及从想要交易这些异象带来的潜在异常收益所需要的套利成本来看，很多市场中所谓的异象便不攻自破了。&lt;/p&gt;&lt;hr&gt;&lt;h2&gt;&lt;b&gt;1 星期四 = 法定砸盘日？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;市场中流传着“星期四 = 法定砸盘日”这种说法。意思是，无论大小盘股票，都会在星期四这天遭到抛售而下跌。这本是坊间茶余饭后的谈资，却在 A 股多次股灾之后的漫长修复道路上给投资/机者心理蒙上了一层抹不去的阴影，牵动着各路资金的神经。&lt;/p&gt;&lt;p&gt;在最近两个月的 8 个周四交易日中，这个说法在各大小盘指数上都得到了体现。下表统计了自 2017 年 8 月 3 日到 2017 年 9 月 21 日以来的 8 个周四，四个有代表性的股指（上证 50，沪深 300，中证 500，以及创业板）的涨跌幅，确实跌多涨少。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-29e95b9de40bc7371cdda63873bb1156_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;735&quot; data-rawheight=&quot;328&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-29e95b9de40bc7371cdda63873bb1156&quot; data-watermark-src=&quot;v2-c8c09464a3eccf5d243c87aef248fbd6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;然而，真的有“星期四 = 法定砸盘日”这种股市异象吗？如果确有这种代表着市场&lt;b&gt;无效性&lt;/b&gt;的现象，那怕是早就被聪明的人利用起来，从而这个异象也就随之消失了。又或者星期四砸盘的背后有什么合理的解释呢？&lt;/p&gt;&lt;p&gt;今天我们就从多个维度来分析一下这个股市异象。分析维度主要围绕统计角度、经济角度和执行角度三大块展开，具体的：&lt;/p&gt;&lt;p&gt;&lt;b&gt;统计角度：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;通过假设检验分析周四收益率均值是否偏离 0。&lt;/li&gt;&lt;li&gt;使用 Normal Theory 和 Bootstrap 两种方法计算周四收益率的置信区间，考察其是否包括 0。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;经济角度：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;纯多头的指数策略在考虑成本的前提下避开周四的收益是否比一直持有指数的收益更高？&lt;/li&gt;&lt;li&gt;纯空头做空周四的策略是否有利可图？&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;执行角度：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;在回测中如果真发现了股市异象，那么这种异象在样本外是否能够持续？&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;为了使我们的研究尽量充分，实证中考察上述提到的四种有代表性的指数，即上证 50，沪深 300，中证 500 和创业板。此外，我们也会考虑不同的时间窗口，以期看看不同的监管和金融市场环境对周四是否有影响。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这些实证指出，周四并无神奇的异象，它只是普通交易中的一个，“星期四 = 法定砸盘日”这种说法是不成立的。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 研究区间和收益率箱体图&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文的实证考虑如下 3 个时间窗口，后面的分别是前面的一个子集，这有助我们考察不同时间段内股市在周四的表现。这 3 个窗口为：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;窗口一：&lt;/b&gt;2011 年 01 月 01 日 – 2017 年 09 月 22 日&lt;/li&gt;&lt;li&gt;&lt;b&gt;窗口二：&lt;/b&gt;2014 年 11 月 01 日 – 2017 年 09 月 22 日&lt;/li&gt;&lt;li&gt;&lt;b&gt;窗口三：&lt;/b&gt;2016 年 03 月 01 日 – 2017 年 09 月 22 日&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;第一个窗口起点为 2011 年 1 月 1 日。这是因为考察的指数中有创业板指数，而它的基日为 2010 年 5 月 30 日。考虑最初半年左右为不成熟的过渡期，我们选择从 2011 年开始。第二个窗口起点为 2014 年 11 月 1 日，因为当月被公认为 A 股第二个大牛市的起点。第三个窗口起点为 2016 年 3 月 1 日，该时点被认为是股灾之后 A 股在监管下的新健康态的起点。&lt;/p&gt;&lt;p&gt;首先来看看考察的 4 个指数周四的收益率在这 3 个时间窗口内的箱体图。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-756275e663af2198f1f3b3fc080f3530_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;609&quot; data-rawheight=&quot;498&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-756275e663af2198f1f3b3fc080f3530&quot; data-watermark-src=&quot;v2-bf57bdeb806e7ff24d2720eb49b45388&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-84e091f2c822bc5abae620d2914f9bfb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;495&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-84e091f2c822bc5abae620d2914f9bfb&quot; data-watermark-src=&quot;v2-298f3fb985dc5e43080e3de08bb16bc6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-cc4867788f992c73809a80dd0ae0d2cd_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;603&quot; data-rawheight=&quot;489&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-cc4867788f992c73809a80dd0ae0d2cd&quot; data-watermark-src=&quot;v2-39cbb6702244e9c80425aba5f72786ad&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-22d0c730eff4a6ce65ded143ef274728_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;607&quot; data-rawheight=&quot;494&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-22d0c730eff4a6ce65ded143ef274728&quot; data-watermark-src=&quot;v2-a965e53c625737402739adaafca0de21&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;以上四张图的结果十分类似，传递出以下几个信息：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;在所有考察的时间窗口内，四大指数星期四收益率的样本均值均小于零。&lt;/li&gt;&lt;li&gt;在整个时间窗口内（即 2011 年 1 月 1 日到 2017 年 9 月 22 日），样本均值小于零的幅度远超过另外两个时间窗口；另外两个窗口内的均值比整个窗口内的均值小一个数量级，这两个窗口内均值虽然为负，但是和零的差别非常小。&lt;/li&gt;&lt;li&gt;由于第二个窗口是第一个窗口的子集，比较它们不难得出推论：星期四收益率为负的样本点主要发生在 2011 年到 2014 年底之间。&lt;/li&gt;&lt;li&gt;股灾结束之后的第三个时间窗口内，周四收益率的波动明显降低，体现了新的监管思路下市场的理性、健康新常态。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下面我们就用一些统计手段来分析一下这些指数在不同窗口内的周四收益率均值。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 统计角度一：假设检验 —— 周四收益率均值是否不为零？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们首先统计学中的假设检验来分析一下周四收益率的均值。为此，提出&lt;b&gt;原假设（null hypothesis）&lt;/b&gt;：&lt;b&gt;&lt;i&gt;星期四的收益率均值为零。&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;来看看我们是否能够&lt;b&gt;拒绝&lt;/b&gt;这个假设。&lt;/p&gt;&lt;p&gt;令 H 代表这个原假设；D 代表我们的周四收益率序列。为了回答“是否能够拒绝原假设”这个问题，我们必须知道&lt;b&gt;后验条件概率 &lt;/b&gt; &lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt; &lt;b&gt;，即在已有收益率序列 D 的前提下，原假设 H 为真的条件概率。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了得到 &lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt;，我们首先对收益率序列 D 进行一般的假设检验，得到 t-statistic 和 p-value，然后把它们放入贝叶斯框架中，得到&lt;b&gt;后验的 Bayesianized p-value，它就是 &lt;/b&gt;&lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt;。在这个框架中，另外一个必要的输入是&lt;b&gt;先验可能性比例（prior odd ratio），它定义为原假设和备择假设出现的概率的比值，代表我们在多大程度上愿意相信待检验的异象。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于“星期四法定砸盘日”，这个异象本身并无有力的业务依据，因此我们假设这个说法的可能性仅有 5%，这意味着我们认为原假设成立的先验概率是 95%，而备择假设成立的先验概率是 5%。因此，prior odd ratio = 95%/5% = 19。有了 t-statistic、p-value 以及 prior odd ratio 之后，就可以将它们套入贝叶斯框架计算出后验概率 &lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt;。计算中，根据使用 t-statistic 或者 p-value，有两种计算方法，因此可以得到两个版本的 &lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt;。具体方法详见之前的文章：&lt;/p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-a15c5ecc3970eb5bc0db7535205acb93&quot; data-image-width=&quot;1118&quot; data-image-height=&quot;694&quot; data-image-size=&quot;180x120&quot;&gt;石川：在追逐 p-value 的道路上狂奔，却在科学的道路上渐行渐远&lt;/a&gt;&lt;p&gt;下面就来看看这 4 个指数在考察的 3 个时间窗口内假设检验的结果。&lt;/p&gt;&lt;p&gt;我们以上证 50 的检验结果（下表）做解释。这里，我们最关注的是后验概率 &lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt; 是否在某个时间窗口内足够小，比如小于 0.05 或者 0.01 以便允许我们拒绝原假设。不幸的是，在这三个窗口内， &lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt; 都非常大，说明在得到的周四收益率序列下，原假设为真的条件概率非常高，因此&lt;b&gt;我们不能拒绝原假设。即我们应该接受它：星期四的收益率均值为零。换句话说，对于上证 50 来说，星期四 ≠ 法定砸盘日。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9cba55223810f7903bebdb3f15816f3a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;798&quot; data-rawheight=&quot;242&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9cba55223810f7903bebdb3f15816f3a&quot; data-watermark-src=&quot;v2-989e643a8340600becf0a3db193f1bb6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;同样的方法可以解读对于其他 3 个指数的假设检验结果，可以得出相同的结论：&lt;b&gt;在任何考察的时间窗口内，对这些指数，我们都要接受星期四收益率的均值等于零这个原假设。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;值得一提的是，对于其他 3 个指数，在&lt;b&gt;整个时间窗口内&lt;/b&gt;原始假设检验的 p-value 实际上非常低，似乎意味着我们应该拒绝原假设。&lt;b&gt;然而，这个先验 p-value 并不等于 &lt;/b&gt;&lt;equation&gt;\mbox{prob}(H|D)&lt;/equation&gt;&lt;b&gt;，因此即便它很小，我们也不能依靠它就来拒绝原假设。&lt;/b&gt;关于这一点的论述，感兴趣的朋友请参阅&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot;&gt;《在追逐 p-value 的道路上狂奔，却在科学的道路上渐行渐远》&lt;/a&gt;。此外，在以 2014/11/01 和 2016/03/01 开始的后两个时间窗口内，即便是原始的 p-value 也很大，这说明所谓的砸盘日异象如果存在（其实不存在），那它顶多存在于 2011 年到 2014 年年底之间。我们会在经济层面分析时再来讨论这点。&lt;/p&gt;&lt;p&gt;对其他 3 个指数的分析结果总结如下：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ccc02642825d54ba408e96d7428c2026_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;794&quot; data-rawheight=&quot;238&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ccc02642825d54ba408e96d7428c2026&quot; data-watermark-src=&quot;v2-02ce216e1c40f2db7596c48196b51211&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-60300c7898e73db8536f04e38dca505c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;793&quot; data-rawheight=&quot;236&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-60300c7898e73db8536f04e38dca505c&quot; data-watermark-src=&quot;v2-88f7e706a1445effc4456eb27bccbd3c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-106ecb10b01c57ddb4f1422f05491605_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;793&quot; data-rawheight=&quot;235&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-106ecb10b01c57ddb4f1422f05491605&quot; data-watermark-src=&quot;v2-65f0c6d063054b2217ebc235ca114838&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;4 统计角度二：周四收益率均值的置信区间&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;下面来看看周四收益率均值的置信区间。如果置信区间包含 0，则说明周四并无异象，即砸盘日不成立。为了计算置信区间，我们考察两种方法：传统的基于 Normal Theory 的方法以及 Bootstrap 方法（计算时随机产生 1000 个 Bootstrap 样本）。&lt;/p&gt;&lt;p&gt;这 4 个指数在 3 个不同窗口内周四收益率均值的 &lt;b&gt;99%&lt;/b&gt; 的置信区间如下：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-09406fef7af3885edc0e97cbaf5dccee_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;667&quot; data-rawheight=&quot;771&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-09406fef7af3885edc0e97cbaf5dccee&quot; data-watermark-src=&quot;v2-8a14115b2bb990ffef3f0cd53323296f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;在这些结果显示，所有考察的 4 个指数在 3 个时间窗口内周四收益率均值的 99% 的置信区间均包括 0，这说明周四收益率并无特别之处。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;第三、四两小节的统计分析结果指出，周四的收益率异象在统计上无法得到显著的支撑。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 经济角度一：剔除周四的多头策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在本节和下一节中，我们考察利用所谓“周四收益率异象”能否获得超额收益，即从经济层面考察这个现象。&lt;/p&gt;&lt;p&gt;本节考虑剔除周四的多头策略，该策略如下：&lt;/p&gt;&lt;p&gt;&lt;i&gt;在给定的时间窗口内，在除星期四这个交易日外，持有指数。因此，策略在周三收盘时清仓，并在周四收盘时重新满仓（因此正好躲开周四）。&lt;b&gt;由于该策略要在周三、周四收盘时交易，冲击成本不可避免。&lt;/b&gt;假设交易费和冲击成本等所有成本为&lt;b&gt;单边万分之五&lt;/b&gt;。（在检查一个策略在经济层面是否显著时，必须考虑合理的成本。）&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;如果周四确实是“法定砸盘日”，那么我们躲开周四的多头策略即便再考虑了各种成本后，也应该能够战胜指数本身。&lt;/b&gt;下面就来看看事实是否如此。&lt;/p&gt;&lt;p&gt;首先来看看上证 50 指数。下图显示了策略（蓝线）在 3 个时间窗口内和基准指数（绿线）的净值比较。&lt;b&gt;可见，在考虑了合理的交易成本后，策略在第二和第三个窗口内均无法战胜基准指数，这意味着刻意躲开周四是无用的。在整个窗口内，策略虽然战胜了指数，但不难看出所有的超额收益几乎都来自 2013 年。&lt;/b&gt;我们在本文的第七节再对此进行评述。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4da4610742c6537630856d58ce883091_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;620&quot; data-rawheight=&quot;798&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4da4610742c6537630856d58ce883091&quot; data-watermark-src=&quot;v2-5100df7221ddf6dad1bfbe0e5bac92a7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;对于其他三个指数也可以得到类似的结论：在后面两个时间窗口内，躲开周四并没有跑赢指数本身。而在整个时间窗口内，策略虽跑赢指数，但绝大部分超额收益来自 2013 年。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e9aaaf8960763c1ac3f967420dceff14_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;804&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e9aaaf8960763c1ac3f967420dceff14&quot; data-watermark-src=&quot;v2-a192697b1de01d15ea65cabb7e1ec6cc&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1ac82472ead93f43d4c1f08f043852ba_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;627&quot; data-rawheight=&quot;804&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1ac82472ead93f43d4c1f08f043852ba&quot; data-watermark-src=&quot;v2-455ad1bcbf4b0c525391817e6f4c32df&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-286545d5471d8b89759f985039fc3bf6_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;621&quot; data-rawheight=&quot;805&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-286545d5471d8b89759f985039fc3bf6&quot; data-watermark-src=&quot;v2-d38235d4dac38975457d6fb5554776ff&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;6 经济角度二：仅做空周四的空头策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;再来看看仅仅做空周四的空头策略表现如何。该策略如下：&lt;/p&gt;&lt;p&gt;在给定的时间窗口内，做空星期四这个交易日。因此，策略在周三收盘时建仓，并在周四收盘时平仓。实际交易中使用股指期货。由于股指期货的交易费较低，因此费用和冲击成本假设为&lt;b&gt;单边万分之三&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;由于创业板没有对应的股指期货，因此我们仅考虑上证 50，沪深 300 和中证 500。注意，这三个指数的股指期货推出时间不同：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;沪深 300 股指期货：2010 年4 月 16 日&lt;/li&gt;&lt;li&gt;上证 50 股指期货：2015 年 4 月 16 日&lt;/li&gt;&lt;li&gt;中证 500 股指期货：2015 年 4月 16 日&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;由于股指期货有不同月份的合约，因此在实证中，我们采用股指期货的当月连续指数。由于上证 50 和中证 500 的股指期货在 2015 年才推出，因此它们的时间窗口从推出时开始。&lt;/p&gt;&lt;p&gt;由于沪深 300 的股指期货历史最长，我们用它来解释该策略的效果。下图显示了策略在 3 个时间窗口内的净值。首先，&lt;b&gt;在 3 个窗口内，策略最终都是亏钱的。&lt;/b&gt;做空“砸盘日”并没有想象的那么美好。策略仅在 2013 年到 2014 年上半年持续上涨。从 2014 年后半年开始几乎稳健下行。这和持续的交易成本以及股指期货的负基差有关。策略做空股指期货，为实现交易必须有对手方做多股指期货。在股灾之后，投资者情绪受到灾难性的打击，加上股指期货交易量的突然管制，这使得&lt;b&gt;股指期货作为对冲工具的成本直线飙升。任何为空头提供保险的多头都需要额外的风险补偿，这造成了股指期货天生的负基差。&lt;/b&gt;这相当于如果想要做空股指期货，先拿来几个点当做成本给多头。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-707e413826a10945db43cc65941ffbca_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;628&quot; data-rawheight=&quot;800&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-707e413826a10945db43cc65941ffbca&quot; data-watermark-src=&quot;v2-30d228c27972c46112a4c759d264cb80&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;策略在上证 50 和中证 500 股指期货上的也表现出了类似的效果：&lt;b&gt;使用股指期货做空周四，无法持续的赚到钱（负收益却比较稳定）。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-39d4e19cb846a7101f3d39328927fc1f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;543&quot; data-rawheight=&quot;469&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-39d4e19cb846a7101f3d39328927fc1f&quot; data-watermark-src=&quot;v2-602a64e59bd5ae336952bcb79c0bc504&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6570602613d11a7fedd7af7eca8b7c56_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;539&quot; data-rawheight=&quot;469&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6570602613d11a7fedd7af7eca8b7c56&quot; data-watermark-src=&quot;v2-ff224c2efb7ef62f281387ba85e8603d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;7 执行角度：样本外何去何从？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;前面两节从经济层面构建了多头和空头两个策略。研究结果显示，空头策略无法赚到钱，而多头策略&lt;b&gt;仅在&lt;/b&gt; 2013 年可以靠避开周四赚到钱。&lt;/p&gt;&lt;p&gt;我们来想想这对构建策略到底有没有意义。&lt;/p&gt;&lt;p&gt;&lt;b&gt;对于周四砸盘日这个异象，假如它成立，则我们预期它会在样本内外都有效，而非仅仅是样本内数据挖掘的产物。&lt;/b&gt;然而，从上面的分析可知，多头策略仅仅在 2013 年有效。试想一下，我们在 2014 年以 2011 到 2013 年底的交易数据为样本内数据研发量化策略，并找到周四异象这么一个带来超额收益的因子。&lt;b&gt;如果我们缺乏系统科学的手段分析该因子在统计上的有效性，并且又无法从业务上来解释它，那么便会盲目的相信找到一个非凡的因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;但是该策略在样本外又如何呢？自 2014 年起，利用我们样本内数据挖掘出来的错误因子，无论是多头还是空头策略都无法获得超额收益，它带给我们的只有额外的交易次数（周三和周五两次额外交易）；我们没有获得收益，却白白给券商交了大把的手续费。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;8 如果你非要相信“星期四 = 砸盘日”&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;无论从统计、经济还是执行角度，周四都不是法定砸盘日；我们无法利用这个所谓的异象来获得超额收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从市场运行的逻辑上说，“法定砸盘日”（甭管是周几）代表着市场的无效性。&lt;b&gt;一旦市场中确实有无效性存在，就一定有人利用这个无效性赚钱，从而该无效性造成的套利机会就会在短期内消失。任何赚钱的策略都提高了市场的效率。&lt;/b&gt;假设市场参与者达成共识，周四市场一定会大跌，那么就会有很多人在周三抛盘，从而造成周三下跌；周四重新在低位接盘，造成周四上涨。此消彼长，砸盘日的无效性也必将消失。&lt;/p&gt;&lt;p&gt;从业务逻辑来说，人们绞尽脑汁给所谓的周四砸盘日找了下面两个解释（解释参考了知乎上关于这个问题上的讨论：&lt;a href=&quot;https://www.zhihu.com/question/35889661&quot;&gt;为什么星期四是法定砸盘日？&lt;/a&gt;）：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;股指期货通常在合约月份的第三个周五交割。为了避免股指期货交割时的大幅波动，在这个周五的前一天（周四）是空方力量集中释放之时。而在此影响下，部分资金卖出避险又加重了这一效应，于是乎不知不觉形成了“周四为法定砸盘日”的思维。&lt;/li&gt;&lt;li&gt; 周四卖掉的资金周五可以转出（如果周五卖掉，只能下周一转出）。对大资金来说，能获得一些无（低）风险收益，同时规避周末可能出现的利空消息。加上散户追涨杀跌效应放大恐慌，所以一般周四较容易出现大跌，特别是在熊市。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;显然，上面这两种解释对周四的影响首先很难被量化的界定，其次它们的持续性也存疑。比如第一种解释和股指期货有关，但是像上证 50 和中证 500 的股指期货都是 2015 年才推出。&lt;b&gt;因此，从构建量化策略的角度，我的观点是“周四 ≠ 法定砸盘日”。一个成功的量化策略背后应有严谨的金融业务逻辑和对市场行为的合理假设。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;当然，对于 A 股这个散户占主导的、非常不成熟的市场，散户跟风操作的风险仍然需要防范（股灾之后的新常态下 A 股已经理性的多）。&lt;/b&gt;因此，“法定砸盘日”虽然站不住脚，但它难免从一定程度上对市场心理造成负面影响，因此可适当对其进行防控。毕竟，在投资中，我们应该永远把风险放在第一位，把赚钱放在第二位。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-12-39594162</guid>
<pubDate>Thu, 12 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>CAPM 的一小段历史</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-10-39455532.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/39455532&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-04d35fed36729db5c42a9d321bf3a4e1_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;1 迟来的认可&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于金融领域的从业者来说，Jack Treynor  这个名字一定不陌生。比如，以他名字命名的 Treynor Ratio 是一个和夏普率类似的衡量收益和波动关系的指标（它和夏普率不同之处在于其分母是 &lt;equation&gt;β&lt;/equation&gt; 而非 &lt;equation&gt;σ&lt;/equation&gt; ）。考过 CFA 的小伙伴也许对 Treynor 更熟悉一些，因为他曾经是 CFA 旗下期刊 Financial Analysts Journal 的编辑。&lt;/p&gt;&lt;p&gt;然而我们今天谈到 Treynor，并不是因为上述两个原因，而是由于当代金融市场价格理论的支柱 —— &lt;b&gt;资本资产定价模型（Capital Asset Pricing Model，CAPM）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1981 年，当 Treynor 即将卸任 Financial Analysts Journal 编辑一职的时候（此前他已经为这个期刊奉献了 13 年），Fischer Black 在当期的 Letters to the Editor 专栏中撰写了一封写给 Treynor 的公开信，感激他的巨大贡献，并指出&lt;b&gt;“你是第一个发明 CAPM 的人”。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-01695e1e953ba06b8ee7f66f92b16462_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;598&quot; data-rawheight=&quot;610&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-01695e1e953ba06b8ee7f66f92b16462&quot; data-watermark-src=&quot;v2-55b00828212c33ada6e0b258da4cabb5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我不知道 Treynor 看到这个评价时作何感想，也许他心如止水，因为在他眼中追求认知市场远比赢得名声重要。但在我们这些作为后人的凡夫俗子看来，这是对 Treynor 巨大贡献的一种肯定。&lt;/p&gt;&lt;p&gt;下面我们就来看看是什么让 Fischer Black 得出了上述结论。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 四个发明者&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;关于 CAPM 的发明者，Wikipedia 上的说明如下：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The CAPM was introduced by Jack Treynor, William F. Sharpe, John Lintner and Jan Mossin independently.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;对于绝大多数像你、我一样的读者，谈到 CAPM，恐怕条件反射直接想到的只有 William Sharpe（毕竟他太出名，而且也因此获得了诺贝尔奖）。真正深耕金融领域的小伙伴可能除了 Sharpe 之外会知道 Lintner 和 Mossin（尤其应该知道 Lintner，因为他推导 CAPM 的出发点和 Sharpe 不同）。但是由于 Treynor 太低调，恐怕很少有人知道他也是 CAPM 的发明者之一（事实上，他应该是最早的发明者，但是他早期的论述并没有公开发表）。下面我们就来重温这段历史。本节的介绍参考了 French (2003) 以及 Sullivan (2006)。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.1 Jack Treynor&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在 CAPM 被提出之前，人们对于风险（risk）如何影响一个公司的资本成本（cost of capital，或者 discount rate）、进而如何影响收益并没有清晰的认识。1958 年，Modigliani 和 Miller 提出了著名的 MM 定理（Modigliani and Miller 1958），它也称为&lt;b&gt;资本结构无关原理&lt;/b&gt;。该定理认为，在不考虑税，破产成本，信息不对称并且假设在有效市场里面，企业价值不会因为企业融资方式改变而改变。这个定理让如何量化风险对于贴现率的影响更加扑朔迷离，这也直接促成了 Treynor 的研究。&lt;/p&gt;&lt;p&gt;Treynor 于 1953 年到 1955 年在哈佛大学攻读 MBA 学位。毕业后他就职于 Arthur D. Little。1958 年夏天，在他休假时读到了 Modigliani and Miller (1958) 这篇论文，这引发了他的思考，并在三周休假内完成了一篇 44 页的文稿。这篇文稿的题目是 Market Value, Time, and Risk。在随后的两年里，他对这篇文稿进行了改进，这便是 Treynor 版的 CAPM 的雏形（Treynor 1961）。&lt;/p&gt;&lt;p&gt;1960 年，Treynor 将他的论文发给了哈佛大学的 John Lintner —— 这是他当时唯一认识的经济学家。然而 Lintner 并没有给 Treynor 太多回应（而 Lintner 自己于几年后也提出了 CAPM，玄妙吧）。机缘巧合，Treynor 的一个朋友在没有告知他的前提下把他的论文发给了 Merton Miller，而 Miller 又把它发给了 Franco Modigliani。后者读了之后建议 Treynor 到麻省理工学院攻读经济学。Treynor 后续在 Modigliani 的主张下，把他最早的论文分成了两部分，第一部名为 Toward a Theory of Market Value of Risky Asset（Treynor 1962），这便是最终 Treynor 版本的 CAPM，可惜它到了 1999 年才被公开出版、呈现在世人面前。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.2 William Sharpe&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Sharpe 在即将开始他博士学习时迎来了人生的重要节点。他在 RAND Corporation（兰德公司）出任经济学家并同时攻读博士学位。在那里，他遇到了一个对其产生重大影响的人 —— Harry Markowitz。用 Sharpe 自己的话说“My debt to him [Markowitz] is truly enormous”。&lt;/p&gt;&lt;p&gt;继续介绍 Sharpe 的 CAPM 之前，让我们“插播”两句 Markowitz 的工作。1952 年，Markowitz 在他著名的文章 Portfolio Selection 中提出了投资组合理论（Markowitz 1952，1959）。Portfolio Selection 对 CAPM 的诞生影响深远。在提出投资组合理论后，Markowitz 尝试提出一种简化模型来实现 portfolio selection。这是因为在他的 mean-variance 框架中，协方差矩阵需要估计的参数太多，实操起来可行性有限。Markowitz 希望把它简化成一个&lt;b&gt;“单因子”模型&lt;/b&gt;来考察风险和收益之间的关系，而 Sharpe 的研究动机正源于此。下面让我们回到 Sharpe。&lt;/p&gt;&lt;p&gt;在 RAND，Markowitz 提议 Sharpe 研究的课题正是 Portfolio Analysis based on a Simplified Model of the Relationships among Securities。虽然 Markowitz 并不在 Sharpe 的论文委员会，但是他对 Sharpe 的指导不亚于他的导师。1961 年，Sharpe 答辩通过获得博士学位，而在他论文的最后一章正是 Sharpe 提出的 CAPM。&lt;b&gt;Sharpe 和 Treynor 在同时期（1960 前后）、互相独立的提出了各自的 CAPM。考虑到 Treynor 最初的工作于 1958 年完成，他应该比 Sharpe 还要早一些。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Sharpe 和 Treynor 彼此是知道对方也在同时进行 CAPM 的研究，而给他们牵线搭桥的人正是 Modigliani。Modigliani 建议他们双方交换论文，这使他们有机会认识到对方的研究。在 Sharpe (1964) 提出 CAPM 这篇文章的脚注 7 中，Sharpe 对 Treynor 的工作进行了认可，也对于 Treynor 没有公开发表他的成果感到惋惜（至于 Treynor 为什么不发表，留到本文结尾揭晓）：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9b3741a4cbc5b8d9baf78b34771b680f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;107&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;Sharpe 于 1961 年提出 CAPM，之后几经抛光打磨，把文章投给了 Journal of Finance。然而，他的第一次提交被拒了，原因是一个审稿人认为他的第二个假设（所有投资人对于资产 —— 预期收益率，标准差，协方差这些 —— 持有相同的看法）的限制太强，因此文章的结论“uninteresting”。幸运的是，后来该期刊换了一个编辑，使得 Sharpe 的 CAPM 于 1964 年问世。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.3 John Lintner&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Lintner 的早期研究兴趣是 Corporate finance。他提出 CAPM 的动机也是源于 Modigliani 和 Miller 的论文（Mehrling 2005）。他认为 MM 的分析是有问题的，并试图通过找到风险资产的定价理论来说明存在最优的资本结构。Lintner 于 1965 年提出 CAPM（Linter 1965a, 1965b）。&lt;/p&gt;&lt;p&gt;前面提到，Treynor 曾在 1961 年将自己的文稿送给 Lintner 评论，但是没有得到太多反馈。我们这里不能不负责任的猜疑 Lintner 是否借鉴了 Treynor 的想法。Mehrling (2005) 对于 Lintner 独立提出 CAPM 这个观点从一定程度上做了背书。公允的说，比较四个最早的 CAPM，Lintner 的文章在数学上最为严谨，他给出了很多证明，并且讨论了很多特殊的情况。在这些情况下，他的模型都是成立的。&lt;/p&gt;&lt;p&gt;有意思的是，在提出 CAPM 之后，Lintner 将他自己的模型和当时已经发表的 Sharpe 的模型进行了比较，并指出他们的模型并不相同，而且他的模型适用性更强。在一段时间内，Sharpe 似乎被说服了，并承认 Lintner 的模型确实优于自己的。然而 Fama (1968) 指出“仔细检查发现，二者的 CAPM 模型是等价的”。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.4 Jan Mossin&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Mossin 于 1966 年发表了他的 CAPM 论文（Mossin 1966）。Mossin 从 1962 年开始于卡耐基梅隆大学攻读博士学位。在他的博士论文中有一章就是其 CAPM 模型的雏形。Mossin 及时的意识到了这个发现的重要性，因此先于其博士论文完成两年就发表了他的 CAPM（他的博士论文于 1968 年通过）。&lt;/p&gt;&lt;p&gt;和 Sharpe 一样，Mossin 研究的出发点也源自投资组合理论。但是，在他的研究中是否借鉴了 Sharpe 的工作我们不得而知。在 Mossin (1966) 中，对 Sharpe (1964) 进行了“批评”，认为其没有精确的阐述均衡条件的定义。&lt;/p&gt;&lt;p&gt;在最初的那段四个 CAPM 模型相继被提出的岁月里，由于不同论文中使用的数学符号大相径庭，人们很难意识到他们之间的等价性（&lt;b&gt;需要非常细致的检查者四篇论文中繁杂的数学符号，才能找到关键方程之间的等价性&lt;/b&gt;）。直到 1970 年，Stone (1970) 才说明了 Mossin 的模型和其他三个的等价性。&lt;/p&gt;&lt;p&gt;虽然在数学上等价，但是这四篇论文揭示了不同的视角（Sullivan 2006）：Treynor 受到 MM 理论的影响，因此他的着眼点是 MM 定理中的命题一：企业的资本结构和它的价值无关。Linter 的研究更关注通过发行股票融资的公司，并认为公司的财务政策非常重要。Sharpe 则毫无疑问受到了 Markowitz 工作的影响，他研究的出发点是最优化投资组合选择。同样，Mossin 的工作也来自投资组合理论，但是他关注的重点是刻画资产市场的均衡条件。&lt;/p&gt;&lt;p&gt;French (2003) 从假设和结论这些角度对这四个模型进行了更加细致的对比（见下面两图）。感兴趣的小伙伴可以进一步阅读。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-59f725be9489a69f5df0eb8b232711ea_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;503&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-59f725be9489a69f5df0eb8b232711ea&quot; data-watermark-src=&quot;v2-55db6e23ee320b2e081d704afc3f9973&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8da582268984caf6f759d45570fa047f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;619&quot; data-rawheight=&quot;646&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8da582268984caf6f759d45570fa047f&quot; data-watermark-src=&quot;v2-229cdce75e6455ba1a883e6c3f952c74&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;从上面历史的复原中可以看到，&lt;b&gt;Treynor 应该是第一个提出 CAPM 的人。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 Fischer Black 的改进版 CAPM&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Treynor、Sharpe、Lintner 和 Mossin 这四位先驱的杰出工作奠定了资本资产定价研究的基础。在 CAPM 被提出之后，在这领域的研究如雨后春笋般层出不穷，从单因子，到双因子、三因子，乃至多因子。大量的后续研究放松了 CAPM 中的一些假设，使得模型更加切合实际、更合理的解释风险和收益之间的关系。在这些非凡的工作中，我想在本文中简单提一下 Black et al. (1972) 这篇。&lt;/p&gt;&lt;p&gt;Black et al. (1972) 观察到，实际的市场数据证明，真实的股票收益率和它们的 &lt;equation&gt;β&lt;/equation&gt;  画出来的资本市场线（SML）远比 CAPM 预测的要更平缓，这说明风险和收益的关系不能非常很好的满足 CAPM。Black et al. (1972) 从时间序列回归和截面回归两个维度实证了上述猜想。&lt;/p&gt;&lt;p&gt;例如，Black et al. (1972) 按照股票的 &lt;equation&gt;β&lt;/equation&gt; 大小把股票分成十组（第一组中 &lt;equation&gt;β&lt;/equation&gt; 最大），然后在时序上回归（检验时考虑了各种偏差和误差的影响），得到了如下结果。按照 CAPM，线性回归的截距项（即 α）应该为 0，&lt;b&gt;然而 Black et al. (1972) 观察到在很多历史时期，&lt;/b&gt; &lt;equation&gt;α&lt;/equation&gt;&lt;b&gt; 显著不为 0，且和 &lt;/b&gt; &lt;equation&gt;β&lt;/equation&gt; &lt;b&gt; 呈负相关&lt;/b&gt; ——  &lt;equation&gt;β&lt;/equation&gt;  大于 1 的股票， &lt;equation&gt;α&lt;/equation&gt; 倾向于是负的。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5dd93341fb773dccb9ccde2b39912d44_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;615&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5dd93341fb773dccb9ccde2b39912d44&quot; data-watermark-src=&quot;v2-da6a0eabfbd856e3681e09f6933223ab&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;观察到实际数据和 CAPM 之间的背离，Black et al. (1972) 抛弃了 CAPM 中存在无风险利率这个假设并提出了一个双因子模型：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mbox{E}[r_j]=\mbox{E}[r_z](1-\beta_j)+\mbox{E}[r_m]\beta_j&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式中没有所谓的无风险收益率，因此小写字母  &lt;equation&gt;r&lt;/equation&gt;  表示股票或者组合的绝对收益。由于第二个因子 &lt;equation&gt;r_z&lt;/equation&gt; 和  &lt;equation&gt;β&lt;/equation&gt;  有关，因此它被称为 &lt;equation&gt;β&lt;/equation&gt; 因子，而 &lt;equation&gt;r_z&lt;/equation&gt; 代表着一个 &lt;equation&gt;β&lt;/equation&gt; 中性的组合的收益率。这是因为 &lt;equation&gt;r_z&lt;/equation&gt; 和 &lt;equation&gt;r_m&lt;/equation&gt; 的协方差为零。这个改进的 CAPM 模型又称为 &lt;b&gt;Black CAPM 模型（或 zero-beta CAPM 模型）&lt;/b&gt;，它比最初的 CAPM 更加符合实际数据，因此应用更加广泛。&lt;/p&gt;&lt;p&gt;在 Black CAPM 被提出的 40 年之后，Frazzini and Pedersen (2014) 从另外的角度解释了 &lt;equation&gt;α&lt;/equation&gt; 和 &lt;equation&gt;β&lt;/equation&gt; 的关系。&lt;b&gt;他们指出在实际投资中，不同的投资者受到不同资金使用的限制。&lt;/b&gt;在这种背景下，为了追求更高的收益，一些投资者（特别是机构）会把有限的资金投资于高风险的投资品，比如高  &lt;equation&gt;β&lt;/equation&gt;  的股票，这便造成了它们超额收益（ &lt;equation&gt;α&lt;/equation&gt; ）的下降。作者用 &lt;equation&gt;ψ&lt;/equation&gt; 来表示资金限制强弱程度，并得出  &lt;equation&gt;α&lt;/equation&gt;  和  &lt;equation&gt;β&lt;/equation&gt;  的关系如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\alpha=\psi(1-\beta)&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;Frazzini and Pedersen (2014) 在不同的市场中（包括股票、商品、债券、外汇）实证了他们的模型。下图显示了在美国股票和全球股票市场中，按照 &lt;equation&gt;β&lt;/equation&gt; 的高低将股票分成十档，每一档的超额收益（超额收益是总收益减去一些常见因子能够解释的部分）。他们针对这个现象提出了 Betting Against Beta 策略、构建投资组合、赚取其他因子无法解释的超额收益。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4c8c8ac781b56058b4fa57663bcf15b4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;885&quot; data-rawheight=&quot;371&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4c8c8ac781b56058b4fa57663bcf15b4&quot; data-watermark-src=&quot;v2-b9d2c02e1ffc6752644a93134a9b0286&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在 CAPM 出现之前，人们不了解风险和预期收益之前的关系。而 CAPM 说明，不是所有的风险都能带来回报 —— 只有那些无法通过多样化而消除的系统性（市场）风险才能带来回报。从最早的 CAPM，再到 Black zero-beta CAPM，再到上面的这个 betting against beta。举这个例子是想说明&lt;b&gt;无数学者前赴后继的投身于理解市场真谛的努力中，让我们逐渐看清什么是正确的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后，我想以 Perold (2014) 的总结作为本小节的收尾：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;资本资产定价模型对我们理解资产价格决定因素至关重要。CAPM 告诉我们，多样化投资者对资产的所有权降低了资产的预期回报、提高了它们的价格。此外，持有非多样化投资组合的投资者则很有可能持有了无法获得回报的风险。由于该模型的结果 —— 尽管它的经验表现喜忧参半 —— 我们现在对预期回报与风险之间的关系有了不同的看法；我们对投资者应如何分配其投资组合有了不同的看法；我们对业绩计量和资本预算等问题有了不同的看法。&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我在本文第一节中曾写到“在他 [Treynor] 眼中追求认知市场远比赢得名声重要”。我之所以有如此想法是因为 Treynor 在回忆为什么不发表他的 CAPM 模型时曾说（Sullivan 2006）：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;I thought that if Sharpe was going to publish, what’s the point of my publishing my paper?&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：我想既然 Sharpe 要发表（他的模型），那么我发表我的意义何在呢？&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;低调！还有比这更低调的吗？&lt;/p&gt;&lt;p&gt;其实 Sharpe 也很低调（他和 Tyernor 在当初都没有充分意识到 CAPM 的重要性）。Fama (1968) 就指出，在 Sharpe (1964) 中，Sharpe 将最重要的结论放在了&lt;b&gt;脚注&lt;/b&gt; 22 中（下图，圈出来的式子就是 CAPM，左侧是 &lt;equation&gt;β&lt;/equation&gt; 的定义）。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6c5453350ea6022addecfbd900de068f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;653&quot; data-rawheight=&quot;615&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6c5453350ea6022addecfbd900de068f&quot; data-watermark-src=&quot;v2-ec7d4ee057e973e1a9615155e84cdf37&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;1990 年，Sharpe 和 Markowitz 以及 Miller 一起获得诺贝尔经济学奖。Sharpe 获奖的原因正是 CAPM。稍显遗憾的是 Lintner 和 Mossin 分别于 1983 年和 1987 年去世，因此无缘此殊荣。而 Treynor 无缘获奖更令人唏嘘 —— 由于他没有公开发表研究成果，他对资产定价所做的贡献一直没有走进大众的视野。&lt;/p&gt;&lt;p&gt;在学术研究中，学术引用通常按照“达尔文主义”来演进。新生代学者几乎很少引用他们的学术前辈不曾引用的那些古老文献。在资产定价领域，早期的重要学者 Lintner、Mossin、Fama 以及 Merton 都或多或少的忽视了 Treynor 的研究。因此后来的学者往往都不知道 Treynor 对 CAPM 的重大贡献。&lt;/p&gt;&lt;p&gt;但我想 Treynor 的努力和贡献，绝不会被遗忘。荣耀也许会迟到，但不会缺席，正如本文开篇提到的那篇 Fischer Black 写给 Treynor 的信一样。但也许 Treynor 早已看淡了这些。在提出 CAPM 之后，他持续地为探究金融市场的真谛做出巨大的贡献。其研究涉及金融、投资中的广泛领域，包括风险、业绩衡量、微观和宏观经济学、交易、会计、投资价值、积极管理、养老金等；他的很多论文发表于 Harvard Business Review，Financial Analysts Journal，Journal of Portfolio Management，Journal of Finance，Journal of Business 以及 Journal of Accounting Research 等高水平期刊。&lt;/p&gt;&lt;p&gt;2007，国际金融工程师协会将 Treynor 选为年度 IAFE/SungARD 金融工程师，以表彰他对金融理论和实践的卓越贡献，尤其是资本资产定价模型。Treynor 于 2016 年 5 月 11 日逝世，享年 86 岁。他留下的无数智慧结晶将源源不竭的造福后人。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Black, F. (1981). An Open Letter to Jack Treynor. &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, July/August. Letters to the Editor, 14.&lt;/li&gt;&lt;li&gt;Black, F., M. C. Jensen and M. Scholes (1972). The Capital Asset Pricing Model: Some Empirical Tests. In &lt;i&gt;Studies in the Theory of Capital Markets&lt;/i&gt;. M. C. Jensen (editor), New York: Praeger, 79 – 121.&lt;/li&gt;&lt;li&gt;Fama, E. (1968). Risk, Return, and Equilibrium: Some Clarifying Comments. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 23, 29 – 40.&lt;/li&gt;&lt;li&gt;Frazzini, A. and L. H. Pedersen (2014). Betting against beta. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 111, 1 – 25.&lt;/li&gt;&lt;li&gt;French, C. W. (2003). The Treynor Capital Asset Pricing Model. &lt;i&gt;Journal of Investment Management&lt;/i&gt;, Vol. 1(2), 60 – 72.&lt;/li&gt;&lt;li&gt;Lintner, J. (1965a). The Valuation of Risk Assets and the Selection of Risky Investments in Stock Portfolios and Capital Budgets. &lt;i&gt;The Review of Economics and Statistics&lt;/i&gt;, Vol. 47, 13 – 37.&lt;/li&gt;&lt;li&gt;Lintner, J. (1965b). Securities Prices, Risk, and Maximal Gains from Diversification. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 20(4), 587 – 615.&lt;/li&gt;&lt;li&gt;Markowitz, H. (1952). Portfolio Selection. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 12, 71 – 91.&lt;/li&gt;&lt;li&gt;Markowitz, H. (1959). &lt;i&gt;Portfolio Selection: Efficient Diversification of Investments.&lt;/i&gt;New York: John Wiley &amp;amp; Sons.&lt;/li&gt;&lt;li&gt;Mehrling, P. (2005). &lt;i&gt;Fischer Black and the Revolutionary Idea of Finance.&lt;/i&gt;Hoboken: John Wiley &amp;amp; Sons.&lt;/li&gt;&lt;li&gt;Modigliani, F. and M. Miller (1958). The Cost of Capital, Corporation Finance, and the Theory of Investment. &lt;i&gt;American Economic Review&lt;/i&gt;, Vol. 48(3), 261 – 297.&lt;/li&gt;&lt;li&gt;Mossin, J. (1966). Equilibrium in a Capital Asset Market. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 34(4), 768 – 783.&lt;/li&gt;&lt;li&gt;Perold, A. F. (2004). The Capital Asset Pricing Model. &lt;i&gt;Journal of Economic Perspectives&lt;/i&gt;, Vol. 18(3), 3 – 24.&lt;/li&gt;&lt;li&gt;Sharpe, W. F. (1964). Capital Asset Prices: A Theory of Market Equilibrium Under Conditions of Risk. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 19(3), 425 – 442.&lt;/li&gt;&lt;li&gt;Stone, B. K. (1970). &lt;i&gt;Risk, Return, and Equilibrium: A General Single-Period Theory of Asset Selection and Capital Market Equilibrium.&lt;/i&gt; Cambridge: MIT Press.&lt;/li&gt;&lt;li&gt;Sullivan, E. J. (2006). &lt;i&gt;A Brief History of the Capital Asset Pricing Model.&lt;/i&gt; APUBEF Proceedings.&lt;/li&gt;&lt;li&gt;Treynor, J. L. (1961). Market Value, Time, and Risk. Unpublished manuscript. “Rough Draft” dated 8/8/61, #95-209.&lt;/li&gt;&lt;li&gt;Treynor, J. L. (1962). Toward a Theory of Market Value of Risky Assets. Unpublished manuscript. “Rough Draft” dated by Treynor to the fall of 1962. A final version was published in 1999, in &lt;i&gt;Asset Pricing and Portfolio Performance.&lt;/i&gt;R. A. Korajczyk (editor), London: Risk Books, 15 – 22.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-10-39455532</guid>
<pubDate>Tue, 10 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>尾部风险建模</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-08-39288885.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/39288885&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-80752daff493d66476231e67afa02200_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;写在前面……&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这篇文章写在 2016 年年底。当时我做量化投资不久，希望从模型的角度学习尾部风险建模，因此&lt;b&gt;这篇文章算是一个学习笔记 + 一些简单的实证&lt;/b&gt;。现如今，经过了近两年在 A 股和国内商品期货市场的摸爬滚打（赚了该赚的钱，也亏了该亏的钱），越来越感觉到对于&lt;b&gt;风险&lt;/b&gt;而言，所有样本内的建模都是对样本外的过拟合，真正的风险是 unknown unknowns。&lt;/p&gt;&lt;p&gt;本文对尾部风险建模的目的是计算诸如风险价值 VaR（给定概率下亏损的阈值 —— &lt;b&gt;最小值&lt;/b&gt;）、或 Expected Shortfall 这类度量风险的指标。关于 VaR 在刻画风险方面是否有用，知乎上有篇著名的讨论：《&lt;a href=&quot;https://www.zhihu.com/question/21774616&quot;&gt;风险价值（VaR）是否是有史以来最蠢的衡量指标？&lt;/a&gt;》，我仔细学习了各位前辈的答案，收获和感慨颇多。对于我而言，对 VaR 的理解和认识远没有各位前辈深刻，但是这篇笔记仍然是一个很好的学习过程，所以我决定还是把它放在专栏里。它记录了学术界对尾部风险建模的一些努力，有助于我们更好的理解收益率的尖峰肥尾分布，以及市场参与者在试图理解风险时 —— 哪怕是一点点 —— 面临的困难。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 风险控制和尾部建模&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2016 年全球金融市场不太平，从英国脱欧到 Trump 当选美国总统再到意大利公投，“黑天鹅”事件频出，就连美联储也跟着添乱，嚷嚷了一年加息、故意扰乱市场对美国经济数据的解读。未来两年，潜在的黑天鹅更是一个接一个。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-515a6d8eb48bf8933b46430487e913d0_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;701&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-515a6d8eb48bf8933b46430487e913d0&quot; data-watermark-src=&quot;v2-f03db720805ae6b20988d0a76e1cafbe&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在这种背景下，风险控制再次回到人们的视线中。&lt;b&gt;在金融领域，风险控制的目的是为了计算极端黑天鹅事件对金融资产造成的潜在损失（负收益率）的可能性以及冲击的大小。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;先来看一个分布。下图为上证指数在过去 15 年内日收益率的分布。我们计算出日收益率的均值和标准差，便可以得到一个基于该均值和标准差的正态分布。下图比较了收益率的直方图和该正态分布。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9cbe7e347024f843f21517de19be76ff_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;609&quot; data-rawheight=&quot;435&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9cbe7e347024f843f21517de19be76ff&quot; data-watermark-src=&quot;v2-d1df42ed07b4716c3d5fa84dcb8d485d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;不难看出，&lt;b&gt;上证指数日收益率的分布表现出明显的尖峰和肥尾特点，尤其是在负收益率部分。&lt;/b&gt;比较日收益率分布和标准正态分布的分位图（下图），也可以清晰地验证这个结论。肥尾意味着上证指数实际发生极端收益率（从上图来看，尤其是极端跌幅）的概率要远远大于正态分布对应的概率。换句话说，&lt;b&gt;如果算出收益率的均值和标准差，然后构建一个正态分布来近似描述日收益率分布，这会造成很大的误差。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bfc78fa85063a570d27cae821eadc021_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;574&quot; data-rawheight=&quot;478&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-bfc78fa85063a570d27cae821eadc021&quot; data-watermark-src=&quot;v2-d34c1801952c4c3c01816a56bd47cb67&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;除了尖峰、肥尾的特点之外，&lt;b&gt;另一个困扰“黑天鹅建模”的问题是，发生极端亏损（真正的黑天鹅）的历史样本太少了&lt;/b&gt;。比如说，我们想回答“上证指数每十年一遇的日收益率最大跌幅是多少”这个问题，回看上证指数过去 20 几年的历史，我们仅仅有可怜的 2 个样本点，无法根据它们构建有效的模型。&lt;/p&gt;&lt;p&gt;那么应该怎么办呢？&lt;b&gt;在统计学上，广义极值分布（Generalized Extreme Value Distribution）可以用来对极端亏损建模。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 极值建模&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;假设随机变量 &lt;equation&gt;X_i&lt;/equation&gt; 代表某投资品的负收益率（亏损），它满足某&lt;b&gt;未知&lt;/b&gt;分布 &lt;equation&gt;F(x) = Pr(X_i ≤ x)&lt;/equation&gt; 。&lt;b&gt;在下文中，我们用负收益率的绝对值代表亏损的大小&lt;/b&gt;（即 &lt;equation&gt;X_i&lt;/equation&gt; 的取值为正数）。在这种描述下，当 &lt;equation&gt;X_i&lt;/equation&gt; 的取值在其分布的右尾（right tail）时，便意味着该投资品发生了极端的亏损。&lt;/p&gt;&lt;p&gt;假设不同时间的亏损 &lt;equation&gt;X_i&lt;/equation&gt; 是独立同分布的，并令 &lt;equation&gt;M_n = \max(X_1, \cdots, X_n)&lt;/equation&gt; ，即 &lt;equation&gt;M_n&lt;/equation&gt; 是  &lt;equation&gt;n&lt;/equation&gt;  个样本中最坏的情况。广义极限分布理论解决的问题就是对 &lt;equation&gt;M_n&lt;/equation&gt; 分布的建模。有了 &lt;equation&gt;M_n&lt;/equation&gt; 的分布，我们就可以回答上面诸如“上证指数每十年一遇的日收益率最大跌幅是多少”的问题。&lt;/p&gt;&lt;p&gt;根据独立同分布的假设，我们可以写出 &lt;equation&gt;M_n&lt;/equation&gt; 的 CDF 为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mbox{Prob}(M_n\le x)=\mbox{Prob}(X_1\le x,\cdots,X_n\le x)=\prod_{i=1}^n F(x)=F^n(x)&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;由于分布 &lt;equation&gt;F&lt;/equation&gt; 是未知的， &lt;equation&gt;F^n&lt;/equation&gt; 自然也是未知的，而经验分布函数对与 &lt;equation&gt;F^n&lt;/equation&gt; 的估计也是非常差的。但是，我们可以根据 Fisher-Tippet 理论（Fisher and Tippett 1928）来渐进逼近 &lt;equation&gt;F^n&lt;/equation&gt; ，并以此得到 &lt;equation&gt;M_n&lt;/equation&gt; 的分布。特别的，Fisher-Tippet 理论证明，将 &lt;equation&gt;M_n&lt;/equation&gt; 标准化后，即 &lt;equation&gt;Z_n = (M_n – μ_n) / σ_n&lt;/equation&gt; ， &lt;equation&gt;Z_n&lt;/equation&gt; 的分布收敛于形式如下的广义极限分布：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;H_{\xi}(z)=\left\{ \begin{array}{lrl} \exp\{-(1+\xi z)^{-1/\xi}\}&amp;amp;\xi\ne 0,&amp;amp;1+\xi z&amp;gt;0\\ \exp\{-\exp{(-z)}\}&amp;amp;\xi=0,&amp;amp;-\infty\le z\le \infty \end{array} \right.&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;因此，只要我们有足够多的原始负收益率样本数据 &lt;equation&gt;X_i&lt;/equation&gt; ，我们可以用下式求出极端亏损 &lt;equation&gt;M_n&lt;/equation&gt; 的分布：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mbox{Prob}(M_n&amp;lt;x)\approx H_{\xi,\mu,\sigma}\left(\frac{x-\mu_n}{\sigma_n}\right)=H_{\xi,\mu_n,\sigma_n}(x)&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;在实际使用中，广义极限分布 &lt;/b&gt;&lt;equation&gt;H&lt;/equation&gt;&lt;b&gt; 的参数&lt;/b&gt; &lt;equation&gt;(ξ, μ, σ)&lt;/equation&gt; &lt;b&gt;可以通过极大似然估计（maximum likelihood estimation）得到。&lt;/b&gt;为了估计这些参数，我们必须有足够多个 &lt;equation&gt;M_n&lt;/equation&gt; 的样本。为此，我们可以将总长为  &lt;equation&gt;T&lt;/equation&gt;  期的历史数据等分成单位长度为  &lt;equation&gt;n&lt;/equation&gt;  的 &lt;equation&gt;m&lt;/equation&gt; 个区间。每个区间中的最大亏损便是 &lt;equation&gt;M_n&lt;/equation&gt; 的一个样本。这样我们就可以得到  &lt;equation&gt;m&lt;/equation&gt;  个样本。这样，便可以根据这些样本得到广义极限分布  &lt;equation&gt;H&lt;/equation&gt;  的参数的估计。Embrechts et. al. (1997) 给出了详细的数学推导。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 阈值外数据建模&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;在风险管理中，风险价值（Value at Risk，VaR）是人们常说的一个概念。&lt;/b&gt;比如，当我们说 1% 的日收益率的 VaR = 6.8%，它的意思是，我们的目标投资品（或者投资组合）在当天有 1% 的概率可能产生&lt;b&gt;超过&lt;/b&gt; 6.8% 的亏损（因此 VaR 的数值是风险的&lt;b&gt;最低值&lt;/b&gt;）。&lt;b&gt;在给定的概率下，VaR 越大，投资品的风险越大。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;然而，如果想计算 VaR 的大小，上一节中对极值分布的模型并无法发挥作用。这是因为&lt;b&gt;在计算 VaR 时，我们必须对亏损分布的右尾进行建模、而不单单是关注某一个极值&lt;/b&gt;（注意，在本文中我们用亏损的绝对值来描述亏损的大小，因此亏损都是正数，所以这里我们是对分布的右尾建模）。为此，我们可以采用&lt;b&gt;广义帕累托分布（Generalized Pareto Distribution）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;和上节一样， &lt;equation&gt;X_i&lt;/equation&gt; 表示某投资品的一系列亏损，并假设它们独立且满足某未知分布 &lt;equation&gt;F&lt;/equation&gt; 。同样的，定义 &lt;equation&gt;M_n = \max(X_1, …, X_n)&lt;/equation&gt; 。假设  &lt;equation&gt;u&lt;/equation&gt;  为某一个给定的亏损阈值。在所有这些 &lt;equation&gt;X_i&lt;/equation&gt; 中，我们感兴趣的是那些大于 &lt;equation&gt;u&lt;/equation&gt; 的样本，即那些亏损超过阈值的样本点，我们希望用它们来对 &lt;equation&gt;X_i&lt;/equation&gt; 分布的右尾进行建模。超过给定阈值的亏损部分，即 &lt;equation&gt;X_i – u&amp;gt; 0&lt;/equation&gt; 的部分，可以由如下条件概率表示：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;F_u(y)=\mbox{Prob}(X-u\le y|X&amp;gt; u)=\frac{F(y+u)-F(u)}{1-F(u)},~~~y&amp;gt;0&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;Embrechts et. al. (1997) 证明，如果亏损 &lt;equation&gt;X_i&lt;/equation&gt; 的极值 &lt;equation&gt;M_n&lt;/equation&gt; 收敛于上节介绍的广义极限分布 &lt;equation&gt;H&lt;/equation&gt; ，那么存在一个 &lt;equation&gt;u&lt;/equation&gt; 的函数 &lt;equation&gt;β(u)&lt;/equation&gt; ，使得 &lt;equation&gt;X_i – u&lt;/equation&gt; 满足如下形式的广义帕累托分布 &lt;equation&gt;G&lt;/equation&gt; ：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;G_{\xi,\beta(u)}(y)=\left\{ \begin{array}{lrl} 1-(1+\xi y/\beta(u))^{-1/\xi}&amp;amp;\mbox{for}&amp;amp;\xi\ne 0\\ 1-\exp\{-y/\beta(u)\}&amp;amp;\mbox{for}&amp;amp;\xi=0 \end{array} \right.,\beta(u)&amp;gt;0&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;在实际应用中，如果我们想对 &lt;/b&gt;&lt;equation&gt;X_i&lt;/equation&gt;&lt;b&gt; 的右尾建模，只需确定阈值 &lt;/b&gt;&lt;equation&gt;u&lt;/equation&gt; &lt;b&gt;。然后在 &lt;/b&gt;&lt;equation&gt;X_i&lt;/equation&gt;&lt;b&gt; 的所有样本中找出所有大于 &lt;/b&gt; &lt;equation&gt;u&lt;/equation&gt; &lt;b&gt; 的样本（注：我们用 &lt;/b&gt;&lt;equation&gt;X_i&lt;/equation&gt;&lt;b&gt; 的绝对值表示亏损的大小，所以亏损在上述数学表达式中是正数），将这些满足的样本各自减去 &lt;/b&gt;&lt;equation&gt;u&lt;/equation&gt;&lt;b&gt; 后得到超过 &lt;/b&gt;&lt;equation&gt;u&lt;/equation&gt;&lt;b&gt; 的部分，然后用这些数据拟合广义帕累托分布 &lt;/b&gt;&lt;equation&gt;G&lt;/equation&gt; &lt;b&gt;，&lt;/b&gt; &lt;equation&gt;G&lt;/equation&gt;&lt;b&gt; 的参数由极大似然估计得到。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;广义帕累托分布 &lt;equation&gt;G&lt;/equation&gt; 的形状随着形状参数 &lt;equation&gt;ξ&lt;/equation&gt; 的不同而不同。特别的，当 &lt;equation&gt;ξ = 0&lt;/equation&gt; 时， &lt;equation&gt;G&lt;/equation&gt; 就化简为指数分布。我们以过去 15 年上证指数日频的负收益率样本为例，取阈值 &lt;equation&gt;u = 2.65\%&lt;/equation&gt;（即考察日收益率亏损超过 2.65% 的尾部分布），得到了 &lt;equation&gt;G&lt;/equation&gt; 的参数。其中形状参数的取值非常接近 0。下图为拟合得到帕累托分布和同比例的指数分布对比超额亏损的直方图的结果。可以看到红色的帕累托分布和绿色的指数分布非常接近。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b28f3962ec9d5bebfff442e0a69c9962_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;601&quot; data-rawheight=&quot;429&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b28f3962ec9d5bebfff442e0a69c9962&quot; data-watermark-src=&quot;v2-c11335b1353b37338ba47eb411a2bf26&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;此外，我们也可以用超额亏损和标准的指数分布放在一起做分位图，得到的结果如下。结果显示分位图近似的满足线性，说明超额亏损的分布和指数分布十分接近。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-170eb02feab1fa76b783ac5cf1f812ee_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;446&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-170eb02feab1fa76b783ac5cf1f812ee&quot; data-watermark-src=&quot;v2-b31bbb8b03adfa57b4554e12c67a9a8c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;利用超额亏损对尾部分布建模后，我们便可以方便的求解风险价值。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 风险价值&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节曾经说过，风险价值描绘的是投资品在某一个指定的概率下亏损程度的阈值。&lt;b&gt;在我们的定义下（即我们用正数来代表亏损的大小），风险价值就是某一给定概率下亏损 &lt;/b&gt;&lt;equation&gt;X_i&lt;/equation&gt;&lt;b&gt; 分布中右尾的某一个分位数。换句话说，只要根据给定的概率求出分位数，它的值就是这个概率对应的风险价值。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;因此，通过广义帕累托分布 &lt;equation&gt;G&lt;/equation&gt; ，我们便可以简单的推导出风险价值的公式。假设 &lt;equation&gt;1 – q&lt;/equation&gt; 代表我们考虑的概率（比如我们想知道 5% 的概率对应的亏损，那么  &lt;equation&gt;1 - q = 0.05&lt;/equation&gt; ），则其对应的风险价值为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\widehat{\mbox{VaR}}_q=\mu+\frac{\hat\beta(u)}{\hat\xi}\left(\left(\frac{n}{k}(1-q)\right)^{-\hat \xi}-1\right)&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;equation&gt;n&lt;/equation&gt;  是亏损样本的总个数，&lt;equation&gt;u&lt;/equation&gt;  是对应的阈值，可以由 &lt;equation&gt;q = F(u)&lt;/equation&gt; 求出。&lt;equation&gt;k&lt;/equation&gt;  是超过  &lt;equation&gt;u&lt;/equation&gt;  的亏损样本的个数。在应用中， &lt;equation&gt;(n-k)/n&lt;/equation&gt; 可以作为对 &lt;equation&gt;F(u)&lt;/equation&gt; 的估计。因此，对于给定的概率 &lt;equation&gt;1 – q&lt;/equation&gt; ，计算风险价值的步骤为：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;根据 &lt;equation&gt;q&lt;/equation&gt; 和 &lt;equation&gt;q = (n-k)/n&lt;/equation&gt; 求出 &lt;equation&gt;k&lt;/equation&gt; ；&lt;/li&gt;&lt;li&gt;根据 &lt;equation&gt;k&lt;/equation&gt; 求出  &lt;equation&gt;u&lt;/equation&gt; ，即在所有亏损的样本中，找到对应的阈值 &lt;equation&gt;u&lt;/equation&gt; ，使得满足 &lt;equation&gt;X_i&lt;/equation&gt; 大于 &lt;equation&gt;u&lt;/equation&gt; 的个数为 &lt;equation&gt;k&lt;/equation&gt; ；&lt;/li&gt;&lt;li&gt;用上一步找到的 &lt;equation&gt;X_i – u&lt;/equation&gt; 建模，得到广义帕累托分布；&lt;/li&gt;&lt;li&gt;将参数带入风险价值的公式中，求出风险价值。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;由于风险价值关注的往往是 5% 甚至 1% 的亏损阈值，它们对应的是亏损分布中非常靠尾部的那些样本，因此只有当 &lt;/b&gt;&lt;equation&gt;n&lt;/equation&gt;&lt;b&gt; 足够大时，我们才可能得到足够多的超额亏损来建模。&lt;/b&gt;可惜的是，在这方面中国 A 股的年份太短了。&lt;/p&gt;&lt;p&gt;即便如此，我们仍然通过下面简单的实验来说明如何计算风险价值。这里我们考虑标普 500 指数（从 1930 年至今）和上证指数（从 2000 年至今）。此外，为了增加样本个数，我们考虑的风险价值对应的概率为 10%，而非极端的 5% 或者 1%。&lt;/p&gt;&lt;p&gt;对于标普 500，我们用每 15 年的数据来滚动建模，得到日收益率在 10% 概率下的风险价值。作为比较，我们用日收益率均值和标准差对应的正态分布同样求出 10% 概率下的风险价值。结果如下图所示。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d8062143c00dcf1d3ae330467ccb1fd8_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;626&quot; data-rawheight=&quot;424&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d8062143c00dcf1d3ae330467ccb1fd8&quot; data-watermark-src=&quot;v2-c9f5669d25a6715e55509489c09696a6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上图说明以下几点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;由于收益率存在明显的肥尾效应，&lt;b&gt;正态分布严重低估了风险价值（绿线持续的在红线之下）&lt;/b&gt;；&lt;/li&gt;&lt;li&gt;在 1929 年股灾之后的有一段时间，风险价值都在高位，这是因为计算的样本中有大量的高亏损样本；&lt;/li&gt;&lt;li&gt;进入 21 世纪以来，风险价值有两次明显的跃升，分别对应着 2000年的 .com 泡沫和 2008 年的次贷危机。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;同样的，我们对上证指数建模。由于数据年份太短，我们用每 10 年的数据来滚动建模。结果如下所示。同样的，正态分布建模严重低估了风险价值。此外，由于上证指数比标普 500 有更加明显的肥尾，因此&lt;b&gt;正态分布对潜在亏损的低估更加显著&lt;/b&gt;。此外，2010 年到 2015 年股灾之前，10% 概率对应的日收益率风险价值并无太大波动；股灾之后，风险价值明显上升。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-00fd449faf29db4d05172b7a71155b65_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;426&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-00fd449faf29db4d05172b7a71155b65&quot; data-watermark-src=&quot;v2-d009dec8978a9638823bf8a25ee6a5c5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我们可以用更短的时间（即更少的样本）对上证指数进行滚动建模。&lt;b&gt;但是样本少一定会带来建模的误差。&lt;/b&gt;下图为我们使用 5 年窗口进行滚动建模的结果。结果表明从 2008 年股灾开始后一直到 2014 年，上证指数的风险都非常大（注意，正态分布建模无法很好的描述风险价值的变化，且存在严重的低估）。在最近两年，随着 2015 年股灾和 2016 年 1 月份熔断引发的二次灾害，风险价值出现了两次迅速的蹿升。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-38a279ef6663eced2f540b04d2fb7606_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;620&quot; data-rawheight=&quot;429&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-38a279ef6663eced2f540b04d2fb7606&quot; data-watermark-src=&quot;v2-37790324e3710e4d68f37481e3326a55&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;做投资时，如何强调风险控制都不过分。然而，做好风控的前提就是能用正确的数学手段对其量化。为了控制风险，有人刻意限制仓位，有人“把鸡蛋放在不同的篮子里”。然而&lt;b&gt;分散投资不完全等价于分散风险。“把鸡蛋放在不同的篮子里”不如“把鸡蛋放在一个篮子里，然后看好这个篮子”&lt;/b&gt;。从这个意义上说，对亏损的正确建模格外重要。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Embrechts, P. C. Kloppelberg, and T. Mikosch (1997). &lt;i&gt;Modelling Extremal Events.&lt;/i&gt;Springer-Verlag, Berlin.&lt;/li&gt;&lt;li&gt;Fisher, R. and L. Tippett (1928). &lt;i&gt;Limiting Forms of the Frequency Distribution of the Largest or Smallest Member of a Sample.&lt;/i&gt; Proceedings of the Cambridge Philosophical Society 24, 180-190.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-08-39288885</guid>
<pubDate>Sun, 08 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>σ 的三要素</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-06-39134993.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/39134993&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-22bcf8a36682d5d67ab961a39b517ddd_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;1 前言&lt;/b&gt;&lt;/p&gt;&lt;p&gt;今天介绍一篇 Barra 的关于风险归因的文章：σ 的三要素（Davis and Menchero 2010）。获得超额收益是主动管理的目标，但在这个过程中，对风险的控制不亚于对收益的追求。在被动投资中，由于仅仅买入市场组合，风险就是市场的系统性风险。在主动管理中，基金经理通过配置得到了不同于市场的投资组合，因此该组合的风险也不同于市场风险。一个优秀的基金经理必须十分清楚其投资组合风险的组成部分。&lt;/p&gt;&lt;p&gt;人们熟知 α 的三要素：α = Volatility × IC × Score。关于主动管理中投资组合的风险（用投资组合收益率的标准差 σ 来衡量），同样存在一个类似的表达式：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\sigma=\mbox{Exposure}\times\mbox{Volatility}\times\mbox{Correlation}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;为了有助于下文的讨论，假设一个基金经理构建了一个主动管理的投资组合 P（该组合由不同的股票以某种权重构成），令 R 代表这个投资组合的收益率。在构建 P 时，基金经理通过将投资组合以特定的风险暴露（exposure）置于不同的收益源（sources of return）之中得到，因此投资组合的收益率 R 可以分解为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;R=\sum_m x_mr_m~~~~~~~~~~(1)\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;x_m&lt;/equation&gt; 是投资组合 P 在收益源 m 上的暴露， &lt;equation&gt;r_m&lt;/equation&gt; 是收益源 m 的收益率。举个例子，假设一个基金经理以 0.3 的暴露买入了银行业的所有股票并以 0.6 的暴露买入了国防军工业的所有股票，以此构建了投资组合。在本例中，银行和国防军工两个行业的收益率就是两个收益源的收益，而 0.3 和 0.6 就是该投资组合在这两个收益源上的暴露，即&lt;/p&gt;&lt;p&gt;&lt;equation&gt;R=0.3r_{\mbox{银行}}+0.6r_{\mbox{国防军工}}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;基于投资组合收益率的分解模型（1），我们下面探讨投资组合的风险 σ(R)。首先来看两个传统的研究方法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 计算 σ(R) 的两种传统方法&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第一种方法是独立考虑每个收益源对投资组合的风险贡献。对于收益源 m，它对投资组合收益率 R 的风险贡献为 &lt;equation&gt;\sigma(x_m r_m)&lt;/equation&gt;，即我们计算收益源收益率 &lt;equation&gt;r_m&lt;/equation&gt; 自身的风险，再把它按比例折算到投资组合收益率的风险中。&lt;b&gt;这种做法虽然直观，但是它没有考虑收益源与投资组合之间的相关性（显然，收益源与投资组合的相关性越高，它对投资组合的风险贡献度越大）。&lt;/b&gt;此外收益源各自独立的风险加在一起不等于投资组合的风险，即&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\sigma(R)\neq\sum_m\sigma(x_mr_m)\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这导致投资组合的风险中无法被收益源的独立风险之和解释。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第二种方法是考虑每种收益源对投资组合风险的&lt;b&gt;边际贡献（marginal contribution）&lt;/b&gt;，它由如下的偏导数定义： &lt;equation&gt;\mbox{MCR}_m=\frac{\partial\sigma(R)}{\partial x_m}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在这种解释下，投资组合对收益源m的风险暴露每增加一个 &lt;equation&gt;\Delta x_m&lt;/equation&gt; 单位，投资组合的风险 σ(R) 便增加 &lt;equation&gt;\mbox{MCR}_m\Delta x_m&lt;/equation&gt;。不难证明，投资组合的风险等于所有收益源的边际风险贡献之和（我们会在下文介绍 σ 的三要素时给出这个式子的推导）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\sigma(R)=\sum_mx_m\mbox{MCR}_m\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;基于边际风险贡献这个方法的最大好处正如上式所示：投资组合的风险可以完全的被边际风险解释。然而，它的缺点是人们很难从业务层面理解偏导数：每个收益源到底对投资组合的风险有多少贡献？这和偏导数又有什么关系？&lt;/b&gt;诸如此类的问题很难直观的回答。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 σ(R) 的三要素&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;由于上述两种传统方法在解释投资组合的风险 σ(R) 都不尽如人意，Davis and Menchero (2010) 提出了投资组合风险的三要素，即 σ = Exposure × Volatility × Correlation。该公式的数学表达为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\sigma(R)=\sum_mx_m\sigma(r_m)\rho(r_m,R)~~~~~~~~~~(2)\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;三要素的解释如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Exposure（暴露）：&lt;/b&gt;即 &lt;equation&gt;x_m&lt;/equation&gt;，它衡量投资组合对每个收益源的暴露大小。这完全由基金经理来决定，充分的反映了基金经理的投资偏好。值得说明的是，投资组合对于收益源的暴露值没有任何符号上的限制，即它既可以为正也可以为负。优秀的基金经理会通过对特定收益源采取负的暴露来对冲投资组合在其他收益源上的风险，从而降低投资组合整体的风险。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Volatility（波动性）：&lt;/b&gt;即 &lt;equation&gt;σ(r_m)&lt;/equation&gt;，它代表的是收益源收益率 &lt;equation&gt;r_m&lt;/equation&gt; 的波动。由于投资组合是暴露在不同的收益源之中，那么收益源收益率的波动越大，显然投资组合的风险的贡献程度（可以是正向也可以是负向，取决于 Exposure 的符号）也越大。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Correlation（相关性）：&lt;/b&gt;即 &lt;equation&gt;ρ(r_m, R)&lt;/equation&gt;，它是收益源和投资组合收益率之间的相关系数，衡量收益源和投资组合收益率的相关性大小。这种相关性越高，投资组合收益率受收益源收益率波动影响的确定性越显著。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;由上述说明可知，风险三要素公式（2）的含义是：&lt;b&gt;如果收益源收益率和投资组合收益率的相关性越高、收益源收益率自身的波动越大、投资组合在该收益源上的暴露越大，那么该收益源对投资组合的风险的贡献就越高。此外，投资组合的风险 σ(R) 可以完全被所有收益源的风险 &lt;/b&gt;&lt;equation&gt;σ(r_m)&lt;/equation&gt;&lt;b&gt; 按上式分解。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;风险三要素公式的正确性由下面的证明给出。&lt;/b&gt;通过对（1）等式两边和投资组合收益率 R 计算协方差可以得到（2）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rrrrll} &amp;amp;\mbox{cov}(R,R)&amp;amp;=&amp;amp;\mbox{var}(R)&amp;amp;=&amp;amp;\displaystyle\sum_m\mbox{cov}(x_mr_m,R)\\ &amp;amp;&amp;amp;&amp;amp;&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\mbox{cov}(r_m,R)\\\\ \Rightarrow&amp;amp;&amp;amp;&amp;amp;\sigma(R)\sigma(R)&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\sigma(R)\sigma(r_m)\rho(r_m,R)\\\\ \Rightarrow&amp;amp;&amp;amp;&amp;amp;\sigma(R)&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\sigma(r_m)\rho(r_m,R) \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上面的推导中仅仅用到了协方差公式的定义，以及协方差和相关系数之间的关系。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 三要素优于传统解释&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;在解释投资组合的风险时，三要素公式较第二节中的两种传统解释有明显的优势。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第一种方法将收益源与投资组合隔绝开来，不考虑收益源与投资组合的相关性，也不考虑收益源之间的相关性，无法正确的解释收益源对 σ(R) 的贡献。&lt;/p&gt;&lt;p&gt;另一方面，对比第二种方法中 σ(R) 的计算公式以及三要素公式（2）易知 &lt;equation&gt;\mbox{MCR}_m = σ(r_m)ρ(r_m, R)&lt;/equation&gt; 。这可以由如下推导验证：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} \mbox{var}(R)&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\mbox{cov}(r_m,R)\\ &amp;amp;=&amp;amp;\displaystyle\sum_mx_m\mbox{cov}\left(r_m,\sum_nx_nr_n\right)\\\\ &amp;amp;=&amp;amp;\displaystyle\sum_n\sum_mx_nx_m\mbox{cov}(r_m,r_n) \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;两边同时对 &lt;equation&gt;x_m&lt;/equation&gt; 求偏导数并利用链式法则以及协方差公式的定义有：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rrll} &amp;amp;\displaystyle2\sigma(R)\frac{\partial\sigma(R)}{\partial x_m}&amp;amp;=&amp;amp;\displaystyle2\sum_nx_n\mbox{cov}(r_m,r_n)\\ \Rightarrow&amp;amp;\displaystyle\sigma(R)\frac{\partial\sigma(R)}{\partial x_m}&amp;amp;=&amp;amp;\displaystyle\sum_nx_n\mbox{cov}(r_m,r_n)\\ \Rightarrow&amp;amp;\displaystyle\sigma(R)\frac{\partial\sigma(R)}{\partial x_m}&amp;amp;=&amp;amp;\displaystyle\mbox{cov}\left(r_m,\sum_nx_nr_n\right)\\ \Rightarrow&amp;amp;\displaystyle\sigma(R)\frac{\partial\sigma(R)}{\partial x_m}&amp;amp;=&amp;amp;\displaystyle\mbox{cov}(r_m,R)\\ \Rightarrow&amp;amp;\displaystyle\sigma(R)\frac{\partial\sigma(R)}{\partial x_m}&amp;amp;=&amp;amp;\displaystyle\sigma(R)\sigma(r_m)\rho(r_m,R)\\ \Rightarrow&amp;amp;\displaystyle\frac{\partial\sigma(R)}{\partial x_m}&amp;amp;=&amp;amp;\displaystyle\sigma(r_m)\rho(r_m,R)\\ \Rightarrow&amp;amp;\displaystyle\mbox{MCR}_m&amp;amp;=&amp;amp;\displaystyle\sigma(r_m)\rho(r_m,R) \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;可见，&lt;b&gt;收益源 m 的边际风险贡献 &lt;/b&gt; &lt;equation&gt;\mbox{MCR}_m&lt;/equation&gt; &lt;b&gt;等于其自身的波动 &lt;/b&gt;&lt;equation&gt;σ(r_m)&lt;/equation&gt;&lt;b&gt; 乘以它和投资组合收益率的相关系数 &lt;/b&gt;&lt;equation&gt;ρ(r_m, R)&lt;/equation&gt; &lt;b&gt;。&lt;/b&gt;显然，比起偏导数的解释，&lt;equation&gt;σ(r_m)&lt;/equation&gt; 与 &lt;equation&gt;ρ(r_m, R)&lt;/equation&gt; 乘积的解释要更加清晰。此外，这种对 &lt;equation&gt;\mbox{MCR}_m&lt;/equation&gt; 的分解可以为基金经理提供更好的判断。&lt;/p&gt;&lt;p&gt;举个例子，假设两个收益源的边际风险贡献都是 1%（且投资组合对这两个收益源的暴露相同）。基于 MCR 的解释方法无法区分它们。进一步假设第一个收益源自身的波动为 10%，它与投资组合的相关系数为 0.1（10% × 0.1 = 1%）；第二个收益源自身的波动为 2%，它与投资组合的相关系数为 0.5（2% × 0.5 = 1%）。 &lt;equation&gt;\mbox{MCR}_m = \sigma(r_m)\rho(r_m, R)&lt;/equation&gt; 说明，虽然  &lt;equation&gt;\mbox{MCR}_m&lt;/equation&gt; 相同，但是收益源 1 自身有更大的波动。这虽然并不意味着收益源 1 更加危险（因为这两个收益源的边际风险贡献相同），但是不要忘记，所有的这些参数都是根据历史数据估计得到的。&lt;b&gt;由于收益率自身的波动比收益率之间的协方差更容易估计，因此收益源 1 对投资组合的风险的影响很有可能比收益源 2 更大。此外，如果基金经理想要排除他的投资组合对这两个收益源中某一个的暴露，那么仅仅依靠 &lt;/b&gt;&lt;equation&gt;\mbox{MCR}_m&lt;/equation&gt;&lt;b&gt;是不够的，&lt;/b&gt; &lt;equation&gt;σ(r_m)&lt;/equation&gt;&lt;b&gt; 与 &lt;/b&gt;&lt;equation&gt;ρ(r_m, R)&lt;/equation&gt;&lt;b&gt; 显然为他提供了更多的依据。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 全新视角：从风险角度看收益相关性&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;风险三要素公式说明，收益源和投资组合的相关性对风险贡献至关重要。收益源和投资组合的相关性又和收益源之间的相关性有着千丝万缕的联系。&lt;/b&gt;通常情况下，用来构建投资组合的收益源之间或多或少存在相关性（可以是正相关也可以是负相关）。比如，如果银行行业和低 &lt;equation&gt;β&lt;/equation&gt; 是两个收益源，那么它们之间显然存在一定的正相关性。两个收益源 m 和 n 的收益率之间的相关性可以由它们的相关系数 &lt;equation&gt;ρ(r_m, r_n)&lt;/equation&gt; 表示。风险三素公式为解读 &lt;equation&gt;ρ(r_m, R)&lt;/equation&gt; 和 &lt;equation&gt;ρ(r_m, r_n)&lt;/equation&gt; 的关系提供了全新的思路。首先给出数学推导： &lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rrll} &amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle\frac{\mbox{cov}(r_m,R)}{\sigma(r_m)\sigma(R)}\\ \Rightarrow&amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle\frac{\mbox{cov}\left(r_m,\sum_n x_n r_n\right)}{\sigma(r_m)\sigma(R)}\\ \Rightarrow&amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle\sum_nx_n\frac{\mbox{cov}(r_m,r_n)}{\sigma(r_m)\sigma(R)}\\ \Rightarrow&amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle\sum_nx_n\frac{\sigma(r_n)\mbox{cov}(r_m,r_n)}{\sigma(r_n)\sigma(r_m)\sigma(R)}\\ \Rightarrow&amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle\sum_nx_n\frac{\sigma(r_n)}{\sigma(R)}\frac{\mbox{cov}(r_m,r_n)}{\sigma(r_n)\sigma(r_m)}\\ \Rightarrow&amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle\sum_nx_n\left[\frac{\sigma(r_n)}{\sigma(R)}\right]\rho(r_m,r_n) \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;此公式说明&lt;b&gt;任何一个收益源 m 和投资组合的相关性 &lt;/b&gt;&lt;equation&gt;ρ(r_m, R)&lt;/equation&gt;&lt;b&gt; 相当于 &lt;/b&gt;&lt;equation&gt;r_m&lt;/equation&gt;&lt;b&gt; 与所有收益源 &lt;/b&gt;&lt;equation&gt;r_n&lt;/equation&gt;&lt;b&gt; 的相关性 &lt;/b&gt;&lt;equation&gt;ρ(r_m, r_n)&lt;/equation&gt;&lt;b&gt; 以权重 &lt;/b&gt;&lt;equation&gt;x_n(σ(r_n)/σ(R))&lt;/equation&gt;&lt;b&gt; 的加和。&lt;/b&gt;收益源 n 对 &lt;equation&gt;ρ(r_m, r_n)&lt;/equation&gt; 的贡献度取决于投资组合对收益源 n 的暴露程度 &lt;equation&gt;x_n&lt;/equation&gt;，收益源 n 对于投资组合的相对波动率 &lt;equation&gt;σ(r_n)/ σ(R)&lt;/equation&gt;，以及收益源 n 与 m 之间的相关性 &lt;equation&gt;ρ(r_m, r_n)&lt;/equation&gt; 。&lt;b&gt;只有当&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;equation&gt;x_n&lt;/equation&gt;&lt;b&gt; 足够大；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;equation&gt;r_n&lt;/equation&gt;&lt;b&gt; 的波动与 R 的波动有可比性；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;equation&gt;r_n&lt;/equation&gt;&lt;b&gt; 与 &lt;/b&gt;&lt;equation&gt;r_m&lt;/equation&gt;&lt;b&gt; 足够相关&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;三个条件同时满足时，收益源 n 才足以影响到收益源 m 与投资组合的相关性。通过比较不同收益源的 &lt;/b&gt;&lt;equation&gt;x_n(σ(r_n)/σ(R))ρ(r_m, r_n)&lt;/equation&gt;&lt;b&gt;，就可以方便的判断哪个收益源 n 对 &lt;/b&gt;&lt;equation&gt;ρ(r_m, R)&lt;/equation&gt;&lt;b&gt; 贡献最大。&lt;/b&gt;这可以为基金经理控制投资组合的风险提供新的思路。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在理想情况下，&lt;/b&gt;如果投资组合的收益可以完全被若干个收益源解释，且&lt;b&gt;这些收益源之间都是无关的（uncorrelated），&lt;/b&gt;即对于不同 m 和 n 有 &lt;equation&gt;ρ(r_m, r_n) = 0&lt;/equation&gt; ，在这种情况下（并且由定义有 &lt;equation&gt;ρ(r_m, r_m) = 1&lt;/equation&gt; ），上式简化为 &lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rrll} &amp;amp;\rho(r_m,R)&amp;amp;=&amp;amp;\displaystyle x_m\frac{\sigma(r_m)}{\sigma(R)}\\ \Rightarrow&amp;amp;\sigma(R)&amp;amp;=&amp;amp;\displaystyle\frac{x_m\sigma(r_m)}{\rho(r_m,R)}~~~~~~~~~~\forall m \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;乍一看，这似乎与三要素公式（2）矛盾（因为（2）里面用到所有收益源的求和，且 &lt;equation&gt;ρ(r_m, R)&lt;/equation&gt; 不是分母）。但简单的计算加上运用最小二乘法回归的性质不难验证&lt;b&gt;上式与（2）是完全一致的&lt;/b&gt;。将上式两边同时乘以 ρ(r_m, R) 的平方得到：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\sigma(R)\rho(r_m,R)^2=x_m\sigma(r_m)\rho(r_m,R)~~~~~~~~~~\forall m\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式对所有收益源 m 都成立。将对应所有收益源 m 的上式相加，经过简单的推导便可以得到风险三要素公式（2）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rrll} &amp;amp;\sum_m\sigma(R)\rho(r_m,R)^2&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\sigma(r_m)\rho(r_m,R)\\ \Rightarrow&amp;amp;\displaystyle\left(\sum_m\rho(r_m,R)^2\right)\sigma(R)&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\sigma(r_m)\rho(r_m,R)\\ \Rightarrow&amp;amp;\displaystyle 1\times\sigma(R)&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\sigma(r_m)\rho(r_m,R)\\ \Rightarrow&amp;amp;\displaystyle\sigma(R)&amp;amp;=&amp;amp;\displaystyle\sum_mx_m\sigma(r_m)\rho(r_m,R) \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在上面的推导中， &lt;equation&gt;\sum_m ρ(r_m, R)^2 = 1&lt;/equation&gt; 是利用到了多元线性回归中 coefficient of determination（就是我们回归中常说的 R-squared）的性质。由于我们假设投资组合的收益率完全由这些收益源解释，因此 R-squared = 1；又因为我们假设了所有的收益源都是不相关的，即 &lt;equation&gt;ρ(r_m, r_n) = 0&lt;/equation&gt; ，在这种情况下 R-squared 等于投资组合收益率与每一个风险源收益率的相关系数的平方和。因此有  &lt;equation&gt;1 = \mbox{R-squared} = \sum_m \rho(r_m, R)^2&lt;/equation&gt; 。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 三要素公式在风险多因子模型中的应用&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在一个风险多因子模型中，个股的收益率（刨除无风险收益率后） &lt;equation&gt;r_n&lt;/equation&gt; 往往被写成若干个风险因子的收益率和其自身的特异性收益率的组合（&lt;b&gt;这些风险因子和股票的特异性便对应上文中的收益源&lt;/b&gt;）： &lt;/p&gt;&lt;p&gt;&lt;equation&gt;r_n=\sum_k X_{nk}f_k+u_n\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;X_{nk}&lt;/equation&gt; 是股票 n 在因子 k 上的暴露， &lt;equation&gt;f_k&lt;/equation&gt; 是因子收益率， &lt;equation&gt;u_n&lt;/equation&gt; 是股票 n 的特异性收益率。所有股票相对无风险的超额收益都可以用上式表示。如果按照一定的权重 &lt;equation&gt;w_n&lt;/equation&gt; 将股票组合成一个投资组合，那么该投资组合的收益率也可以由这些风险因子收益率和所有股票的特异性收益率表示： &lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} R&amp;amp;=&amp;amp;\displaystyle\sum_k\left(\sum_n w_nX_{nk}\right)f_k+\sum_n w_nu_n\\\\ &amp;amp;=&amp;amp;\displaystyle\sum_k X_kf_k+\sum_nw_nu_n \end{array}\\&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;对上式直接运用风险三要素公式便可方便的求出投资组合的风险的组成：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-02308dfc622ac78b2cc04d30721e542f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;481&quot; data-rawheight=&quot;133&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-02308dfc622ac78b2cc04d30721e542f&quot; data-watermark-src=&quot;v2-10c3f73ee05cc755ca483b6dfc39a9b5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;投资组合的风险由因子模型的系统性风险和个股特异性风险两部分组成。&lt;/b&gt;个股特异性风险源于个股的特异性收益 &lt;equation&gt;u_n&lt;/equation&gt; ，它是风险因子无法解释的那部分收益。&lt;b&gt;使用风险多因子模型时，为了正确计算投资组合的风险，上面两个组成部分均要考虑。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Davis, B. and Menchero, J. (2010). &lt;i&gt;Risk Contribution is Exposure times Volatility times Correlation. Technical Report. &lt;/i&gt;MSCI Barra Research.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-06-39134993</guid>
<pubDate>Fri, 06 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Barra 因子模型中的风险调整</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-03-38895499.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38895499&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-722ff3aac0b559afc2aacbd5a02e0d2c_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;除了 Newey-West 调整，Barra 模型中同时还使用了 Eigenfactor 风险调整和贝叶斯收缩来进一步提高协方差矩阵的估计。本文介绍这两种技巧。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一期文章讲了 Barra 对协方差矩阵的 Newey-West 调整（&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38506157&quot;&gt;链接&lt;/a&gt;），本文趁热打铁，再简单介绍一下 Barra 对风险的另外两处调整，它们都是 Barra 模型中的核心组成部分。&lt;/p&gt;&lt;p&gt;在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38280638&quot;&gt;《正确理解 Barra 的纯因子模型》&lt;/a&gt;中曾经提到，Barra 的纯因子模型没有什么可投资性，但是它仍然有两个重要的作用：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;由于每个因子组合都仅仅专注于单一因子，因此它有利于评估每个因子自身的表现；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;有助于计算个股收益率的协方差矩阵，这对于优化投资组合及风险控制很有帮助。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;通过多因子模型，股票的超额收益被分解为被因子解释的部分以及各自的特异性收益率：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf{r} = \mathbf{Xf}+\mathbf{u}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在上式中， &lt;equation&gt;\bf r&lt;/equation&gt; 为 N × 1 维个股收益率向量（省略了时间下标，假设有 N 支股票）、 &lt;equation&gt;\bf X&lt;/equation&gt; 为当期因子暴露矩阵（N × K 矩阵，K 为因子个数）， &lt;equation&gt;\bf f&lt;/equation&gt;为 K × 1 维因子收益率向量， &lt;equation&gt;\bf u&lt;/equation&gt; 为 N × 1 维个股特异性收益率向量。通过因子模型可知，个股收益率的协方差满足如下关系：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf{V} = \mathbf{X V_f X&#39;}+\mathbf{\Delta}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;equation&gt;\bf V&lt;/equation&gt;（N × N）是股票收益率的协方差矩阵， &lt;equation&gt;\mathbf{V}_f&lt;/equation&gt;（K × K）是因子收益率的协方差矩阵，而 &lt;equation&gt;\bf \Delta&lt;/equation&gt; 为 N × N 对角阵，其对角线上的元素对应个股的特异性收益率的方差。 为了得到 &lt;b&gt;V&lt;/b&gt; 的准确估计，对于 &lt;equation&gt;\mathbf{V}_f&lt;/equation&gt; 和 &lt;equation&gt;\bf\Delta&lt;/equation&gt; 的求解至关重要。在上一期&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38506157&quot;&gt;《协方差矩阵的 Newey-West 调整》&lt;/a&gt;中，我们指出为了得到更准确的估计，Barra 对 &lt;equation&gt;\mathbf{V}_f&lt;/equation&gt; 和 &lt;equation&gt;\bf\Delta&lt;/equation&gt; 都进行了 Newey-West 调整。&lt;/p&gt;&lt;p&gt;然而，Barra 对风险调整的脚步并没有止步于此。在 Newey-West 调整之后，它们对因子收益率的协方差矩阵 &lt;equation&gt;\mathbf{V}_f&lt;/equation&gt; 进行了 &lt;b&gt;Eigenfactor risk adjustment&lt;/b&gt;，并对个股的特异性收益率方差矩阵 &lt;equation&gt;\bf\Delta&lt;/equation&gt; 进行了&lt;b&gt;Bayesian shrinkage&lt;/b&gt;（贝叶斯收缩）。本文就来对它们分别做简要介绍。&lt;/p&gt;&lt;p&gt;在此之前，先让我们了解另外一个概念：&lt;b&gt;Bias statistic（偏差统计量）&lt;/b&gt;，这是因为本文关注的两种调整都是以降低 Bias statistic 为目标的。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 偏差统计量&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Bias statistic 是评估风险模型准确性的一个常用指标（Menchero et al. 2011），&lt;b&gt;它用来衡量风险预测值和风险实际值（用已实现波动率来评估）之间的误差&lt;/b&gt;。如果这二者之间有显著误差，则我们说这个风险预测是有偏的，故这个统计量称为偏差统计量。&lt;/p&gt;&lt;p&gt;在数学上，偏差统计量的定义如下。令 &lt;equation&gt;R_{nt}&lt;/equation&gt; 为某投资组合 n 在 t 期的收益率， &lt;equation&gt;σ_{nt}&lt;/equation&gt; 是 t 期&lt;b&gt;期初（beginning-of-period）&lt;/b&gt;的预测风险。用 &lt;equation&gt;σ_{nt}&lt;/equation&gt; 对 &lt;equation&gt;R_{nt}&lt;/equation&gt; 进行标准化得到：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;b_{nt}=\displaystyle\frac{R_{nt}}{\sigma_{nt}}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;上面这个标准化在数学上的含义是将&lt;/b&gt; &lt;equation&gt;R_{nt}&lt;/equation&gt; &lt;b&gt;的波动率 —— 实际的已实现波动率 —— 使用期初预测的波动率&lt;/b&gt; &lt;equation&gt;σ_{nt}&lt;/equation&gt; &lt;b&gt;进行标准化。如果期初风险预测是准确的，那么&lt;/b&gt; &lt;equation&gt;b_{nt}&lt;/equation&gt; &lt;b&gt;的标准差应该为 1。&lt;/b&gt;利用总共 T 期的 &lt;equation&gt;b_{nt}&lt;/equation&gt; 计算样本标准差就得到 Barra 定义的偏差统计量 &lt;equation&gt;B_n&lt;/equation&gt; ：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle B_n=\sqrt{\frac{1}{T-1}\sum_{t=1}^T\left(b_{nt}-\bar b_n\right)^2}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在收益率符合正态分布的假设下， &lt;equation&gt;B_n&lt;/equation&gt; 的 95% 的置信区间为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;B_n\in [1-\sqrt{2/T},1+\sqrt{2/T}]&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;可见，当样本个数足够大（即 T 足够大）的时候，偏差统计量 &lt;equation&gt;B_n&lt;/equation&gt; 应该离 1 不远。&lt;b&gt;如果它离 1 不远则说明我们在期初的风险预测值比较准确，反之则意味着期初的风险预测值是有偏的，这时就需要修正。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;在上面的使用中，一个比较强的假设是收益率满足正态分布。&lt;/b&gt;当背离这条假设时， &lt;equation&gt;B_n&lt;/equation&gt; 很有可能远离 1 而这却并不意味着风险的预测是有偏的。在这方面，Barra 的 USE4 research note （Menchero et al. 2011）里面有更多的讨论。在本文的最后，我们简单评论一下这个正态分布假设。&lt;/p&gt;&lt;p&gt;好了，现在我们清楚了偏差统计量，马上来看对协方差矩阵的 eigenfactor 风险调整。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 协方差矩阵的 Eigenfactor 风险调整&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Barra 的 USE4 模型中，在对因子收益率协方差矩阵进行 Newey-West 调整之后，又进行了 Eigenfactor 调整。关于这个调整介绍的最详细的文献是 Menchero, Wang, and Orr (2011)，这篇文章比 USE4 模型文档中的介绍要更完整，我们就从它讲起。本节的介绍偏重于解释 Eigenfactor 调整的业务意义，会涉及少量必要的数学推导，但是不会详述所有的技术细节。&lt;/p&gt;&lt;p&gt;这里请暂时忘记因子，因为上面这篇文章的研究的对象是个股超额收益的的协方差矩阵。超额收益是相对市场而言的，定义如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;f_{nt}=r_{nt}-R_t^M&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式中，  &lt;equation&gt;r_{nt}&lt;/equation&gt;  是股票 n 在交易日 t 的收益， &lt;equation&gt;R_t^M&lt;/equation&gt; 是该日的市场收益， &lt;equation&gt;f_{nt}&lt;/equation&gt; 是股票在 t 的超额收益。使用不同股票的超额收益序列，就能计算出样本协方差矩阵：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf{V}_0(mn)=\displaystyle\frac{1}{T-1}\sum_{t=1}^T(f_{mt}-\bar f_{mt})(f_{nt}-\bar f_{nt})&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;这里 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; 是协方差矩阵，而  &lt;equation&gt;\mathbf{V}_0(mn)&lt;/equation&gt; 代表这个矩阵中对应的股票 m 和 n 之间的协方差。 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; 是样本协方差矩阵，它只是未知总体的估计，&lt;b&gt;它是无偏估计吗？是否会在某些特定使用方法下有很大的偏差？&lt;/b&gt;这就是 Barra 关心的。为此采用第二节提到的 Bias statistic 来评估它是否是无偏的。&lt;/p&gt;&lt;p&gt;他们首先检查了&lt;b&gt;个股&lt;/b&gt;和&lt;b&gt;随机选择个股权重而构建的投资组合&lt;/b&gt;，发现在这两种情况下，Bias statistic 都离 1 不远 —— very nice。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5e7849b692bc5d10b36f82e5cc9d72c4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;633&quot; data-rawheight=&quot;345&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5e7849b692bc5d10b36f82e5cc9d72c4&quot; data-watermark-src=&quot;v2-5ad132b8411b5abd6d3af0e1d5d28942&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;然而在现实中，我们并不是随机的投资个股，所以上面的结论虽然不错但可惜是不够的。&lt;b&gt;现实中我们通常以某种目标来优化投资组合、确定股票在组合中的权重；&lt;/b&gt;比如使用马科维茨 mean-variance optimization 框架得到的最优组合。对于这些最优化得到的投资组合，它们的 Bias statistic 怎样呢？&lt;/p&gt;&lt;p&gt;为了回答这个问题，Eigenfactor 闪亮登场。&lt;/p&gt;&lt;p&gt;假设样本协方差矩阵 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; 是满秩的。使用它的所有特征向量构建一个矩阵 &lt;equation&gt;\mathbf{U}_0&lt;/equation&gt; —— 这个矩阵的每一列就是 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; 的一个特征向量。利用线性代数的性质，我们可以用 &lt;equation&gt;\mathbf{U}_0&lt;/equation&gt; 把 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; “旋转”一下，变成一个对角阵：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\mathbf{D}_0=\mathbf{U}_0^{-1}\mathbf{V}_0\mathbf{U}_0&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;这个 &lt;equation&gt;\mathbf{D}_0&lt;/equation&gt; 是个对角阵，它对角线上的元素为和那些特征向量对应的特征值。这其实是对 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; 进行特征分解。这个变换的业务含义是什么呢？假设一共有 N 个股票，则每一个特征向量都是一个 N × 1 的向量，它里面第 n 个数就代表这第 n 支股票的权重。以该特征向量中的数值作为权重就得到了一个 eigenfactor portfolio（eigenfactor 一词是 Barra 发明的，因为来自特征向量 eigenvector）。&lt;/p&gt;&lt;p&gt;由于一共有 N 个特征向量，所以有 N 个 eigenfactor portfolios。更重要的是，这些投资组合之间相互独立，协方差为 0，这在数学上体现在 &lt;equation&gt;\mathbf{D}_0&lt;/equation&gt; 是个对角阵。前面刚说过，它对角线上的元素是 &lt;equation&gt;\mathbf{V}_0&lt;/equation&gt; 的特征值，而它们也是这些 eigenfactor portfolios 的方差。&lt;/p&gt;&lt;p&gt;&lt;b&gt;那么这些 eigenfactor portfolios 的 Bias statistics 如何呢？是否接近 1 呢？很不幸，答案是否定的。&lt;/b&gt;下图是按照 eigenfactor portfolios 的样本方差从小到大顺序将这些组合排列（横坐标），然后查看它们的 Bias statistics（纵坐标）。可见，这二者基本成反比 —— 当 eigenfactor 组合的样本方差小时，它的 Bias statistics 非常大，说明估计值非常不准。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-da608ea2f3ecb603ada98b015f84b8fd_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;538&quot; data-rawheight=&quot;479&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-da608ea2f3ecb603ada98b015f84b8fd&quot; data-watermark-src=&quot;v2-bf76b34b26bf28f492b9654b6676889d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;即便如此我们仍然会问 —— 这 eigenfactor portfolios 在实际中有含义吗？如果我们不按照特征向量中的权重来构建投资组合，那么即便它们的 Bias statistics 偏离 1 对我们也没有影响。不幸的是，它们有含义！这就是 Barra 考虑 eigenfactor 调整的原因。以下是 Barra 的原文：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Eigenfactors are not economically intuitive. However,&lt;/i&gt; &lt;i&gt;&lt;b&gt;they do play an important role in portfolio optimization. &lt;/b&gt;For instance, the first eigenfactor solves for the minimum variance portfolio subject to the constraint that the sum of squared weights adds up to 1. Similarly, the last eigenfactor solves the corresponding maximum variance problem.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;它的意思是&lt;b&gt;这些 eigenfactor portfolios 在投资组合的最优化构建中有很大的意义。&lt;/b&gt;比如，方差最小的 eigenfactor 组合就等价于我们以最小化组合方差为优化目标构建的组合（这句话逻辑真完美……）；方差最大的 eigenfactor 组合就等价于我们以最大化方差为优化目标（不确定是否有人这么干……）而构建的投资组合。&lt;/p&gt;&lt;p&gt;在 Barra 看来，这些 eigenfactor portfolios 和我们最终使用这些个股、以某种最优化目标来构建的最优投资组合有着千丝万缕的联系。因此，如果这些 eigenfactor portfolios 的 Bias statistics 很差，那么我们可以预期，以某种目标最优化得到的投资组合的 Bias statistics 也好不到哪去（下图是 Barra 给的模拟产生的最优化组合的 Bias statistics 例子，都高达 1.4 以上）。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ba5ec01220bf3651ae61158b1c8cac29_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;508&quot; data-rawheight=&quot;476&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ba5ec01220bf3651ae61158b1c8cac29&quot; data-watermark-src=&quot;v2-00744816e96ba1ec7d2bb072dc088192&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这就是为什么要对协方差矩阵进行 eigenfactor 调整。读到这里，细心的小伙伴可能会说“你上面这都是个股协方差矩阵啊，但是 USE4 里面是因子协方差矩阵”。&lt;/p&gt;&lt;p&gt;下面说 USE4。&lt;/p&gt;&lt;p&gt;对因子协方差矩阵的 eigenfactor 调整的数学方法和上面完全一致。在 Menchero, Wang, and Orr (2011) 这篇文章的数学推导中，Barra 就说了计算样本协方差矩阵的“assets”可以是 factors，大类资产以及个股：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4c5b587c06a73bb2b4cc62f33a21e29f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;624&quot; data-rawheight=&quot;209&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4c5b587c06a73bb2b4cc62f33a21e29f&quot; data-watermark-src=&quot;v2-77f44443b8abfb91c4c6f06c13b2008a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;因此从数学上来说，不管上面是个股协方差矩阵还是因子协方差矩阵，都没问题。从业务上来说呢，同样对因子协方差矩阵做“旋转”。假设有 K 个因子（别忘了，这每一个因子代表着一个由个股构建出来的纯因子投资组合），因此得到 K 个特征向量。&lt;/p&gt;&lt;p&gt;&lt;b&gt;以这些特征向量为权重得到的 eigenfactor portfolios 恰好就是在这 K 个纯因子投资组合之上的某种配置组合（组合的组合）。&lt;/b&gt;这句话本身就足以说明 eigenfactor 风险调整的重要性了。我们分析因子的目的是为了针对这些纯因子组合的风险收益特性进行进一步优化，从而把这些因子组合放在一起，得到一个多因子组合（即让我们最终的投资组合暴露于多个优异的 α 因子中）。然而，上面的分析指出，&lt;b&gt;以纯因子组合为输入经过优化后得到的投资组合，它的风险估计是有偏的&lt;/b&gt;（Bias statistic 显著不为 1，见下图）。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fae100a54306818a5ddc9f0f70cd7a40_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;643&quot; data-rawheight=&quot;421&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fae100a54306818a5ddc9f0f70cd7a40&quot; data-watermark-src=&quot;v2-370c1e7d0234a89945f1f860a286d808&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;因此，对因子的协方差矩阵做 eigenfactor risk 调整也是十分必要的。&lt;/b&gt;这就是 Barra 采取这个调整的原因。下图比较了调整前（左图）后（右图）的 Bias statistics，效果显著：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-23a78bbebd13269c7ff0d09dc1243edf_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;630&quot; data-rawheight=&quot;251&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-23a78bbebd13269c7ff0d09dc1243edf&quot; data-watermark-src=&quot;v2-9582440fd6806010316abe9883c9750c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上面从业务逻辑的角度解释了为什么 Barra 要对因子协方差矩阵进行 eigenfactor risk 调整。在调整的具体的数学细节上面，其思想是 Bootstrap，请阅读 Menchero, Wang, and Orr (2011) 或者是 USE4 模型的文档，这里就不赘述了。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 特异性收益率的风险调整&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节来解释 Barra 对个股特异性收益率的风险调整 —— 贝叶斯收缩。&lt;/p&gt;&lt;p&gt;&lt;b&gt;贝叶斯收缩是一个常见的将先验和后验结合起来的手段；它是先验和后验的线性组合&lt;/b&gt;（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38614373&quot;&gt;《收益率预测的贝叶斯收缩》&lt;/a&gt;）。对（协）方差矩阵进行贝叶斯收缩并不是 Barra 的独创，事实上 Ledoit and Wolf (2003) 就提出了这个思想，并取得了不错的效果。他们的方法也比下面要介绍的 Barra 的收缩方法（主要是在收缩强度系数的选取上）复杂的多，这个咱们以后再说。&lt;/p&gt;&lt;p&gt;来看 Barra 的问题。首先计算出个股的特异性波动率，这是后验。但是，Barra 指出使用&lt;b&gt;样本内数据计算出的特异性波动率在样本外的持续性很差。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下图中，所有股票按照特异性波动率大小分成 10 档（图中第 1 档代表波动率最小；第 10 档代表波动率最大），计算每档的平均 Bias statistic。可以看到，对于波动率小的档，Bias statistic 显著大于 1，说明它低估了样本外这些股票的特异性波动率；而对于波动率大的档，Bias statistic 显著小于 1，说明它高估了这些股票在样本外的特异性波动率。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-557a1ea104600986c1340a435a0b1917_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;752&quot; data-rawheight=&quot;511&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-557a1ea104600986c1340a435a0b1917&quot; data-watermark-src=&quot;v2-270df661375b4662cf6399f3efa55041&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;既然使用样本数据得到的这个后验不准，那就需要使用先验来矫正一下。&lt;/b&gt;先验就是我们认为正确的特异性波动率，所以我们把样本数据计算出来的后验特异性波动率向着先验来靠拢，这就是“收缩”一词的意思，这就是为什么这个技术较贝叶斯收缩。&lt;/p&gt;&lt;p&gt;如何计算先验呢？对于任意给定的个股，Barra 采用&lt;b&gt;一大堆&lt;/b&gt;个股特异性收益的波动率的&lt;b&gt;均值&lt;/b&gt;作为先验。这个“一大堆”是什么呢？Barra 把所有个股按照市值分成十档，然后找到我们目标个股所在的市值那一档，而这一档中的所有股票就是这“一大堆”。&lt;/p&gt;&lt;p&gt;计算这一大堆中所有股票的特异性波动率，取它们的平均。怎么取呢？不是简单的等权，而是按照市值加权的。&lt;b&gt;这个使用和目标股票处在同一市值这一档所有股票（一大堆）按照市值权重计算出来的特异性波动率就是先验。&lt;/b&gt;以 &lt;equation&gt;s_n&lt;/equation&gt; 表示市值档位 &lt;equation&gt;\hat σ_n&lt;/equation&gt;表示 &lt;equation&gt;s_n&lt;/equation&gt; 中股票 n 的特异性收益率， &lt;equation&gt;w_n&lt;/equation&gt; 表示 &lt;equation&gt;s_n&lt;/equation&gt; 中股票 n 的按照其市值计算出来的权重。则这个先验的表达式为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\bar\sigma(s_n)=\displaystyle\sum_{n\in s_n}w_n\hat \sigma_n&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;可见，先验就是把属于 &lt;equation&gt;s_n&lt;/equation&gt; 内的所有股票的特异性波动率按照它们的市值为权重平均起来。&lt;/p&gt;&lt;p&gt;现在先验、后验都有了，最后一步就是把这二者线性组合在一起：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\sigma_n^{SH}=\nu_n\bar \sigma(s_n)+(1-\nu_n)\hat \sigma_n&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式中等式左侧就是收缩后股票 n 的最终特异性波动率，等式右侧的第一项中的 &lt;equation&gt;\nu_n&lt;/equation&gt; 是在收缩时赋予先验的权重（称为收缩强度系数）。如何确定权重呢？&lt;b&gt;它和后验与先验的偏离程度有关。&lt;/b&gt;具体的， &lt;equation&gt;\nu_n&lt;/equation&gt; 的表达式为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle\nu_n=\frac{q|\hat\sigma_n-\bar\sigma(s_n)|}{\displaystyle\sqrt{\frac{1}{N(s_n)}\sum_{j\in s_n}(\hat\sigma_j-\bar\sigma(s_n))^2}+q|\hat\sigma_n-\bar\sigma(s_n)|}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式中，q 是一个经验系数， &lt;equation&gt;N(s_n)&lt;/equation&gt; 是市值档位 &lt;equation&gt;s_n&lt;/equation&gt; 中股票的个数。这个表达式中的分子以及分母中的第二项的 &lt;equation&gt;|\hat σ_n - \bar σ(s_n)|&lt;/equation&gt; 表示了我们股票 n 的后验特异性波动率和其先验之间的偏离程度；而上式分母中的第一项是市值档位 &lt;equation&gt;s_n&lt;/equation&gt; 中所有股票的特异性波动率和其先验偏离程度的标准差，它是这一大堆股票的&lt;b&gt;平均偏离程度&lt;/b&gt;的一个度量。&lt;/p&gt;&lt;p&gt;最终的压缩权重 &lt;equation&gt;\nu_n&lt;/equation&gt; 就由这两个偏离程度（以及经验系数 q）决定：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;equation&gt;|\hat σ_n - \bar σ(s_n)|&lt;/equation&gt; 越大， &lt;equation&gt;\nu_n&lt;/equation&gt; 就越大，而不要忘记 &lt;equation&gt;\nu_n&lt;/equation&gt; 是先验的权重。这就是说，对于目标个股，后验越不靠谱（它的偏离程度和所有小伙伴的平均偏离程度相比更高），我们越不能相信后验，而是越要相信先验，所以 &lt;equation&gt;\nu_n&lt;/equation&gt; 越大。&lt;/li&gt;&lt;li&gt;&lt;equation&gt;|\hat σ_n - \bar σ(s_n)|&lt;/equation&gt; 越小，说明这个目标股票特异性波动率的偏离程度低，我们愿意相信它，所以这时赋予先验的权重 &lt;equation&gt;\nu_n&lt;/equation&gt; 就要小点。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在上面 &lt;equation&gt;\nu_n&lt;/equation&gt; 的表达式中，唯一剩下的就是要确定经验系数 q 了。Barra 没有具体说，但是不难想它一定和 Bias Statistic 有关。贝叶斯收缩的目的就是为了降低个股特异性波动率的 Bias Statistic，所以可以通过综合考虑所有个股特异性波动率收缩前后 Bias statistic 的改进来找到合适的 q 值。&lt;/p&gt;&lt;p&gt;根据 USE4 文档中报告的结果，贝叶斯收缩效果显著改善了各市值档位内个股的特异性波动率（下图）。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6dc8597610f060477b2b77e414a56b7d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;737&quot; data-rawheight=&quot;495&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6dc8597610f060477b2b77e414a56b7d&quot; data-watermark-src=&quot;v2-3e5d2b9a5d7db599e95c12e7ba906cb1&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;以上就是对特异性波动率做的贝叶斯收缩。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文介绍了 Barra 对波动率的两种调整方法，它们都是以改善 Bias statistic 为目标。而第二节曾指出，如果收益率不满足正态分布，那么 Bias statistics 可能也是不准的。&lt;/p&gt;&lt;p&gt;既然存在收益率不满足正态分布这个风险，那么 Barra 仍将上述偏差统计量用于因子收益率协方差矩阵和个股特异性收益率方差的调整中，是否合理呢？先来说说因子收益率。对于每个因子，它的收益率是一揽子股票的加权收益率（权重是从模型中根据截面回归来的），因此它是一个投资组合（纯因子组合）的收益率。比起个股，投资组合的收益率应该更加满足正态分布的假设。再来看看个股的特异性收益率。在市场上流行的因子模型中，对因子解释不了的残差（即特异性收益率）通常做的假设大多是正态分布。所以，从这个意义上说，似乎能理解 Barra 坚持使用上述偏差统计量的原因。&lt;/p&gt;&lt;p&gt;在投资实务中，任何模型都需要假设、模型本身并无好坏。所以我们也不用把 Barra 的处理方法当作唯一的、正确的答案。这仅仅是来自 Barra 的选择 —— 我相信这背后自有它的道理和考量。有的小伙伴给我们留言，告诉我们国内一些券商报告中有很多其他不错的评价协方差矩阵准确性的方法。那些无疑也是值得我们学习和尝试的。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ledoit, O. and M. Wolf (2003). Improved estimation of the covariance matrix of stock returns with an application to portfolio selection. &lt;i&gt;Journal of Empirical Finance&lt;/i&gt;, 10, 603 – 621&lt;/li&gt;&lt;li&gt;Menchero, J., D. J. Orr, and J. Wang (2011). &lt;i&gt;The Barra US Equity Model (USE4).&lt;/i&gt;MSCI Barra Research Notes.&lt;/li&gt;&lt;li&gt;Menchero, J., J. Wang, and D. J. Orr (2011). &lt;i&gt;Eigen-adjusted Covariance Matrices.&lt;/i&gt; MSCI Research Insight.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-03-38895499</guid>
<pubDate>Tue, 03 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>次世代均值回归策略</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-07-02-38821733.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38821733&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1568d9553d093a1cdc1aad49549c46e0_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;1 金融市场的均值回归&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在量化投资领域，&lt;b&gt;均值回归（mean reversion）&lt;/b&gt;代表着一大类策略。金融市场的均值回归定义如下：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;In finance, mean reversion is the assumption that a stock&#39;s&lt;/i&gt; &lt;i&gt;&lt;b&gt;price&lt;/b&gt;&lt;/i&gt; &lt;i&gt;will tend to move to the average price over time.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：在金融领域，均值回归假设随着时间的移动，股票的&lt;b&gt;价格&lt;/b&gt;朝着它的均值移动。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;我们可以把上述定义中的“股票”换成其他任何投资品。这个定义中最核心的两个字是“&lt;b&gt;价格&lt;/b&gt;”（而不是投资品的“收益率”）：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;“价格呈现均值回归”等价于“收益率呈现序列负相关性”。&lt;/b&gt;这是一种非常好的、可以被拿来构建优秀策略的特性。&lt;/li&gt;&lt;li&gt;&lt;b&gt;“收益率呈现均值回归（即收益率围绕 0 随机的上下波动）”等价于“价格呈现随机游走”。&lt;/b&gt;这是投资品最差的一种形态，在这种情况下不存在有效的赚钱策略（运气除外）。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;请暂停一下，花几秒钟体会一下上面这两句话。它们是所有均值回归策略的核心，也是本文的核心。&lt;/p&gt;&lt;p&gt;先锋基金（Vanguard）的创始人 John Bogle 曾教导我们说，在金融市场，均值回归是一条铁律。确实，投资品的价格不可能一直涨或者一直跌，拿出任何一段时间来看，它似乎总是围绕着局部的均值上下往复波动，呈现出围绕着均值的回归运动。&lt;b&gt;但是这种程度的回归对于在统计上构建一个有效的量化策略并没有太多的帮助。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-41611ba160daadf532b59755e212164c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;689&quot; data-rawheight=&quot;208&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-41611ba160daadf532b59755e212164c&quot; data-watermark-src=&quot;v2-f5c0fdb42af34fa81a90940b916d5ab2&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在现实中，为了构建一个均值回归策略，我们要求&lt;b&gt;价格的时间序列满足平稳性&lt;/b&gt;。显然，&lt;b&gt;单一&lt;/b&gt;投资品的价格是很难满足这个假设的。于是量化界的小伙伴们便开动脑筋，终于发现&lt;b&gt;虽然单一投资品的价格不满足均值回归，但是可以把多个投资品（通常是两个）线性组合在一起，使它们的价差满足均值回归。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;找到一对价差满足均值回归的投资品是早期均值回归策略的初衷，因此这类策略又有另外一个广为人知的别名 —— 配对交易（pairs trading）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;配对交易就是当下市场上主流的构建均值回归策略的方法。&lt;/b&gt;它通常利用&lt;b&gt;协整（co-integration）&lt;/b&gt;或者&lt;b&gt;价格距离法&lt;/b&gt;来找到这样一对投资品，并认为它们的价差会在一定的区间内往复运动，然后基于价差的统计特性计算阈值进行交易，因此这种策略通常又叫&lt;b&gt;统计套利（statistical arbitrage）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;在我看来，&lt;b&gt;多品种构建的价差很难满足一价定理、不易回归；针对这类价差的统计套利策略的风险收益比很差。&lt;/b&gt;本文介绍一种新的均值回归思路。不过在此之前，还是让我们先来看看市场上流行的这两种投资品配对方法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 协整&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们都知道收益率序列满足平稳性，而价格序列不满足平稳性。收益率满足平稳性仅仅说明价格呈现随机游走，它对于构建赚钱的投资策略没什么用。我们想要的是价格序列呈现出平稳性。但凡事都有一个例外：&lt;b&gt;虽然单一投资品的价格不满足平稳性，但有时把多个投资品（通常是两个）线性组合在一起构成一个价差序列，该序列满足平稳性。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在数学上，如果多个非平稳的时间序列通过线性组合得到一个平稳的时间序列，则把满足这种关系称为协整（co-integration）。我们在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38755022&quot;&gt;《小心伪回归发现的假关系》&lt;/a&gt;中介绍了协整发生的原因。&lt;/p&gt;&lt;p&gt;对于两个投资品的价格序列，它们的价格都表现出了一定的随机性。&lt;b&gt;如果它们的随机性来自同一个随机过程（共同的因素），则说它们满足协整关系，并可以通过一定的线性组合把这个共同的随机因素剔除掉，而剩下满足平稳性的价差序列。&lt;/b&gt;在数学上，可以使用 ADF test 来检验一个价差序列是否满足平稳性。&lt;/p&gt;&lt;p&gt;EWA 和 EWC 是一对儿满足协整的经典例子。它们分别代表澳大利亚（EWA）和加拿大（EWC）股指的两个 ETFs。由于这两个国家的经济都主要依靠商品，因此可以认为这两个股指的波动来自共同的因子。下图为这两个 ETFs 的价格序列（左图）和回归得到的价差序列（右图）。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fcc36a037b7f8de676eb06986c62f7bf_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;914&quot; data-rawheight=&quot;338&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fcc36a037b7f8de676eb06986c62f7bf&quot; data-watermark-src=&quot;v2-8d80810f3a4ddcac25baf804084eaac3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;对价差进行 ADF 检验，得到的统计值为 -4.09（p-value 为 0.0065），小于显著性 1% 对应的阈值 -3.96，因此在 1% 的显著性水平下拒绝原假设。ADF 检验说明该价差序列满足平稳性，即 EWA 和 EWC 满足协整关系。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 价格距离方法&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;再来看看另一种方法：价格距离法。该方法的主要参考文献是 Gatev et al. (2006)。该文的作者指出，寻找配对的一种方法是看两个投资品标准化后的价格序列是否足够接近 —— &lt;b&gt;即在寻找配对的形成期这两个投资品标准化后的累积价差是否足够小。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;关于为什么采用这种方法找配对，该文作者给出的解释如下：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;We use this approach because it best approximates the description of how traders themselves choose pairs. Interviews with pairs traders suggest that they try to find two stocks whose prices “move together”.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：我们使用这种方法，是因为它最接近交易员们描述的配对方法。对配对交易的交易员的采访表明，他们试图找到两支价格“一起移动”的股票。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;假设形成期的长度为 T，期内的某投资品 i 的价格序列为 &lt;equation&gt;P_{i0}, P_{i1}, \cdots, P_{iT}&lt;/equation&gt; 。在这种方法中，首先以  &lt;equation&gt;P_{i0}&lt;/equation&gt;  为基准将价格序列转化为对数价格（这相当于把 t 时刻的价格转化成 0 到 t 之间的对数收益率），然后再计算 T 期内任意两个投资品 i 和 j 的价格偏差平方和（记为  &lt;equation&gt;D_{ij}&lt;/equation&gt; ）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} s_{it}&amp;amp;=&amp;amp;\ln P_{it}-\ln P_{i0}\\ D_{ij}&amp;amp;=&amp;amp;\displaystyle\sum_{t=1}^T(s_{it}-s_{jt})^2 \end{array}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在没有任何限制的版本中，任意两个投资品（比如两支股票或者两种不同的商品期货）都会被使用这种方法来计算它们之间价格走势的相似程度。在有限制的版本中 —— 或者说是从业务上出于防止过拟合的考虑 —— 上述计算仅仅被应用于同一行业的股票（比如不同的银行）或者同一种类的商品期货（比如农产品或者化工），以杜绝仅仅因为巧合而没有业务逻辑支撑的配对儿（Bianchi et al. 2009）。&lt;/p&gt;&lt;p&gt;当所有潜在的投资品两两计算价格距离之后，距离最小的那些配对儿就被认为是满足价格一起运动，即它们的价差会在未来一段时间内呈现均值回归，因此被用来交易。交易的规则就是经典的统计套利，当价差的取值较历史均值偏离两个标准差时，就进行做多或者做空价差的操作。下图是 Gatev et al. (2006) 给出的一个按上述方法找出的股票配对交易的例子。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3efd4cec3a1d5ded2f56c018c20b45ec_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;736&quot; data-rawheight=&quot;515&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3efd4cec3a1d5ded2f56c018c20b45ec&quot; data-watermark-src=&quot;v2-a4a2ff417342efb470cc626f01f26cb8&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;我们使用国内商品期货数据简单测试过这种配对儿方法。结论是，&lt;b&gt;它在形成期内确实能找到价格走势非常接近的商品配对儿，但是这些商品在交易期内（即相对配对儿来说是样本外）的走势相当不一致。&lt;/b&gt;事实上，我们发现没有任何业务层面的机制来约束它们继续一起移动，因此其价差也就根本不满足均值回归，上述方法在国内市场上的有效性仍然是个大大的问号。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 配对交易的不足&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;均值回归策略的特点是&lt;b&gt;“收益有限、风险无限”&lt;/b&gt;。上述两种使用协整和价格距离构建配对交易的策略在这方面体现的可谓是淋漓尽致。&lt;/p&gt;&lt;p&gt;来看前半句，即便是能找到两个靠谱的投资品，使它们的价差呈现稳定的均值回归特性，基于这个价差的策略的交易次数也会非常少。这是因为只有当价差偏离到一定的程度（比如 2 个标准差之外），策略才可能进行交易，而这种偏离发生的频率非常低。所以，这类策略通常在很长时间内都没有任何交易。&lt;/p&gt;&lt;p&gt;下图是利用 EWA 和 EWC 这两个 ETFs 构建的配对交易。该策略的年化连续收益率为 8.72%，最大回撤 -9.38%。从净值和最大回撤曲线中看出很大的一部分收益来自 2009 年；在 2013 年到 2015 年间，策略发生了长达 758 个自然日的回撤。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-801937af089384f29221642585737e4d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;545&quot; data-rawheight=&quot;359&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-801937af089384f29221642585737e4d&quot; data-watermark-src=&quot;v2-f360a8e1bf0c389b92838de4fa8e59bf&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;再来看看后半句。&lt;b&gt;由于被用来配对的投资品之间很难满足一价定理，所以没有任何金融业务上的核心逻辑来保证价差会一直满足均值回归。&lt;/b&gt;比如 Brent 和 WTI 这两种原油，它们的价格走势应该非常接近。而这二者的价差（下图）在 2011 年之前也确实呈现出稳定的均值回归特性。但是从 2011 年开始风云突变，这两种油的走势就不再一致，它们的价差也几乎没有表现出任何回归的现象。&lt;b&gt;不难想象一个交易该价差的策略在价差突破历史阈值之后不但没有回归、反而持续迅速扩大时的绝望。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f05e860938845537aa7b8421282bc602_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;626&quot; data-rawheight=&quot;359&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f05e860938845537aa7b8421282bc602&quot; data-watermark-src=&quot;v2-9fa1265b10717a14564ef3f2378693cf&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;基于上述原因，大量的实证显示，这类策略的收益风险比较差。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;既然找到多个投资品并构建一个满足均值回归的价差不是特别靠谱，那么有没有更好的办法呢？究其核心，构建一个均值回归策略需要的是找到一个&lt;b&gt;具有负的自相关性的收益率序列&lt;/b&gt;。正是由于投资品的&lt;b&gt;绝对&lt;/b&gt;收益率几乎是随机的（没有统计上显著的负相关性），人们才退而求其用不同的投资品构建能够回归的价差（使价差收益率满足负相关性）。&lt;/p&gt;&lt;p&gt;虽然投资品的绝对收益率几乎是随机的，但是&lt;b&gt;在正确的方法下，投资品的残差收益率是可以用来构建均值回归策略的。&lt;/b&gt;这就是均值回归的新思路。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 因子残差法&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Yeo and Papanicolaou (2017) 提出了针对投资品（这里特指股票）残差收益率的均值回归策略（该研究很大程度上受到了 Avellaneda and Lee 2010 的启发），用几句话来高度概括一下就是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;个股的收益率中有能够被公共因子解释的部分（比如市场因子、盈利因子、规模因子、估值因子等），把这些公共部分刨去之后剩下的就是残差收益率。对所有个股的累积残差收益率做随机分析，找到残差收益率的变化过程中满足均值回归的那些个股，进行交易。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面我们结合上述过程中涉及到的量化模型来对每一步做一个简要介绍。&lt;/p&gt;&lt;p&gt;首先是通过多因子模型来求出个股的残差对数收益率（Yeo and Papanicolaou 2017 使用了统计因子，即认为因子本身是观测不到的，而是从股票的收益率中直接提取的 —— 比如利用主成分分析）。这里使用对数收益率是为了方便之后把残差收益率直接求和得到“残差对数价格”的随机过程（下文略去“对数”二字）。假设 &lt;equation&gt;u_{it}&lt;/equation&gt; 是个股 i 在第 t 期的残差对数收益率，将 0 到 t 期内的残差收益率加起来就得到 t 时刻的累积对数残差价格：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;X_{it}=\sum_{l=1}^t u_{il}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;接下来，对 X_it 使用 &lt;b&gt;Ornstein-Uhlenbeck (OU) 过程&lt;/b&gt;建模。OU 过程由 Leonard Ornstein 和 George Eugene Uhlenbeck 提出，该随机过程满足如下的随机微分方程：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;dX_{it}=\theta_i(\mu_i-X_{it})dt+\sigma_i dW_{it}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;equation&gt;\theta_i&lt;/equation&gt; ， &lt;equation&gt;\mu_i&lt;/equation&gt; ，以及 &lt;equation&gt;\sigma_i&lt;/equation&gt; 分别是针对个股 i 的模型参数， &lt;equation&gt;W_i&lt;/equation&gt; 是布朗运动。和标准的布朗运动相比，这个模型的不同之处在于上式右侧的第一项，其中 &lt;equation&gt;\mu_i&lt;/equation&gt; 表示 &lt;equation&gt;X_{it}&lt;/equation&gt; 的长均值。这一项说明，如果 &lt;equation&gt;X_{it}&lt;/equation&gt; 大于（小于） &lt;equation&gt;\mu_i&lt;/equation&gt; ，那么在下一时刻的增量 &lt;equation&gt;dX_{it}&lt;/equation&gt; 会是负的（正的），从而使 t + 1 时刻的 &lt;equation&gt;X_i&lt;/equation&gt; 倾向于向均值移动，而 &lt;equation&gt;\theta_i&lt;/equation&gt; 则代表像均值移动的速度，因此 &lt;b&gt;OU 过程满足均值回归特性。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;当然，众多个股之中，哪些的残差价格更好的满足 OU 过程需要通过参数估计来确定。为此，Yeo and Papanicolaou (2017) 考虑了三个要求：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;入选个股的 &lt;equation&gt;\theta_i&lt;/equation&gt; 必须足够大，代表着它的残差价格序列的均值回归速度很快。&lt;/li&gt;&lt;li&gt;入选个股的模型参数的误差必须足够小，这才能保证统计上的可靠性，如果估计误差很大，那么参数是不可信的。&lt;/li&gt;&lt;li&gt;必须随时间的变化滚动建模，因为没有任何机制来保证一支个股的残差价格能够一直满足均值回归。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;满足上述条件的个股则脱颖而出，它们将被用来构建最终的投资组合。&lt;/p&gt;&lt;p&gt;在构建投资组合时，最核心的一点是：&lt;b&gt;整个策略针对的都是个股残差价格的均值回归。因此，在投资组合中必须让入选的个股满足市场中性，更精确地说是满足计算残差收益率时使用的风格因子中性。&lt;/b&gt;如果无法保证这一点，即便残差价差回归了，但是因为在个别因子上仍有暴露，导致的股价走势可能仍然和策略的建仓方向（多、空）不同、产生亏损。&lt;/p&gt;&lt;p&gt;具体的，在构建最优投资组合时，Yeo and Papanicolaou (2017) 考虑了如下因素，其中第一个就是因子中性（假设一共有 p 个因子），此外还要求了 dollar 中性（即多空对应的资金量相同），以及总杠杆的限制。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-cbcb109596625caeeae13325b56428c7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;740&quot; data-rawheight=&quot;248&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-cbcb109596625caeeae13325b56428c7&quot; data-watermark-src=&quot;v2-738f9c5ebf8b296abc7bb8795f289605&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上面的最后一条是开仓的方向（多、空）。在计算开仓信号时，Yeo and Papanicolaou (2017) 采用了传统的统计套利的思路，即计算信号 S_it：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;S_{it}=\frac{X_{it}-\mu_i}{\sigma_i}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;当  &lt;equation&gt;S_{it} &amp;gt; 1.25&lt;/equation&gt;  时，做空该个股，之后当 &lt;equation&gt;S_{it}&lt;/equation&gt; 回归到小于 0.5 时平仓；当 &lt;equation&gt;S_{it}&amp;lt;-1.25&lt;/equation&gt; 时，做多该个股，之后当 &lt;equation&gt;S_{it}&lt;/equation&gt; 回归到大于 -0.5 时平仓。&lt;/p&gt;&lt;p&gt;最后来看看效果。下图给出了这个均值回归策略在不同时间段的净值曲线。在 5 basis points 和 10 basis points 的交易成本假设下，该策略在不同的时间段（包括金融危机）均取得了正收益，效果还是很不错的。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-024ca06b3e10ae3e09bf26a2496ebd01_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;669&quot; data-rawheight=&quot;480&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-024ca06b3e10ae3e09bf26a2496ebd01&quot; data-watermark-src=&quot;v2-ac4537e318a9995cf6484e5718317ff5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;看到这里，有的小伙伴也许会问，即便这个思路确实新颖，但是实操起来似乎还有几个问题：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;优异的回测结果是否多少受益于回测期内的 data mining？毕竟这么多数据一通优化，而在现实中没有必然的因素来保证残差价格一定会实现均值回归；&lt;/li&gt;&lt;li&gt;实证中的投资组合同时多、空开仓，而在国内市场做空受限的前提下，这个策略想要原封不动移植到 A 股上几乎不可能。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;不要忙着悲观，也许 Yeo and Papanicolaou (2017) 文中的结果有一定 data mining 的成分，&lt;b&gt;但是残差价格这背后的回归是有合理的解释的 —— 来自行为金融学的解释。&lt;/b&gt;残差收益率的负相关性是由于投资者的过度反应造成的，而从某种意义上说，Yeo and Papanicolaou (2017) 是针对残差收益率的潜在负相关性做了更加精密的定量化分析。&lt;/p&gt;&lt;p&gt;下面就来看看来自行为金融学的例子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 来自行为金融学的实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;早在 1984 年，Richard Thaler（2017 年诺贝尔经济学获得者，以研究行为经济学而闻名）和 Werner De Bondt 写了一篇影响深远的文章，题为“Does the stock market overreact?”（De Bondt and Thaler 1984，被引用近 8300 次）。文中，他们使用&lt;b&gt;股票相对于市场的超额（残差）收益率&lt;/b&gt;构建了一个&lt;b&gt;赢家组合（残差收益率为正）&lt;/b&gt;和一个&lt;b&gt;输家组合（残差收益率为负）&lt;/b&gt;。数据显示，&lt;b&gt;这个输家组合在未来取得了比赢家组合（定期调仓）更高的收益&lt;/b&gt;，如下图所示。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3364e2cdb0531338ada80ee5be168e32_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;693&quot; data-rawheight=&quot;459&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3364e2cdb0531338ada80ee5be168e32&quot; data-watermark-src=&quot;v2-f6b781dbfdebc6f9c0db102e8d8dbb77&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;这个结果说明，残差收益率确实有一定的负相关性，这造成了之前跑输市场的组合在之后跑赢了市场；反之亦然。这就是为什么长期来看，输家组合远远跑赢了赢家组合。&lt;/p&gt;&lt;p&gt;在计算残差收益时，DeBondt and Thaler (1984) 仅仅使用个股的收益率减去市场的收益率，并没有考虑其他因子甚至是个股的 β。&lt;b&gt;造成这种现象的原因正是投资者的过度反应。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这个简单的策略无需使用上一节介绍的那个复杂量化框架，但它利用了同样的实质 —— &lt;b&gt;个股的残差收益率具备负相关性。&lt;/b&gt;在 A 股上，也很容易做简单的验证。以沪深 300 的成分股为例，按照个股相对于沪深 300 指数的残差收益率的 20 日均值从小到大排序分成 5 组、定期调仓，这 5 个投资组合的收益率很好的满足单调性（下图） —— &lt;b&gt;残差收益率均值最低的组合收益最高。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-075058335ffa57db8003678c5283e250_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;780&quot; data-rawheight=&quot;701&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-075058335ffa57db8003678c5283e250&quot; data-watermark-src=&quot;v2-2ea4dff73ad5a661e0e9411af7612160&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上面的结果说明，个股残差收益率在一定程度上确实有负相关性。此外，残差最小的组合也显著跑赢了沪深 300 指数，说明纯多头的策略也是有价值的。所以，即便无法轻易做空个股，Yeo and Papanicolaou (2017) 提出的这个构建均值回归策略的量化思路仍然可以被借鉴。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我曾思考给本文起个什么样的标题。最开始比较满意的是“The Next Generation of 均值回归策略”，因为这个针对投资品残差收益率的策略确实较以往的配对交易大大不同。但是标题里中英混搭感觉怪怪的，因此还是把英文拿掉换成中文，并蹭热点（你懂的）用了个“次世代”。&lt;/p&gt;&lt;p&gt;至少在我看来，Yeo and Papanicolaou (2017) 这个模型没有重新定义“次世代”，也没有重新定义“重新定义”。&lt;/p&gt;&lt;p&gt;&lt;b&gt;一个均值回归策略能否有效取决于它是否能够保证价格时间序列回归的机制。&lt;/b&gt;大量的实证显示，纯粹基于不同投资品的价格数据来找这种回归是不太靠谱的。而行为金融学提供了全新的视角。&lt;b&gt;流水的投资者，铁打的认知偏差。&lt;/b&gt;这些根深蒂固的认知偏差产期存在于市场之中，使得投资品的价格和收益率表现出特定的性质。如果这些行为偏差能够被我们所用，从行为金融学的角度构建均值回归策略也许会大有可为。&lt;/p&gt;&lt;p&gt;&lt;b&gt;以某个显著的市场特性作为切入点，使用最恰当的数学工具，更加精确的实现一个交易目标、并获取优秀的风险收益，这就是量化投资的最大意义。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Avellaneda, M. and J-H. Lee (2010). Statistical arbitrage in the US equities market. &lt;i&gt;Quantitative Finance&lt;/i&gt;, Vol. 10(7), 761 – 782.&lt;/li&gt;&lt;li&gt;Bianchi, R., D. Michael, and R. Zhu (2009). &lt;i&gt;Pairs trading profits in commodity futures markets.&lt;/i&gt; In: Proceedings of Asian Finance Association 2009 International Conference, June 30 – July 3, 2009, Brisbane, Queensland.&lt;/li&gt;&lt;li&gt;De Bondt, W. F. M. and R. Thaler (1984). Does the stock market overreact? &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 40(3), 793 – 805.&lt;/li&gt;&lt;li&gt;Gatev, E., W. N. Goetzmann, and K. G. Rouwenhorst (2006). Pairs trading: performance of a relative-value arbitrage rule. &lt;i&gt;The Review of Financial Studies&lt;/i&gt;, Vol. 19(3), 797 – 827.&lt;/li&gt;&lt;li&gt;Yeo, J. and G. Papanicolaou (2017). Risk control of mean-reversion time in statistical arbitrage. &lt;i&gt;Risk and Decision Analysis&lt;/i&gt;, Vol. 6(4), 263 – 290.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-07-02-38821733</guid>
<pubDate>Mon, 02 Jul 2018 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
