<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>川流不息</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/</link>
<description>分享量化投资技术与实证心得 北京量信投资管理有限公司是一家在中国基金业协会备案登记的专业私募基金管理人。本专栏作者石川是量信投资的联合创始人。希望通过这个平台和各位小伙伴分享我们在量化投资领域的知识和心得。原创不易，请保护版权，请在获得授权后转载。已委托“维权骑士”(http://rightknights.com) 为进行维权行动。</description>
<language>zh-cn</language>
<lastBuildDate>Sun, 03 Feb 2019 22:09:22 +0800</lastBuildDate>
<item>
<title>出色不如走运 (III)？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-02-02-56154663.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56154663&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b67f8e2d7d4b2f70affdcb79a88cba69_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文使用随机因子的实证结果定量说明了仅靠运气就能够达到的选股效果，帮助判断选股因子是否真正有效。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用因子选股的逻辑是因子 —— 无论是来自基本面、量价还是宏观经济等 —— 都对股票未来的收益率有预测性。在定量评价一个因子是否有效时，主要的考察方式之一是计算该因子的收益率是否显著不为零（原假设）。&lt;/p&gt;&lt;p&gt;假设因子的预期收益率和该预期收益率的 standard error 分别为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%5D&quot; alt=&quot;\mbox{E}[f]&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bs.e.%7D%28%5Cmbox%7BE%7D%5Bf%5D%29&quot; alt=&quot;\mbox{s.e.}(\mbox{E}[f])&quot; eeimg=&quot;1&quot;&gt; ，则假设检验的 t-statistic 为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bt-statistic%7D%3D%5Cfrac%7B%5Cmbox%7BE%7D%5Bf%5D%7D%7B%5Cmbox%7Bs.e.%7D%28%5Cmbox%7BE%7D%5Bf%5D%29%7D&quot; alt=&quot;\displaystyle\mbox{t-statistic}=\frac{\mbox{E}[f]}{\mbox{s.e.}(\mbox{E}[f])}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;在进行单因子检验时，一般要求该因子的 t-statistic 大于 2，从而以 5% 的显著性水平拒绝原假设，并认为该因子确实有预测股票收益率的能力。&lt;b&gt;然而，如果同时考虑众多因子（多重检验，multiple testing）并从里面挑出来最好的，由于 data mining 的问题（即运气），即便最好因子的 t-statistic 大于 2，也不能认为它是有效的。&lt;/b&gt;之前的两篇文章&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650876036%26idx%3D1%26sn%3D42f442ff51b288fa58e2a5d7bee3b8cf%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《出色不如走运?》&lt;/a&gt;以及&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;对这个问题进行了探讨。&lt;/p&gt;&lt;p&gt;今天这篇是《出色不如走运(III)?》。&lt;/p&gt;&lt;p&gt;假设同时考察 n 个因子、这些因子对于股票收益率的预测能力满足 Uniform distribution。如果从这 n 个因子中挑出效果最好的，这个“最好的”因子的 t-statistic 和 p-value 有哪些性质呢？我们想要回答的问题是：&lt;b&gt;在多重检验的 n 选 1 问题中，对于给定的显著性水平 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;&gt; &lt;b&gt;（比如 5%），单一因子的 p-value 或 t-statistic 应满足什么条件才能拒绝原假设。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;根据 order statistic 的概率知识可知，这 n 个因子中第 i 好的满足 Beta distribution：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+U_%7B%28i%29%7D%5Csim%5Cmbox%7BBeta%7D%28i%2Cn%2B1-i%29&quot; alt=&quot;\displaystyle U_{(i)}\sim\mbox{Beta}(i,n+1-i)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;从 n 个里面挑出最好的相当于令 i = n。根据 Beta distribution 的定义和简单计算有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28U_%7B%28n%29%7D%3Cx%29%3Dx%5En&quot; alt=&quot;\displaystyle \mbox{prob}(U_{(n)}&amp;lt;x)=x^n&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;令  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x+%3D+%281+%E2%80%93+p%29%5E%7B1%2Fn%7D&quot; alt=&quot;x = (1 – p)^{1/n}&quot; eeimg=&quot;1&quot;&gt;  并利用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28U+%3C+x%29+%3D+1+%E2%80%93+%5Cmbox%7Bprob%7D%28U+%E2%89%A5+x%29&quot; alt=&quot;\mbox{prob}(U &amp;lt; x) = 1 – \mbox{prob}(U ≥ x)&quot; eeimg=&quot;1&quot;&gt; 可知：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%5Cleft%28U_%7B%28n%29%7D%5Cge%281-p%29%5E%7B1%2Fn%7D%5Cright%29%3Dp&quot; alt=&quot;\displaystyle \mbox{prob}\left(U_{(n)}\ge(1-p)^{1/n}\right)=p&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;在因子分析中，通常关注的是因子收益率是否显著不为零 —— 可正可负 —— 因此一般使用双边检验。对于给定的 p-value（单边  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p%2F2&quot; alt=&quot;p/2&quot; eeimg=&quot;1&quot;&gt; ），由上式可知（将  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;&gt;  换成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p%2F2&quot; alt=&quot;p/2&quot; eeimg=&quot;1&quot;&gt; ），这 n 个因子中最好的那个的 t-statistic 的绝对值需不小于以下阈值才能拒绝原假设：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bt-statistic%7D%5E%5Cstar%3D%5Cmathcal%7BN%7D%5E%7B-1%7D%5Cleft%28%5Cleft%281-%5Cfrac%7Bp%7D%7B2%7D%5Cright%29%5E%7B1%2Fn%7D%5Cright%29&quot; alt=&quot;\displaystyle \mbox{t-statistic}^\star=\mathcal{N}^{-1}\left(\left(1-\frac{p}{2}\right)^{1/n}\right)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;当 n 很大时，从上式可进一步推导出单一因子的 p-value 需要小于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p%2Fn&quot; alt=&quot;p/n&quot; eeimg=&quot;1&quot;&gt; 才能在 n 选 1 的 multiple testing 下拒绝原假设。举例来说，我们考察 10 个因子并希望以 5% 的显著性水平找到真正有效的因子，则这些因子各自的 p-value 只有小于 5%/10 = 0.5% 才能拒绝原假设。这正是大名鼎鼎的 &lt;b&gt;Bonferroni correction（邦费罗尼校正&lt;/b&gt;）。&lt;/p&gt;&lt;p&gt;实际因子选股面临更复杂的问题：如何从 n 个因子中选出最好的 k 个，而非 1 个；如何配置选出来的这 k 个因子 —— 等权配置还是按照它们&lt;b&gt;样本内&lt;/b&gt;的表现好坏配置。如果不妥善解决 multiple testing 的问题，上述这些做法会导致&lt;b&gt;选择偏差（selection bias）&lt;/b&gt;以及&lt;b&gt;过拟合偏差（overfitting bias）&lt;/b&gt;。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 选择偏差和过拟合偏差&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在选择因子时，通常的做法是在回测中使用因子定期构建投资组合，然后分析因子预期收益率的 t-statistic。如果该 t 值小于零（且显著为负）则把该因子反过来使用。假设同时考察 n 个因子，并根据因子 t-statistic 绝对值的大小采用下列做法之一：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 按照样本内 n 个因子 t-statistics 的正负同时使用全部因子，按照等权或者样本内因子效果赋权来选股（n 选 n 问题） —— 这种做法引入 overfitting bias；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 从这 n 个因子中挑出样本内 t-statistic 绝对值最大的 1 个（n 选 1 问题），使用该因子选股 —— 这种做法引入 selection bias；&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 从这 n 个因子中挑出样本内 t-statistic 绝对值最大的 k 个（n 选 k 问题），并按等权或样本内效果赋权选股 —— 这种做法同时引入 selection bias 和 overfitting bias。&lt;/p&gt;&lt;p&gt;Novy-Marx (2015) 研究了多因子选股回测中的 selection bias 和 overfitting bias 问题。本文第一节中的数学推导正是来自 Novy-Marx (2015)，而它仅仅是 n 选 1 的一种简化情况。在投资实务中，更常见的是上述第二种 n 选 k 的问题，它面临&lt;b&gt;“因子怎么选”&lt;/b&gt;和&lt;b&gt;“因子如何配”&lt;/b&gt;这两个严峻的问题，一不小心就会引入大量的噪音。&lt;/p&gt;&lt;p&gt;&lt;b&gt;毫无疑问，multiple testing 下的数据挖掘是因子选股的大敌。通过 data mining，仅仅依靠运气，挑出来的因子 —— 哪怕再没有业务含义 —— 也会在样本内获得显著不为零的选股收益率，但它只是过拟合而已。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;针对 multiple testing 中的 data mining，Novy-Marx (2015) 从理论和实证经验两个角度分析了上述 n 选 n、n 选 1、n 选 k 三个问题中，多因子策略的 t-statistic 的分布问题。该文使用纯随机产生的因子 —— 理论上没有任何预测性 —— 在美股上选股、以美股的真实收益率计算这些随机因子的因子收益率，从而定量分析上述三个问题中多因子选股策略的 t-statistic 的阈值。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这些 t-statistic 的阈值远超单因子检验中的 2.0，而如此之高的阈值更是仅仅来自于运气和 data mining。在实际选股中，使用多因子构建的策略的 t-statistic 唯有超过这些阈值才意味着它们真的对收益率有统计上非显著为零的预测性。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文下一节借鉴 Novy-Marx (2015) 的思路产生随机因子，使用中证 500 指数的成分股进行实证分析。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 来自中证 500 的实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;实证中的回测期从 2010 年 1 月到 2019 年 1 月，考察 n 个随机因子的选股能力。具体的：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 对于每一个因子，在每月末，随机生成 500 支成分股在该因子上的取值并从高到低排列，选择取值最高的 10% 做多、取值最低的 10% 做空，以该多空组合的收益率作为该期因子的收益率；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 计算回测期内每个因子的 t-statistic，如果某个因子的 t-statistic 为负，则把该随机因子反过来使用；&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 按照每个随机因子 t-statistic 绝对值的大小，挑选绝对值最大的 k (≤ n) 个因子，并按照等权或者正比于它们 t-statistics 的绝对值大小配置因子；&lt;/p&gt;&lt;p&gt;&lt;b&gt;4.&lt;/b&gt; 以最终多个因子的配置结果作为最终的选股结果，计算该策略在整个回测期内的 t-statistic；&lt;/p&gt;&lt;p&gt;&lt;b&gt;5.&lt;/b&gt; 上述 1 – 4 步完成了 n 选 k（当 k = 1 和 n 时，问题分别变为 n 选 1 和 n 选 n）的一次实验。为了得到 n 选 k 问题中 t-statistic 的经验分布并计算 5% 显著性水平下的 t-statistic 的阈值，对于每一组 n 和 k，将上述 4 步进行 5000 次仿真，从而计算 t-statistic 的阈值。&lt;/p&gt;&lt;p&gt;举个例子。下图是当 n = 20，k = 3（即从 20 个随机因子中选出样本内 t-statistic 绝对值最大的 3 个，并按 t-statistic 绝对值大小配置）时，5000 次仿真得到的该策略的 t-statistic 的经验分布，其均值为 3.2，其 5% 显著性水平下对应的 t-statistic（即该分布中 95% 分位数）高达 4.16。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;710&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;710&quot; data-original=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;710&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;710&quot; data-original=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;该结果表明，如果我们从 20 个源于业务逻辑（或者很多人乐此不疲的 data mining）的因子中选择 3 个最好的来选股时，该策略的 t-statistic 要超过 4.16 才能认为这 3 个因子的选股效果不仅仅是运气。&lt;/p&gt;&lt;p&gt;接下来看看不同 n 和 k 的取值下，5% 显著性水平对应的 t-statistic 的阈值的情况。下图比较了不同 n 取值下，n 选 1 和 n 选 n 两种极端情况 —— n 选 1 代表仅有 selection bias；n 选 n 代表仅有 overfitting bias。下图传递出以下信息：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 随着考察的随机因子个数（n）的增加，策略 t-statistic 的阈值逐渐递增；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 选 n 个因子比选 1 个因子有更高的阈值；按样本内表现配置比等权配置有更高的阈值；它们说明 overfitting bias 比 selection bias 更容易在样本内产生过拟合。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;461&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;764&quot; data-original=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;461&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;764&quot; data-original=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看更一般的 n 选 k 的情况。下图显示了 n = 10、20、40 和 100 时，不同 k 取值下的选股策略的 t-statistic 阈值。在一般的投资实务中，尝试 100 甚至几百个因子并选择其中某些好的是十分常见的。从该实证结果中可以观察到：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 随着 n 和 k 的增加，对于按照随机因子 t-statistic 绝对值赋权配置的策略，它们的 t-statistic 阈值递增；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 随着 n 的增加，等权配置和按因子样本内表现配置的效果越来越接近；&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 对于等权配置因子的情况，能够观察到策略的效果并不随 k 递增；比如当 n = 10 时，t-statistic 的阈值随 k 先增大后减小。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;691&quot; data-rawheight=&quot;422&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;691&quot; data-original=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;691&quot; data-rawheight=&quot;422&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;691&quot; data-original=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上述实证结果中，最有意思的大概是第三条。&lt;b&gt;对于等权配置的情况，在一开始，使用更多的因子可以降低策略的波动率，从而提升 t-statistic 的阈值；而一旦因子个数超过最优值，越来越多排名靠后的因子被选入，它们会降低策略的收益率，从而降低 t-statistic 的阈值。&lt;/b&gt;这是在因子投资实务中需要考虑的问题。&lt;/p&gt;&lt;p&gt;从图中可以看到，对于实证中考察的最极端情况，即“从 100 个因子选 10 个最好的”，仅仅靠运气，以随机因子构建的策略在中证 500 成分股的样本内回测中就能取得高达 7 以上的 t-statistic 阈值。Data mining 造成的 selection bias 和 overfitting bias 不容小视。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;近年来，海外学术界越来越意识到 multiple testing 造成的因子分析中 data mining 的问题。一些先进的统计手段被提出以帮助鉴别哪些是真正有效的因子，哪些仅仅是运气。这些文献包括&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;中介绍的那些，以及本文提及的 Novy-Marx (2015)。&lt;/p&gt;&lt;p&gt;在 empirical asset pricing 和 factor allocation 方面，我们都是 data mining 的好手。拿来一个因子，如果不好使，可以对它进行差分 —— 美其名曰增长率；再不好使，二阶差分 —— 美其名曰加速度；还不好使，行业中性、市值中性试一下、用各种其他因子回归得到残差再试一下；对于选出的因子，等权配如果效果不理想，可以按照事后夏普率配一下；还不理想？使用滚动窗口进行动态因子择时……&lt;/p&gt;&lt;p&gt;诚然，对于有严谨金融逻辑的因子 —— 比如 ROE —— 我们没有必要把它和一帮其他“邪门”因子一起比较，然后要求 ROE 也有非常高的 t-statistic，这是对统计手段的走火入魔。但是，&lt;b&gt;对于很多纯粹靠 data mining 加工出来的因子，本文使用随机因子的实证结果定量说明了仅靠运气就能够达到的效果，从而帮助判断选股因子是否真正有效。&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;While one should combine multiple signals they believe in, one should not believe in a combination of signals simply because they backtest well together.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;感谢阅读，祝各位新春快乐！节后见。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt; &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Novy-Marx, R. (2015). &lt;i&gt;Backtesting strategies based on multiple signals&lt;/i&gt;. NBER Working Paper, No. 21329.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-02-02-56154663</guid>
<pubDate>Sat, 02 Feb 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>配置风险收益还是配置噪音？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-01-23-55549936.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55549936&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6a0bccb28af1ae5210368743fdb44f57_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用收益率序列计算夏普率、并比较不同策略时应使用科学的统计检验方法并回答正确的问题。这需要合理的先验和足够长的数据。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;资产配置是投资中最重要的课题之一。很多量化手段都被用来进行资产配置，比如人们耳熟能详的简单多样化、风险平价、波动率倒数、最小波动率等方法。&lt;/p&gt;&lt;p&gt;在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38301218&quot; class=&quot;internal&quot;&gt;《你真的搞懂了风险平价吗？》&lt;/a&gt;一文中我们指出，当资产之间相互独立时，应按照每个资产的夏普率平方来分配投资组合的风险，这能够最大化投资组合的夏普率。令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A3&quot; alt=&quot;Σ&quot; eeimg=&quot;1&quot;&gt; 表示资产的协方差矩阵、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSR%7D_i+%3D+%CE%BC_i%2F%CF%83_i&quot; alt=&quot;\mbox{SR}_i = μ_i/σ_i&quot; eeimg=&quot;1&quot;&gt; 表示资产 i 的夏普率、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_p&quot; alt=&quot;σ_p&quot; eeimg=&quot;1&quot;&gt; 表示投资组合的波动率、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89&quot; alt=&quot;ω&quot; eeimg=&quot;1&quot;&gt; 为权重向量。容易证明（下图）当投资品相互独立时（协方差矩阵是对角阵），根据夏普率平方分配风险得到的权重 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89_i&quot; alt=&quot;ω_i&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i%2F%28%CF%83_i%29%5E2&quot; alt=&quot;μ_i/(σ_i)^2&quot; eeimg=&quot;1&quot;&gt; 成正比。这个比例正是大名鼎鼎的&lt;b&gt;凯利准则（Kelly criterion）&lt;/b&gt;。&lt;b&gt;在资产相互独立的假设下，按此权重配置保证了投资组合的夏普率最大。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;570&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;570&quot; data-original=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;570&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;570&quot; data-original=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;在实际资产配置中，涉及的资产一般为不同类别的大类资产（如股票、债券、商品、外汇等）或者是相关性很低的投资策略，资产间可近似假设不相关。&lt;b&gt;量化配置的核心就变成是否能准确的计算不同资产的夏普率（或者其他风险、收益指标）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面以沪深 300、美国 7-10 年国债、标普 500 和黄金四种资产比较一下按夏普率平方分配风险配置（下文中简称为按夏普率配置）和简单多样化配置的效果。这四类资产在回测期内的表现如下（该实证例子来自 2017 年底的&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650877501%26idx%3D1%26sn%3D65db26221ea270a282c94d47b188ae57%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《主动风险预算初探》&lt;/a&gt;一文，因此回测期仅到 2017 年底）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;664&quot; data-rawheight=&quot;222&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;664&quot; data-original=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;664&quot; data-rawheight=&quot;222&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;664&quot; data-original=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对于按夏普率配置策略，选择月频交易频率，每个月末调仓。调仓时排除最近三个月内收益率均值为负以及由于未上市因而不可交易的资产（例如在 2003 年 3 月 31 日，沪深 300 指数尚未推出，不可交易）。对于满足条件的资产，采用 20 周滚动窗口的周频收益率数据计算夏普率；按照夏普率的平方来分配风险、计算最佳的配置权重。如果当期所有资产都被排除，则在下个月空仓。非空仓时则要求每月均满仓配置，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89_i&quot; alt=&quot;ω_i&quot; eeimg=&quot;1&quot;&gt; 之和为 1。按夏普率配置和简单多样化这两种策略的表现如下图所示。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;515&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;515&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从上述实证结果来看，按夏普率配置完胜简单多样化。按夏普率平方分配风险似乎 “理论完美、实证给力”，但现实中真的是这样吗？别着急，继续往下看。&lt;/p&gt;&lt;p&gt;上述实证结果的前提是能够对夏普率进行正确的计算。&lt;b&gt;本文的观点是通过有限的样本数据来对总体未知的夏普率进行推断、以及检验不同策略或资产的夏普率是否有显著差异（从而赋予不同的配置权重）是非常困难的一件事（是可能的，但很困难）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;来看一个假想的例子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 两年 vs 二十年&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用正态分布独立构建两个策略的周频收益率序列。假设两个策略的年化真实夏普率分别为 1 和 2；周频的波动率为 1%，通过夏普率就可以计算这两个周频收益率序列各自的均值，从而获得正态分布的全部参数。假设对每个策略产生 &lt;b&gt;1000 个样本点（对应约为二十年的时间）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;下图首先展示了这两个策略在&lt;b&gt;前 100 个样本点（对应两年）&lt;/b&gt;的累积收益率。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;848&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;848&quot; data-original=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;848&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;848&quot; data-original=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;你可能猜到了，我一定会故意找一个年化夏普率为 1 的策略在这前 100 周（对应两年）跑赢那个夏普率为 2 的策略的例子。上图中的蓝色为夏普率为 1 的策略的累积收益率；黄色为夏普率为 2 的策略的累积收益率。&lt;/p&gt;&lt;p&gt;如果我们把时间拉长到全部 1000 个样本点（二十年），则毫无意外的，黄色策略大幅跑赢了蓝色（注意下图中纵坐标是对数坐标）。这个例子说明，即便是年化夏普率 1 和 2 这种巨大的差异，如果只有很短的样本数据也完全能带给我们错误的结论（况且两年已经不短）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;849&quot; data-rawheight=&quot;425&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;849&quot; data-original=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;849&quot; data-rawheight=&quot;425&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;849&quot; data-original=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;你可能接着会说我一定是在“cherry picking”，试了半天找出了上面这么一个有违常理的例子。下面来看看多次仿真的结果。假设进行 5000 次仿真，每次仿真生成年化夏普率分别为 1 和 2 的两个策略，每个策略长度为 1000 个样本点。下图绘制了在前 n 个样本点下（横坐标为 n 的取值），夏普率为 1 的策略跑赢夏普率为 2 的策略的概率（纵坐标）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;740&quot; data-rawheight=&quot;371&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;740&quot; data-original=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;740&quot; data-rawheight=&quot;371&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;740&quot; data-original=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上图表明，如果我们的样本数据很短（比如 n = 10 或 20 周，对应几个月的情况），使用样本数据夏普率来比较两个策略的错误率（即认为真实夏普率为 1 的策略比真实夏普率为 2 的策略更好）高达 30% 以上；即使是使用 100 个样本点（两年），判断的错误率也有 16.34%。（所以“cherry picking”并没有花费我很多时间。）随着样本长度增加，错误率持续降低。&lt;/p&gt;&lt;p&gt;这个例子说明，&lt;b&gt;哪怕仅仅是希望定性的判断两个策略的夏普率孰高孰低，我们都需要足够长的样本数据。&lt;/b&gt;而如果想定量的比较不同策略的夏普率差异，则需要适合的统计检验。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 夏普率检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;数学上有很多手段检验两个收益率时间序列的夏普率是否显著不同。在这方面，最早的研究大概是 Jobson and Korkie (1981)。不过该研究假设两个策略的收益率满足二元正态分布，而实际的收益率时间序列中难以满足该假设。&lt;/p&gt;&lt;p&gt;针对上述问题，Ledoit and Wolf (2008) 提出了改进的检验方法。本文的重点虽然不是介绍这些检验方法，但由于下文的举例研究中将使用 Ledoit and Wolf (2008) 的方法，故在本节对其简要说明。感兴趣的朋友请进一步参考原文；跳过本小节也不影响后面内容的阅读。&lt;/p&gt;&lt;p&gt;根据夏普率的定义，它是策略超额收益均值和其标准差的比值。而对于一个随机变量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=X&quot; alt=&quot;X&quot; eeimg=&quot;1&quot;&gt; ，其方差满足如下关系：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28X%29%3D%5Cmbox%7BE%7D%5BX%5E2%5D-%28%5Cmbox%7BE%7D%5BX%5D%29%5E2&quot; alt=&quot;\mbox{var}(X)=\mbox{E}[X^2]-(\mbox{E}[X])^2&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt; 因此，对于（超额）收益率随机变量 r，对应的夏普率可以表达为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BSharpe+Ratio%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BE%7D%5Br%5D%7D%7B%5Csqrt%7B%5Cmbox%7Bvar%7D%28r%29%7D%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BE%7D%5Br%5D%7D%7B%5Csqrt%7B%5Cmbox%7BE%7D%5Br%5E2%5D-%28%5Cmbox%7BE%7D%5Br%5D%29%5E2%7D%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{Sharpe Ratio}&amp;amp;=&amp;amp;\displaystyle\frac{\mbox{E}[r]}{\sqrt{\mbox{var}(r)}}\\ &amp;amp;=&amp;amp;\displaystyle\frac{\mbox{E}[r]}{\sqrt{\mbox{E}[r^2]-(\mbox{E}[r])^2}} \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;换句话说，夏普率可以表达为收益率 r 的一阶矩（即均值 E[r]）和&lt;b&gt;非中心化&lt;/b&gt;的二阶矩（即 E[r^2]）的函数。Ledoit and Wolf (2008) 正是采用了上述表达式，极大的简化了推导。&lt;/p&gt;&lt;p&gt;对于两个待比较夏普率的收益率序列 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5C%7Br_i%5C%7D&quot; alt=&quot;\{r_i\}&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5C%7Br_n%5C%7D&quot; alt=&quot;\{r_n\}&quot; eeimg=&quot;1&quot;&gt; ，它们的真实（但未知）夏普率之差（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94&quot; alt=&quot;Δ&quot; eeimg=&quot;1&quot;&gt; 表示）是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_i%5D&quot; alt=&quot;\mbox{E}[r_i]&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_n%5D&quot; alt=&quot;\mbox{E}[r_n]&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_i%5E2%5D&quot; alt=&quot;\mbox{E}[r_i^2]&quot; eeimg=&quot;1&quot;&gt; 以及 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_n%5E2%5D&quot; alt=&quot;\mbox{E}[r_n^2]&quot; eeimg=&quot;1&quot;&gt; 的函数（为简化表达式，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC+%3D+%5Cmbox%7BE%7D%5Br%5D&quot; alt=&quot;μ = \mbox{E}[r]&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3+%3D+%5Cmbox%7BE%7D%5Br%5E2%5D&quot; alt=&quot;γ = \mbox{E}[r^2]&quot; eeimg=&quot;1&quot;&gt; ）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5CDelta%3Df%28%5Cmu_i%2C%5Cmu_n%2C%5Cgamma_i%2C%5Cgamma_n%29%3D%5Cdisplaystyle%5Cfrac%7B%5Cmu_i%7D%7B%5Csqrt%7B%5Cgamma_i-%5Cmu_i%5E2%7D%7D+-%5Cfrac%7B%5Cmu_n%7D%7B%5Csqrt%7B%5Cgamma_n-%5Cmu_n%5E2%7D%7D&quot; alt=&quot;\Delta=f(\mu_i,\mu_n,\gamma_i,\gamma_n)=\displaystyle\frac{\mu_i}{\sqrt{\gamma_i-\mu_i^2}} -\frac{\mu_n}{\sqrt{\gamma_n-\mu_n^2}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;在实际中，我们只有样本数据，使用样本数据计算出的夏普率之差为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat%5CDelta%3Df%28%5Chat%5Cmu_i%2C%5Chat%5Cmu_n%2C%5Chat%5Cgamma_i%2C%5Chat%5Cgamma_n%29%3D%5Cdisplaystyle%5Cfrac%7B%5Chat%5Cmu_i%7D%7B%5Csqrt%7B%5Chat%5Cgamma_i-%5Chat%5Cmu_i%5E2%7D%7D+-%5Cfrac%7B%5Chat%5Cmu_n%7D%7B%5Csqrt%7B%5Chat%5Cgamma_n-%5Chat%5Cmu_n%5E2%7D%7D&quot; alt=&quot;\hat\Delta=f(\hat\mu_i,\hat\mu_n,\hat\gamma_i,\hat\gamma_n)=\displaystyle\frac{\hat\mu_i}{\sqrt{\hat\gamma_i-\hat\mu_i^2}} -\frac{\hat\mu_n}{\sqrt{\hat\gamma_n-\hat\mu_n^2}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;为了对夏普率之差进行检验，我们必须知道样本夏普率之差的 standard error。为此，Ledoit and Wolf (2008) 使用了统计学中的 &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Delta_method&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;delta method&lt;/a&gt;。具体的，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v+%3D+%28%CE%BC_i%2C+%CE%BC_n%2C+%CE%B3_i%2C+%CE%B3_n%29%27&quot; alt=&quot;v = (μ_i, μ_n, γ_i, γ_n)&#39;&quot; eeimg=&quot;1&quot;&gt; —— 即向量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=v&quot; alt=&quot;v&quot; eeimg=&quot;1&quot;&gt;  代表了计算两个收益率序列夏普率之差的总体（population）未知参数；令向量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+v&quot; alt=&quot;\hat v&quot; eeimg=&quot;1&quot;&gt;  对应  &lt;img src=&quot;https://www.zhihu.com/equation?tex=v&quot; alt=&quot;v&quot; eeimg=&quot;1&quot;&gt;  的样本（sample）参数。Ledoit and Wolf (2008) 假设：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csqrt%7BT%7D%28%5Chat+v-v%29%5Cxrightarrow%7Bd%7D+%5Cmathcal%7BN%7D%280%2C%5CPsi%29&quot; alt=&quot;\sqrt{T}(\hat v-v)\xrightarrow{d} \mathcal{N}(0,\Psi)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式箭头上的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;&gt;  表示依分布收敛； &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt;  表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28%CE%BC_i%2C+%CE%BC_n%2C+%CE%B3_i%2C+%CE%B3_n%29&quot; alt=&quot;(μ_i, μ_n, γ_i, γ_n)&quot; eeimg=&quot;1&quot;&gt; 的协方差矩阵（未知、需估计）； &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;&gt; 为样本长度。由于夏普率之差  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94&quot; alt=&quot;Δ&quot; eeimg=&quot;1&quot;&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v&quot; alt=&quot;v&quot; eeimg=&quot;1&quot;&gt; 的函数，直接使用 delta method 可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csqrt%7BT%7D%28%5Chat+%5CDelta-%5CDelta%29%5Cxrightarrow%7Bd%7D+%5Cmathcal%7BN%7D%280%2C%5Cnabla+f%28v%29%5ET%5CPsi%5Cnabla+f%28v%29%29&quot; alt=&quot;\sqrt{T}(\hat \Delta-\Delta)\xrightarrow{d} \mathcal{N}(0,\nabla f(v)^T\Psi\nabla f(v))&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cnabla+f%28v%29%3D%5Cdisplaystyle%5Cleft%5B+%5Cbegin%7Barray%7D%7Br%7D+%5Cdisplaystyle%5Cfrac%7B%5Cgamma_i%7D%7B%28%5Cgamma_i-%5Cmu_i%5E2%29%5E%7B1.5%7D%7D%5C%5C+%5Cdisplaystyle-%5Cfrac%7B%5Cgamma_n%7D%7B%28%5Cgamma_n-%5Cmu_n%5E2%29%5E%7B1.5%7D%7D%5C%5C+%5Cdisplaystyle-%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cmu_i%7D%7B%28%5Cgamma_i-%5Cmu_i%5E2%29%5E%7B1.5%7D%7D%5C%5C+%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cmu_n%7D%7B%28%5Cgamma_n-%5Cmu_n%5E2%29%5E%7B1.5%7D%7D+%5Cend%7Barray%7D%5Cright%5D&quot; alt=&quot;\nabla f(v)=\displaystyle\left[ \begin{array}{r} \displaystyle\frac{\gamma_i}{(\gamma_i-\mu_i^2)^{1.5}}\\ \displaystyle-\frac{\gamma_n}{(\gamma_n-\mu_n^2)^{1.5}}\\ \displaystyle-\frac{1}{2}\frac{\mu_i}{(\gamma_i-\mu_i^2)^{1.5}}\\ \displaystyle\frac{1}{2}\frac{\mu_n}{(\gamma_n-\mu_n^2)^{1.5}} \end{array}\right]&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式就是使用样本数据计算的夏普率之差需要满足的分布。一旦我们能够得到协方差矩阵 Ψ 的相合估计  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%A8&quot; alt=&quot;\hat Ψ&quot; eeimg=&quot;1&quot;&gt; ，就可以利用下式求出  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%94&quot; alt=&quot;\hat Δ&quot; eeimg=&quot;1&quot;&gt;  的 standard error：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bs.e.%7D%28%5Chat+%5CDelta%29%3D%5Csqrt%7B%5Cfrac%7B%5Cnabla+f%28%5Chat+v%29%5ET%5Chat%5CPsi%5Cnabla+f%28%5Chat+v%29%7D%7BT%7D%7D&quot; alt=&quot;\displaystyle\mbox{s.e.}(\hat \Delta)=\sqrt{\frac{\nabla f(\hat v)^T\hat\Psi\nabla f(\hat v)}{T}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;有了 standard error，再假设真实夏普率之差为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94+%3D+%CE%B8&quot; alt=&quot;Δ = θ&quot; eeimg=&quot;1&quot;&gt; ，便可以计算 t-statistic：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bt-statistic%7D%3D%5Cfrac%7B%5Chat%5CDelta-%5Ctheta%7D%7B%5Cmbox%7Bs.e.%7D%28%5Chat+%5CDelta%29%7D&quot; alt=&quot;\displaystyle\mbox{t-statistic}=\frac{\hat\Delta-\theta}{\mbox{s.e.}(\hat \Delta)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;有了 t-statistic 就可以进一步计算 p-value 并以此接受或拒绝原假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94+%3D+%CE%B8&quot; alt=&quot;Δ = θ&quot; eeimg=&quot;1&quot;&gt; 。问题的核心由此归结为估计协方差矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt; 。为此，Ledoit and Wolf (2008) 给出了两种方法：&lt;/p&gt;&lt;p&gt;第一种方法是基于渐进正态性的假设，使用 heteroskedasticity and autocorrelation (HAC) kernel estimation 对  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt;  进行估计。在协方差矩阵的 HAC 估计方面，学术界有很多方法，Ledoit and Wolf (2008) 采用的是 Andrews (1991) 给出的方法。&lt;/p&gt;&lt;p&gt;第二种方法是使用自助法（bootstrap）。Ledoit and Wolf (2008) 认为对于实际中的收益率时间序列，由于分布未知且样本数量较短，前一种基于渐进正态性的方法可能无法给出正确的估计。出于这种考虑，Ledoit and Wolf (2008) 采用了 studentized bootstrap 方法（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41099219&quot; class=&quot;internal&quot;&gt;《用 Bootstrap 进行参数估计大有可为》&lt;/a&gt;中的第五节）。&lt;/p&gt;&lt;p&gt;由于篇幅所限，本节不再展开介绍协方差矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt; 的估计。感兴趣的朋友请参考 Ledoit and Wolf (2008)。在下一节的实验中，由于使用的假想收益率序列出自正态分布，因此使用上述第一种方法对夏普率进行检验。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 回答正确的问题&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上述夏普率差别的检验回答的是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%5Chat+%CE%94+%7C+%CE%94+%3D+%CE%B8%29&quot; alt=&quot;\mbox{prob}(\hat Δ | Δ = θ)&quot; eeimg=&quot;1&quot;&gt; 的问题 —— 即在原假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=H_0%3A%CE%94+%3D+%CE%B8+&quot; alt=&quot;H_0:Δ = θ &quot; eeimg=&quot;1&quot;&gt; 下，我们观测到样本夏普率差异  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%94&quot; alt=&quot;\hat Δ&quot; eeimg=&quot;1&quot;&gt;  的概率。&lt;b&gt;在实际进行资产配置时，即便我们能显著的拒绝原假设，它也不是我们最关心的问题。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在利用不同夏普率进行资产配置时，正确的问题是计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8+%7C+%5Chat+%CE%94%29&quot; alt=&quot;\mbox{prob}(Δ = θ | \hat Δ)&quot; eeimg=&quot;1&quot;&gt; —— &lt;b&gt;即当样本数据显示出 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%94&quot; alt=&quot;\hat Δ&quot; eeimg=&quot;1&quot;&gt;&lt;b&gt; 的夏普率差异时，这两个策略真实夏普率差异是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B8&quot; alt=&quot;θ&quot; eeimg=&quot;1&quot;&gt; &lt;b&gt; 的概率。&lt;/b&gt;由贝叶斯法则可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8+%7C+%5Chat+%CE%94%29&quot; alt=&quot;\mbox{prob}(Δ = θ | \hat Δ)&quot; eeimg=&quot;1&quot;&gt; 与 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94+%3D+%CE%B8&quot; alt=&quot;Δ = θ&quot; eeimg=&quot;1&quot;&gt; 的先验概率以及统计检验结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%5Chat+%CE%94+%7C+%CE%94+%3D+%CE%B8%29&quot; alt=&quot;\mbox{prob}(\hat Δ | Δ = θ)&quot; eeimg=&quot;1&quot;&gt; 的乘积成正比：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28%5CDelta%3D%5Ctheta%7C%5Chat%5CDelta%29%26%3D%26%5Cdisplaystyle+%5Cfrac%7B%5Cmbox%7Bprob%7D%28%5CDelta+%3D%5Ctheta%29%5Cmbox%7Bprob%7D%28%5Chat%5CDelta%7C%5CDelta%3D%5Ctheta%29%7D%7B%5Cmbox%7Bprob%7D%28%5Chat%5CDelta%29%7D%5C%5C+%26%5Cpropto%26%5Cdisplaystyle%5Cmbox%7Bprob%7D%28%5CDelta%3D%5Ctheta%29%5Cmbox%7Bprob%7D%28%5Chat%5CDelta%7C%5CDelta%3D%5Ctheta%29+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \displaystyle \mbox{prob}(\Delta=\theta|\hat\Delta)&amp;amp;=&amp;amp;\displaystyle \frac{\mbox{prob}(\Delta =\theta)\mbox{prob}(\hat\Delta|\Delta=\theta)}{\mbox{prob}(\hat\Delta)}\\ &amp;amp;\propto&amp;amp;\displaystyle\mbox{prob}(\Delta=\theta)\mbox{prob}(\hat\Delta|\Delta=\theta) \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式说明，为了计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8+%7C+%5Chat+%CE%94%29&quot; alt=&quot;\mbox{prob}(Δ = θ | \hat Δ)&quot; eeimg=&quot;1&quot;&gt; 需要知道先验 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8%29&quot; alt=&quot;\mbox{prob}(Δ = θ)&quot; eeimg=&quot;1&quot;&gt; 是多少。在一定程度上，它的取值和主观经验判断密切相关 —— 比如认为两个策略夏普率没有差异的概率最大；或者认为某个策略就是风险收益更高，因此它们年化夏普率差异为 1 的概率最大等。&lt;/p&gt;&lt;p&gt;下面，假设真实年化夏普率差异 θ 的取值为 0、0.5 和 1，并假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+0%29+%3D+0.6&quot; alt=&quot;\mbox{prob}(Δ = 0) = 0.6&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+0.5%29+%3D+0.2&quot; alt=&quot;\mbox{prob}(Δ = 0.5) = 0.2&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+1%29+%3D+0.2&quot; alt=&quot;\mbox{prob}(Δ = 1) = 0.2&quot; eeimg=&quot;1&quot;&gt; 。我们再来看看第二节中的那两个策略。&lt;/p&gt;&lt;p&gt;当只有前 100 周的样本数据，通过使用本文第三节介绍的检验方法得到如下结果：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;723&quot; data-rawheight=&quot;157&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;723&quot; data-original=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;723&quot; data-rawheight=&quot;157&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;723&quot; data-original=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从 prob(Δ = θ) 和 prob(\hat Δ | Δ = θ) 的乘积来看，最大的是 θ = 0.0 的情况，这说明仅仅通过 100 期的表现，我们并不能认为这两个策略中谁更好，尽管实际情况是策略 2 的真实夏普率是策略 1 的两倍。&lt;/p&gt;&lt;p&gt;当使用全部 1000 个样本数据时，可得到的结果如下。在足够长的样本数据下（二十年），结果显示两个策略最有可能的真实夏普率差别是 θ = 1.0。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;721&quot; data-rawheight=&quot;158&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;721&quot; data-original=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;721&quot; data-rawheight=&quot;158&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;721&quot; data-original=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;这个例子虽然从收益率序列到先验都是假想的，但通过它想要引出的观点是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. &lt;/b&gt;评价不同资产/策略的夏普率差异（进而进行更主动的资产配置）需要一个基于统计手段的科学分析框架，并在这个框架下回答正确的问题；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. &lt;/b&gt;样本数据的长短对于总体统计量的推断至关重要，使用很短的数据计算夏普率或者资产配置也许更倾向于配置噪音。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;资产配置从来都不是一个容易的课题。&lt;/p&gt;&lt;p&gt;当我们知道不同策略（或者资产）真实夏普率的时候，没有理由使用简单多样化配置；充分利用不同资产的夏普率信息才可能最大化投资组合的夏普率，达到最优的风险收益特性。可惜，真实夏普率是未知的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;使用收益率序列计算夏普率并比较不同策略时应该使用科学的统计检验并回答正确的问题。这需要合理的先验和足够长的数据。&lt;/b&gt;而基于有限的数据计算出（不确定性极大的）夏普率来配置相当于择时。计算夏普率在一定程度上近似于计算收益率；短时间内收益率的外推性是非常差的，因此使用短时间内夏普率进行资产配置（择时）并不十分合理的。&lt;/p&gt;&lt;p&gt;为什么第一节中的例子里按照滚动窗口计算出的夏普率来配置显著战胜了简单多样化呢？其原因是 A 股中泾渭分明的牛、熊市 —— 任何对着 A 股的择时策略只要能躲过几波熊市都会显著提升样本内效果。在该例子中，一旦我们把 A 股从资产池中排除，对于余下几种资产，使用滚动夏普率并没有战胜简单多样化（下图）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;545&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;968&quot; data-original=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;545&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;968&quot; data-original=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;当使用了正确的方法和足够的数据之后，对于夏普率的判断（从而改变策略配置权重）是一种改变我们先验的低频行为。&lt;/b&gt;如果正确，它将会提高投资组合在未来的风险收益特征；如果错误，它则大概率是在样本内对着数据过拟合而已。&lt;/p&gt;&lt;p&gt;&lt;b&gt;基于有限的收益率序列、滚动计算夏普率（或其他风险、收益指标）并配置资产，到底是在配置风险收益还是在配置噪音？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Andrews, D. W. K. (1991). Heteroskedasticity and autocorrelation consistent covariance matrix estimation. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 59(3), 817 – 858.&lt;/li&gt;&lt;li&gt;Jobson, J. D. and B. M. Korkie (1981). Performance hypothesis testing with the Sharpe and Treynor measures. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 36(4), 889 – 908.&lt;/li&gt;&lt;li&gt;Ledoit, O. and M. Wolf (2008). Robust performance hypothesis testing with the Sharpe ratio. &lt;i&gt;Journal of Empirical Finance&lt;/i&gt;, Vol. 15(5), 850 – 859.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-01-23-55549936</guid>
<pubDate>Wed, 23 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>多因子回归检验中的 Newey-West 调整</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-01-16-54913149.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-74781a2b37d40bae46dca534e259ec5a_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Newey-West 调整是计量经济学中的经典方法，在多因子模型回归分析中无处不在。本文介绍它的用法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文有很多数学公式。&lt;/p&gt;&lt;p&gt;本文的推导重点参考了 William Greene 的经典教材 Econometric Analysis（Greene 2003，我用的第五版，最新的出到了第八版）。&lt;/p&gt;&lt;p&gt;本文回答了一个曾让我纠结很久的问题。&lt;/p&gt;&lt;p&gt;在学术界关于 empirical asset pricing 的论文中，portfolio test 和 regression test 是检验一个新因子是否有效的两个常见手段。在前者中，使用已有因子的收益率作为 regressors、使用基于新因子构建的投资组合的收益率作为被解释变量，进行时序回归，从而检验新因子组合是否可以获得超额收益 α、以及它在已有因子上的 β。在后者中，新因子和已有因子一起被用来和个股收益率进行截面回归（通常使用 Fama-MacBeth regression），然后考察新因子的预期收益率 E[f] 是否显著不为零。&lt;/p&gt;&lt;p&gt;无论是上面哪种方法，学者们都会对回归分析得到的 α、β 以及 E[f] 给出 t-statistic 从而检验它们的显著性。而在学术论文所报告的结果中，经常出现诸如“Newey and West adjusted t-statistic”或者“Newey and West adjusted standard error”（standard error 是用来计算 t-statistic 的）这样的描述。这不禁让人疑问：&lt;b&gt;回归检验中的 Newey and West 调整到底是什么？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;除了要搞懂它到底是什么之外，我们也关心它是如何实操的，这样才能将它用在 A 股的实证研究中。这就是本文关心的话题。本文的内容提要如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;第二、三节介绍必要的数学背景，解释 Newey-West 调整的重要性。&lt;/li&gt;&lt;li&gt;第四节针对 A 股进行 portfolio test 的实证研究，指出考虑 Newey-West 调整后 α 和 β 的显著性的变化。&lt;/li&gt;&lt;li&gt;第五节说明通过 Fama-MacBeth regression 求解因子预期收益率 E[f] 中的 Newey-West 调整是一种简化版。&lt;/li&gt;&lt;li&gt;第六节总结本文，并评论一下 Barra 在计算协方差矩阵中的 Newey-West 调整。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;让我们从广义线性回归说起。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 广义线性回归&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;考虑如下&lt;b&gt;广义线性回归模型（generalized linear regression model）&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cdisplaystyle+%5Cmathbf%7By%7D%26%3D%26%5Cmathbf%7BX%5Cbeta%7D%2B%5Cmathbf%7B%5Cvarepsilon%7D%5C%5C+%5Cmbox%7BE%7D%5B%5Cmathbf%7B%5Cvarepsilon%7D%7C%5Cmathbf%7BX%7D%5D%26%3D%26%5Cmathbf%7B0%7D%5C%5C+%5Cmbox%7BE%7D%5B%5Cmathbf%7B%5Cvarepsilon%5Cvarepsilon%27%7D%7C%5Cmathbf%7BX%7D%5D%26%3D%26%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%3D%5Cmathbf%7B%5CSigma%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \displaystyle \mathbf{y}&amp;amp;=&amp;amp;\mathbf{X\beta}+\mathbf{\varepsilon}\\ \mbox{E}[\mathbf{\varepsilon}|\mathbf{X}]&amp;amp;=&amp;amp;\mathbf{0}\\ \mbox{E}[\mathbf{\varepsilon\varepsilon&#39;}|\mathbf{X}]&amp;amp;=&amp;amp;\sigma^2\mathbf{\Omega}=\mathbf{\Sigma} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上述模型是&lt;b&gt;时序上&lt;/b&gt;的线性回归模型；其中 &lt;b&gt;y&lt;/b&gt; 是 T × 1 阶向量（T 代表时序的总期数）；&lt;b&gt;X&lt;/b&gt; 是 T × K 阶矩矩阵（其中 K 是 regressors 的个数）；&lt;b&gt;ε&lt;/b&gt; 是 T × 1 阶残差向量；&lt;b&gt;Σ&lt;/b&gt;（T × T 阶）是残差的协方差矩阵。回归的目的是为了得到回归系数 &lt;b&gt;β&lt;/b&gt;（K × 1 阶矩阵）并检验它们的显著性。&lt;/p&gt;&lt;p&gt;上述模型和经典线性回归模型最大的区别是矩阵 &lt;b&gt;Ω&lt;/b&gt; 的引入。在经典模型中假设给定解释变量 &lt;b&gt;X&lt;/b&gt; 下，不同时刻 t 的残差是独立且同方差，因此 &lt;b&gt;Ω&lt;/b&gt; 是单位阵 &lt;b&gt;I&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;在广义线性回归中，残差独立、同方差这两个假设均可被打破，从而得到两个残差中常见的特性：&lt;b&gt;异方差（heteroscedasticity）&lt;/b&gt;和&lt;b&gt;自相关（autocorrelation）&lt;/b&gt;。多因子模型回归中的残差就经常呈现上述两种特性。在广义线性回归模型中引入 &lt;b&gt;Ω&lt;/b&gt; 正是为了反映上述特性。以下是两个例子。&lt;/p&gt;&lt;p&gt;对于异方差（但仍可以假设独立），通常有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brllll%7D+%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%26%3D%26%5Csigma%5E2+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Comega_%7B11%7D%260%26%5Ccdots%260%5C%5C+0%26%5Comega_%7B22%7D%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+0%260%26%5Ccdots%26%5Comega_%7BTT%7D+%5Cend%7Barray%7D%5Cright%5D%26%3D%26+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Csigma_%7B1%7D%5E2%260%26%5Ccdots%260%5C%5C+0%26%5Csigma_%7B2%7D%5E2%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+0%260%26%5Ccdots%26%5Csigma_%7BT%7D%5E2+%5Cend%7Barray%7D%5Cright%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rllll} \sigma^2\mathbf{\Omega}&amp;amp;=&amp;amp;\sigma^2 \left[\begin{array}{cccc} \omega_{11}&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ 0&amp;amp;\omega_{22}&amp;amp;\cdots&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;\cdots&amp;amp;\omega_{TT} \end{array}\right]&amp;amp;=&amp;amp; \left[\begin{array}{cccc} \sigma_{1}^2&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ 0&amp;amp;\sigma_{2}^2&amp;amp;\cdots&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;\cdots&amp;amp;\sigma_{T}^2 \end{array}\right] \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;对于自相关（但同方差），通常有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%26%3D%26%5Csigma%5E2+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1%26%5Crho_1%26%5Ccdots%26%5Crho_%7BT-1%7D%5C%5C+%5Crho_1%261%26%5Ccdots%26%5Crho_%7BT-2%7D%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+%5Crho_%7BT-1%7D%26%5Crho_%7BT-2%7D%26%5Ccdots%261+%5Cend%7Barray%7D%5Cright%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \sigma^2\mathbf{\Omega}&amp;amp;=&amp;amp;\sigma^2 \left[\begin{array}{cccc} 1&amp;amp;\rho_1&amp;amp;\cdots&amp;amp;\rho_{T-1}\\ \rho_1&amp;amp;1&amp;amp;\cdots&amp;amp;\rho_{T-2}\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \rho_{T-1}&amp;amp;\rho_{T-2}&amp;amp;\cdots&amp;amp;1 \end{array}\right] \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;当然我们也可以既考虑异方差又考虑自相关性。在一般情况下 &lt;b&gt;Ω&lt;/b&gt; 矩阵中第 i 行、第 j 列的元素用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89_%7Bij%7D&quot; alt=&quot;ω_{ij}&quot; eeimg=&quot;1&quot;&gt; 表示。&lt;/p&gt;&lt;p&gt;如果 &lt;b&gt;Ω&lt;/b&gt; 已知，则通常使用 generalized least squares 来对 &lt;b&gt;β&lt;/b&gt; 进行参数估计。但当 &lt;b&gt;Ω&lt;/b&gt; 未知时，OLS 往往是首选。对该广义线性回归模型进行 OLS 求解就可以得到 &lt;b&gt;β&lt;/b&gt; 的 OLS 估计，记为 &lt;b&gt;b&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%3D%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%27y%7D%3D%5Cmathbf%7B%5Cbeta%7D%2B%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%27%5Cvarepsilon%7D&quot; alt=&quot;\mathbf{b}=(\mathbf{X&#39;X})^{-1}\mathbf{X&#39;y}=\mathbf{\beta}+(\mathbf{X&#39;X})^{-1}\mathbf{X&#39;\varepsilon}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;对上式两边取期望，则当 E[&lt;b&gt;ε&lt;/b&gt;|&lt;b&gt;X&lt;/b&gt;] = 0 的假设成立时易知 E[&lt;b&gt;b&lt;/b&gt;] = &lt;b&gt;β&lt;/b&gt;。利用 E[&lt;b&gt;b&lt;/b&gt;] = &lt;b&gt;β&lt;/b&gt; 进而推导出 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵，记为 &lt;b&gt;V&lt;/b&gt;_OLS：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BV%7D_%7B%5Cmbox%7BOLS%7D%7D%26%3D%26%5Cmbox%7BE%7D%5B%28%5Cmathbf%7Bb-%5Cbeta%7D%29%28%5Cmathbf%7Bb-%5Cbeta%7D%29%27%7C%5Cmathbf%7BX%7D%5D%5C%5C+%26%3D%26%5Cmbox%7BE%7D%5B%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%7D%27%5Cvarepsilon%5Cvarepsilon%27%5Cmathbf%7BX%28X%27X%29%7D%5E%7B-1%7D%7C%5Cmathbf%7BX%7D%5D%5C%5C+%26%3D%26%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%7D%27%28%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%29%5Cmathbf%7BX%28X%27X%29%7D%5E%7B-1%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27%7D%5B%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%5D%5Cmathbf%7BX%7D%5Cright%29%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mathbf{V}_{\mbox{OLS}}&amp;amp;=&amp;amp;\mbox{E}[(\mathbf{b-\beta})(\mathbf{b-\beta})&#39;|\mathbf{X}]\\ &amp;amp;=&amp;amp;\mbox{E}[(\mathbf{X&#39;X})^{-1}\mathbf{X}&#39;\varepsilon\varepsilon&#39;\mathbf{X(X&#39;X)}^{-1}|\mathbf{X}]\\ &amp;amp;=&amp;amp;(\mathbf{X&#39;X})^{-1}\mathbf{X}&#39;(\sigma^2\mathbf{\Omega})\mathbf{X(X&#39;X)}^{-1}\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1}\left(\frac{1}{T}\mathbf{X&#39;}[\sigma^2\mathbf{\Omega}]\mathbf{X}\right)\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1} \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;当残差不存在异方差以及自相关性时，&lt;b&gt;Ω&lt;/b&gt; = &lt;b&gt;I&lt;/b&gt; 而上面的协方差矩阵也可以简化成我们最熟悉的经典 OLS 里面的形式，也就是各种 OLS 软件包给出的参数的标准误（协方差矩阵对角线元素的平方根）和 t-statistic 的结果。然而，&lt;b&gt;当残差存在异方差或者自相关时，OLS 得到的 β 的方差的估计是不准确的，从而影响对 β 进行统计检验。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在 &lt;b&gt;Ω&lt;/b&gt; 未知的情况下，需对 &lt;b&gt;V&lt;/b&gt;_OLS 进行估计。上面的表达式可以看成是三个矩阵相乘的形式，其中第一个和第三个仅和 &lt;b&gt;X&lt;/b&gt; 有关，因此&lt;b&gt;核心目标就是估计中间矩阵（middle matrix）。&lt;/b&gt;为了方便讨论，另&lt;b&gt;Q&lt;/b&gt; 代表中间的矩阵：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BQ%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27%7D%5B%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%5D%5Cmathbf%7BX%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET%5Csum_%7Bj%3D1%7D%5ET%5Csigma_%7Bij%7D%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_j%27+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mathbf{Q}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\mathbf{X&#39;}[\sigma^2\mathbf{\Omega}]\mathbf{X}\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T\sum_{j=1}^T\sigma_{ij}\mathbf{x}_i\mathbf{x}_j&#39; \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_i+%3D+%5Bx_%7Bi1%7D%2C+x_%7Bi2%7D%2C+%E2%80%A6%2C+x_%7BiK%7D%5D%E2%80%99&quot; alt=&quot;\mathbf{x}_i = [x_{i1}, x_{i2}, …, x_{iK}]’&quot; eeimg=&quot;1&quot;&gt; ，即 &lt;b&gt;X&lt;/b&gt; 的第 i 行的转置（注意它不等于 &lt;b&gt;X&lt;/b&gt; 的第 i 列）。一旦我们能找到矩阵 &lt;b&gt;Q&lt;/b&gt; 的估计，便可进而求出 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵 &lt;b&gt;V&lt;/b&gt;_OLS。在估计 &lt;b&gt;Q&lt;/b&gt; 时，我们需要用到的“武器”便是 regressor 矩阵 &lt;b&gt;X&lt;/b&gt; 以及样本残差 &lt;b&gt;e&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;针对残差的假设不同，最常见的两种估计是 White 估计（仅假设异方差）以及 Newey and West 估计（考虑异方差及自相关）。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 White and Newey-West Estimators&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当残差仅有异方差但没有自相关时，我们需要的估计量 &lt;b&gt;Q&lt;/b&gt; 简化为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BQ%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET%5Csigma_%7Bi%7D%5E2%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_i%27+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{Q}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T\sigma_{i}^2\mathbf{x}_i\mathbf{x}_i&#39; \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;White (1980) 指出使用 &lt;b&gt;X&lt;/b&gt; 以及 &lt;b&gt;e&lt;/b&gt; 可以求出 &lt;b&gt;Q&lt;/b&gt; 的渐进估计（记为 &lt;b&gt;S&lt;/b&gt;_0）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BS%7D_0%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET+e_%7Bi%7D%5E2%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_i%27+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{S}_0&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T e_{i}^2\mathbf{x}_i\mathbf{x}_i&#39; \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;将上述 &lt;b&gt;Q&lt;/b&gt; 的估计 &lt;b&gt;S&lt;/b&gt;_0 代入到 &lt;b&gt;V&lt;/b&gt;_OLS 的表达式中，可以得到 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵的估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BV%7D_%7B%5Cmbox%7BOLS%7D%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET+e_i%5E2%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_i%27%5Cright%29%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D%5C%5C%5C%5C+%26%3D%26T%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BS%7D_0%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{V}_{\mbox{OLS}}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1}\left(\frac{1}{T}\sum_{i=1}^T e_i^2\mathbf{x}_i\mathbf{x}_i&#39;\right)\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1}\\\\ &amp;amp;=&amp;amp;T(\mathbf{X&#39;X})^{-1}\mathbf{S}_0(\mathbf{X&#39;X})^{-1} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上述估计称为 &lt;b&gt;White heteroscedasticity consistent estimator&lt;/b&gt;。&lt;b&gt;这一结果极其重要。它意味着哪怕我们对异方差的取值或结构一无所知，我们仍然可以根据最小二乘的结果进行适当的推断。&lt;/b&gt;考虑到实际问题中，多因子收益率残差的异方差性质未知，这一性质就显得格外重要。&lt;/p&gt;&lt;p&gt;在实际问题中，除了异方差外，仍需考虑残差的自相关性。为此，一个自然的想法是将上述 &lt;b&gt;Q&lt;/b&gt; 的估计延伸到对角线之外的元素，即：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BS%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET%5Csum_%7Bj%3D1%7D%5ET+e_%7Bij%7D%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_j%27+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{S}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T\sum_{j=1}^T e_{ij}\mathbf{x}_i\mathbf{x}_j&#39; \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;然而，这种方法有两个问题，因此并不正确：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;首先，该表达式中一共有 T^2 项求和，而它的 scaling factor 仅仅是 1/T，因此 &lt;b&gt;S&lt;/b&gt; 可能完全不收敛；&lt;/li&gt;&lt;li&gt;即便 &lt;b&gt;S&lt;/b&gt; 收敛，它也很可能不是正定的，从而使得最后估计的 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵不是正定的，这显然有违常理。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;怎么办呢？大名鼎鼎的 Newey and West estimator 闪亮登场（Newey and West 1987）！他们给出了当残差同时存在异方差和自相关时，&lt;b&gt;Q&lt;/b&gt; 的相合估计，记为 &lt;b&gt;S&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%26%5Cmathbf%7BS%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5C%7B%5Csum_%7Bt%3D1%7D%5ET+e_%7Bt%7D%5E2%5Cmathbf%7Bx%7D_t%5Cmathbf%7Bx%7D_t%27%2B%5Csum_%7Bl%3D1%7D%5EL%5Csum_%7Bt%3Dl%2B1%7D%5ET+w_le_%7Bt%7De_%7Bt-l%7D%28%5Cmathbf%7Bx%7D_t%5Cmathbf%7Bx%7D_%7Bt-l%7D%27%2B%5Cmathbf%7Bx%7D_%7Bt-l%7D%5Cmathbf%7Bx%7D_%7Bt%7D%27%29%5Cright%5C%7D%5C%5C+%5Cmbox%7Bwhere%7D%26w_l%26%3D%26%5Cdisplaystyle+1-%5Cfrac%7Bl%7D%7B1%2BL%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rrll} &amp;amp;\mathbf{S}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left\{\sum_{t=1}^T e_{t}^2\mathbf{x}_t\mathbf{x}_t&#39;+\sum_{l=1}^L\sum_{t=l+1}^T w_le_{t}e_{t-l}(\mathbf{x}_t\mathbf{x}_{t-l}&#39;+\mathbf{x}_{t-l}\mathbf{x}_{t}&#39;)\right\}\\ \mbox{where}&amp;amp;w_l&amp;amp;=&amp;amp;\displaystyle 1-\frac{l}{1+L} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这就是计量经济学中无处不在的 Newey-West 调整。&lt;/b&gt;上式中，大括号中的第一项对应仅有异方差情况下的 &lt;b&gt;S&lt;/b&gt;_0，而后面第二项则是针对自相关性的修正。其中 L 是计算自相关性影响的最大滞后阶数（Newey and West 1994 给出了自动计算 L 取值的自适应算法），w_l 是滞后期 l 的系数，其隐含的意思是自相关性的影响随着滞后期 l 的增大而减小。在实际计算时，考虑到自由度的问题，为了得到无偏估计可以将上式中大括号外面的 1/T 换成 1/(T - K)；大括号内部的求和项仍是 T 项及 L × T 项。&lt;/p&gt;&lt;p&gt;将 &lt;b&gt;S&lt;/b&gt; 代入到 &lt;b&gt;V&lt;/b&gt;_OLS 的表达式中，得到 &lt;b&gt;Newey–West autocorrelation consistent covariance estimator&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BV%7D_%7B%5Cmbox%7BOLS%7D%7D%26%3D%26%5Cdisplaystyle+T%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BS%7D%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{V}_{\mbox{OLS}}&amp;amp;=&amp;amp;\displaystyle T(\mathbf{X&#39;X})^{-1}\mathbf{S}(\mathbf{X&#39;X})^{-1} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;在时序&lt;/b&gt; &lt;b&gt;OLS 回归中，Newey-West 调整同时作用于多个&lt;/b&gt; &lt;b&gt;regressors 的回归系数&lt;/b&gt;，从而求出 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵，常见于因子分析中的 portfolio test 中，具体方法为：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用目标因子投资组合的收益率序列和（多个）已有因子收益率在时序上 OLS 回归（同时带截距项，代表超额收益部分；假设已有因子 + 截距项一共 K 个 regressors），得到残差；&lt;/li&gt;&lt;li&gt;使用截距项和已有因子收益率序列（回归中的 &lt;b&gt;X&lt;/b&gt;）和残差 &lt;b&gt;e&lt;/b&gt;，通过 Newey-West 调整求出 &lt;b&gt;V&lt;/b&gt;_OLS；&lt;/li&gt;&lt;li&gt;将 &lt;b&gt;V&lt;/b&gt;_OLS 的对角线元素开平方，其平方根就是参数 &lt;b&gt;b&lt;/b&gt; 的标准误（一共 K 个，对应 K 个 regressors）；&lt;/li&gt;&lt;li&gt;使用 &lt;b&gt;b&lt;/b&gt; 的估计和 Newey-West 调整后的标准误计算出这些参数的 t-statistics，从而判断它们的显著性。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下面来看一个例子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 一个例子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/53944793&quot; class=&quot;internal&quot;&gt;《寻找股票市场中的预期差》&lt;/a&gt;一文基于基本面和市场预期之差进行了选股。对于使用“预期差”因子构建的投资组合，该文应用一些已有因子进行了 portfolio test。假设已有因子包括 Fama and French (1993) 三因子以及 Carhart (1997) 的动量因子。这四个因子的累积收益率如下图所示。下面用这个 portfolio test 说明 Newey-West 调整。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;847&quot; data-rawheight=&quot;429&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;847&quot; data-original=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;847&quot; data-rawheight=&quot;429&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;847&quot; data-original=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上述四个因子以及一个截距项作为 regressors，对“预期差”因子的投资组合在时序上进行 OLS 回归，得到残差 &lt;b&gt;e&lt;/b&gt;。加入截距项后，&lt;b&gt;X&lt;/b&gt; 矩阵一共有 5 列 —— 第一列全是 1，对应截距；后面四列对应 4 个已有因子的收益率时间序列。使用 &lt;b&gt;X&lt;/b&gt; 和 &lt;b&gt;e&lt;/b&gt; 对进行 Newey-West 调整，计算回归系数的标准误。在计算中，使用Newey and West (1994) 自动计算滞后阶数 L：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+L%3D4%5Ctimes%5Cleft%28%5Cfrac%7BT%7D%7B100%7D%5Cright%29%5E%7B2%2F9%7D&quot; alt=&quot;\displaystyle L=4\times\left(\frac{T}{100}\right)^{2/9}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;由于实证中一共使用了 108 期月频收益率数据，因此 T = 108；由上式计算出的 L = 4。下表给出了使用经典 OLS 和使用 Newey-West 调整后得到的回归系数 standard errors 以及 t-statistics。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;285&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;778&quot; data-original=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;285&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;778&quot; data-original=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;使用 Newey-West 调整后，“预期差”选股的超额收益（α）的 t-statistic 从 3.325 上升至 4.371；HML 以及 MOM 因子的系数 β_HML 和 β_MOM 的 t-statistics 分别从 20.171 和 3.420 降低到 10.778 和 2.233。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 简化版 Newey-West 调整&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节说明了在进行时序回归的 portfolio test 中如何进行 Newey-West 调整。那么，使用截面回归的 regression test 又如何呢？&lt;/p&gt;&lt;p&gt;在因子分析中，Fama-MacBeth regression 是最常见的截面回归方法（Fama and MacBeth 1973）。在该回归中，每一期使用当期因子暴露和个股下一期的收益率进行截面回归，得到因子的收益率；在全部期进行截面回归后，便可得到每个因子收益率的时间序列。&lt;b&gt;将因子收益率在时序上取均值就得到每个因子的预期收益率，而我们关心的是该因子预期收益率是否显著不为零。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;对于任何因子，其收益率序列在时序上很可能存在异方差和自相关性，因此在计算其均值标准误的时候需要进行 Newey-West 调整。&lt;/b&gt;然而，这和上面的多因子时序回归很不相同。如何进行 Newey-West 调整呢？&lt;/p&gt;&lt;p&gt;关于这个问题，Turan Bali、Robert Engle、Scott Murray 三位所著的经典教材 Empirical Asset Pricing, the cross section of stock returns（Bali et al. 2016）给出了答案。&lt;b&gt;对于单个因子的收益率序列，将其用 1 作为 regressor 回归得到残差 —— 这相当于用因子收益率减去它在时序上的均值。&lt;/b&gt;然后把这个残差和 &lt;b&gt;X&lt;/b&gt; = &lt;b&gt;1&lt;/b&gt; 代入到 Newey-West 调整中即可。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;411&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;727&quot; data-original=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;411&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;727&quot; data-original=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;在这个简化版的 Newey-West 调整中，&lt;b&gt;Q&lt;/b&gt; 的估计 &lt;b&gt;S&lt;/b&gt; 简化为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%26%5Cmathbf%7BS%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5C%7B%5Csum_%7Bt%3D1%7D%5ET+e_%7Bt%7D%5E2%2B2%5Csum_%7Bl%3D1%7D%5EL%5Csum_%7Bt%3Dl%2B1%7D%5ET+w_le_%7Bt%7De_%7Bt-l%7D%5Cright%5C%7D%5C%5C+%5Cmbox%7Bwhere%7D%26e_t%26%3D%26f_t+-+%5Cmbox%7BE%7D_t%5Bf_t%5D%5C%5C+%26w_l%26%3D%26%5Cdisplaystyle+1-%5Cfrac%7Bl%7D%7B1%2BL%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrll} &amp;amp;\mathbf{S}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left\{\sum_{t=1}^T e_{t}^2+2\sum_{l=1}^L\sum_{t=l+1}^T w_le_{t}e_{t-l}\right\}\\ \mbox{where}&amp;amp;e_t&amp;amp;=&amp;amp;f_t - \mbox{E}_t[f_t]\\ &amp;amp;w_l&amp;amp;=&amp;amp;\displaystyle 1-\frac{l}{1+L} \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中 f_t 代表被检验因子的收益率时间序列，E_t[f_t] 是它在时序上的均值。由于我们仅仅有一个 regressor，因此上述 &lt;b&gt;S&lt;/b&gt; 其实是一个标量。将它代入到 &lt;b&gt;V&lt;/b&gt;_OLS 的表达式中，在对其开方，就得到 E_t[f_t] 的标准误：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bs.e.%7D%28%5Cmbox%7BE%7D_t%5Bf_t%5D%29%26%3D%26%5Cdisplaystyle+%5Csqrt%7B%5Cmathbf%7BS%7D%2FT%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mbox{s.e.}(\mbox{E}_t[f_t])&amp;amp;=&amp;amp;\displaystyle \sqrt{\mathbf{S}/T} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;对每个因子依次使用上述修正，获得其各自收益率均值的 standard error，然后就可以计算 t-statistic 以及 p-value 并检验它们的显著性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文介绍了计量经济学中常见的 Newey-West 估计（顺便提一句， White 1980 估计也十分流行），它们在因子回归分析中无处不在。在 portfolio test 中，通过时序回归，并应用 Newey-West 调整对多个 regressors 的回归系数的标准误同时修正；在 regression test 中，首先通过 T 期截面回归得到因子的收益率时序，然后再对该时序进行 Newey-West 调整从而得到因子预期收益率的标准误。&lt;/p&gt;&lt;p&gt;在 Barra 的因子模型中，采用 Newey-West 调整对日频因子收益率的协方差矩阵进行了修正（Briner et al. 2009, pp 25）：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1102&quot; data-rawheight=&quot;289&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1102&quot; data-original=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1102&quot; data-rawheight=&quot;289&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1102&quot; data-original=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;有必要指出的是，Barra 修正的是因子收益率的协方差矩阵，而不是因子收益率均值或者任何回归系数 β&lt;/b&gt; &lt;b&gt;的协方差矩阵。&lt;/b&gt;仔细检查上面的式子，并没有看到任何 regressor 矩阵 &lt;b&gt;X&lt;/b&gt; 或者残差向量 &lt;b&gt;e&lt;/b&gt; 的身影；以上 Barra 的用法和本文讨论的 portfolio test 和 regression test 中的 Newey-West 调整都不太一样。我对其的理解是（欢迎批评、指正），Barra 借鉴了 Newey-West 在处理 middle matrix &lt;b&gt;Q &lt;/b&gt;时引入滞后期处理自相关性的方法，将它的日频自相关矩阵 C 对标为 Newey and West (1987) 中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%A9_0&quot; alt=&quot;\hat Ω_0&quot; eeimg=&quot;1&quot;&gt; ，从而应用了 Newey and West (1987) 中的式 (5)。&lt;/p&gt;&lt;p&gt;最后，非常感谢你认真看到这里。这不是一篇 fancy 的文章，而是一篇工具文，希望它能对你有些帮助。在我自己进行 empirical asset pricing 研究时，在 portfolio test 和 regression test 时也会用到 Newey-West 调整。相信你看完本文，在今后再看到我提及它的时候，知道我干了什么。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Bali, T. G., R. F. Engle, and S. Murray (2016). &lt;i&gt;Empirical asset pricing, the cross section of stock returns.&lt;/i&gt; John Wiley &amp;amp; Sons, Inc., Hoboken, New Jersey.&lt;/li&gt;&lt;li&gt;Briner, B. G., R. C. Smith, and P. Ward (2009). &lt;i&gt;The Barra Europe equity model (EUE3)&lt;/i&gt;. Research Notes.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Greene, W. H. (2003). &lt;i&gt;Econometric Analysis (5th ed)&lt;/i&gt;. Prentice Hall, Upper Saddle River, New Jersey.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1994). Automatic lag selection in covariance matrix estimation. &lt;i&gt;Review of Economic Studies&lt;/i&gt;, Vol. 61(4), 631 – 653.&lt;/li&gt;&lt;li&gt;White, H. (1980). A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 48(4), 817 – 838.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-01-16-54913149</guid>
<pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>如果我们能正确预测基本面因子</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-01-09-54469842.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54469842&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-34c98a73840c97d45277561b5e27835b_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用历史基本面信息来预测未来的基本面，并基于预测值选股；如果能够预测准确，便可在价格修正以反映最新的基本面时获得超额收益。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;基于基本面的量化多因子选股一直是市场中研究和实践的重点，其核心逻辑是找到并配置能够预测股票未来收益率的因子。随着机器学习技术的飞速发展，越来越多的先进算法（比如各种神经网络）被用于挖掘基本面因子和股票未来收益率之间的非线性关系。&lt;/p&gt;&lt;p&gt;诚然，股票的价格和上市公司的基本面密切相关。但是在选股时，我们很难准确判断模型的有效输入。对于投资这种开放性问题，大千世界的任何信息都有可能会对决策产生影响，信息量巨大而信噪比极低。&lt;/p&gt;&lt;p&gt;如下图所示，基本面信息仅仅是现实世界全部信息的一小部分，其中还包含了大量的无用噪音甚至是虚假、错误信息。股票未来的价格反映了全部信息中的一小撮有用信息；然而具体哪些信息有用是未知的，该信息和基本面信息有交集，但后者远飞前者的全部。&lt;b&gt;直接使用基本面信息来选股（即预测股票未来的价格或收益率）将受到高信噪比的影响。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;489&quot; data-rawheight=&quot;226&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;489&quot; data-original=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;489&quot; data-rawheight=&quot;226&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;489&quot; data-original=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;此外，虽然市场上存在一些异象无法被有效市场假说（EMH）解释（它们源自行为金融学中的各种认知偏差），但 EMH 仍然在大部分时间相对有效，是主宰市场的第一范式。这就意味着最新的基本面信息已经一定程度上反映在价格之中了；再使用它们来预测未来的价格，其效果会打一定的折扣。&lt;/p&gt;&lt;p&gt;为了应对上述种种困难，学术界和业界在最近几年提出了一个新的思路（如下图所示）：&lt;b&gt;使用历史基本面信息来预测未来的基本面，并基于预测值选股；如果能够预测准确，当最新财报被公布的时候，价格发生修正以反映最新的基本面信息，使得那些提前布局的投资者获得超额收益。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;503&quot; data-rawheight=&quot;171&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;503&quot; data-original=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;503&quot; data-rawheight=&quot;171&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;503&quot; data-original=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;这种做法背后的假设是能够通过历史基本面信息预测出未来的基本面。我对此的看法是，&lt;b&gt;这绝不容易&lt;/b&gt;，但与使用历史基本面信息预测未来收益率相比，它背后的逻辑更直接、纯粹，而不像基本面和收益率之间还隔了一层。&lt;b&gt;由此可以猜想，过去和未来基本面之间的信噪比比过去基本面和未来价格之间的信噪比更高。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文的目的有如下两个：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;海外的业界基于上述思路，通过机器学习算法预测未来基本面信息、提出了&lt;b&gt;前视因子模型（Lookahead Factor Model，LFM）&lt;/b&gt;的概念。本文对这个方法进行简要介绍。&lt;/li&gt;&lt;li&gt;本文的题目中用了“如果”（if），而不是“如何”（how）。我希望首先定量探讨通过预知未来 —— 完美以及不完美的情况下 —— 能否带来超额收益。&lt;b&gt;只有这个 if 的前提成立了，以后的 how 才有意义&lt;/b&gt;（而且这个 how 也并不一定非要通过机器学习实现）。在这方面，本文基于中证 500 做一些简单实证。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下面首先来看看 Lookahead Factor Model。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Lookahead Factor Model&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2017 年，Alberg and Lipton (2017) 在 NIPS Time Series Workshop 上报告了一篇题为《Improving factor-based quantitative investing by forecasting company fundamentals》的文章。本节对它做简要介绍。&lt;/p&gt;&lt;p&gt;之所以不花太多的篇幅，是因为这毕竟不是发表在 NIPS 正会上的，而且它仅仅是一个 poster session，文章本身也很短，所以其效果的可靠性仍有待检验。但我仍希望它能给小伙伴们带来一些启发。&lt;/p&gt;&lt;p&gt;Alberg and Lipton (2017) 的研究动机是观察到，如果能够开天眼知道未来一段时间的基本面信息（包括 Book-to-Market、EBIT/EV、Net Income/EV 以及 Sales/EV 这些），并通过它们来选股，则可以在美股上获得更高的收益，且预知未来的时间越长（用 months of clairvoyance 表示）收益越高（下图）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;601&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;601&quot; data-original=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;601&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;601&quot; data-original=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以此为动机，他们使用了 Multilayer Perceptrons（MLPs）以及 Recurrent Neural Networks（RNNs）两种算法构建了预测模型，使用历史基本面信息来预测未来的基本面信息。&lt;/p&gt;&lt;p&gt;在回测中，二位作者使用了 1970 年 1 月至 2017 年 9 月 NYSE、NASDAQ 以及 AMEX 上的股票（排除了非美国的公司、金融行业公司以及超小市值公司）。模型的输入特征包括 16 个基本面变量和 4 个价格时序变量（全部是动量类的）。这 16 个基本面特征包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Revenue (TTM)；&lt;/li&gt;&lt;li&gt;Cost of good sold (TTM)；&lt;/li&gt;&lt;li&gt;SG&amp;amp;A (TTM)；&lt;/li&gt;&lt;li&gt;EBIT (TTM)；&lt;/li&gt;&lt;li&gt;Net income (TTM)；&lt;/li&gt;&lt;li&gt;Cash and cash equivalents (当季)；&lt;/li&gt;&lt;li&gt;Receivables (当季)；&lt;/li&gt;&lt;li&gt;Inventories (当季)；&lt;/li&gt;&lt;li&gt;Other current assets (当季)；&lt;/li&gt;&lt;li&gt;PP&amp;amp;E (当季)；&lt;/li&gt;&lt;li&gt;Other assets (当季)；&lt;/li&gt;&lt;li&gt;Debt in current liabilities (当季)；&lt;/li&gt;&lt;li&gt;Accounts payable (当季)；&lt;/li&gt;&lt;li&gt;Taxes payable (当季)；&lt;/li&gt;&lt;li&gt;Other current liabilities (当季)；&lt;/li&gt;&lt;li&gt;Total liabilities (当季)。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在建模时，所有特征均经过必要的标准化处理；整个回测期被分为样本内（1970 - 1999）和样本外（2000 - 2017）两部分；样本内被进一步分为 training set 和 validation set 两部分。Alberg and Lipton (2017) 使用样本内的 validation set 确定模型的超参数 —— 包括 learning rate、model architecture、objective function weighting —— 以及 early stopping criteria。&lt;/p&gt;&lt;p&gt;为了解决 RNN 容易过拟合的问题，Alberg and Lipton (2017) 特意指出他们的模型是多任务学习，同时预测 16 个基本面指标；损失函数为预测值和实际值之间的均方误差（MSE）。不过作者也指出，在全部 16 个基本面指标中，&lt;b&gt;他们最终用来选股的是 EBIT/EV，因此在损失函数中对该项赋予了更高的权重。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;实证结果显示，基于神经网络的复杂算法在样本外取得了比 naïve 算法（即使用当期数据猜下一期）更低的MSE。相比 S&amp;amp;P500 指数本身以及传统的因子选股（基于当期 EBIT/EV 选股），两个 lookahead factor models 都取得了更高的年化收益率和夏普率（下表）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;192&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;768&quot; data-original=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;192&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;768&quot; data-original=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上就是关于 Alberg and Lipton (2017) 这篇文章的简要介绍。国内的一些量化论坛基于该方法在 A 股上做了实证，感兴趣的朋友可以找来看看。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 假如开天眼&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节和下一节来回答本文关注的 if 问题。我们以中证 500 成分股为选股池，回测期为 2009 年 12 月到 2018 年 12 月，选择 Earnings per Share (EPS) 作为目标基本面因子来考察成功预测未来 EPS 能否获得超额收益。&lt;/p&gt;&lt;p&gt;首先，来看看常规做法：每月末按最新 EPS 数据选取该指标最高的 20 支股票等权配置，按月调仓，不考虑任何交易成本。该选股的效果如下。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c668433852c72a9dc3438802eb331c9e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;459&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;764&quot; data-original=&quot;https://pic3.zhimg.com/v2-c668433852c72a9dc3438802eb331c9e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c668433852c72a9dc3438802eb331c9e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;459&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;764&quot; data-original=&quot;https://pic3.zhimg.com/v2-c668433852c72a9dc3438802eb331c9e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c668433852c72a9dc3438802eb331c9e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;接下来，假设开天眼已知未来一个月的 EPS，并基于此选择 20 支 EPS 最大的股票等权配置、按月调仓。该策略的表现如下。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9582044016c12ea9364f870a106842d4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;772&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;772&quot; data-original=&quot;https://pic1.zhimg.com/v2-9582044016c12ea9364f870a106842d4_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9582044016c12ea9364f870a106842d4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;772&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;772&quot; data-original=&quot;https://pic1.zhimg.com/v2-9582044016c12ea9364f870a106842d4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-9582044016c12ea9364f870a106842d4_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;将这两个选股策略和中证 500 指数本身放在一起比较，高下立判。&lt;b&gt;无疑，EPS 本身是一个非常优秀的选股因子，而如果能预知未来 EPS 则可以获得更大的优势、更高的收益。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-33cb1b5a2a2096443799f54569dd306a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;928&quot; data-rawheight=&quot;468&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;928&quot; data-original=&quot;https://pic3.zhimg.com/v2-33cb1b5a2a2096443799f54569dd306a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-33cb1b5a2a2096443799f54569dd306a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;928&quot; data-rawheight=&quot;468&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;928&quot; data-original=&quot;https://pic3.zhimg.com/v2-33cb1b5a2a2096443799f54569dd306a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-33cb1b5a2a2096443799f54569dd306a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;发生这种现象背后的原因是什么呢？&lt;/p&gt;&lt;p&gt;下图显示了使用当期 EPS 选股时，回测期内每月平均换股的数量。其中变化最多的是五月份。这是因为上市公司需要在每年 4 月 30 日之前披露上一年的年报。因此在每年四月底，使用最新披露的 EPS 选出的股票往往较之前的选择有较大变化，这便解释了五月份的持股较四月份的持股变化最大。其他月份的股票变化和季报、中报披露以及中证 500 调整成分股有关。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;812&quot; data-original=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;812&quot; data-original=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;类似的，下图显示了使用&lt;b&gt;下个月&lt;/b&gt; EPS 选股时，每月平均换股的数量。比较这前后两张图，&lt;b&gt;其中最大的区别就是正常情况下五月份的变化提前在四月发生&lt;/b&gt;（因为我们假设在三月底就知道四月最新披露的 EPS 中最大的股票）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;907&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;907&quot; data-original=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;907&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;907&quot; data-original=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对比使用当期 EPS 选股和使用未来 EPS 选股的每月平均收益率，可以看到前面提到的这种前移带来的巨大差异。正如下图所示，&lt;b&gt;开天眼（图中 Oracle）选股的四月份收益率较正常（图中 Regular）选股的收益率有巨大提升。&lt;/b&gt;此外，开天眼选股在八月份也有巨大的提升（8 月 30 日是中报披露的截止日期）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7cb880c90b37a1f35af0c14e323068bc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;478&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;865&quot; data-original=&quot;https://pic1.zhimg.com/v2-7cb880c90b37a1f35af0c14e323068bc_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7cb880c90b37a1f35af0c14e323068bc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;478&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;865&quot; data-original=&quot;https://pic1.zhimg.com/v2-7cb880c90b37a1f35af0c14e323068bc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-7cb880c90b37a1f35af0c14e323068bc_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上结果说明，如果能准确的预测并使用未来的 EPS 选股，确实能够获得更高的收益。不幸的是，现实中我们不能开天眼。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 不完美预测能否带来提高？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第三节的结果仅仅是一个美好的愿景。在实际中，即便能够在一定程度上预测未来的 EPS（或其他基本面信息），其准确性也难以保证。&lt;b&gt;在不完美的预测下，这种努力是否能够带来超额收益呢？&lt;/b&gt;这就是本节探讨的问题。&lt;/p&gt;&lt;p&gt;以开天眼的结果作为 EPS 选股的标准答案，可以计算出使用历史 EPS 选股的错误率。从下图不难看出，由于基本面指标变动的频率较低，&lt;b&gt;在很多没有新信息披露的月份里，选股的错误率也很低，但是这并没有什么作用（这一点在构建损失函数的时候值得考虑）。起决定性作用的是错误率高的那些月份。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;423&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;423&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上一节的分析指出，使用未来 EPS 选股的优势在于提前知道年报和中报（特别是前者）中最新的 EPS，因此四月和八月贡献了巨大的超额收益。观察上图不难发现，使用历史 EPS 选股时，四月份的错误率也是全部十二个月份中最高的。下表统计了回测期内每年四月和八月使用历史 EPS 选股的错误率。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;590&quot; data-rawheight=&quot;393&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;590&quot; data-original=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;590&quot; data-rawheight=&quot;393&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;590&quot; data-original=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;由此可见，预测 EPS 的努力可以考虑以降低四月和（或）八月选股的错误率为目标。&lt;/b&gt;为了回答“不完美预测能否带来提高”这个问题，首先考虑四月为目标并按照以下逻辑进行仿真实验。&lt;/p&gt;&lt;p&gt;对于给定的正确率 c，在回测中每年的三月底从四月 EPS 最高的 20 支股票中随机选出 20 × c 支，作为预测模型正确的部分；从剩余 480 支股票中随机选出 20 × (1 - c) 支作为预测模型错误的部分；如此便完成一次选取（这是一个非常粗糙的处理方式，因为从剩余 480 支股票中随机选出的可能是 EPS 非常差的股票；实际的预测模型 —— 无论是机器学习或者其他方法 —— 应该会比这种处理好一些）。为了降低随机性的影响，在每个四月进行 100 次仿真，取它们的平均值作为正确率 c 下该预测模型的选股结果，以此考察 EPS 预测正确率和选股效果的关系。&lt;/p&gt;&lt;p&gt;下表中 Panel A 展示了四月份 EPS 预测不同正确率下选股的效果。结果表明，随着正确率的提升，收益率和夏普率逐渐增加，选股效果远强于使用当前 EPS 的表现（使用当前 EPS 的年化收益率为 6.33%；夏普率为 0.37）。同时也看到，即便是把正确率提高到 90%，其选股效果也显著弱于全部使用未来 EPS 的情况，这说明仅仅改进四月份的正确率是不够的。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-835e560b93746a8c34f3548ce7303f47_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;728&quot; data-original=&quot;https://pic4.zhimg.com/v2-835e560b93746a8c34f3548ce7303f47_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-835e560b93746a8c34f3548ce7303f47_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;728&quot; data-original=&quot;https://pic4.zhimg.com/v2-835e560b93746a8c34f3548ce7303f47_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-835e560b93746a8c34f3548ce7303f47_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上表中 Panel B 展示了同时提高四月和八月正确率的结果。随着年报和中报披露月份的同时改进，选股效果较 Panel A 中的结果进一步显著提升。当然，我们也必须注意到，&lt;b&gt;正确率的边际效应在逐渐减小&lt;/b&gt;。上述结果留给我们的启发有以下两点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;以月频进行基本面预测时，应该着重考虑年报和季报集中披露的月份的正确率；&lt;/li&gt;&lt;li&gt;正确率对选股效果提升的边际效应逐渐减弱，当对重点月份预测的正确率提高到一定水平后，可考虑提升其他月份预测的正确性。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;从实证结果来看，即便是不完美的预测也是值得尝试的。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上周的文章中提到了&lt;a href=&quot;https://zhuanlan.zhihu.com/p/53944793&quot; class=&quot;internal&quot;&gt;“预期差”&lt;/a&gt;的概念 —— 如果我们能找到市场中的预期差，便可以利用它来获得超额收益。本文提到的准确预测 EPS 其实质也是提前捕捉预期差，等待价格向价值修正。&lt;/p&gt;&lt;p&gt;想再次强调的是，针对预测基本面这个话题，本文探讨的是 if 的问题，而不是 how 的问题，并通过实证给出了预测中一些可能需要关注的地方。在 how 的问题上，希望文中介绍的 Alberg and Lipton (2017) 给大家提供一些思路。&lt;/p&gt;&lt;p&gt;在基本面的预测方面，无论采用什么方法，预测准确才是最关键的。这就是为什么优秀分析师的盈利预测（一致预期数据）是很值钱的，因为这些数据确实能够带来 α。只不过很多时候，这些 α 的成本太高了。这就给了机器学习契机。希望在未来能够看到学术界和业界在这方面的更多突破，将先进机器学习算法运用到上市公司财务数据的预测中，为低成本的获取 α 提供新的可能性。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Alberg, J. and Z. C. Lipton (2017). &lt;i&gt;Improving factor-based quantitative investing by forecasting company fundamentals.&lt;/i&gt; NIPS Time Series Workshop 2017 (&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//sites.google.com/site/nipsts2017/accepted-papers&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;sites.google.com/site/n&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ipsts2017/accepted-papers&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;), available at &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1711.04837&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;arxiv.org/pdf/1711.0483&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-01-09-54469842</guid>
<pubDate>Wed, 09 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>寻找股票市场中的预期差</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-01-03-53944793.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/53944793&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-93d047840dd702d906e91bf3bb384229_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;科学衡量基本面价值，找到市场和基本面之间的预期差，获取超额收益是值得努力的方向。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;以 P/B 为代表的价值因子在美股上长盛不衰。在 A 股上，其经济效益虽然不如美股显著，但价值因子在 empirical asset pricing 以及因子选股上的作用也不容忽视。&lt;/p&gt;&lt;p&gt;以中证 500 成分股为例，下图展示了依靠做多低 P/B（价值股）、做空高 P/B（成长股）的对冲组合的净值曲线（每月调仓、不考虑任何交易成本）。长期来看，价值股跑赢了成长股。然而，这背后的解释是什么呢？风险补偿还是错误定价？&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0070163506f967f5e2d8c24c95cc1729_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;326&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;750&quot; data-original=&quot;https://pic2.zhimg.com/v2-0070163506f967f5e2d8c24c95cc1729_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0070163506f967f5e2d8c24c95cc1729_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;326&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;750&quot; data-original=&quot;https://pic2.zhimg.com/v2-0070163506f967f5e2d8c24c95cc1729_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0070163506f967f5e2d8c24c95cc1729_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;2012 年，一篇发表于顶刊 Review of Financial Studies 上的文章（Piotroski and So 2012）回答了这个问题。&lt;b&gt;两位作者提出了预期差（expectation errors）的概念，指出价值股战胜成长股背后的原因是错误定价。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文就来聊聊这个预期差。下文的大部分篇幅将用于介绍预期差在中证 500 上的实证结果（第三、四节）。在那之前，我们首先来说明 Piotroski and So (2012) 的研究框架。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 研究框架&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;按照错误定价的解释，价值股跑赢成长股的原因是市场参与者低估了前者、高估了后者。这里的高估和低估都是价格相对于期内在价值而言的。&lt;b&gt;价格反映了投资者对股票的市场预期，而内在价值反映了股票本身的基本面预期。高、低估说明这两个预期之间存在差异，Piotroski and So (2012) 把这个差异定义为预期差。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;更进一步，Piotroski and So (2012) 认为，&lt;b&gt;价值股跑赢成长股的内在逻辑是预期差的修正&lt;/b&gt;。具体来说，他们使用一个 F-score 模型（出自 Piotroski 2000）通过 9 个指标给股票的基本面打分，以此作为股票的基本面预期。这 9 个指标从盈利能力、资本结构及偿债能力、运营效率三个维度衡量一个公司的内在价值。这些指标以及它们的打分方式如下。这 9 个指标打分的总分取值范围是 0 到 9，分数越高说明上市公司的基本面越好。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f6fe0e49b045b84157ae9c1f3f5a8954_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;610&quot; data-rawheight=&quot;352&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;610&quot; data-original=&quot;https://pic1.zhimg.com/v2-f6fe0e49b045b84157ae9c1f3f5a8954_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f6fe0e49b045b84157ae9c1f3f5a8954_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;610&quot; data-rawheight=&quot;352&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;610&quot; data-original=&quot;https://pic1.zhimg.com/v2-f6fe0e49b045b84157ae9c1f3f5a8954_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f6fe0e49b045b84157ae9c1f3f5a8954_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;另一方面，Piotroski and So (2012) 使用 P/B（原文中是 Book-to-Market ratio，即 BM）作为股票的市场预期。按照基本面预期和市场预期分别分成高、中、低三档，便构成了如下图所示的九宫格。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-af7e74f9f72db08036a842a5d3d5f2d5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;653&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;653&quot; data-original=&quot;https://pic2.zhimg.com/v2-af7e74f9f72db08036a842a5d3d5f2d5_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-af7e74f9f72db08036a842a5d3d5f2d5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;653&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;653&quot; data-original=&quot;https://pic2.zhimg.com/v2-af7e74f9f72db08036a842a5d3d5f2d5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-af7e74f9f72db08036a842a5d3d5f2d5_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;Piotroski and So (2012) 认为，对于基本面优秀的股票，市场对它们的高估值无可厚非；同理，对于基本面很差的股票，市场对它们的低预期也非常合理。这两类股票的基本面预期基本等于市场预期（不存在预期差），它们的价格已经较好的反映了其内在价值，在未来不会带来超额收益。&lt;/p&gt;&lt;p&gt;相反，当市场预期和基本面预期不一致时，就存在预期差。具体来说：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;基本面预期低（&lt;b&gt;F-score 低&lt;/b&gt;）、市场预期高（&lt;b&gt;高 P/B&lt;/b&gt;）是&lt;b&gt;被高估的成长股&lt;/b&gt;。一旦预期差修正，这些股票就会获得&lt;b&gt;负的&lt;/b&gt;超额收益；&lt;/li&gt;&lt;li&gt; 基本面预期高（&lt;b&gt;F-score 高&lt;/b&gt;）、市场预期低（&lt;b&gt;低 P/B&lt;/b&gt;）是&lt;b&gt;被低估的价值股&lt;/b&gt;。一旦预期差修正，这些股票就会获得&lt;b&gt;正的&lt;/b&gt;超额收益。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;按照 Piotroski and So (2012) 的猜想，预期差造成了错误定价；预期差的修正为常规仅依靠 P/B 大小而做多价值、做空成长的对冲组合带来了超额收益；&lt;b&gt;该组合的超额收益由这些存在预期差的价值股和成长股贡献，而非那些不存在预期差的价值股或成长股。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;针对他们提出的猜想，Piotroski and So (2012) 在美股上进行了实证。他们构建了三个对冲策略。其中 Value/Glamour Strategy 代表仅以 P/B 构建的价值、成长对冲策略；Congruent Strategy 代表使用不存在预期差的价值和成长股构建的策略；最后 Incongruent Strategy 代表使用存在预期差的价值和成长股（即市场预期 &amp;lt; 基本面预期的价值股和市场预期 &amp;gt; 基本面预期的成长股）构建的策略。这三种策略在实证中的年化收益率如下图所示：&lt;b&gt;Incongruent Strategy 远远跑赢另外两个策略；且常规 V/G 对冲策略中的收益几乎全部来自存在预期差的股票。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d96eeda4b38da1d7c0ae064ec3362eb2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;793&quot; data-rawheight=&quot;618&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;793&quot; data-original=&quot;https://pic3.zhimg.com/v2-d96eeda4b38da1d7c0ae064ec3362eb2_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d96eeda4b38da1d7c0ae064ec3362eb2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;793&quot; data-rawheight=&quot;618&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;793&quot; data-original=&quot;https://pic3.zhimg.com/v2-d96eeda4b38da1d7c0ae064ec3362eb2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d96eeda4b38da1d7c0ae064ec3362eb2_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;此外，下表给出了统计结果（重点关注圈出来的部分）。其中带预期差的 Incongruent V/G strategy 可以获得 22.64% 的年化收益率；而另一方面，不含预期差的 Congruent V/G strategy 的收益率近似为零。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ee78ce15a13193fe27e626677c0b161_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1066&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1066&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ee78ce15a13193fe27e626677c0b161_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ee78ce15a13193fe27e626677c0b161_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1066&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1066&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ee78ce15a13193fe27e626677c0b161_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4ee78ce15a13193fe27e626677c0b161_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;实证结果支持了 Piotroski and So (2012) 的猜想，说明价值股战胜成长股背后的原因是预期差造成的错误定价。下面我们以中证 500 为例在 A 股上做实证。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 中证 500 上的预期差&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;以中证 500 成分股为选股池，回测期为 2009 年 12 月到 2018 年 12 月。每月末将 P/B 最小的 150 支选为价值股；P/B 最高的 150 支选为成长股；同时，对股票按照上述 F-score 打分（由于股票增发维度的数据质量问题，我们放弃该指标，用剩余 8 个指标打分）。&lt;b&gt;在 150 支价值股中，选出 F-score 最高的 50 支作为存在预期差的价值股；在 150 支成长股中，选出 F-score 最低的 50 支作为存在预期差的成长股。&lt;/b&gt;每月调仓、等权配置，不考虑任何交易成本。&lt;/p&gt;&lt;p&gt;为了和带预期差的对冲策略比较，我们同样选出不带预期差的价值和成长股构建策略。具体的：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;将 P/B 最小的 150 支股票中 F-score 最低的 50 支选为不带预期差的价值股；&lt;/li&gt;&lt;li&gt;将 P/B 最大的 150 支股票中 F-score 最高的 50 支选为不带预期差的成长股。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;此外，我们使用 P/B 最小的 150 支股票构建常规的价值股组合；P/B 最大的 150 支股票构建常规的成长股组合。常规、预期差、以及没有预期差口径下，价值股和成长股投资组合在回测期内的表现如下表所示。该结果和 Piotroski and So (2012) 在美股上的结果相似，可以得到一致的结论：&lt;b&gt;价值股会跑赢成长股（贡献来自存在预期差的股票），而这背后的逻辑是预期差的修正。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f588be5ef3bf66999696095281a5de3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;638&quot; data-original=&quot;https://pic4.zhimg.com/v2-3f588be5ef3bf66999696095281a5de3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f588be5ef3bf66999696095281a5de3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;638&quot; data-original=&quot;https://pic4.zhimg.com/v2-3f588be5ef3bf66999696095281a5de3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3f588be5ef3bf66999696095281a5de3_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;此外，参考 Piotroski and So (2012) 的思路，使用价值股和成长股投资组合构建三个多空对冲组合：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;常规对冲组合（V/G）：做多常规价值股、做空常规成长股；&lt;/li&gt;&lt;li&gt;预期差对冲组合（Incongruent V/G）：做多存在预期差的价值股、做空存在预期差的成长股；&lt;/li&gt;&lt;li&gt;非预期差对冲组合（Congruent V/G）：做多非预期差价值股、做空非预期差成长股。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;这三个组合的风险、收益情况如下：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dcb020d6cc1771ec9d80224ea5c081e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;604&quot; data-original=&quot;https://pic1.zhimg.com/v2-dcb020d6cc1771ec9d80224ea5c081e0_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dcb020d6cc1771ec9d80224ea5c081e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;604&quot; data-original=&quot;https://pic1.zhimg.com/v2-dcb020d6cc1771ec9d80224ea5c081e0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-dcb020d6cc1771ec9d80224ea5c081e0_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;下面两张图展示了这三个策略在回测期内的净值表现和回撤情况，以及它们的月频收益率的变化。毫无疑问，预期差对冲组合（Incongruent V/G）跑赢了常规 V/G 组合以及非预期差 V/G 组合。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9d472de6b8dde2121d85b855b6f3bf60_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;856&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;856&quot; data-original=&quot;https://pic1.zhimg.com/v2-9d472de6b8dde2121d85b855b6f3bf60_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9d472de6b8dde2121d85b855b6f3bf60_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;856&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;856&quot; data-original=&quot;https://pic1.zhimg.com/v2-9d472de6b8dde2121d85b855b6f3bf60_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-9d472de6b8dde2121d85b855b6f3bf60_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d3aca9d9064e46f1555da94eff084d1f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;935&quot; data-rawheight=&quot;559&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;935&quot; data-original=&quot;https://pic4.zhimg.com/v2-d3aca9d9064e46f1555da94eff084d1f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d3aca9d9064e46f1555da94eff084d1f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;935&quot; data-rawheight=&quot;559&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;935&quot; data-original=&quot;https://pic4.zhimg.com/v2-d3aca9d9064e46f1555da94eff084d1f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-d3aca9d9064e46f1555da94eff084d1f_b.jpg&quot;&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;4 回归检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节来看看预期差对于 empirical asset pricing 是否有借鉴意义。预期差的本质是买入那些基本面过硬且便宜的股票、同时卖出基本面很差却非常昂贵的股票，因此它在 F-score 涉及的三维度上以及价值因子上均有一定的暴露。它所获取的超额收益在多大程度上会被其他因子解释呢？&lt;/p&gt;&lt;p&gt;首先来看 portfolio test。我们使用主流的因子 asset pricing 模型对 Incongruent V/G 和 Congruent V/G 投资组合进行检验，考察这两个投资组合能否获得主流因子无法解释的超额收益。在 asset pricing 模型方面，考察以下四个：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;CAPM 模型：&lt;/b&gt;仅考虑 MKT 市场因子；&lt;/li&gt;&lt;li&gt;&lt;b&gt;三因子模型：&lt;/b&gt;参照 Fama and French (1993) 考察 MKT，HML 以及 SMB 三因子；&lt;/li&gt;&lt;li&gt;&lt;b&gt;四因子模型：&lt;/b&gt;在 Fama-French 三因子基础上加上 Carhart (1997) 的 MOM 动量因子；&lt;/li&gt;&lt;li&gt;&lt;b&gt;五因子模型：&lt;/b&gt;在上述四因子模型的基础上，加上 Fama and French (2015) 中的 RMW 因子。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;对于 MKT 因子，我们选择中证 500 本身的月频收益率。其他风格因子的构建方法为：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;HML：&lt;/b&gt;做多 P/B 最小的 150 支，做空 P/B 最大的 150 支，每月调仓；&lt;/li&gt;&lt;li&gt;&lt;b&gt;SMB：&lt;/b&gt;做多市值最小的 250 支，做空市值最大的 250 支，每月调仓；&lt;/li&gt;&lt;li&gt;&lt;b&gt;MOM：&lt;/b&gt;做多过去 12 个月到过去 1 个月之间收益率最高的 150 支，做空过去 12 个月到过去 1 个月之间收益率最低的 150 支，每月调仓；&lt;/li&gt;&lt;li&gt;&lt;b&gt;RMW：&lt;/b&gt;因子为经营利润 TTM 与市值的比值，做多该因子最大的 150 支，做空该因子最小的 150 支，每月调仓。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;依次使用不同的 asset pricing 模型，portfolio tests 的结果如下：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d1a5bb45286a9ef821eb2bfee25a29cb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;692&quot; data-rawheight=&quot;396&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;692&quot; data-original=&quot;https://pic4.zhimg.com/v2-d1a5bb45286a9ef821eb2bfee25a29cb_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d1a5bb45286a9ef821eb2bfee25a29cb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;692&quot; data-rawheight=&quot;396&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;692&quot; data-original=&quot;https://pic4.zhimg.com/v2-d1a5bb45286a9ef821eb2bfee25a29cb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-d1a5bb45286a9ef821eb2bfee25a29cb_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;结果表明，随着解释因子个数的增多，这两个投资组合获取超额收益的能力逐渐减弱，但&lt;b&gt;我们仍然能在预期差 V/G 组合中观察到因子无法解释的正 α、并在非预期差 V/G 组合中观察到因子无法解释的负 α。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;再来看看 regression test。具体的，我们把预期差作为一个解释变量，使用 Fama-MacBeth regression（Fama and MacBeth 1973）考察其对个股收益率截面差异的解释力度。为了排除其他因子的影响，下面考虑三个模型：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;模型一考虑市场因子、Size 因子（对数市值）、P/B 因子以及预期差因子；&lt;/li&gt;&lt;li&gt;模型二在模型一的基础上，增加动量 MOM 因子；&lt;/li&gt;&lt;li&gt;模型三在模型二的基础上增加利润因子。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在因子载荷（factor loading）方面，对于市场因子，我们借鉴 Barra 的做法，假设中证 500 成分股在其上的载荷均为 1；对于除预期差之外的风格因子，使用个股在该因子上当期的取值为因子载荷；对于预期差因子，那些存在预期差的价值股在该因子上载荷为 1、那些存在预期差的成长股在该因子上的载荷为 -1、其余股票在该因子上的载荷为 0。对于除预期差外的其他风格因子，对左右各 1% 的极值进行 winsorization  处理；最后对全部风格因子进行标准化。&lt;/p&gt;&lt;p&gt;在月频的每一期，使用当期因子载荷和下个月个股的收益率进行截面回归，得到对应的因子收益率。在所有时间点进行截面回归后就得到每个因子收益率的时间序列，从而可以计算因子收益率的显著性。结果如下表所示。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-05def623847f6119de08157ba13839a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;565&quot; data-rawheight=&quot;500&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;565&quot; data-original=&quot;https://pic3.zhimg.com/v2-05def623847f6119de08157ba13839a6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-05def623847f6119de08157ba13839a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;565&quot; data-rawheight=&quot;500&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;565&quot; data-original=&quot;https://pic3.zhimg.com/v2-05def623847f6119de08157ba13839a6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-05def623847f6119de08157ba13839a6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;在模型一和模型二中，预期差因子对于个股预期收益率截面差异的显著性在 5% 以下。然而，随着利润因子的加入，预期差因子的解释力度的显著性水平仅仅为 10% 以下，说明其解释力度下降。这说明预期差因子（本实证中使用的方法）和利润因子之间存在一定的相关性。&lt;/p&gt;&lt;p&gt;&lt;b&gt;本节的回归分析说明，预期差因子确实能够获得一定的超额收益。然而，它和一些已有的因子之间存在一些相关性，因此并不是一个非常有效的定价因子。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文介绍了 Piotroski and So (2012) 提出的预期差的概念，并花了大量的篇幅介绍在中证 500 上的实证结果。研究表明，该现象也存在于中证 500 的成分股之间。这对于选股乃至资产定价提供了新的思路。&lt;/p&gt;&lt;p&gt;在 Piotroski and So (2012) 这篇文章中，除了预期差能带来超额收益这个假设外，两位作者还用数据证实了另一个猜想，即&lt;b&gt;存在预期差的股票在未来的盈余公告窗口内有更显著的收益（正或负），以及分析师在这些股票上的预测误差更大、对它们的预期修正也更大。&lt;/b&gt;这都表明预期差是由投资者的反应不到位造成的 —— &lt;b&gt;对于价值股，即便是它们的基本面优秀，投资者也过度悲观；对于热门成长股，哪怕是它们基本面很差，投资者也过度乐观。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文的侧重点在于对中证 500 上的实证，对于预期差背后的投资者非理性行为并没有过多的解释。在这方面，推荐感兴趣的朋友进一步阅读&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMjM5NzU3MDc1MA%3D%3D%26mid%3D2455722579%26idx%3D1%26sn%3De410e3dfa5bcacab0bd48a90bc7ddc86%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《投资中的预期差(Expectation Errors) - 价值投资和成长投资》&lt;/a&gt;这篇文章，该文对预期差背后的成因做了大量分析，并在美股上进行了实证（顺便打个 call，这是我非常喜欢的一个公众号，该文作者徐杨我也很佩服，我写作本文的最大启发也正是该文）。&lt;/p&gt;&lt;p&gt;最后想要指出的是，本文的实证中使用了 F-score 是为了尽量在 A 股上复现 Piotroski and So (2012) 的发现。在实际中，该模型也未必就是最适合 A 股的模型；如何更好的衡量股票的内在价值也是见仁见智。但无论如何，定量、科学的衡量基本面价值，找到预期差，获取超额收益都是值得努力的方向。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A five-factor asset pricing model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Piotroski, J. D. (2000). Value investing: the use of historical financial statement information to separate winners from losers. &lt;i&gt;Journal of Accounting Research&lt;/i&gt;, Vol. 38, 1 – 41.&lt;/li&gt;&lt;li&gt;Piotroski, J. D. and E. C. So (2012). Identifying expectation errors in value/glamour strategies: a fundamental analysis approach. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 25(9), 2841 – 2875.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-01-03-53944793</guid>
<pubDate>Thu, 03 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>实证研究 —— A 股上显著的风格因子</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-12-18-52693884.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52693884&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b80a439ebb0ff3963427c2528a7095a0_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文检验了 A 股市场上主流风格因子的显著性。以中证 500 指数为例，显著的风格因子包括 beta、earnings yield 以及 liquidity。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上周的&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52221111&quot;&gt;《解释股票截面预期收益差异的独立因子》&lt;/a&gt;一文介绍了 Review of Financial Studies 上发表的 Green, Hand and Zhang (2017) 一文（以下称 GHZ）。该文使用 Fama-MacBeth regression（Fama and MacBeth 1973）同时检验了 94 个美股上的因子，并发现了 12 个能够解释股票预期收益率截面差异的显著因子。&lt;/p&gt;&lt;p&gt;本文按照 GHZ 的思路对 A 股上的风格因子进行简单实证，看看到底哪些因子是显著的。为了使实证结果更有指导价值，本文选用中国市场上主流的风格因子进行讨论。在针对 A 股的因子研究中，MSCI 旗下的 Barra 大概是最知名的 —— 这主要因为它家 marketing 做的比较好；比如 MSCI 在今年 8 月底在北京、深圳、香港三地同时高调发布了最新的中国模型 CNE6。除了 MSCI 之外，国内也有一些优秀的风险因子数据提供商，这些本土化的风格因子模型由于更接地气，也广泛被市场认可。&lt;/p&gt;&lt;p&gt;根据 GHZ 提出的方法，检验显著因子的过程包括如下步骤：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;通过在每一期进行截面回归得到所有风格因子收益率的时间序列（即 Fama-MacBeth regression）；&lt;/li&gt;&lt;li&gt;对每个因子，求出收益率的均值以及均值的标准误；&lt;/li&gt;&lt;li&gt;计算每个因子的 t-statistic 以及 p-value；&lt;/li&gt;&lt;li&gt;由于 multiple testing（即同时检验多个因子）的影响，对 p-value 进行修正；&lt;/li&gt;&lt;li&gt;根据修正后的 p-value 是否小于 0.05 判断显著的因子。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下面以中证 500 成分股为例，分析风格因子在其上的显著性。行文将逐一说明上述步骤。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 因子收益率&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;在因子显著性检验中，最重要的无疑是获得靠谱的因子收益率时序数据。&lt;/b&gt;在实证中，我们采用米筐科技（RiceQuant，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52668646&quot;&gt;介绍请点这里&lt;/a&gt;）提供的因子收益率数据。作为国内领先的量化投资数据和解决方案提供商，米筐高质量的风险因子模型一共包括 39 个因子，其中市场联动因子 1 个，申万一级行业因子 28 个，风格因子 10 个。此外，为了更好的捕捉风格因子在不同指数上表现的差异，米筐提供了以常用指数（包括沪深 300、中证 500、中证 800）的成分股以及全市场为股票池的因子收益率数据。&lt;/p&gt;&lt;p&gt;实证的回测期从 2010 年 1 月 1 日到 2018 年 11 月 30 日。这 10 个风格因子包括：beta、 book-to-price、earnings yield、growth、leverage、liquidity、momentum、nonlinear size、residual volatility 以及 size。这些风格因子事实上是 10 大类因子，每一大类内部又有进一步的细分因子。这 10 大类因子间进行了必要的正交化处理，相关性较低。本文的实证使用这 10 大类因子，而非更细分的小因子。&lt;/p&gt;&lt;p&gt;在计算因子收益率时，该模型使用全部 39 个因子在每一期进行截面回归（即 Fama-MacBeth regression），保证了得到的风格因子投资组合是这些因子的&lt;b&gt;纯因子组合&lt;/b&gt;，从而排除对别的因子的暴露、更好的评价目标因子获取超额收益的效果。在实证的回测期内，中证 500 指数上因子日频收益率如下所示。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-db3c53e376c84d67c1af312f95f40dde_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;857&quot; data-rawheight=&quot;303&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-db3c53e376c84d67c1af312f95f40dde&quot; data-watermark-src=&quot;v2-7e03330d91d08e46792ac4786283f9f9&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;有了收益率的时间序列，我们接下来计算收益率均值和均值的标准误。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 收益率均值和均值的标准误&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在 GHZ 这篇文章中，检验美股上有效因子的频率是月频。而我们使用的因子收益率是日频 —— 因为该模型最重要的是对风险建模。为了在 A 股上复现 GHZ 的研究思路，我们先进行必要的处理，计算月频因子收益率的期望以及标准误。&lt;/p&gt;&lt;p&gt;&lt;b&gt;对于收益率，使用每个月内所有交易日的累积收益率作为该因子的月频收益率。对月频收益率在时序上取均值就得到期望收益率，记为&lt;/b&gt; μ&lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了计算收益率均值的 standard error，首先需要求出月频收益率的标准差（standard deviation）。为此，本文借鉴 Barra 的处理方法，即计算日频收益率的标准差，并将其推广到月频。&lt;/p&gt;&lt;p&gt;在计算日频收益率的标准差时，必须要主要到&lt;b&gt;因子收益率在时间序列上存在很强的自相关性，这会影响收益率标准差的计算。&lt;/b&gt;以 beta、book-to-price、earnings yield 以及 growth 四个因子为例，下图显示了其因子收益率的自相关系数随滞后期的变化。每个图中阴影部分为 5% 的置信区间。&lt;b&gt;在很大的滞后期范围内，日频因子收益率均存在显著的自相关性。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dbb4e38964ae2252eb77741627c97f77_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;973&quot; data-rawheight=&quot;738&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-dbb4e38964ae2252eb77741627c97f77&quot; data-watermark-src=&quot;v2-5b54326180af43dbb406ca515877c44d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;由于上述原因，在使用因子收益率时间序列计算其标准差时，必须考虑对时序相关性进行修正。为此，我们采用 Newey-West 调整（Newey and West 1987），在调整中选择的最大滞后期为 50。令  &lt;equation&gt;s_d&lt;/equation&gt;  表示经 Newey-West 调整后的日频因子收益率的标准差（为了简化表达式，省略了表示具体某个因子的下标）。&lt;/p&gt;&lt;p&gt;在得到日频标准差之后，假设每个月内有 22 个交易日并通过下式得到月频因子收益率的标准差 s：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle s = \sqrt{22} s_d&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;最后，使用月频因子收益率的标准差计算出因子收益率&lt;b&gt;均值&lt;/b&gt;的 &lt;b&gt;standard error&lt;/b&gt;（n 表示月频期数）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{s.e.}(\mu)=\frac{s}{\sqrt{n}}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;通过上述处理就可以求出我们关心的变量，月频因子期望收益率 μ 和它的标准误 s.e.(μ)。实证中，中证 500 指数上这10个风格因子的 μ 和 s.e.(μ) 分别如下表所示。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-351ed43974f004a1cfbb628a368e73f2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;641&quot; data-rawheight=&quot;395&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-351ed43974f004a1cfbb628a368e73f2&quot; data-watermark-src=&quot;v2-43d8226fcae6dac3abfc6e24581aadd9&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;下面就来计算 t-statistic 以及 p-value。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 t-statistic 和 p-value&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;有了 μ 和 s.e.(μ)，根据 t-statistic 的定义有：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{t-statistic}=\frac{\mu}{\mbox{s.e.}(\mu)}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;由于月频期数超过 100，因此 t 分布和正态分布十分接近，故采用正态分布将上述 t-statistic 转化为 p-value。&lt;/p&gt;&lt;p&gt;&lt;b&gt;就一个因子是否显著来说，我们关注的是它的 t-statistic 是否显著不为零，其具体取值可正可负。&lt;/b&gt;从选股的角度来说，如果一个因子的收益率显著为负，那么只需要将它的多、空对调过来使用即可。因此，依照 GHZ 的计算方法，本文计算双尾 p-value。具体的，由 t-statistic 计算 p-value 的方法如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{p-value}= \left\{\begin{array}{rll} 2\times (1-\Phi(\mbox{t-statistic})),~~\mbox{if t-statistic} \ge 0\\ 2\times \Phi(\mbox{t-statistic}),~~\mbox{if t-statistic} &amp;lt; 0 \end{array}\right. &lt;/equation&gt; &lt;/p&gt;&lt;p&gt;上式中，Φ 表示标准正态分布的累积密度函数。中证 500 上 10 个风格因子的 t-statistic 及 p-value 分别为：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1da84fc7c7292346461c2486263df61b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;655&quot; data-rawheight=&quot;396&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1da84fc7c7292346461c2486263df61b&quot; data-watermark-src=&quot;v2-269b48f58d90b74f0c1b04d852cdf0bf&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;5 修正 p-value&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在检验因子时，multiple testing —— 同时检验很多因子并找到其中最显著的 —— 是一个严重的问题。&lt;b&gt;为了正确评价因子是否显著，必须考虑 multiple testing 的影响、修正原始的 p-value。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;常见的修正方法分为两类：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;以控制 family-wise error rate（族错误率）为目标的 Bonferroni 和 Holm 修正；&lt;/li&gt;&lt;li&gt;以控制 false discovery rate 为目标的 BHY 修正。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;Family-wise error rate（FWER）和 false discovery rate（FDR）代表着 Type I error 的两个不同的定义。&lt;/b&gt;Type I error 是错误的拒绝原假设，也叫 false positive 或 false discovery。&lt;b&gt;在我们的上下文中，它意味着错误的发现了一个其实没用的因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;假设 K 个因子的 p-value 分别为  &lt;equation&gt;p_1&lt;/equation&gt; 、 &lt;equation&gt;p_2&lt;/equation&gt; 、…、 &lt;equation&gt;p_K&lt;/equation&gt; 。根据事先选定的显著性水平，比如 0.05，其中 R 个因子在单因子测试中被认为是显著的。换句话说，我们有 R 个发现（discoveries） —— 包括 true discoveries 和 false discoveries。令 &lt;equation&gt;N_r ≤ R&lt;/equation&gt; 代表 false discoveries 的个数。FWER 和 FDR 的定义如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\begin{array}{rll} \mbox{FWER}&amp;amp;=&amp;amp;\mbox{prob}(N_r\ge 1)\\ \mbox{FDR}&amp;amp;=&amp;amp;\mbox{E}[N_r/R] \end{array}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;从定义不难看出，&lt;b&gt;FWER 是至少出现一个 false discovery 的概率，控制它对围绕单一因子的假设来说是相当严格的，会大大提升 Type II Error。&lt;/b&gt;相比之下，&lt;b&gt;FDR 控制的是 false discoveries 的比例，它允许 &lt;/b&gt;&lt;equation&gt;N_r&lt;/equation&gt;&lt;b&gt; 随 R 增加，是一种更温和的方法。&lt;/b&gt;此外，BHY 方法对检验统计量之间的相关性不敏感，它的适应性更强。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论采用哪种方法，修正后的 p-value 通常大于单一因子测试中得到的 p-value，因此会有相当一部分在单一检验中存活下来的因子在修正后不再显著。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;依照 GHZ 使用的方法，本文采用 BHY 修正（Benjamini and Hochberg 1995, Benjamini and Yekutieli 2001）。它从诸多因子的原始 p-value 中最大的一个开始逆向修正，公式如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;p_i^{\mbox{BHY}}=\left\{ \begin{array}{lll} p_K&amp;amp;\mbox{if}&amp;amp;i=K\\ \min\left\{p_{i+1}^{\mbox{BHY}},\displaystyle\frac{K\times c(K)}{i}p_i\right\}&amp;amp;\mbox{if}&amp;amp;i\le K-1 \end{array} \right.&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle c(K)=\sum_{j=1}^K\frac{1}{j}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;由定义可知，原始 p-value 最大的因子调整后的 BHY p-value 就是它自己。从第二大 p-value 开始，依次按照上述公式计算，计算其他因子调整后的 BHY p-value。在中证 500 的例子中，这 10 个因子经调整后的 p-value 分别如下所示（&lt;b&gt;红色标注出了调整后 p-value 小于 0.05 的显著因子&lt;/b&gt;）；作为比较，同时给出了原始 p-value。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-17681bebd4d6910b8ec8f075da361171_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;641&quot; data-rawheight=&quot;393&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-17681bebd4d6910b8ec8f075da361171&quot; data-watermark-src=&quot;v2-f252f76ac98ba92a705a1b8c409712fe&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;不难发现，&lt;b&gt;所有因子调整后的 p-value 均不小于原始 p-value。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 显著风格因子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文第 2 到第 5 小结的分析最终&lt;b&gt;在中证 500 上发现了三个显著因子： beta、earnings yield 以及 liquidity；而其他七个风格因子均无法独立解释中证 500 成分股预期收益率的截面差异。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;把这 10 个风格因子的累积收益率作图如下。可以看到，这三个因子（liquidity 需要多、空对调过来用）的效果确实强于其他七个因子。在使用了纯因子模型（Fama-MacBeth regression）并考虑了 multiple testing 带来的修正之后，人们熟知的 book-to-price、size 以及 residual volatility 等因子在中证 500 上则不再显著。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2adceed05dc00764292f57f026501e0e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1340&quot; data-rawheight=&quot;613&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2adceed05dc00764292f57f026501e0e&quot; data-watermark-src=&quot;v2-5f95e92f9f873465ed10e98911008a18&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;除了中证 500 指数外，米筐还提供沪深 300、中证 800 以及全市场上的风格因子收益率。最终，按照上述检验思路可以计算出不同选股池上的显著因子，结果如下。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ce4947e61da358555ed490c7dfea145e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;779&quot; data-rawheight=&quot;437&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ce4947e61da358555ed490c7dfea145e&quot; data-watermark-src=&quot;v2-8a96f659367b1f44aab95d385aa007fb&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;7 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文使用 GHZ 的方法检验了 A 股市场上主流的 10 大风格因子的显著性。跨市场而言，显著的因子包括 beta、earnings yield、liquidity、nonlinear size 以及 residual volatility；但这些风格因子在不同指数上的效果也有所差别。&lt;/p&gt;&lt;p&gt;需要说明的是，无论是 Barra 的中国股票模型，还是本土化的优秀因子模型，它们首先都是一个风险模型，其次才是也可以当作收益率截面模型来用。&lt;b&gt;这些模型最重要的作用是波动率预测和投资组合的风险归因。&lt;/b&gt;本文主要的目的是再次梳理检验因子显著性的流程，实证中涉及的这 10 大类因子未必就是最能捕捉 A 股市场上 asset pricing 机制的因子。感兴趣的小伙伴可以尝试更细分的因子。只不过在 multiple testing 的修正下，我们预期很多因子仅仅是“看上去很美”。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Benjamini, Y. and Y. Hochberg (1995). Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing. &lt;i&gt;Journal of the Royal Statistical Society&lt;/i&gt;, Series B, Vol. 57, 289 – 300.&lt;/li&gt;&lt;li&gt;Benjamini, Y. and D. Yekutieli (2001). The Control of the False Discovery Rate in Multiple Testing under Dependency. &lt;i&gt;Annals of Statistics&lt;/i&gt;, Vol. 29, 1165 – 1188.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Green, J., J. R. M. Hand, and X. F. Zhang (2017). The characteristics that provide independent information about average U.S. monthly stock returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(12), 4389 – 4436.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-12-18-52693884</guid>
<pubDate>Tue, 18 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>解释股票截面预期收益差异的独立因子</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-12-12-52221111.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52221111&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5dbd0c611d939a44b1db5a4f8c3e896d_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Green, Hand and Zhang (2017) 通过 Fama-MacBeth 回归同时检验了 94 个因子，发现其中 12 个是显著的。他们的研究方法对于 A 股的因子投资实践有很大的价值。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在发表偏差（&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot;&gt;publication bias&lt;/a&gt;）的驱使下，多重检验（multiple testing）已经成为学术界在进行 asset pricing 时的普遍做法。然而，很多发表于顶级期刊的所谓能够解释股票截面预期收益差异的因子都是虚假发现（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;）。针对这个问题，2011 年，前美国金融协会主席 John Cochrane 教授在主席演讲中向学术界提出挑战 —— &lt;b&gt;到底哪些因子能独立解释股票预期收益截面差异？&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e4f6b7a2d06052cc37d5500f8a487286_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1068&quot; data-rawheight=&quot;542&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e4f6b7a2d06052cc37d5500f8a487286&quot; data-watermark-src=&quot;v2-6318ccfd3ff919a65cf320f647e667e3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;2017 年，一篇发表于顶刊 Review of Financial Studies 上的文章通过使用 Fama-MacBeth Regression （Fama and MacBeth 1973）同时检验 94 个学术界发表的异象回答了这个问题（Green, Hand and Zhang 2017，下文记为 GHZ）。&lt;/p&gt;&lt;p&gt;事实上，这并不是学术界就此问题的唯一尝试。比如，Harvey and Liu (2018) 提出了一个基于回归的框架来排除运气的成分以便检验真正有效的因子。不过 Harvey and Liu (2018) 这篇文章的核心内容是介绍他们提出的方法而非实证结果。而 GHZ 的研究指出了美股上真正有效的因子，具有更高的实证价值。无论是这些因子还是 GHZ 使用的方法对 A 股都有不小的借鉴意义。&lt;/p&gt;&lt;p&gt;本文就来介绍 GHZ 这篇论文。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 数据和因子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在研究中，GHZ 利用了 CRSP，Compustat 以及 I/B/E/S 数据库的数据首先挑选出了 102 个因子，回测时间是 1980 年 1 月到 2014 年 12 月，频率为月频。回测期之所以从 1980 年开始是由上市公司基本面数据的可得性决定的；同时包含 NYSE、AMEX 以及 NASDAQ 的上市公司。&lt;/p&gt;&lt;p&gt;除此之外，&lt;b&gt;GHZ 的特别之处是考虑了微小市值公司对评价因子有效性时的影响。&lt;/b&gt;为此，他们将所有股票根据市值分成三挡：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;市值超过中位数的股票为大市值组；&lt;/li&gt;&lt;li&gt;市值在中位数和 20% 分位数之间的为小市值组；&lt;/li&gt;&lt;li&gt;市值在 20% 分位数之下的为微小市值（microcap）组。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;微小市值的这些股票的市值之和仅占所有股票总市值的 3%。为了避免回归分析时对它们过度加权，GHZ 采取了两种回归方法：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;对所有股票采用市值加权最小二乘法（VWLS）；&lt;/li&gt;&lt;li&gt;对前两组的股票（即所有股票中排除微小市值组）采取普通最小二乘法（OLS）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;作者认为上述两种方法能够更合理的找到有效因子，并通过合并这两种回归的结果确定最终的显著因子。作为比较 —— 同时也是为了说明过度加权微小市值股票的危害 —— GHZ 也同样对所有的股票进行了 OLS 回归。不出意外，由于微小市值股票存在造成的偏误，这种方法能够发现更多的“有效”因子，但很多因子在非微小市值股票上并不显著。&lt;/p&gt;&lt;p&gt;在进行多因子同时回归时，因子间的共线性是必须考虑的问题。&lt;b&gt;共线性会造成因子收益率标准误（standard error）的巨大误差，从而无法有效的评价因子是否显著&lt;/b&gt;（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41993542&quot;&gt;《为什么要进行因子正交化处理?》&lt;/a&gt;）。GHZ 使用 variance inflation factors（VIF）对因子进行了初步筛选，并剔除了 8 个 VIF 高于 7 的因子（下图），最终从 102 个因子中选出了 94 个待评价的因子。这 94 个因子的平均相关系数为 0.07。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4790a1bdd7bbf4ba2a6203196c0f1d95_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;719&quot; data-rawheight=&quot;693&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4790a1bdd7bbf4ba2a6203196c0f1d95&quot; data-watermark-src=&quot;v2-2517734c1f1a71d60b296b93fde6ef84&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;同时检验 94 个因子属于 multiple testing 的问题。&lt;b&gt;为避免过拟合，GHZ 对回归分析得到的单个因子 p-value 进行了以控制 false discovery rate为目标的调整&lt;/b&gt;，具体使用的方法为 BHY 修正（Benjamini and Yekutieli 2001，见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;）。&lt;b&gt;GHZ 以调整后的 p-value 小于 0.05 作为因子显著的准则。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;除了调整后的 p-value 之外，GHZ 也同时计算了每个因子的 t-statistic。Harvey et al. (2016) 指出由于 multiple testing 的问题，单个因子的 t-statistic（的绝对值）至少要大于 3 才可能显著。GHZ 也以此为显著性准则汇报了显著性因子的个数。&lt;b&gt;该准则比调整后 p-value 小于 0.05 要弱一些，因此找到了更多的因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面就来看看实证结果。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 单个因子检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在同时对 94 个因子进行检验之前，GHZ 首先对每个因子进行了单独检验。&lt;b&gt;作者这么做的目的是希望通过单独检验和共同检验分别找出显著性的因子，以此比较这两种方法找到的因子是否一致，这可能会对未来的 asset pricing 研究带来一些启发和灵感。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在单个因子检验中，截面回归方程的左侧是个股的收益率，右侧是目标因子和其他控制变量。根据有无控制变量，单个因子的检验一共有以下四个版本：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;仅有单个目标因子，无其他控制变量；&lt;/li&gt;&lt;li&gt;除了单个目标因子外，还包括四因子模型（Fama and French 1993 的三因子 + Carhart 1997 的动量因子）；&lt;/li&gt;&lt;li&gt;除了单个目标因子外，还包括 Fama-French 五因子模型（Fama and French 2015）;&lt;/li&gt;&lt;li&gt;除了单个目标因子外，还包括 Hou et al. (2015) 的因子模型。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;对每一个版本，通过在每期用因子暴露和下一期的个股收益率截面回归得到因子收益率，然后使用因子收益率的时序对因子显著性进行分析，计算得到调整后的 p-value 以及 t-statistic，使用 p-value 是否小于 0.05 或 t-statistic 绝对值是否大于 3.0 为基准决定真正显著的独立因子。在回归时，考虑了本文前一节提到的三种方法 —— 对所有股票进行 VWLS，对非微小市值股票进行 OLS，以及（作为“反面教材”的）对所有股票进行 OLS。为了方便在下文中介绍结果，将前两种回归称为 GHZ 回归。&lt;/p&gt;&lt;p&gt;单个因子检验的结果如下（由于 94 个因子太多，故节选部分）：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e5dbf7d38855c18e9314266aa9ffeaa5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;880&quot; data-rawheight=&quot;616&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e5dbf7d38855c18e9314266aa9ffeaa5&quot; data-watermark-src=&quot;v2-762892428cb65c013870490d7c9b9ab1&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上图中最重要的部分是红色标记的地方 —— 即使用调整后 p-value 小于 0.05 为基准确定的显著因子个数。在没有控制变量的模型中（column A），GHZ 回归一共找到了 12 个显著因子；作为对比，由于微小市值股票的影响，对所有股票的 OLS 回归发现了 30 个显著因子。这说明 18 个因子在非微小市值股票上是无效的。其他带控制变量的回归（columns B to D）也有类似的结果。&lt;/p&gt;&lt;p&gt;在没有控制变量的模型中，&lt;b&gt;通过单个因子回归分析发现的显著因子包括：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;总资产增长率&lt;/b&gt;（asset growth）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;经行业调整的销售收入增长率&lt;/b&gt;（growth in industry-adjusted sales）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;流通股本变动百分比&lt;/b&gt;（growth in shares outstanding）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;存货变动&lt;/b&gt;（growth in inventory）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;盈余公告宣告收益&lt;/b&gt;（earnings announcement return）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;账面价值增长率&lt;/b&gt;（growth in book value of equity）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;资本支出增长率&lt;/b&gt;（growth in CAPEX）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;长期净营运资产增长率&lt;/b&gt;（growth in long-term net operating assets）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;机器设备厂房存货增长率&lt;/b&gt;（growth in PP&amp;amp;E plus inventory）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;盈利同比增长的季度数&lt;/b&gt;（number of consecutive quarters with earnings higher than the same quarter a year ago）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;销售收入与存货差的增长率&lt;/b&gt;（growth in sales less growth in inventory）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;标准化的未预期盈余&lt;/b&gt;（standardized unexpected quarterly earnings）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;以上通过单个检验从 94 个发表于学术期刊的显著因子中选出了 12 个，这些因子是经过 multiple testing 调整后仍然有效的。下面就来看看对这 94 个因子同时回归会得到怎样的结果。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 多个因子共同检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在共同检验时，GHZ 将所有 94 个因子同时放入回归方程的右侧，进行 Fama-MacBeth regression。和上一节一样，仍然使用三种回归方法。结果（节选）如下：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-94cd6d37bec78c10687e199f0d47d02b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;689&quot; data-rawheight=&quot;654&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-94cd6d37bec78c10687e199f0d47d02b&quot; data-watermark-src=&quot;v2-bef61ff1a938aba06685e76ded8e1d9c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;根据 p-value 基准，在对所有股票进行 VWLS 时，一共发现了 6 个显著因子；在对非微小市值股票进行 OLS 回归时，一共发现了 9 个显著因子。将这两个回归的结果合并一共得到 12 个显著因子。与之相对应的是，在对所有股票进行 OLS 回归时，由于微小市值的影响，一共发现了 23 个显著因子。&lt;/p&gt;&lt;p&gt;&lt;b&gt;把 94 个因子共同检验也发现了 12 个显著因子，它们是：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;账面市值比&lt;/b&gt;（book-to-market）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;现金&lt;/b&gt;（cash）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;分析师数量的变化&lt;/b&gt;（change in the number of analysts）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;盈余公告宣告收益&lt;/b&gt;（earnings announcement return）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;一个月的动量&lt;/b&gt;（1-month momentum）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;六个月动量的变化&lt;/b&gt;（change in 6-month momentum）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;盈利同比增长的季度数量&lt;/b&gt;（number of consecutive quarters with earnings higher than the same quarter in a year ago）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;年度研发支出占市值的比重&lt;/b&gt;（annual R&amp;amp;D to market cap）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;收益波动性&lt;/b&gt;（return volatility）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;股票换手率&lt;/b&gt;（share turnover）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;股票换手率的波动性&lt;/b&gt;（volatility of share turnover）；&lt;/li&gt;&lt;li&gt;&lt;b&gt;零交易的天数&lt;/b&gt;（zero trading days）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;虽然上一节的单一因子检验和本节的共同检验碰巧都发现了 12 个因子，但是仔细比较不难看出&lt;b&gt;两种方法找到的显著因子中大部分并不相同。&lt;/b&gt;根据 McLean and Pontiff (2016) 对因子分类的定义，在单一因子检验中，10 个显著的因子都是基本面因子；而在共同检验时，仅有盈利同比增长的季度数量属于基本面因子，剩余更多的是交易行为因子。&lt;/p&gt;&lt;p&gt; 上述两种检验结果为今后的 asset pricing 传递出两个重要信息：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;在排除了微小市值对回归造成的偏误以及修正了多重检验的数据挖掘之后，真正显著的因子个数很少；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;在 asset pricing 的研究中，在分析一个潜在异象时，应该选择共同检验发现的这些显著因子作为控制变量来进行研究。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;5 样本外投资组合收益分析&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在前两节的研究中，这些显著的因子是在整个回测期（1980 到 2014）期间发现的。它们也许对 asset pricing 有帮助，但是上述结果无法说明它们在实战中是否有交易的价值 —— &lt;b&gt;我们不能回到过去交易这些在事后被证明有效的因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了研究它们在交易中是否能够带来超额收益，GHZ 采用了滚动窗口使用因子选股并在样本外构建投资组合的方法。样本外滚动测试使用过去 10 年（120 个月）的数据来回归，因此从 1990 年开始。在选股时，由于同时考虑了多个因子，因此使用因子收益率来预测个股在下一期的收益率，并使用预期收益率的高低构建多空对冲的投资组合（做多预期收益率最高的 10%、做空预期收益率最低的 10%）。实证中一共考察了三种不同的投资组合（三个组合的区别是对小市值股票的权重依次提升）。&lt;/p&gt;&lt;p&gt;当使用全部 94 个因子进行滚动回归时，不同投资组合的收益率如下图所示。&lt;b&gt;随着小市值比重的增加，投资组合的收益率逐渐增大。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c22f7947ca365ab0958e11eb8cdf3beb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;917&quot; data-rawheight=&quot;430&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c22f7947ca365ab0958e11eb8cdf3beb&quot; data-watermark-src=&quot;v2-e4a693e7aa5a0e560fb07f676dcc8cee&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;如果不使用全部 94 个因子，而仅仅使用 GHZ 通过共同检验找出的 12 个独立因子会怎样呢？下图给出了答案。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ca9a08ccc7e3edb7ac9b730860591a4c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;877&quot; data-rawheight=&quot;430&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ca9a08ccc7e3edb7ac9b730860591a4c&quot; data-watermark-src=&quot;v2-0061e093bc7939b17a556c106721affd&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;可以很明显的看到，&lt;b&gt;仅仅使用 12 个独立因子显著降低了投资组合的收益率。这意味着我们好不容易辛辛苦苦找出了 12 个对解释 asset pricing 有效的独立因子，但是从实战选股的角度来说，这却不如使用全部 94 个因子 —— 不管它们是不是过拟合。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如何解释这种现象呢？GHZ 这篇文章并没有对此进行过多的讨论。就我的理解，上述结果说明了两点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;这 12 个因子在整个回测期内显著；当使用滚动窗口时，不同的因子可能在不同历史时期显著，因此使用 94 个因子能够更好的捕捉因子风格的轮动。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;实盘交易的目标是为了获得超额收益，而不是理解 asset pricing 的机制。对于选股模型来说，最核心的是对未来收益率的预测是否准确，而非因子的收益率估计是否无偏。上面的结果说明使用更多的因子提高了样本外收益率预测的准确性。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;有必要指出的是，上面的实证结果并没有考虑实际交易中的手续费等问题，且同时使用 94 个因子一定存在过拟合的问题。因此，虽然数据显示 94 个因子比 12 个因子的效果更好，这也不意味着我们在实际交易中一定能取得显著的优势。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 2003 年前后的差异&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;GHZ 这篇文章研究的最后一个部分发现因子在 2003 年前后截然不同的表现 —— 因子对截面收益率差异的解释力度骤然下降。&lt;/b&gt;上一节提到的三个样本外投资组合的收益率在 2003 年前后的表现如下图所示，前后出现了明显的差异。这些投资组合的净值曲线在 2003 年之后变得更加平坦。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6a9d6638b92c5e52d016a8406392a1bb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;914&quot; data-rawheight=&quot;444&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6a9d6638b92c5e52d016a8406392a1bb&quot; data-watermark-src=&quot;v2-0423b6e3f66236002da4ac25f4ca4c6e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-deac4c9720f7e1f63cb644558ab752e4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;787&quot; data-rawheight=&quot;604&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-deac4c9720f7e1f63cb644558ab752e4&quot; data-watermark-src=&quot;v2-25b3bd9f7e614b96e93085d71ba5c29a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;在 2003 年之后，仅仅有 2 个因子仍然显著，它们分别为盈利同比增长的季度数量以及经行业调整后的员工数。究其原因，&lt;b&gt;GHZ 认为在 2003 年之后，美股上的套利成本大幅降低造成了这种现象。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;2002 年 7 月，美国股市通过了 Sarbanes-Oxley 法案；同年 10 月，SEC 加速了对上市公司披露 10-Q 和 10-K 文件的要求。与此同时，在 2003 年初（1 月到 5 月），纽交所引入自动报价系统，减少了交易的摩擦成本。&lt;b&gt;这一系列变化极大降低了交易股票市场异象的量化对冲策略的成本和技术难度。&lt;/b&gt;无疑，2003 年前后的差异对于今后研究提出了挑战。GHZ 也呼吁今后 asset pricing 的研究应该给予 2003 年之后的数据更多的权重。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;研究因子时最艰难的部分往往是数据的准备。一旦有了高质量的数据，各种用于检验的回归及其他统计手段是非常丰富的。作为一篇同时研究 94 个因子的文章，GHZ 的一个巨大贡献在于因子数据的计算，以及为了计算因子而对公司基本面和交易数据的收集、整理。此外，GHZ 在截面回归中用个股的收益率和这 94 个因子进行回归，可以想见计算量之巨大。这和 Harvey and Liu (2018) 中给出的简单例子完全不同。&lt;/p&gt;&lt;p&gt;简单总结一下这篇文章给多因子投资实务的启发：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;分析时应排除过度加权微小市值股票造成的偏差；&lt;/li&gt;&lt;li&gt;真正显著的因子很少，绝大部分其他因子都是数据挖掘的产物、或者能够被这一小部分独立因子解释；&lt;/li&gt;&lt;li&gt;共同检验和单一检验发现的显著因子往往不同，前者的发现更有效；&lt;/li&gt;&lt;li&gt;因子投资和资产定价的目标不同；前者是为了提高样本外预测的准确性，后者是为了确保因子收益率的无偏估计；在投资实务中，更应该注重前者，但也要考虑实际的交易限制和成本。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;GHZ 通过同时回归找到的 12 个因子虽然是针对美股，但很多在 A 股上也是有效的。此外，GHZ 使用多个因子同时进行 Fama-MacBeth regression 的做法和 Barra 如出一辙。今后的研究会使用 Barra 中国股票模型中的风格因子进行类似的实证，检验不同因子在 A 股上的显著性，希望以此更好的指导我们在 A 股上实践因子投资。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Benjamini, Y. and D. Yekutieli (2001). The Control of the False Discovery Rate in Multiple Testing under Dependency. &lt;i&gt;Annals of Statistics&lt;/i&gt;, Vol. 29, 1165 – 1188.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Cochrane, J. H. (2011). Presidential address: Discount rates. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 66(4), 1047 – 1108.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A five-factor asset pricing model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Harvey, C. R., Y. Liu, and H. Zhu (2016). … and the cross-section of expected returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 5 – 68.&lt;/li&gt;&lt;li&gt;Harvey, C. R. and Y. Liu (2018). Lucky Factors. Working paper, &lt;i&gt;available at SSRN: https://ssrn.com/abstract=2528780.&lt;/i&gt;&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue, and L. Zhang (2015). Digesting anomalies: an investment approach. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 28(3), 650 – 705.&lt;/li&gt;&lt;li&gt;Green, J., J. R. M. Hand, and X. F. Zhang (2017). The characteristics that provide independent information about average U.S. monthly stock returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(12), 4389 – 4436.&lt;/li&gt;&lt;li&gt;McLean, R.D., J. Pontiff. (2016). Does academic research destroy stock return predictability? &lt;i&gt;Journal of Finance&lt;/i&gt; 71(1), 5–32.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-12-12-52221111</guid>
<pubDate>Wed, 12 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>投资中的 N 种认知偏差，总有一款打败你</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-12-07-48155082.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/48155082&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-656e51135aff0d6ec6e45b0571f37b29_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文介绍投资中常见的 12 个认知偏差。无论是主观还是量化投资，交易者都应通过不断努力和科学方法去克服它们、规避它们造成的危害。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;有日子没有写点关于行为金融学（Behavioral Finance）的东西了。本文标题中的 N 旨在说明影响投资决策的认知偏差有很多，单靠一篇文章也说不完，本文简单介绍其中的 12 个。在今后的文章中会不断的扩充这个列表。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论是在消费还是投资中，非理性决策背后的原因是人们大脑中根深蒂固的认知偏差（cognitive bias）。&lt;/b&gt;如今双十一又要来了，给各种非理性的消费行为敞开了大门。为了防止双十一期间的非理性行为波及投资决策，今天我们就来聊聊和投资密切相关的一些认知偏差。&lt;/p&gt;&lt;p&gt;Wikipedia 上关于认知偏差的定义如下：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;&lt;b&gt;Cognitive biases are systematic patterns of deviation from norm or rationality in judgment&lt;/b&gt;, and are often studied in psychology and behavioral economics.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：&lt;b&gt;认知偏差是在决策中系统地偏离范式或理性的行为&lt;/b&gt;；它通常是心理学和行为经济学的研究范畴。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在 Wikipedia 上列出的认知偏差超过 110 种。本文介绍的 12 种偏差包括（字母顺序排列，重要性不分先后）：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Anchoring（锚定效应）&lt;/li&gt;&lt;li&gt;Availability Heuristic（可得性启发法）&lt;/li&gt;&lt;li&gt;Bandwagon Effect（从众效应）&lt;/li&gt;&lt;li&gt;Confirmation Bias（确认偏误）&lt;/li&gt;&lt;li&gt;Framing Effect（框架效应）&lt;/li&gt;&lt;li&gt;Gambler’s Fallacy（赌徒谬误）&lt;/li&gt;&lt;li&gt;Hindsight（后见之明）&lt;/li&gt;&lt;li&gt;Insensitivity to Sample Size（对样本数不敏感）&lt;/li&gt;&lt;li&gt;Outcome Bias（结果偏误）&lt;/li&gt;&lt;li&gt;Overconfidence（过度自信）&lt;/li&gt;&lt;li&gt;Peak-End Rule（峰终定律）&lt;/li&gt;&lt;li&gt;Selective Perception（选择性知觉）&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下文对于每种偏差，首先给出它的定义，然后通过一个（些）生活中的例子帮助理解，最后再通过一个（些）投资中的例子或现象说明它的危害。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 Anchoring&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;Anchoring or focalism is a cognitive bias for an individual to rely too heavily on an initial piece of information offered (known as the &quot;anchor&quot;) when making decisions.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：锚定或聚焦是一种认知偏差，它指的是个人在做决定时&lt;b&gt;过度依赖&lt;/b&gt;其被提供的&lt;b&gt;初始信息&lt;/b&gt;（称为“锚”）[哪怕该信息和所做决策毫无关联]。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Anchoring（锚定效应）是在生活和投资中都经常出现的一种认知偏差。行为金融学的先驱 Amos Tversky 和 Daniel Kahneman 曾对它做过大量研究（Tversky and Kahneman 1974）。在一个实验中，两组参与者分别猜测美国人口中非洲裔的百分比。在预测之前，首先当着每组参与者的面进行一次幸运大转盘，转盘的结果为 0 到 100 之间的一个随机数字。大转盘的结果和非洲裔的百分比毫无关系，按理说应该对预测结果没有影响。然而玄妙的事情发生了 —— 第一组参与者得到的转盘结果为 10，他们的猜测结果为 25%；第二组参与者得到的转盘结果为 65，他们的猜测结果高达 45%。显然，不少参与者使用大转盘的结果作为了“锚”。&lt;/p&gt;&lt;p&gt;在另一个类似的研究中，600 名基金经理被要求写下他们手机号码的后四位，并同时预测伦敦有多少个医生。在手机后四位大于 7000 的那些投资经理中，大部分预测伦敦有 8000 名医生；而在手机后四位小于 3000 的投资经理中，大部分猜测伦敦有 4000 名医生。电话号码后四位和医生个数没有什么关系，但基金经理们都用自己的手机号后 4 位作为了判断的基准。&lt;/p&gt;&lt;p&gt;在量化交易中，统计套利是一个常见的策略。在黑色商品产业链中，一对儿常见的统计套利标的是螺纹钢和热卷，市场中存在很多交易这两种商品价格差（称为卷螺差）的策略。&lt;b&gt;而构建这类策略时人们经常关注的就是价差的历史走势；这就是所谓的“锚”。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5f13f3134e78affe9d3a742b5cfde35a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;946&quot; data-rawheight=&quot;440&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;946&quot; data-original=&quot;https://pic3.zhimg.com/v2-5f13f3134e78affe9d3a742b5cfde35a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5f13f3134e78affe9d3a742b5cfde35a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;946&quot; data-rawheight=&quot;440&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;946&quot; data-original=&quot;https://pic3.zhimg.com/v2-5f13f3134e78affe9d3a742b5cfde35a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-5f13f3134e78affe9d3a742b5cfde35a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上图展示了使用热卷和螺纹钢的主力合约计算的卷螺差的时间序列。在进入今年十月下旬之前，卷螺差的历史极值从未突破过 -200。以此来构建策略的话，我们会在卷螺差到达 -200 时做多热卷、做空螺纹。不幸的是，在十月下旬，卷螺差持续突破历史下限，而上述的套利交易也只能持续亏损。&lt;b&gt;当我们过度依赖历史极值这个“锚”的时候，就会忽视其他的因素 —— 这两种商品各自的库存、钢厂的生产情况、需求端的区别等。&lt;/b&gt;忽视这些因素将会造成非最优的判断，策略亏损也就在情理之中了。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Availability Heuristic&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The availability heuristic is a mental shortcut that relies on&lt;/i&gt; &lt;i&gt;&lt;b&gt;immediate examples&lt;/b&gt;&lt;/i&gt; &lt;i&gt;that come to a given person&#39;s mind when evaluating a specific topic, concept, method or decision.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：可得性启发法是一种心理捷径，它指的是当人们评估问题、概念、方法或决策时，往往依赖于脑海中&lt;b&gt;最容易想起来&lt;/b&gt;的那些示例。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;如果有人问我们英文中是以字母 r 开头的单词多还是 r 在第三个位置上的单词多时，我们会马上在大脑中搜索这满足这两种模式的单词。以 r 开头的比如 return；r 在第三位的比如 car。对该问题的回答会基于哪种情况下想起的单词更多。显然，我们轻而易举就能想起大把以 r 开头的单词，比如 rat，road，read，result……，而想起 r 在第三位的单词却要费劲的多。基于此，我们会（错误地）认为以 r 开头的单词要多于 r 在第三位的单词，而事实恰恰相反（Tversky and Kahneman 1973）。&lt;/p&gt;&lt;p&gt;&lt;b&gt;可得性启发法背后的“逻辑”是，如果人们能够很容易的想起某个示例，那么它一定是重要的。在这种认知偏差下，人们在投资中往往错误地被近期发生的事情所左右。&lt;/b&gt;不成熟的交易者会过分看重最近交易的结果，并让这些交易 —— 无论盈利还是亏损 —— 来支配他们未来的决定。在亏损后，交易者往往急于回本；在盈利后，交易者可能会变得信心爆棚（下面会有专门一个偏差叫做 overconfidence）。这两种状态都容易让人在随后的交易中变得更加草率。&lt;/p&gt;&lt;p&gt;Barber and Odean (2008) 的研究发现，投资者在选择股票时倾向于考虑那些最近引起他们注意的股票，诸如近期新闻中的集中报道的股票、交易量异常大的股票、以及单日内回报极高的股票。毫无疑问，这些都是会给投资者留有非常深刻的印象，从而导致他们出现可得性启发法偏差。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ffb398ab15b291adb1c825c012327425_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;820&quot; data-original=&quot;https://pic2.zhimg.com/v2-ffb398ab15b291adb1c825c012327425_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ffb398ab15b291adb1c825c012327425_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;820&quot; data-original=&quot;https://pic2.zhimg.com/v2-ffb398ab15b291adb1c825c012327425_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-ffb398ab15b291adb1c825c012327425_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;同样的问题也出现在分析师中间。Lee et al. (2008) 发现分析师倾向于使用最近的经验来判断事件的可能性。具体来说，当经济扩张时，分析师对公司每股收益长期增长的预测往往相对乐观；而当经济收缩时他们则相对悲观。这个现象说明分析师在做出长期预测时夸大了经济当前状态的影响。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 Bandwagon Effect&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The bandwagon effect is a phenomenon whereby the rate of uptake of beliefs, ideas, fads and trends increases the more that they have already been adopted by others.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：从众效应是指人们受到多数人的一致思想或行动影响，从而随波逐流、人云亦云。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Bandwagon Effect 的中文名是从众效应。这个英文名字可能不太常见，它还有另外一个家喻户晓的名字 —— Herding（羊群效应）。&lt;b&gt;人们喜欢随波逐流是因为群组有一种自我加强机制，能产生群组极化。&lt;/b&gt;同样的观点在组内被不断地重复，使得组内的成员倾向于相信同样的观点。&lt;/p&gt;&lt;p&gt;某个选举实验中共有 3 位候选者，其中 1 号候选者较其他两位优势显著。实验在两个不同的场景中展开。在第一个场景中，实验参与者被告知 3 位候选人的全部信息。在这种情况下，83% 的参与者选择 1 号候选人。在第二个场景中，有关 1 号候选人的信息被分成两部分，一部分共享给全部参与者，而另一部分被随机的分配给参与者。从众效应使得这些参与者仅仅关注与他们共享的关于 1 号候选人的信息，这大大的降低了该候选人的竞争力，最终仅有 18% 的实验者选择 1 号候选人。&lt;/p&gt;&lt;p&gt;从众效应每天都发生在市场中。由于信息不对称，投资者通过观察大多数人的行为来推测其私有信息，或是过度依赖于舆论而模仿他人决策。&lt;b&gt;影响从众的最重要因素不是意见本身的正确与否而是认同此意见人数的多寡。&lt;/b&gt;个人非理性行为导致了集体的非理性表现。羊群行为说明个体不顾私有信息，采取与别人相同的行动。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;People&#39;s actions can be totally independent of their own information and totally dependent on their observation of others&#39; actions or words.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：人们的行为可以完全独立于他们自己的信息，完全依赖于他们对他人行为或言语的观察。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;从众效应和大脑构造有关。&lt;b&gt;神经学家发现，真正的痛苦（real pain）和社会性的痛苦（social pain）是由大脑的同一部位感受到的；&lt;/b&gt;不随波逐流相当于寻找社会性的痛苦、从而带来真正的痛苦。因此，没有人勇于寻找真理，这也使得逆向思维格外可贵。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 Confirmation Bias&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;i&gt;Confirmation bias, also called confirmatory bias, is the tendency to search for, interpret, favor, and recall information in a way that confirms one&#39;s preexisting beliefs or hypotheses.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;译：确认偏误，也被称为证实性偏差，是个人选择性地回忆、搜集有利细节，[忽略不利或矛盾的资讯]，来支持自己已有的想法的片面诠释。&lt;/i&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d8047ef50cb5b5fc238bf36111333c4a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;701&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;701&quot; data-original=&quot;https://pic3.zhimg.com/v2-d8047ef50cb5b5fc238bf36111333c4a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d8047ef50cb5b5fc238bf36111333c4a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;701&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;701&quot; data-original=&quot;https://pic3.zhimg.com/v2-d8047ef50cb5b5fc238bf36111333c4a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d8047ef50cb5b5fc238bf36111333c4a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;来看一个游戏。下图中有四张卡片，分别为字母 A、Q，数字 4、7。假设我告诉你“每一个元音字母卡片的背面都是一个偶数”并让你通过翻动两张卡片来检验我是否说谎，你会翻哪两张呢？别着急，静下心来想一想。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8a3bac7b25078855e767e64399683082_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;367&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;638&quot; data-original=&quot;https://pic3.zhimg.com/v2-8a3bac7b25078855e767e64399683082_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8a3bac7b25078855e767e64399683082_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;367&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;638&quot; data-original=&quot;https://pic3.zhimg.com/v2-8a3bac7b25078855e767e64399683082_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8a3bac7b25078855e767e64399683082_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;大多数人会选择 A 和 4，因为它们是和上述陈述相符的卡片，但是确认性的证据并不能证明任何事 —— 事实上，我并没有说偶数的背面是元音，因此翻动卡片 4 并不说明任何问题。正确的答案是翻动 A 和 7，后者可能会提供有价值的否定依据（disconfirming evidence） —— 如果 7 的背面是元音就可以证明“元音字母卡片的背面都是一个偶数”是错误的。&lt;/p&gt;&lt;p&gt;就像上面的卡片例子一样，投资者在做投资决定时倾向于收集确认证据，而不是评估所有可用的信息。在分析公司基本面时，分析员有时早早的就提出了结论，之后便陷入了确认偏误 —— 努力寻找所有能够证明其观点成立的论据和数据，而忽视了那些使之结论不成立的数据；当处于亏损的交易之中时，交易者有时会拒绝接受事实、而是如饥似渴的寻找所有可能支持自己交易的证据，迷失自我。确认偏误在投资者持有先验时的杀伤力可能更大。&lt;b&gt;在贝叶斯框架中，如果新息不能客观的反映交易的全貌而陷入确认偏误，那么它对于先验只能是强化作用。&lt;/b&gt;从这个意义上说，我们希望新息是无偏的。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 Framing Effect&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The framing effect is an example of cognitive bias, in which people react to a particular choice in different ways depending on how it is presented.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：框架效应是一种认知偏差，它指的是当呈现方式不同时，人们对于特定选择做出的反应也是不同的。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Framing Effect（框架效应）是Prospect Theory（Kahneman and Tversky 1979）的重要组成部分。Amos Tversky 和 Daniel Kahneman 在研究框架效应时举过下面这个例子（Tversky and Kahneman 1981）。有 600 名患者感染了一种致命疾病，救治方法有 A 和 B 两种。方法 A 预计将导致 400 人死亡（200 人获救），如果使用方法 B，则有 1/3 的几率无人死亡，但 2/3 的几率所有人都会死亡。通过 positive framing（积极框架，即有多少人会活下去）以及 negative framing（消极框架，即有多少人会死亡）向参与者陈述这两种疗法，并让他们从 A 和 B 中选择。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-339a1a95351db5880ed700fc1a91f991_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;195&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;690&quot; data-original=&quot;https://pic2.zhimg.com/v2-339a1a95351db5880ed700fc1a91f991_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-339a1a95351db5880ed700fc1a91f991_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;195&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;690&quot; data-original=&quot;https://pic2.zhimg.com/v2-339a1a95351db5880ed700fc1a91f991_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-339a1a95351db5880ed700fc1a91f991_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;当采用 positive framing 时，有 72% 的参与者选择 A；当采用 negative framing 时，仅有 22% 的参与者选择 A。上述结果说明，选项如何呈现能够极大的影响人们的反应。&lt;b&gt;当结果以获利（positive framing）的方式呈现时，人们倾向于规避风险&lt;/b&gt;（更多的人选择了疗法 A 以确保 200 个人 100% 获救）；&lt;b&gt;当结果以损失（negative framing）的方式呈现时，人们倾向于追求风险&lt;/b&gt;（更多的人选择了疗法 B，尽管它有可能让全部 600 人丧生）。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prospect Theory 指出，在人们决策时，亏损带来的痛苦要高于同等程度收益带来的喜悦（通常痛苦是喜悦的两倍）；在确定性的低收益和大概率的高收益面前，人们往往错误的选择前者；在确定性的低亏损和大概率的高亏损面前，人们往往错误的选择后者。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于这种偏差，在盈利的交易中，由于提前平仓能够带来确定性的利润，交易者在这时往往做不到坚持持有、而错误的提前平仓。反之，在亏损的交易中，由于追求风险，交易者总奢望能够回本而无法按照策略的信号止损，因为止损造成的确定性亏损将给他带来很大的痛苦。&lt;/p&gt;&lt;p&gt;除了极少数高频交易者来说，大部分投资者使用的都是中低频策略。这些策略能赚到钱的必要（不充分）条件是在市场的发展有利于策略时，投资者能够拿住盈利的单子，让利润奔跑。不幸的是，框架效应造成的对确定性收益的偏爱正是投资者的大敌。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 Gambler&#39;s Fallacy&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The gambler&#39;s fallacy is the mistaken belief that, if something happens more frequently than normal during a given period, it will happen less frequently in the future (or vice versa).&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：赌徒谬误是错误的认为如果某件事情在某段时间内比正常情况发生得更频繁，那么它在未来发生的频率就会降低（反之亦然）。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;1913 年 8 月 18 日，在 Monte Carlo 赌场的轮盘赌中（一共有 37 个格子，每个格子上有一个数字，其中红黑颜色的格子各 18个，剩余的一个是绿色），小球奇迹般的连续 26 次落到了黑色的格子中，其发生的概率低于 6 亿分之一。在小球不断落入黑色格子的过程中，大量的赌徒错误的认为之前出现的黑色格子太多了，之后的赌局中小球应该更有可能性落入到红色的格子中，从而开始疯狂的下注，最终导致了数百万法郎的亏损。这就是著名的赌徒谬误，也称为蒙特卡洛谬误。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-41f16062b8b07e9e14f57cd220c801f1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1029&quot; data-rawheight=&quot;541&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1029&quot; data-original=&quot;https://pic2.zhimg.com/v2-41f16062b8b07e9e14f57cd220c801f1_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-41f16062b8b07e9e14f57cd220c801f1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1029&quot; data-rawheight=&quot;541&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1029&quot; data-original=&quot;https://pic2.zhimg.com/v2-41f16062b8b07e9e14f57cd220c801f1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-41f16062b8b07e9e14f57cd220c801f1_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;当不同的赌局结果之间相互独立且符合同分布时，前序的结果对于未来的赌局没有影响。因此，即便之前的 26 轮出现了史无前例的连续黑色格子，也并不意味着之后的赌局中，红色格子比黑色格子出现的概率更高。&lt;/p&gt;&lt;p&gt;有必要指出的是，&lt;b&gt;赌徒谬误和 Regression towards the mean（均值回归）不同。均值回归说的是当一个随机变量在一次测量中出现了极值时，那么它在下一次测量中的取值会更加靠近其均值。&lt;/b&gt;以上面的轮盘赌为例，假设随机变量 X 为 26 次赌局中小球落入黑色格子的次数，则 X = 26（表示连续 26 次黑色格子）。均值回归说的是如果再进行 26 次赌局，那么 X 的取值会靠近 13（即 26 次赌局中出现 13 个黑色格子）&lt;b&gt;而非少于&lt;/b&gt; 13；而赌徒谬误说的是再进行 26 次赌局，必须要“扭转”前 26 局中全是黑色的情况而出现更多的红色（从而使得整个 52 局中红色和黑色小格出现的次数大致相当），因此 X 的取值应小于 13。这就是均值回归和赌徒谬误的区别。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在投资中，赌徒谬误意味着当交易者经历了连续的几次亏损后就会错误的认为下一次交易赢钱的概率会更高。&lt;/b&gt;如果每次交易的结果是独立的，那么下一次交易的胜率和之前的连续亏损（或者连续盈利）没有关系。在这种情况下，正确的做法依然是坚持策略，而非因错误的高估概率而进行人为干预。&lt;/p&gt;&lt;p&gt;之前我们提出了一个定义：&lt;b&gt;当一个策略的收益率序列满足 IID 且均值为正时，该策略是有效的。&lt;/b&gt;针对这个有效性的定义提出了一个猜想：&lt;b&gt;对于一个有效的策略，任何 overlay 策略都无法进一步提高它的夏普率。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果某个策略在下一次交易时盈利的概率是之前交易中出现亏损次数的函数，那么按照上述定义，该策略是非有效的，它的收益率有时序相关性，可以通过进一步的 overlay 策略来改进它的风险收益特征。对于有效的策略，如果认为连续亏损后更有可能出现盈利，那就是步入了赌徒谬误。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7 Hindsight&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;Hindsight bias is the inclination, after an event has occurred, to see the event as having been predictable, despite there having been little or no objective basis for predicting it.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：后见之明是指在某一事件&lt;b&gt;发生后&lt;/b&gt;，我们回过头来认为该事件的结果是可预测的，尽管可能根本没有客观依据来表明该事件具备可预测性。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;生活中不乏事后诸葛亮。&lt;/p&gt;&lt;p&gt;2004 年雅典奥运会女排决赛中，中国队在 0 : 2 落后的情况下连扳三局实现惊天逆转夺冠。在关键的第三局，中国队曾以 19 : 21 落后；在接下来的第四局（依然是俄罗斯的制胜局）更是以 21 : 23 落后。在这些不利局面下，女排凭借顽强拼搏的精神实现逆转。在举国欢庆的同时，无数后见之明者出来高呼“我早就知道女排会取胜！”。&lt;/p&gt;&lt;p&gt;在一项研究中，Calvin College 学院的学生被要求预测美国参议院对最高法院提名人 Clarence Thomas 的投票结果。58% 的学生正确地预测出他将被任命。在结果出来后，学生们被要求回忆他们是否曾做出正确的预测。高达 78% 的学生回答说正确地预测了 Thomas 的提名。无疑，这高出的 20 个百分点来自部分学生的后见之明。&lt;/p&gt;&lt;p&gt;&lt;i&gt;Life is lived forwards, but understood backwards.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;在投资中，后见之明更是屡见不鲜。每当大盘大涨后者大跌时，收盘之后总有抓人眼球的文章出来总结八大利好、七大利空。投资者在泡沫破裂后便神奇的具备了识别泡沫的能力也是后见之明的例子。在 1999 年和 2007 年没有多少投资者能够正确预测股市即将下跌。然而，当我们现在回顾时，人们常常感到当初有些迹象是十分明确的、所有人都应该可以看到。&lt;/p&gt;&lt;p&gt;作为一个优秀的投资者，坚持复盘是一门必修课。然而，我们不应该让复盘成为后见之明的牺牲品。盈亏同源，当市场不满足策略的假设时，任何策略都会亏钱，而这在事前根本无法判断 —— 即便策略的胜率再高也有亏损的交易。摒弃后见之明，在市场面前心怀敬畏。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;8 Insensitivity to Sample Size&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;Insensitivity to sample size is a cognitive bias that occurs when people judge the probability of obtaining a sample statistic without respect to the sample size.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：对样本数不敏感是指人们在不考虑样本量的情况下计算样本统计量的概率时产生的一种认知偏差。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Tversky and Kahneman (1974) 中有这样一个例子：一个小镇上有两个医院、规模不同。大医院平均每天出生 45 个新生儿、小医院平均每天出生 15 个新生儿。新生儿的性别中男女比例每天各不相同，但平均下来差不多各占 50%。在接下来的一年时间里，这两个医院分别记录新生儿中 60% 以上时男婴的日期。你认为哪家医院记录下来的这样的日子更多？&lt;/p&gt;&lt;ul&gt;&lt;li&gt;A. 大医院&lt;/li&gt;&lt;li&gt;B. 小医院&lt;/li&gt;&lt;li&gt;C. 差不多（日子数差别在 5% 以内）&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在这个研究中，56% 的参与者选择了 C，而 A 和 B 的回答者各有 22%。从统计学可知，大医院的每天新生儿中男婴的比例比小医院更容易接近 50%，因此上述问题的正确答案应该是 B。接近 78% 的回答者给出了错误的选择，说明他们在计算中没有正确考虑样本的大小。&lt;/p&gt;&lt;p&gt;投资中经常出现这样标题的文章：《大数据告诉你 XX 月大盘怎么走》、《大数据告诉你 XX 节后是涨是跌》。点开一看，所谓的大数据就是一共十来个样本点。&lt;b&gt;对样本数据不敏感这种偏差指出，当样本点非常少的时候，使用有限的样本点根本无法可靠的计算出变量的变化范围。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;在投资中，大数定律（Law of Large Numbers）是一个优秀策略的朋友；而小数定律（Law of Small Numbers）则是一种偏差。&lt;/b&gt;只有当交易次数足够多的时候，才能客观的评价一个策略的优劣。仅在有限次交易后就急于评价交易系统则是一种错误的做法。&lt;/p&gt;&lt;p&gt;但是，这对于很多中低频策略来说是非常痛苦的。一个周频策略一年才有 52 次交易、一个月频策略一年更是只有 12 次交易。这意味着在样本外需要很长的时间才能够评价策略是否失效。&lt;b&gt;对于这类策略，需要强有力的来自投资或经济规律的先验信仰来辅助判断。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以价值投资为例，进入 2018 年以来，全球的价值投资都不好做，一直跌跌不休。但是，价值投资毕竟经受住了几十年的考验，短期的低迷表现并不能撼动价值投资有效的内在本质。我们也应该坚持信仰，正如 AQR 的创始人 Cliff Asness 说的那样：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Let&#39;s all be nicer to financial theory. If we stick with it long enough, it will probably be nice to us.&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;9 Outcome Bias&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The outcome bias is an error made in evaluating the quality of a decision when the outcome of that decision is already known.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：结果偏误指的是人们总是以结果判断当初决策的质量，而不考虑决策的过程。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Baron and Hershey (1988) 给出了下面这个 case study。一个 55 岁的心脏病患者需要决定是否进行手术治疗。如果手术成功，他的病情会得到极大缓解，他的预期寿命会从 65 岁延长至 70 岁。然而，手术存在一定风险 —— 在所有经历过类似手术的患者中，有 8% 的患者手术失败。在综合考虑了患者和历史数据的情况下，医生决定进行手术。请给医生的决策打分。&lt;/p&gt;&lt;p&gt;如果人们足够理性，那么在给医生的决策打分时应该定量的考虑所有相关的因素 —— 比如病人的情况、手术成功的概率、手术成功带来的益处、手术失败的风险等。这样的打分应该和手术本身的结果无关，因为结果是决策之后的概率事件。然而，在这个 case study 中我们看到，当手术的结果是成功时，医生决策的得分要远远高于手术失败时医生决策的得分。这个例子有力的说明了结果偏误。&lt;/p&gt;&lt;p&gt;&lt;b&gt;打破这个偏差的关键在于，在评价一个决策的好坏时，我们应该注重决策的过程本身，而非结果。&lt;/b&gt;好的过程 + 好的结果 = 应得的成功；好的过程 + 坏的结果 = 坏运气。虽然好的过程不一定会产生好的结果，但我们不应该因为一个坏的结果就否定过程。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-12fbbea4ce2131e5635a1c17e470778f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;558&quot; data-rawheight=&quot;155&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;558&quot; data-original=&quot;https://pic4.zhimg.com/v2-12fbbea4ce2131e5635a1c17e470778f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-12fbbea4ce2131e5635a1c17e470778f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;558&quot; data-rawheight=&quot;155&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;558&quot; data-original=&quot;https://pic4.zhimg.com/v2-12fbbea4ce2131e5635a1c17e470778f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-12fbbea4ce2131e5635a1c17e470778f_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;在商品期货界，有一个人神一般的存在 —— Mr. Fairy（这是别名，真名不详）。在 2000 年日本举办的 ROBBINS-TAICOM 期货冠军赛上，Fairy 一战成名，获得冠军，在历时半年的比赛中获得了超过 1000% 的收益。此外，他在随后的几年中又两次夺冠，收益分别为 709% 和 1131%，说明他第一次夺冠不是偶然。&lt;/p&gt;&lt;p&gt;坊间有一本出版物记录了 Fairy 在比赛中每天的交易日志，读过之后给人最深的感受是他对于每笔交易严谨的评价。他总能客观的看待交易的结果，如果好的结果来自于运气而非正确的决策，他会马上反省而非洋洋自得，这便是 Fairy 最值得学习的地方。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在投资中，收益不可预测，风险控制有时也很有限，唯一能控制好的就是过程。而科学的投资，尊重事实，严谨分析数据就是能够形成好的过程的必要条件。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;10 Overconfidence&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The overconfidence effect is a well-established bias in which a person&#39;s subjective confidence in his or her judgements is reliably greater than the objective accuracy of those judgements.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：过度自信是一种根深蒂固的偏见。在这种偏见中，人们对于其判断[能力]的自信心总是高于该判断[能力]的客观准确性[水平]。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;过度自信似乎与生俱来。在一项对 600 名基金经理的调研中，有 74% 的人认为自己比别的基金经理更好（这远远超过 50%）。大量类似的例子出现在生活中的方方面面。&lt;/p&gt;&lt;p&gt;除此之外，&lt;b&gt;研究表明信息过载能够导致过度自信。&lt;/b&gt;在一项研究中，8 位经验丰富的赌马者使用 88 个变量来鉴别马匹的好坏（类似多因子选股）。他们首先根据自己的经验将这些变量按其对于选赛马的重要性进行排序。在随后的测试中，这些赌马者首先仅通过最重要的 5 个变量来挑选马匹，然后变量的个数增加到 10 个、15 个、以此类推，一直到 40 个。研究发现，这些赌马者挑出优秀马匹的准确率并没有随着使用变量个数的增加而提升。换句话说，他们用 5 个变量选出马匹的准确性和用 40 个变量选出马匹的准确性并无统计上的显著差异。但是随着信息的增多，他们对他们预测的信心却显著增加。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6787be7b4f98a1765b87c31d4eecf333_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;596&quot; data-rawheight=&quot;339&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;596&quot; data-original=&quot;https://pic4.zhimg.com/v2-6787be7b4f98a1765b87c31d4eecf333_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6787be7b4f98a1765b87c31d4eecf333_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;596&quot; data-rawheight=&quot;339&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;596&quot; data-original=&quot;https://pic4.zhimg.com/v2-6787be7b4f98a1765b87c31d4eecf333_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6787be7b4f98a1765b87c31d4eecf333_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;在交易中，过度自信的一个严重后果是 illusion of control&lt;/b&gt; —— 这是我非常喜欢的一个偏差（我自己也犯过）。当交易者连续出现盈利之后，他就会产生一种错觉，认为交易系统或者量化策略真正的发现了一些别人没发现的关于市场运行的内在规律，因此认为市场的走势是可控的。在这种错觉下，交易者往往会不顾控制风险、干预策略、大幅加仓，一旦幻想破灭，等待他的往往是巨大的亏损。&lt;/p&gt;&lt;p&gt;&lt;b&gt;反过来，illusion of control 又可以放大过度自信。&lt;/b&gt;比如在一个扔硬币的游戏中，如果一个人连续猜对了几次硬币的正反，他就会觉着他是“天选之人”，可以控制扔硬币的结果。在 Insensitivity to sample size 中我们提到了 Law of Small Numbers。当样本数量非常有限的时候，连续的盈利（或连续的亏损）均有可能出现，这在统计上并不意味着什么显著的情况。理性的交易者应避免过度自信、客观的分析每一次交易。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;11 Peak-End Rule&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;The peak–end rule is a psychological heuristic in which people judge an experience largely based on how they felt at its peak and at its end, rather than based on the total sum or average of every moment of the experience.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：峰终定律是一种心理启发，它指的是人们对于一个体验的评价很大程度上仅仅取决于体验在峰值时和在结束时的感受，而非整个体验期内的平均感受。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这个翻译有些拗口，来看下面这张图。图中上下两种情况代表了某件事情的发展过程带给我们的体验。从体验值的起点和终点来看，这两种情况的体验值变化是相同的。不同的是第二种情况中体验的峰值远远超过第一种情况的峰值。峰终定律表明，人们通过 Peak 和 End 两点的体验值来评价整段体验，因此图中第二种情况比第一种情况带给我们更大的痛苦。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3ff9e024f1ef23d7f777eccddcaec78b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;753&quot; data-rawheight=&quot;403&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;753&quot; data-original=&quot;https://pic4.zhimg.com/v2-3ff9e024f1ef23d7f777eccddcaec78b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3ff9e024f1ef23d7f777eccddcaec78b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;753&quot; data-rawheight=&quot;403&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;753&quot; data-original=&quot;https://pic4.zhimg.com/v2-3ff9e024f1ef23d7f777eccddcaec78b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3ff9e024f1ef23d7f777eccddcaec78b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;人类的大脑并不能记住所有的事情。&lt;b&gt;从进化的角度来说，我们只能记住那些帮助我们生存的事情；记住最痛苦的事情（negative peak）可以让我们在未来避免它们；记住最愉快的时刻（positive peak）能够指引我们在未来更好的通过努力获得它们。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;今年十一长假我去了一趟上海，登上了中国第一高楼上海中心大厦俯瞰黄浦江夜景。由于人多，排队登顶花费了大概 90 分钟的时间，登上去之后赏景、拍照仅花费不到 30 分钟。如果让我回忆这段经历，首先从我脑海中跳出的一定是黄浦江两岸壮美的夜景带来的喜悦（peak moment），而非那看似遥遥无期的排队等候时间。&lt;/p&gt;&lt;p&gt;峰终定律由 Kahneman et al. (1993) 提出。在一项实验中，参与者经历了两个不同版本的痛苦体验。在第一个版本中，他们将双手浸泡在 14 摄氏度的凉水中内并坚持 60 秒；在第二个版本中，参与者同样先重复上述步骤，然而在 60 秒之后，参与者被要求继续坚持 30 秒，同时水温会提高的 15 摄氏度。尽管第二个版本比第一个版本多了 30 秒的痛苦体验时长，但在第二个实验的结尾，水温是 15 度、较版本一上升了 1 度，这使得参与者普遍认为第二个实验的痛苦程度更低一些，体现了峰终定律偏差。&lt;/p&gt;&lt;p&gt;在医院的治疗过程中也有很多峰终定律的例子。在治疗过程中，患者总是根据峰值时的疼痛程度和结束时的疼痛程度来评价该治疗手段的不适程度；无论治疗过程中疼痛程度的长短或变化情况如何，都会发生这种情况（Redelmeier and Kahneman 1996）。&lt;/p&gt;&lt;p&gt;在交易中，我们时常由这样的感受：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;大盘走出了倒 V 的形状，当天虽然录得正收益，但是收盘的价格较日内的最高价差了不少。&lt;/li&gt;&lt;li&gt;大盘走出了 V 字反转，当天虽然录得负收益，但是收盘价较当天的最低价已经着实反弹了不少。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;由于峰终定律，第一种尽管是正收益，我们的体验是大盘从最高点到收盘价之间的下跌造成的失落；第二种尽管是负收益，我们的体验是从最低点到收盘价之间强势反弹带来的慰藉。显然，这两种体验都是认知偏差。客观的评价一个交易应该以交易开始时的价格作为合理的参考点，而非 peak 时刻的价格。&lt;/p&gt;&lt;p&gt;在交易中，策略的浮盈（亏）随投资品价格的走势发生变化。如果交易者频繁看盘，他则更有可能踏入峰终定律的陷阱。每当策略的浮盈从 peak 时刻下跌的时候，峰终效应偏差就会给他造成痛苦。这种痛苦会促使他错误的寻求继续改进策略的空间，从而锁定 peak 时刻的最高浮盈。任何以此为目标而对策略的改动都会带来过拟合，这无异于自掘坟墓。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;12 Selective Perception&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;Selective perception is the tendency not to notice and more quickly forget stimuli that cause emotional discomfort and contradict our prior beliefs.&lt;/i&gt;&lt;br&gt;&lt;i&gt;译：选择性知觉指的是人们倾向于忽略或快速遗忘那些让我们感到不快或和我们的观念相左的因素。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;直白的说，选择性知觉偏差和我们平时常说的“戴着有色眼镜”类似。比如，当我们在看一副画的时候，我们看到的是我们心理希望看到的，而非这幅画客观传达出来的画面。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4d46b09485c224e17c59222f5f4c3fb6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;539&quot; data-rawheight=&quot;301&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;539&quot; data-original=&quot;https://pic3.zhimg.com/v2-4d46b09485c224e17c59222f5f4c3fb6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4d46b09485c224e17c59222f5f4c3fb6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;539&quot; data-rawheight=&quot;301&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;539&quot; data-original=&quot;https://pic3.zhimg.com/v2-4d46b09485c224e17c59222f5f4c3fb6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4d46b09485c224e17c59222f5f4c3fb6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;选择性知觉在体育运动的粉丝中经常出现。今年的俄罗斯世界杯决赛在法国和克罗地亚之间进行。很多克罗地亚的球迷尽管承认它和法国队之间的差距，仍然希望自己支持的球队夺冠。不幸的是，法国队技高一筹，捧得大力神杯。面对这样的结果，大量狂热的球迷把原因归咎于曼朱基奇不幸的乌龙和佩里西奇倒霉的手球送点，以及格列兹曼颇有争议的摔倒和法国队领先之后的防守反击，而无法正视两队之间实力上存在的客观差距，以及赛前状态的强烈反差（克罗地亚之前的淘汰赛全部经历了加时赛，体力遭到了巨大消耗）。&lt;/p&gt;&lt;p&gt;学术界对类似的情况也有研究。Hastorf and Cantril (1954) 分析了普林斯顿和达特茅斯橄榄球比赛的情况，发现主场作战的普林斯顿球迷表现出了显著的选择性知觉。&lt;/p&gt;&lt;p&gt;选择性知觉偏差对交易十分危险。交易者都惧怕亏损造成的痛苦，而面对亏损时经常自我辩解。选择性知觉让交易者倾向于忽略掉自己在决策中所犯的错误，而寻找其他的原因。&lt;b&gt;在市场好的时候，所有人都赚钱，有人错把市场的 β 当作自己的 α；而当市场差、β 消失的时候，这些人却回避自己的问题。&lt;/b&gt;优秀的交易者不应该责备市场、抱怨环境以及任何外部因素。交易者必须为自己的交易结果负责。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;13 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;行为金融学中总有聊不完的话题。本文介绍了 12 个认知偏差，每一个都值得进一步深入研究。&lt;/p&gt;&lt;p&gt;一直以来，量化投资的一个优势是能够摒弃或者减少投资中常见的认知偏差。然而，我越来越觉得有些偏差的杀伤力太过巨大，就连量化投资也很容易中招，比如 overconfidence、peak-end rule、以及 insensitivity to sample size。一旦策略出现连续的盈利或者亏损、这些偏差就很容易让我们产生干预策略的冲动。归根到底，无论是主观投资还是量化投资，它的使用者都是人，而人不可避免要犯错。&lt;/p&gt;&lt;p&gt;如何减少这些偏差的危害呢？一方面，我们应通过不断的实盘积累来历练自己的心性，在交易中追求一致性。另一方面，可以考虑将整个投资流程中的步骤有效的分解、隔离，比如策略研发、交易执行、复盘回顾由不同的团队独立执行，从而防止认知偏差在投资流程中扩散，确保量化策略的严格执行。&lt;/p&gt;&lt;p&gt;克服、规避投资中的认知偏差是一个不断求索的过程，我们还有很长的路要走。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-143700bb8aa71740d826e6adf1fc4778_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;501&quot; data-rawheight=&quot;203&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;501&quot; data-original=&quot;https://pic1.zhimg.com/v2-143700bb8aa71740d826e6adf1fc4778_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-143700bb8aa71740d826e6adf1fc4778_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;501&quot; data-rawheight=&quot;203&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;501&quot; data-original=&quot;https://pic1.zhimg.com/v2-143700bb8aa71740d826e6adf1fc4778_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-143700bb8aa71740d826e6adf1fc4778_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barber, B. M. and T. Odean (2008). All that glitters: the effect of attention and news on the buying behavior of individual and institutional investors. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 21(2), 785 – 818.&lt;/li&gt;&lt;li&gt;Baron, J. and J. C. Hershey (1988). Outcome bias in decision evaluation. &lt;i&gt;Journal of Personality and Social Psychology&lt;/i&gt;, Vol. 54(4), 569 – 579.&lt;/li&gt;&lt;li&gt;Hastorf, A. H. and H. Cantril (1954). They saw a game: a case study. &lt;i&gt;Journal of Abnormal and Social Psychology&lt;/i&gt;, Vol. 49, 129 – 134.&lt;/li&gt;&lt;li&gt;Kahneman, D., B. L. Fredrickson, C. A. Schreiber, and D. A. Redelmeier (1993). When more pain is preferred to less: adding a better end. &lt;i&gt;Psychological Science&lt;/i&gt;, Vol. 4(6), 401 – 405.&lt;/li&gt;&lt;li&gt;Kahneman, D. and A. Tversky (1979). Prospect Theory: An Analysis of Decision under Risk. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 47(2), 263 – 291.&lt;/li&gt;&lt;li&gt;Lee, B., J. O’Brien, and K. Sivaramakrishnan (2008). An analysis of financial analysts’ optimism in long-term growth forecasts. &lt;i&gt;Journal of Behavioral Finance&lt;/i&gt;, Vol. 9(3), 171 – 184.&lt;/li&gt;&lt;li&gt;Redelmeier, D. A. and D. Kahneman (1996). Patients’ memories of painful medical treatments: real-time and retrospective evaluations of two minimally invasive procedures. &lt;i&gt;Pain&lt;/i&gt;, Vol. 66(1), 3 – 8.&lt;/li&gt;&lt;li&gt;Tversky, A. and D. Kahneman (1973). Availability: a heuristic for judging frequency and probability. &lt;i&gt;Cognitive Psychology&lt;/i&gt;, Vol. 5(2), 207 – 232.&lt;/li&gt;&lt;li&gt;Tversky, A. and D. Kahneman (1974). Judgment under uncertainty: heuristics and biases. &lt;i&gt;Science&lt;/i&gt;, Vol. 185(4157), 1124 – 1131.&lt;/li&gt;&lt;li&gt;Tversky, A. and D. Kahneman (1981). The faming of decisions and the psychology of choice. &lt;i&gt;Science&lt;/i&gt;, Vol. 211(4481), 453 – 458.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-12-07-48155082</guid>
<pubDate>Fri, 07 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>尾部相关性、尾部风险平价和圣杯分布</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-12-05-51629295.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51629295&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-cb0919ecbc17d8b006d5fad49f9cdc6e_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文首先介绍了尾部相关性，并以此引出尾部风险平价的概念。从风险的角度来说，一个好的投资组合中应该同时拥有 convergent 和 divergent risk taking 的策略。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;年底适合聊聊风险。&lt;/p&gt;&lt;p&gt;在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/49527632&quot;&gt;《艰难时刻需要坚韧信仰》&lt;/a&gt;这篇文章的最后，我们提到了同一大类资产中的不同策略，尽管它们平时的相关性可能很低，但是当极端事件出现时，它们的相关性会骤然上升，同时下跌造成亏损，无法起到分散风险的作用。&lt;b&gt;不同策略在极端情况下的相关性称为尾部相关性（tail correlation），它是进行资产组合配置时需要考虑的关键因素之一。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文将围绕尾部风险展开讨论。下文首先介绍尾部相关性，之后引出&lt;b&gt;尾部风险平价（tail risk parity）&lt;/b&gt;的概念，它被认为比流行的风险平价（risk parity）更能抗风险。最后会介绍两个平时提的较少的两个风险概念 —— &lt;b&gt;convergent and divergent risk taking&lt;/b&gt;。（抱歉，实在找不出来特别合适的中文翻译，但我保证会用中文大白话解释清楚。）&lt;/p&gt;&lt;p&gt;先来看看尾部相关性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 尾部相关性&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;尾部相关性衡量的是不同资产出现极端损失时的相关性。为了计算它，最简单的办法可以采用条件概率计算条件相关性。但是，&lt;b&gt;业界主流的做法是通过 VaR（Value at Risk）或者 ES（Expected Shortfall）来反推尾部相关性，这样得到的结果称为 VaR-implied tail correlation 或 ES-implied tail correlation。&lt;/b&gt;本文介绍后面这种方法。&lt;/p&gt;&lt;p&gt;Liu (2016) 使用 Campbell et al. (2002) 的模型，假设资产 i 的收益率 &lt;equation&gt;r_i&lt;/equation&gt; 分布满足如下形式：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle r_i=\mu_i+\sigma_iZ_i&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;μ_i&lt;/equation&gt; 、 &lt;equation&gt;σ_i&lt;/equation&gt; 分别为均值和标准差， &lt;equation&gt;Z_i&lt;/equation&gt; 为标准正态分布。由上述分布模型以及 VaR 的定义可知，资产 i 的 &lt;equation&gt;α&lt;/equation&gt; 分位数的 VaR 为：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{VaR}_{i,\alpha}=\mu_i+\sigma_i\mbox{VaR}(Z_i)_\alpha&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;假设某投资组合 P 由两个资产按照权重  &lt;equation&gt;w_1&lt;/equation&gt; 和 &lt;equation&gt;w_2&lt;/equation&gt; 构成，则根据定义，投资组合 P 的收益率的标准差满足：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \sigma_P^2=w_1^2\sigma_1^2+w_2^2\sigma_2^2+2w_1w_2\rho\sigma_1\sigma_2&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;将 VaR 定义中右侧的  &lt;equation&gt;σ_i&lt;/equation&gt;  代入上式，并利用 &lt;equation&gt;\mbox{VaR}(Z_1) = \mbox{VaR}(Z_2) = \mbox{VaR}(Z_P)&lt;/equation&gt; 化简，最终得到两个资产间的 VaR-implied correlation：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \rho_{\mbox{VaR},\alpha}=\frac{(\mbox{VaR}_{P,\alpha}-\mu_P)^2-w_1^2(\mbox{VaR}_{1,\alpha}-\mu_1)^2-w_2^2(\mbox{VaR}_{2,\alpha}-\mu_2)^2}{2w_1w_2(\mbox{VaR}_{1,\alpha}-\mu_1)(\mbox{VaR}_{2,\alpha}-\mu_2)}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;除了上述这种计算方法，业界（Cotter and Longin 2006）还使用另一种更简化的方法：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \rho_{\mbox{VaR},\alpha}=\frac{(\mbox{VaR}_{P,\alpha})^2-w_1^2(\mbox{VaR}_{1,\alpha})^2-w_2^2(\mbox{VaR}_{2,\alpha})^2}{2w_1w_2\mbox{VaR}_{1,\alpha}\mbox{VaR}_{2,\alpha}}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;这种方法直接使用资产和投资组合的 VaR 进行计算，并不对 r 的分布做正态假设。它和前一种方法的区别就是计算时是否使用  &lt;equation&gt;μ_i&lt;/equation&gt; 。由于  &lt;equation&gt;μ_i&lt;/equation&gt;  的取值较 VaR 通常小一个数量级，因此两种方法的计算结果非常接近。&lt;/p&gt;&lt;p&gt;值得一提的是，当 VaR 被用来刻画尾部风险时，其常被人诟病的是它仅仅是一个  &lt;equation&gt;α&lt;/equation&gt;  分位数的取值，衡量的是在给定的概率下损失的最小值、不能准确刻画收益分布的左侧肥尾。&lt;b&gt;为了解决这个问题，人们提出了 Expected Shortfall（ES，也称作 Expected Tail Loss）的概念，它是 &lt;/b&gt; &lt;equation&gt;α&lt;/equation&gt; &lt;b&gt; 分位数左侧尾部风险的均值，相较于 VaR 能够更好的刻画尾部风险。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;将上述 VaR-implied correlation 根据 ES 的定义做一步扩展得到 ES-implied correlation：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \rho_{\mbox{ES},\alpha}=\frac{(\mbox{ES}_{P,\alpha}-\mu_P)^2-w_1^2(\mbox{ES}_{1,\alpha}-\mu_1)^2-w_2^2(\mbox{ES}_{2,\alpha}-\mu_2)^2}{2w_1w_2(\mbox{ES}_{1,\alpha}-\mu_1)(\mbox{ES}_{2,\alpha}-\mu_2)}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;来看一个例子。&lt;/p&gt;&lt;p&gt;让我们来看看沪深 300 指数和标普 500 指数的相关性是否随尾部风险递增。假设使用周频数据，数据的跨度从 2005 年 1 月到 2018 年 11 月。上述两种资产在这段时期内周频收益率的相关系数为 0.16。假设按照  &lt;equation&gt;w_1 = w_2 = 0.5&lt;/equation&gt;  的权重配置它们，得到投资组合，以此计算它们之间的 ES-implied correlation。&lt;/p&gt;&lt;p&gt;下图展示了这两种资产和投资组合在不同  &lt;equation&gt;α&lt;/equation&gt;  分位数下的 ES。毫无意外地，随着 &lt;equation&gt;α&lt;/equation&gt; 的减小（代表着尾部事件越来越极端），ES 的亏损幅度也逐渐增大。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3eed9bec1616aed6ec0954ac4c597f3c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;770&quot; data-rawheight=&quot;324&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3eed9bec1616aed6ec0954ac4c597f3c&quot; data-watermark-src=&quot;v2-3d870ad6856b0a63c1b36e89959940a5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;下图是这两种资产的 ES-implied correlation。随着尾部事件越来越极端，二者的尾部 correlation 也逐渐增大，且远远高于整个回测期内的 0.16。当 &lt;equation&gt;α = 1\%&lt;/equation&gt; 时，二者的相关系数高达 0.333；当 &lt;equation&gt;α = 0.5\%&lt;/equation&gt; 时，它们的相关系数进一步增大到 0.445。当金融危机出现的时候，谁都难以独善其身。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5e1e21215bf50e5fded691c0d811f2d5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;761&quot; data-rawheight=&quot;333&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5e1e21215bf50e5fded691c0d811f2d5&quot; data-watermark-src=&quot;v2-130ef8cdde57b609062a206aaef8a43d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;3 尾部风险平价&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于大部分常见的资产或者投资策略，它们的收益分布都有如下的形状 —— 均值为正，但是左侧存在着极端事件造成的巨大亏损，从而造成分布的负偏。这个分布通常称为 Taleb Distribution，以 Nassim Nicholas Taleb 命名；他以黑天鹅一书闻名于世（左侧的极端事件则代表了黑天鹅）。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5a575945a7ff106e4e50f428c6421776_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;572&quot; data-rawheight=&quot;322&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5a575945a7ff106e4e50f428c6421776&quot; data-watermark-src=&quot;v2-d2634797aeb520ab859ea34b334f1681&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;不同资产的尾部相关性远远高于它们平时的相关性说明这些资产的左侧肥尾往往同时出现（比如 2008 年的金融危机），因此在市场出现危机时无法有效的分散风险。&lt;/p&gt;&lt;p&gt;由于这个原因，人们在配置不同的资产或者投资策略时提出了&lt;b&gt;尾部风险平价（tail risk parity）&lt;/b&gt;的概念。它是风险平价的一个延伸（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38301218&quot;&gt;《你真的搞懂了风险平价吗？》&lt;/a&gt; —— 我发现这篇文章是 2017 年 12 月 21 日写的，也是年底）。&lt;/p&gt;&lt;p&gt;&lt;b&gt;尾部风险平价的目标是让不同资产或策略对投资组合的尾部风险贡献相同。&lt;/b&gt;它更多的是一种理念，而具体实现方法则因人而异。比如，如果直接把风险平价的概念应用到尾部风险平价中，我们可以让不同资产的权重 &lt;equation&gt;w_i&lt;/equation&gt; 满足（使用 ES 度量尾部风险）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \frac{\partial\mbox{ES}_P}{\partial w_i}\times w_i=\frac{\partial\mbox{ES}_P}{\partial w_j}\times w_j&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;举个例子。假设有三种资产，它们的收益风险特性如下：&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9449e082525620890eb99d955ab9dd59_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;249&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9449e082525620890eb99d955ab9dd59&quot; data-watermark-src=&quot;v2-a7a94303e3b88a10d715862f5a54eb62&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;按照风险平价和尾部风险平价，这三种资产在投资组合中的权重分别为：&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d2a07da9ae9c3d36d99a4ad881808488_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;132&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d2a07da9ae9c3d36d99a4ad881808488&quot; data-watermark-src=&quot;v2-e6f04458d5cda916853a6ebd15acf846&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;根据这两种方法配置的投资组合的风险收益特征为：&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ad0fb79fc32d4582135c72c8077c27ee_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;244&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ad0fb79fc32d4582135c72c8077c27ee&quot; data-watermark-src=&quot;v2-65587bba50ef155ee07c013324da3612&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;上述结果说明，&lt;b&gt;尾部风险平价以牺牲部分收益为代价换取了投资组合更低的尾部风险和波动率&lt;/b&gt;。在这个例子中，两种配置方法的夏普率相同，但从衡量尾部风险控制的指标 μ/ES 来看，尾部风险平价无疑更有优势。&lt;/p&gt;&lt;p&gt;再来看看另一种尾部风险平价的实现方法。下面这个投资组合在 TLT（US long government bond ETF）和 SPY（S&amp;amp;P 500 Index ETF）之间配置。&lt;b&gt;它使用资产的最大回撤作为评价尾部风险的指标，要求二者对投资组合的最大回撤贡献相似。&lt;/b&gt;最终，它以 70% 和 30% 的比例将资金分配于 TLT 和 SPY 之中。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f96a176fc1199c8800213a64b6b99cb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1116&quot; data-rawheight=&quot;645&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3f96a176fc1199c8800213a64b6b99cb&quot; data-watermark-src=&quot;v2-2a7d87fbcabd5c624dfd8378cc508979&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;当不同资产（或策略）的尾部风险在时间上不重叠时（即发生在不同的时期），尾部风险平价则可以发挥出最大的威力。这也体现了大类资产配置的重要性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 Convergent vs Divergent Risk Taking&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本小节来介绍两个平时人们可能听的比较少的概念 —— convergent and divergent risk taking。&lt;/p&gt;&lt;p&gt;在那之前，先让我们说说圣杯分布。&lt;/p&gt;&lt;p&gt;上一小节介绍了 Taleb 分布。如果有一种资产或者投资策略，它的收益分布满足期望为正、但肥尾在右侧 —— 即“风险有限、收益无限”，我们则称它的分布满足&lt;b&gt;圣杯分布（Holy Grail distribution）&lt;/b&gt;。&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0d2ab0486adc99bf0373cc80192973ba_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;350&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-0d2ab0486adc99bf0373cc80192973ba&quot; data-watermark-src=&quot;v2-ce6cc54619aefa3a05274875e142b281&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;每个人都希望找到这样的收益分布，它能够和常见的 Taleb 分布很好的对冲、分散风险。在极端事件给传统资产带来巨额亏损时，这类策略往往有很好的收益。什么样的策略具备这种分布呢？这需要从策略暴露的风险说起，从而引出我们的主角 —— convergent and divergent risk taking。这两个术语经常出现在管理期货中。&lt;/p&gt;&lt;p&gt;&lt;b&gt;任何投资策略想要赚钱，都需要承担一定的风险。&lt;/b&gt;而策略承担什么样的风险就决定了它的收益分布具备何种的特征。风险可以被分为 convergent risks 和 divergent risks 两大类，因此策略也可以被视为 convergent risk taking 和 divergent risk taking 两大类。&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Convergent risks 是那些被人们理解、可通过建模并使用量化手段测量（尽管不一定准确）的风险。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Divergent risks 是哪些未知的风险、无法预测的风险、不能很好的被度量的风险。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;当我们构建 convergent risk taking 策略的时候，我们会根据金融学或者经济学对市场或者投资品的走势有一个先验信仰，并以此为判断做出投资决策。&lt;/b&gt;以 long only 的股票投资为例，我们相信股市是经济的晴雨表，而长期来看经济会增长、股票则会给我们带来 risk premium，因此愿意承担其短期波动（可能很大）带来的风险。这样的策略就是 convergent risk taking 策略。&lt;/p&gt;&lt;p&gt;&lt;b&gt;另一方面，在构建 divergent risk taking 策略时，人们假设投资品未来的走势是未知的、不使用任何先验信仰来辅助判断投资品会涨还是会跌。&lt;/b&gt;如果过去投资品一直涨，但是最近开始跌了，那么这种类型的策略不会以该投资品过去的走势为先验从而认为它还会继续涨，而是会顺应当下的趋势而认为它还会继续跌。&lt;/p&gt;&lt;p&gt;在上面提到的两种不同风险类型的策略中，&lt;b&gt;股市中的价值投资无疑是 convergent risk taking 的代表。&lt;/b&gt;这类策略通过深度行业研究挖掘上市公司的内在价值，当价格低于价值时则买入且越低（跌）越买，耐心的等待其价格向价值回归、无视短期的波动，这是这类策略愿意且主动承担的风险。&lt;/p&gt;&lt;p&gt;&lt;b&gt;常见于 CTA 中的趋势追踪策略或者股市中的动量策略无疑是 divergent risk taking 的代表。&lt;/b&gt;这类策略对投资品的内在价值不做任何假设，仅仅是严格依据价格的走势进行交易：价格上涨了做多、价格下跌时做空；当盈利时会逐渐加仓，当亏损时会及时清仓。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Divergent risk taking 策略的收益特征满足了圣杯分布的特性。&lt;/b&gt;这就是为什么趋势追踪策略能够长盛不衰的原因。在趋势追踪领域不乏 Winton Group 和 Aspect Capital 这样的杰出代表。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2013 年，Asness、Moskowitz 以及 Pedersen 在 Journal of Finance 上发表了一篇影响深远的文章，题为 Value and Momentum Everywhere（Asness et al. 2013）。通过上文的描述，&lt;b&gt;不难看出 Value 和 Momentum 恰恰代表了两大类 risk taking 策略，从风险的角度，它们完美的互补。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;有必要指出的是，圣杯分布是非常美好的，而获得美好的东西注定是十分困难的。&lt;/b&gt;趋势策略本身是非常反人性的（见&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzIyMDEwNDk1Mg==&amp;amp;mid=2650875531&amp;amp;idx=1&amp;amp;sn=76cf95ccad5ddfbdebe7c26855570c1d&amp;amp;scene=21#wechat_redirect&quot;&gt;《海龟交易法则：逆人性投资》&lt;/a&gt;）。趋势策略最困难的地方在于在趋势中拿的住单子，让利润奔跑（只有这样才能实现收益率分布的右尾）。由于认知偏差中造成的对于确定性低收益的过度偏爱，人们总是倾向于早早平掉盈利的单子。市场中有句老话说的是&lt;b&gt;趋势策略最赚钱的时候一定是交易者最难受的时候。&lt;/b&gt;只有克服人性的种种错误，才能真正享受到趋势策略带来的圣杯分布。&lt;/p&gt;&lt;p&gt;本文从尾部相关性出发介绍了如何基于 VaR 或者 ES 计算在极端事件发生时资产之间的相关性。大量的实证表明，同类甚至是跨大类的资产在市场发生危机的时候相关性都会迅速蹿升，导致投资组合的巨大亏损。为了减轻这个问题，尾部风险平价的资产配置方法越来越被投资者认可。该方法以牺牲一定的收益换来危机时更低的亏损，从而提升投资组合的风险收益特征。&lt;/p&gt;&lt;p&gt;本文的最后指出，&lt;b&gt;从风险的角度来说，一个好的投资组合中应该同时拥有 convergent 和 divergent risk taking 的策略。&lt;/b&gt;这两个概念其实并不是什么“玄幻”的东西，它们在生活中也很常见。比如在社会交往方面，有的人更喜欢只和少数几个交心的朋友互动、非常珍视小范围的朋友圈，这属于 convergent 行为；而另一些人则更加 social，喜欢和各种各样的人打交道、交朋友、坚信人生的下一个 big opportunity 就来自某个新朋友，这就属于 divergent 行为。这两种行为并无对错、也各有优缺点；将它们结合起来往往会实现双赢。&lt;/p&gt;&lt;p&gt;希望本文的介绍能带给你一些启发，更加科学的分配投资组合暴露的风险。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Asness, C. S., T. J. Moskowitz, and L. H. Pedersen (2013). Value and Momentum Everywhere. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 68(3), 929 – 985.&lt;/li&gt;&lt;li&gt;Campbell, R., K. Koedijk, and P. Kofman (2002). Increased correlation in bear markets. &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, Vol. 58(1), 87 – 94.&lt;/li&gt;&lt;li&gt;Cotter, J. and F. Longin (2006). &lt;i&gt;Implied correlation from VaR&lt;/i&gt;. MPRA paper No. 3506, University College Dublin.&lt;/li&gt;&lt;li&gt;Liu, J. (2016). &lt;i&gt;A new tail-based correlation&lt;/i&gt;. Working paper, McGill University.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-12-05-51629295</guid>
<pubDate>Wed, 05 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>美股上一个跨越时间尺度的趋势因子</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2018-11-28-51043407.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51043407&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-57e217c9f9cffb81280147535f0b1a72_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Han et al. (2016) 通过截面回归将美股上的短期反转、中期动量和长期反转合并成一个新的趋势因子。该因子能获得显著的超额收益，为美股的 asset pricing 提供了新的思路。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;熟悉美股 asset pricing 或 factor investing 的小伙伴都知道，&lt;b&gt;美股在不同的时间尺度上表现出了动量或者反转效应&lt;/b&gt;。比如，在研究动量因子时，常见的做法是按照月频使用 t – 12 到 t – 1 之间的收益率作为动量因子，这说明在一年这个时间尺度上存在动量，而之所以刨去最近一个月是因为未来收益率往往和最近一个月呈现反转。此外，DeBondt and Thaler (1985) 指出美股在 3 ~ 5 年的时间尺度上存在反转。&lt;/p&gt;&lt;p&gt;鉴于上述现象，一个自然的想法是针对不同的周期构建三个因子 —— 短周期的反转因子、中周期的动量因子、以及超长周期的反转因子，然后把投资组合适当的暴露在这些不同的因子中。如果这三个级别的不同现象都能带来 risk premium，则长期来看暴露在它们之上会有好的投资回报。&lt;/p&gt;&lt;p&gt;然而，除此之外，&lt;b&gt;是否有更好的办法把不同级别的动量或者反转因子综合到一起，构建一个跨越不同时间尺度的趋势因子呢？&lt;/b&gt;2016 年，一篇发表于顶刊 Journal of Financial Economics 的文章（Han et al. 2016）给出了肯定的答案。这篇文章的三位作者是 UNC Charlotte 的 Yufeng Han、Washington Univ. in St. Louis 的周国富以及清华大学的朱英姿教授。&lt;/p&gt;&lt;p&gt;老实说，我对于这篇文章的看法有些复杂。原因有二。&lt;/p&gt;&lt;ul&gt;&lt;li&gt;第一个原因是，当我最初看完该文的摘要和 Introduction 的时候，“不负责任”的主观想法是既然这三个级别的趋势、反转各自有效，那么按照一定的方法把它们动态的组合在一起一定能（在 in-sample）取得更好的效果，但是这肯定有过拟合之嫌。不过随着继续深入研读，三位作者从不同的角度、通过大量的 empirical results 大大打消了读者对于过拟合的疑虑。&lt;/li&gt;&lt;li&gt;第二个原因是在大 A 股上动量因子 —— 无论在什么尺度上 —— 似乎都不太好用，常见的都是各种反转。因此，在未经过系统实证的情况下，我无法确定该方法移植到 A 股后是否也有很好效果。但是，&lt;b&gt;这篇文章中采用的通过截面回归来构建趋势因子的思路，以及为了检验该因子而使用的很多统计手段都非常值得在进行 asset pricing 时借鉴。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;出于这些考虑，我决定花笔墨把这篇文章认真介绍一下，希望给各位一些启发。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 趋势因子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;为了构建趋势因子，首先要选择具体的方法来计算不同时间尺度下的动量、反转。为此，Han et al. (2016) 采用的是 &lt;b&gt;Moving Average（MA，移动平均）&lt;/b&gt;。移动平均是一个被技术分析广泛采用的简单指标，许多实盘交易结果指出 MA 对于未来的收益率有一定的预测性。&lt;/p&gt;&lt;p&gt;在理论方面，Han et al. (2016) 受到 Wang (1993) 的启发，使用一个简单的随机过程模型对于 MA 在收益率上面的预测性进行了分析。此外，Zhu and Zhou (2009) 从资产配置的角度研究了移动平均的价值。理论分析和实证数据均显示移动平均在交易中的作用。&lt;/p&gt;&lt;p&gt;在 Han et al. (2016) 研究的实证中，计算趋势因子的频率是月频，回测期为 1926 年 1 月至 2014 年 12 月（数据来自 CRSP 并采用了学术界常见的数据处理方法）。为了计算趋势因子，首先在每个月 t 的最后一个交易日计算每支股票（用 j 表示）在不同时间尺度 L 的移动平均：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle A_{jt,L}=\frac{P_{j,t-L+1}+P_{j,t-L+2}+\cdots+P_{j,t}}{L}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;equation&gt;P_{j, t-L+i}&lt;/equation&gt; 为股票 j 在第 t-L+i 个月最后一个交易日的价格（上述表达式和 Han et al. 2016 中的有些差异；我在不影响理解的前提下简化了表达式）。考虑到不同股票价格的量级存在巨大的差别，计算的下一步是使用最新的价格 &lt;equation&gt;P_{j, t}&lt;/equation&gt; 对上述移动平均进行标准化：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \tilde A_{jt,L}=\frac{A_{jt,L}}{P_{j,t}}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;在有了不同时间尺度（lag L）的移动平均之后，Han et al. (2016) 将它们视作不同级别的趋势（可能是动量、也可能是反转）信号，&lt;b&gt;在每期使用股票最新的 MA 指标和下一期的收益率进行截面回归，得到这些移动均线因子的收益率&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle r_{j,t}=\beta_{0,t}+\sum_{i}\beta_{i,t}\tilde A_{jt-1,L_i}+\epsilon_{j,t},~~~j=1,\cdots,n&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;equation&gt;r_{j,t}&lt;/equation&gt; 为个股 j 在 t 期的收益率， &lt;equation&gt;L_i&lt;/equation&gt; 为第 i 个计算移动平均的时间尺度。通过截面回归就可以得到这些移动平均因子的收益率 &lt;equation&gt;β_{i,t}&lt;/equation&gt; 。再具体计算时，计算均线的时间尺度 &lt;equation&gt;L_i&lt;/equation&gt; 的取值为 3、5、10、20、50、100、200、400、600、800 以及 1000 个交易日，它们分别对应的时间尺度为日频、周频、月频、季度、一年、两年、三年以及四年。&lt;/p&gt;&lt;p&gt;一旦在不同 t 上使用截面回归得到了  &lt;equation&gt;β_{i,t}&lt;/equation&gt; ，就可以在时序上取均值来预测下一个选股窗口内（月频）各均线因子的预期收益率。为此，作者采用了使用过去 12 个月的 &lt;equation&gt;β_{i,t}&lt;/equation&gt; 来计算下个月的预期收益率：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{E}_t[\beta_{i,t+1}]=\frac{1}{12}\sum_{m=1}^{12}\beta_{i,t+1-m}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;最终，使用对 t + 1 的均线预期收益率 &lt;equation&gt;\mbox{E}_t[β_{i,t+1}]&lt;/equation&gt; 和个股 j 在 t 期的最新均线指标取值就可以计算出每支股票在 t + 1 的收益率预测，并以此对股票排序构建趋势因子（在该计算中并不需要用到截面回归的截距项，因为该项对所有个股都一样，不改变因子的单调性）：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \mbox{E}[r_{i,t+1}]=\sum_{i}\mbox{E}_t[\beta_{i,t+1}]\tilde A_{jt,L_i}&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;简单梳理一下。上述计算趋势因子的过程首先找出了每支股票在不同时间尺度下的移动平均；将这些移动平均视为因子并通过截面回归得到每期因子收益率；通过滚动窗口计算出每个移动平均因子在这段时间内的收益率均值，&lt;b&gt;从而动态的捕捉了在不同的历史时期，哪种级别的移动均线对于预测下一期的股票收益率最有效&lt;/b&gt;（β 的方向决定了方向 —— 动量或者反转，β 的大小决定了预测的强弱）；最终使用移动均线因子收益率和最新的因子取值计算出个股下一期收益率的预测，以此对个股排序。&lt;/p&gt;&lt;p&gt;&lt;b&gt;具体的，在每个月末将股票按照预期收益率从大到小排序，将排名前 1/5 的股票等权构建多头组合，将排名后 1/5 的股票等权构建空头组合。多空组合的收益率之差就是该趋势因子。&lt;/b&gt;和我们熟悉的 HML、SMB 一样，趋势因子本身也是一个多空投资组合的收益率。&lt;/p&gt;&lt;p&gt;下图展示了回测期内趋势因子（Trend）和短期反转（SREV）、中期动量（MOM）以及长期反转（LREV）以及 Fama-French 三因子（Fama and French 1993）的收益。从均值（以及对应的 t-statistic）来看，趋势因子无疑优势明显。&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aee486abfa4f1b735b500b5316a16a1f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;825&quot; data-rawheight=&quot;662&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-aee486abfa4f1b735b500b5316a16a1f&quot; data-watermark-src=&quot;v2-ee93a4e6964bd767ed44ea614e77d393&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;接下来就来比较一下这个新的趋势因子和传统的动量、反转因子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 趋势因子 vs 传统动量、反转因子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;尽管动量因子在美股上占有举足轻重的地位，但它经常被人诟病的是该因子在市场从熊市反弹时的不良表现。在这些时期，动量因子的空头一方总会出现报复性反弹，收益率远超其多头一方，造成动量因子巨大的损失。这个现象被称为 &lt;b&gt;momentum crashes&lt;/b&gt;（Daniel and Moskowitz 2016）。&lt;/p&gt;&lt;p&gt;Han et al. (2016) 的经验结果显示，新的趋势因子在 momentum crashes 时期往往能取得非常优异的收益：&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d1673139dc5f2738ec9641021bfe1506_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;839&quot; data-rawheight=&quot;638&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d1673139dc5f2738ec9641021bfe1506&quot; data-watermark-src=&quot;v2-f064c1dba618945b4b0e259a9674a22d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;分析其原因，是因为新的趋势因子和传统的动量因子的相关性很低。由于该方法通过滚动回归动态的暴露在不同级别的移动均线指标上，因此可以想见在回测期内，它更多暴露在长、短期反转因子上，而非中期动量因子上。下图（Panel B）展示了趋势因子和传统因子的相关性，说明了这一点。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-491b43fabb66e9edc5b429724ad556d4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;857&quot; data-rawheight=&quot;697&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-491b43fabb66e9edc5b429724ad556d4&quot; data-watermark-src=&quot;v2-16373c461aa99e8dcde918bb7eea3c39&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;然而，在上面的结果中，最令我惊讶的是趋势因子非常小的最大回撤（max drawdown，MDD）—— 其最大回撤只有 20%（too good to be true），远远优于其他三个动量、反转因子。这说明在市场下行的时候，趋势因子中空头一方非常给力。当然，在实际投资中，考虑到交易的成本和各种做空的限制，上述结果会打一定的折扣。Han et al. (2016) 也客观的指出，为了科学评价该趋势因子在实际投资中的价值仍需要更多的研究工作。&lt;/p&gt;&lt;p&gt;为了定量比较新的趋势因子和传统的动量、反转因子，Han et al. (2016) 采用了学术界常用的 &lt;b&gt;mean-variance spanning tests&lt;/b&gt;（Huberman and Kandel 1987）。直观的说，该方法考察 K 个已知资产构建的 mean-variance 有效前沿能否包含某个新资产（或者投资组合）。在数学上，考虑新的趋势因子和 SREV、MOM 以及 LREV 三因子的回归模型如下：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle r_{\mbox{Trend},t}=\alpha+\beta_1 r_{\mbox{SREV},t}+\beta_2 r_{\mbox{MOM},t}+\beta_3 r_{\mbox{LREV},t}+\epsilon_t&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;该检验的 null hypothesis 是：&lt;/p&gt;&lt;p&gt;&lt;equation&gt;\displaystyle \alpha=0,~~~\beta_1+\beta_2+\beta_3=1&lt;/equation&gt; &lt;/p&gt;&lt;p&gt;Kan and Zhou (2012) 指出 mean-variance spanning tests 有六个不同的版本。下表考虑了全部六个版本，并考虑了不同的回测期 —— 全部回测期、衰退期以及金融危机。&lt;b&gt;所有版本均显著的拒绝原假设，说明新的趋势因子存在传统动量、反转因子无法解释的股票截面预期收益差异。&lt;/b&gt;这意味着，仅仅通过将投资组合暴露于传统的 SREV、MOM 以及 LREV 三因子无法取得该趋势因子带来的超额收益。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6aefd13564d2a4d34214b772de81c93c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;823&quot; data-rawheight=&quot;545&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6aefd13564d2a4d34214b772de81c93c&quot; data-watermark-src=&quot;v2-4290b5449174a735d52346236e53a326&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;最后来看看趋势因子能否被 CAPM 模型以及 Fama-French 三因子模型解释 —— 即考察它是否有 CAPM-α 和三因子-α。除了考察趋势因子自身之外，Han et al. (2016) 还考虑了根据预期收益率高低将股票分成五档构建的投资组合，结果如下表所示。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0cd46595cd5872914401bd4b6a3523c1_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;816&quot; data-rawheight=&quot;718&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-0cd46595cd5872914401bd4b6a3523c1&quot; data-watermark-src=&quot;v2-e75b6244eb82a96788b068ed27d3db44&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;从结果来看，对于趋势因子，它存在无法被传统 CAPM 或 Fama-French 三因子解释的超额收益。从因子暴露来看，当使用三因子模型时，它在 SMB 和 HML 上的暴露在统计上非常不显著。&lt;/p&gt;&lt;p&gt;&lt;b&gt;面对如此超额收益，Han et al. (2016) 却指出，他们并不认为该趋势因子一定是一个异象（anomaly）。&lt;/b&gt;作者认为趋势背后也许存在对应的风险，而趋势获得的超额收益和风险补偿有关。有效市场假说（EMH）之父 Eugene Fama 指出，market efficiency 已经成为一个 &lt;b&gt;joint hypothesis&lt;/b&gt; 问题 —— 即为了检验市场有效性，首先要有一个合理的 asset pricing 模型；如果模型未知或者错误，就不能正确的评判任何异象是否真的是异象。这意味着，检验 EMH 的同时必须也要检验 asset pricing 模型。依照这个思路，如果趋势因子（或者更传统意义上的动量）是真实（但未知）asset pricing 模型的一部分，那么它获取的超额收益就是某种风险的补偿，而非市场异象。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 趋势因子是否来自数据挖掘？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;正如引言中所说的，我最初对趋势因子持怀疑态度，认为它不可避免的存在数据挖掘的问题。&lt;b&gt;与传统的动量或反转因子相比，该因子无论从模型复杂度或者参数复杂度都更高，因此数据挖掘的可能性也更大。&lt;/b&gt;针对这方面，Han et al. (2016) 从四个角度进行了阐述。&lt;/p&gt;&lt;p&gt;首先，三位作者指出，构建趋势因子所使用的移动平均窗口长度并非优化的结果，这些参数背后都有一定的业务逻辑。第二，如果把回测期按照每十年分成一个区间并观测趋势因子在这些区间内的表现（下图）会发现该因子获得的收益非常稳健。&lt;b&gt;作者指出稳健的表现说明该因子不太可能是数据挖掘的产物&lt;/b&gt;。&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-698eb396373d8b209dc070ab0df13d00_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;575&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-698eb396373d8b209dc070ab0df13d00&quot; data-watermark-src=&quot;v2-f4d0ffb1490a9e7178b64aecea96d412&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;第三，Harvey et al. (2016) 针对“因子挖掘”界普遍存在的 multiple testing 问题，提出单一因子的 t-statistic 至少要超过 3 才有可能是一个真的异象。而趋势因子的 t-statistic 高达 13.6（传统动量因子的 t-statistic 为 6.04），远超这一阈值。不过 Harvey et al. (2016) 自己也指出即便是这个阈值也非常保守。为此，Harvey and Liu (2018) 针对 multiple testing 的问题，提出了一个基于回归的分析因子有效性的框架（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;），在该框架下，传统的动量因子已经不再有效。因此，使用该框架来进一步检验趋势因子是否有效可以作为一个未来的研究课题。&lt;/p&gt;&lt;p&gt;&lt;b&gt;最后的第四个角度是 out of sample test，它无疑比前三个角度更具说服力。&lt;/b&gt;Han et al. (2016) 在其他 G7 国家（法国、英国、德国、意大利、加拿大、日本）的股市中检验了趋势因子的有效性。在所有这些国家中均观察到了来自趋势因子的超额收益；除德国外，在其他国家中的月频 CAPM-α 均高于 1%。虽然趋势因子在这些国家中的表现没有在美股上明显，但无疑作为样本外的数据集，这样的结果支持了“趋势因子并非数据挖掘的产物”这一观点。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 Fama-MacBeth Regression&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;除了上述四个角度的论述外，Han et al. (2016) 还进行了很多 robustness check 并通过考虑交易成本来检查趋势因子的有效性。本小节挑选这其中的 Fama-MacBeth regression（Fama and MacBeth 1973）进行介绍。Fama-MacBeth regression 的优势在于可以控制很多变量，从而考察目标变量在解释股票预期收益率截面差异的显著性。&lt;/p&gt;&lt;p&gt;在 Fama-MacBeth regression 中，回归方程左侧的是个股的收益率，在右侧的解释变量中，除了常见的因子（如 log(size)、log(B/M)、E/P）外，还加入了 &lt;equation&gt;ER_{trd}^{12}&lt;/equation&gt; 、 &lt;equation&gt;ER_{trd}^{6}&lt;/equation&gt; 及 &lt;equation&gt;ER_{trd}^{60}&lt;/equation&gt; 等使用不同尺度 MA 计算出来的预期收益率。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-93fac172474efe489eeb187c7c69cfcb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;989&quot; data-rawheight=&quot;731&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-93fac172474efe489eeb187c7c69cfcb&quot; data-watermark-src=&quot;v2-c85b4cc2c31401862dbf9852e79ab8fc&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;结果（上图）显示，当考虑了常见的因子后，被加入回归的 &lt;/b&gt;&lt;equation&gt;ER_{trd}^{12}&lt;/equation&gt; &lt;b&gt;、&lt;/b&gt; &lt;equation&gt;ER_{trd}^{6}&lt;/equation&gt;&lt;b&gt; 或 &lt;/b&gt;&lt;equation&gt;ER_{trd}^{60}&lt;/equation&gt;&lt;b&gt; 依然对个股的截面预期收益率差异有非常显著的解释作用。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 趋势因子和信息不确定性&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;长久以来，技术分析和基本面分析是股票投资中的两大派系，而移动平均是技术分析中的优秀手段。因此，本文介绍的基于移动平均的趋势因子也源自技术分析，是使用技术分析进行 asset pricing 的一种努力。当股票的（基本面）信息存在较高的不确定性时，投资者和交易者往往更倾向使用技术分析手段来选股。由此，Han et al. (2016) 提出了一个假设：&lt;b&gt;在信息不确定性高的股票中（比在信息不确定性低的股票中）使用趋势因子可获得更高的收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了验证这一点，该文选择了市值、特异性波动率、换手率、分析师覆盖、公司年龄作为信息不确定的代理指标。具体来说，&lt;b&gt;高的信息不确定性意味着公司市值小、特异性波动率大、换手率低、分析师覆盖少、以及公司年龄短。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Han et al. (2016) 将股票逐一使用这些代理指标以及趋势因子进行 double sorting，然后考察趋势因子的效果，结果如下图所示（省略了 market size 这个指标）。以 IVol（特异性波动率）为例，对于 IVol 低的股票（信息不确定性低），趋势因子的月频收益率均值为 0.87% ，而对于 IVol 高的股票（信息不确定性高），趋势因子的月频收益率高达 2.25%。&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-305a8c33fd2d74c5fdfcedd61d711256_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;793&quot; data-rawheight=&quot;682&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-305a8c33fd2d74c5fdfcedd61d711256&quot; data-watermark-src=&quot;v2-a747b2220e7f3ebd5364ca73a699a763&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;对于其他的信息不确定性代理指标，也都可以观察到类似的结果，从而证实了“趋势因子在信息不确定性高的股票中能获得更高的收益”这一猜想。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Han et al. (2016) 通过截面回归将美股上的短期反转、中期动量和长期反转合并成一个新的趋势因子。该因子能获得显著的超额收益，为美股的 asset pricing 提供了新的思路。除了本文介绍的内容外，Han et al. (2016) 还包括更多的统计检验，给出了关于这个新的趋势因子的大量实证结果。&lt;/p&gt;&lt;p&gt;如果让我来总结一下，这篇文中最重要的一点在于使用传统 SREV、MOM 以及 LREV 三个因子进行的 mean-variance spanning 无法解释新的趋势因子。这意味着，&lt;b&gt;围绕上述三因子暴露构建的投资组合无法获得基于这个单一趋势因子所能获得的超额收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为什么会出现这种现象了？下图 —— MA(20) 和 MA(100) 的回归系数随时间的变化 —— 给出了答案。&lt;b&gt;这些回归系数随时间的变化意味着在构建趋势因子时，通过使用截面回归，该趋势因子动态的捕捉了不同时间尺度上的动量、反转信号在预测股票收益率时的作用。&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-eb2337ceac357c6aa558d78cbe1a16a2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;648&quot; data-rawheight=&quot;643&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-eb2337ceac357c6aa558d78cbe1a16a2&quot; data-watermark-src=&quot;v2-37519d6e09de1ac6db51cef31b47471f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;虽然无法完全排除数据挖掘的可能性，但不可否认该因子在不同历史时期捕捉到了不同级别的动量、反转信号。Han et al. (2016) 这篇文章的实证结果到 2014 年 12 月，在未来可以采用 2015 年开始的样本外数据对其检验，考察其是否依然有效。&lt;/p&gt;&lt;p&gt;&lt;b&gt;趋势追踪策略面临的最大难题通常是在哪种时间尺度上计算趋势。趋势往往很难稳健的存在于固定的频率。&lt;/b&gt;这个趋势因子从一定程度上解决了这个问题。然而，它背后一个较强的经验数据依据是美股在历史长河中确实存在显著的短期反转、中期动量和长期反转。如果在未来，用于计算该因子的一个或者多个级别的移动均线不再有预测收益率的能力，那么该趋势因子将会面临新的挑战。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Daniel, K. and T. J. Moskowitz (2016). Momentum Crashes. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 122(2), 221 – 247.&lt;/li&gt;&lt;li&gt;DeBondt, W. F. M. and R. Thaler. (1985). Does the stock market overreact? &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 40(3), 793 – 805.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Han, Y., Zhou, G., Y. Zhu (2016). A trend factor: any economic gains from using information over investment horizons? &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 122(2), 352 – 375.&lt;/li&gt;&lt;li&gt;Harvey, C. R., Y. Liu, and H. Zhu (2016). … and the cross-section of expected returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 5 – 68.&lt;/li&gt;&lt;li&gt;Harvey, C. R. and Y. Liu (2018). Lucky Factors. Working paper, &lt;i&gt;available at SSRN: https://ssrn.com/abstract=2528780&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;Huberman G. and S. Kandel (1987). Mean-variance spanning. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 42(4), 873 – 888.&lt;/li&gt;&lt;li&gt;Kan, R. and G. Zhou (2012). Tests of mean-variance spanning. &lt;i&gt;Annals of Economics and Finance&lt;/i&gt;, Vol. 13(1), 139 – 187.&lt;/li&gt;&lt;li&gt;Wang, J. (1993). A model of intertemporal asset prices under asymmetric information. &lt;i&gt;Review of Economic Studies&lt;/i&gt;, Vol. 60, 249 – 282.&lt;/li&gt;&lt;li&gt;Zhu, Y. and G. Zhou (2009). Technical analysis: an asset allocation perspective on the use of moving averages. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 92(3), 519 – 544.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://rightknights.com/&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2018-11-28-51043407</guid>
<pubDate>Wed, 28 Nov 2018 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
